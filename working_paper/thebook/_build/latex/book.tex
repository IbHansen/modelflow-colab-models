%% Generated by Sphinx.
\def\sphinxdocclass{jupyterBook}
\documentclass[letterpaper,10pt,english]{jupyterBook}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
\ifdefined\pdfimageresolution
    \pdfimageresolution= \numexpr \dimexpr1in\relax/\sphinxpxdimen\relax
\fi
%% let collapsible pdf bookmarks panel have high depth per default
\PassOptionsToPackage{bookmarksdepth=5}{hyperref}
%% turn off hyperref patch of \index as sphinx.xdy xindy module takes care of
%% suitable \hyperpage mark-up, working around hyperref-xindy incompatibility
\PassOptionsToPackage{hyperindex=false}{hyperref}
%% memoir class requires extra handling
\makeatletter\@ifclassloaded{memoir}
{\ifdefined\memhyperindexfalse\memhyperindexfalse\fi}{}\makeatother

\PassOptionsToPackage{warn}{textcomp}

\catcode`^^^^00a0\active\protected\def^^^^00a0{\leavevmode\nobreak\ }
\usepackage{cmap}
\usepackage{fontspec}
\defaultfontfeatures[\rmfamily,\sffamily,\ttfamily]{}
\usepackage{amsmath,amssymb,amstext}
\usepackage{polyglossia}
\setmainlanguage{english}



\setmainfont{FreeSerif}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Italic,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldItalic
]
\setsansfont{FreeSans}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Oblique,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldOblique,
]
\setmonofont{FreeMono}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Oblique,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldOblique,
]



\usepackage[Bjarne]{fncychap}
\usepackage[,numfigreset=1,mathnumfig]{sphinx}

\fvset{fontsize=\small}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}

\addto\captionsenglish{\renewcommand{\contentsname}{Model, solutions and Modelflow}}

\usepackage{sphinxmessages}



        % Start of preamble defined in sphinx-jupyterbook-latex %
         \usepackage[Latin,Greek]{ucharclasses}
        \usepackage{unicode-math}
        % fixing title of the toc
        \addto\captionsenglish{\renewcommand{\contentsname}{Contents}}
        \hypersetup{
            pdfencoding=auto,
            psdextra
        }
        % End of preamble defined in sphinx-jupyterbook-latex %
        

\title{MFMod models in Python with ModelFlow}
\date{Oct 11, 2022}
\release{}
\author{Ib Hansen}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{}
\makeindex
\begin{document}

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{content/introduction::doc}}


\begin{sphinxadmonition}{warning}{Warning:}
\sphinxAtStartPar
This Jupyter book is work in progress and very much a draft.

\sphinxAtStartPar
Please send any suggestions and comments to Ib
\end{sphinxadmonition}

\sphinxAtStartPar
The purpose of this Jupyter Book is to introduce
the handeling of \sphinxhref{https://openknowledge.worldbank.org/handle/10986/32217}{World Bank‚Äôs macroeconomic and fiscal model(MFMod)} in python. This is acomplished through a python library: \sphinxcode{\sphinxupquote{modelflow}}.

\sphinxAtStartPar
ModelFlow is a Python library developed to leverage on the Pandas data management library and the broader Python ecosystem. Using Modelflow you can:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Solve models

\item {} 
\sphinxAtStartPar
Analyze models

\item {} 
\sphinxAtStartPar
Analyze results

\item {} 
\sphinxAtStartPar
Visualize results

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Model Specification} With ModelFlow you can specify your models as concise and intuitive equations. ModelFlow transforms your equations into Python code and solves your model.

\sphinxAtStartPar
\sphinxstylestrong{Large models}.
ModelFlow can handle models with 1 million equations and more. The library is therefore also suited for very large models.

\sphinxAtStartPar
\sphinxstylestrong{Agile model development}
The models are specified at a high level of abstraction and are processed fast. This makes ModelFlow the obvious choice when developing and experimenting with large models.

\sphinxAtStartPar
\sphinxstylestrong{Onboarding models}.
Creating a model often entails recycling several models specified in different ways: Eviews, Excel, Latex, Dynare, Python and other languages/tools.
ModelFlow, which is nested in the Python‚Äôs ecosystem, makes it possible to transform models defined in many different languages into ModelFlow models.

\sphinxAtStartPar
\sphinxstylestrong{Onboarding data}.
ModelFlow is build on top of Pythons Pandas Library. Pandas is the swiss army knife for datascience and has a lot of data wrangeling capabilities and in addition makes it easy to import and manage data from different sources.

\sphinxAtStartPar
\sphinxstylestrong{Analytic} ModelFlow provides you with a range of visual tools that help you understand your models and your results.

\sphinxAtStartPar
\sphinxstylestrong{Open Source}
Be part of the community. The entire library is written in Python and is to be found on this \sphinxhref{https://github.com/IbHansen/Modelflow2}{Github page}  . So you can adjust the tools to your needs or help develope the library further.

\sphinxAtStartPar
The documentation can be viewed \sphinxhref{https://ibhansen.github.io/doc}{here}

\sphinxAtStartPar
\sphinxstylestrong{Acknowledgment}
<Fortcomming>

\sphinxstepscope


\part{Model, solutions and Modelflow}

\sphinxstepscope


\chapter{What is a Model in ModelFlow ?}
\label{\detokenize{content/notebooks/intro/model and solution:what-is-a-model-in-modelflow}}\label{\detokenize{content/notebooks/intro/model and solution::doc}}
\sphinxAtStartPar
The term \sphinxhref{https://en.wikipedia.org/wiki/Model}{\sphinxstylestrong{model}} can mean different things to different people. A model in the eyes of the ModelFlow library is a \sphinxstylestrong{discrete} model that can be defined as one or several \sphinxstylestrong{mathematical equations}. The equations are the same for every time frame, \(t\) and \sphinxstyleemphasis{can} have \sphinxstylestrong{lagged} and \sphinxstylestrong{leaded} variables.

\sphinxAtStartPar
A good book on model solution is \hyperlink{cite.content/litterature:id8}{Pauletto} also  \hyperlink{cite.content/litterature:id7}{Petersen and Sims} is a useful paper.

\sphinxAtStartPar
Such a model could consist of one or several equations where:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\(\mathbf{n}\) number of endogenous variables

\item {} 
\sphinxAtStartPar
\(\mathbf{k}\) number of exogenous variables

\item {} 
\sphinxAtStartPar
\(\mathbf{u}\) max lead of endogenous variables

\item {} 
\sphinxAtStartPar
\(\mathbf{r}\) max lag of endogenous variables

\item {} 
\sphinxAtStartPar
\(\mathbf{s}\) max lag of exogenous variables

\item {} 
\sphinxAtStartPar
\(t\) time frame (year, quarter, day or any other unit)

\end{itemize}

\sphinxAtStartPar
and can be written in a \sphinxstylestrong{normalized} or \sphinxstylestrong{un\sphinxhyphen{}normalized} form.


\section{Normalized model}
\label{\detokenize{content/notebooks/intro/model and solution:normalized-model}}
\sphinxAtStartPar
The following model consists of a number of equations. Each equations represents the relationship between an endogenous variable in the model (on the left side) and a series of variables that it depends on (on the right side of the equation). The number of endogenous variables is equal to the number of equations.
\begin{align*}
y_t^1  &=  f^1(y_{t+u}^1...,y_{t+u}^n...,y_t^2...,y_{t}^n...y_{t-r}^1...,y_{t-r}^n,x_t^1...x_{t}^k,...x_{t-s}^1...,x_{t-s}^k) \\
y_t^2  &=  f^2(y_{t+u}^1...,y_{t+u}^n...,y_t^1...,y_{t}^n...y_{t-r}^1...,y_{t-r}^n,x_t^1...x_{t}^k,...x_{t-s}^1...,x_{t-s}^k) \\
\vdots \\
y_t^n  &=  f^n(y_{t+u}^1...,y_{t+u}^n...,y_t^1...,y_{t}^{n-1}...y_{t-r}^1...,y_{t-r}^n,x_t^1...x_{t}^r,x..._{t-s}^1...,x_{t-s}^k)
\end{align*}
\sphinxAtStartPar
The model can also be written in matrix notation where  \(\mathbf{y}_t\) and \(\mathbf{x}_t\) are vectors of endogenous/exogenous variables for time \(t\).
\begin{equation*}
\begin{split}
\mathbf{y}_t = \mathbf{F}(\mathbf{y}_{t+u} \cdots \mathbf{y}_t \cdots \mathbf{y}_{t-r},\mathbf{x}_t \cdots \mathbf{x}_{t-s})
\end{split}
\end{equation*}
\sphinxAtStartPar
ModelFlow allows the variables (the  \(ùê±\)‚Äôs and \(ùê≤\)‚Äôs) to be scalars, matrices, arrays or Pandas DataFrames.


\section{Un\sphinxhyphen{}normalized form}
\label{\detokenize{content/notebooks/intro/model and solution:un-normalized-form}}
\sphinxAtStartPar
Some models can not easily be specified as normalized formulas.

\sphinxAtStartPar
Especially for models with equilibrium conditions not involving price, the the more general un\sphinxhyphen{}normalized form is more suitable. This means that instead of our endogenous variables on the left side the left hand side is \sphinxcode{\sphinxupquote{0}} and the right hand side is an expression.

\sphinxAtStartPar
A very simple demand/supply model with three endogenous variables: demand, supply and price model looks like this:
\begin{align*}
demand_t  &=  f^1(price_t) \\
supply_t  &= f^2(price_t)\\ 
demand_t &= supply_t
\end{align*}
\sphinxAtStartPar
If it is difficult to rewrite the model with  an explicit expression for the price, the model can be made to an un\sphinxhyphen{}normalized model:
\begin{align*}
0   &=  f^1(price_t)-demand_t \\
0 &= f^2(price_t)-supply_t\\ 
0 &= supply_t-demand_t
\end{align*}
\sphinxAtStartPar
Which can be solved.
The number of endogenous variables and equations should still be the same. And the model developer has to define which variables are endogenous.

\sphinxAtStartPar
Written in matrix notation an un\sphinxhyphen{}normalized model looks like this:
\begin{equation*}
\begin{split}
\mathbf{0} = \mathbf{G}(\mathbf{y}_{t+u} \cdots \mathbf{y}_t \cdots \mathbf{y}_{t-r},\mathbf{x}_t \cdots \mathbf{x}_{t-s})
\end{split}
\end{equation*}

\section{A model solution}
\label{\detokenize{content/notebooks/intro/model and solution:a-model-solution}}
\sphinxAtStartPar
The purpose of models (in this context) is to combine the model with data and find values for endogenous variables consistent with the model and the data \sphinxhyphen{} a \sphinxstylestrong{solution}

\sphinxAtStartPar
For a normalized model:
\begin{equation*}
\begin{split}
\mathbf{y}_t  = \mathbf{F}(\mathbf{y}_{t+u} \cdots \mathbf{y}_t \cdots \mathbf{y}_{t-r},\mathbf{x}_t \cdots \mathbf{x}_{t-r})
\end{split}
\end{equation*}
\sphinxAtStartPar
a solution is  \(\mathbf{y}_t^{*}\) so that:
\begin{equation*}
\begin{split}
\mathbf{y}_t^* = \mathbf{F}(\mathbf{y}_{t+u} \cdots \mathbf{y}_t^* \cdots \mathbf{y}_{t-r},\mathbf{x}_t \cdots \mathbf{x}_{t-r})
\end{split}
\end{equation*}
\sphinxAtStartPar
For the un\sphinxhyphen{}normalized model:
\begin{equation*}
\begin{split}
\mathbf{0} = \mathbf{G}(\mathbf{y}_{t+u} \cdots \mathbf{y}_t \cdots \mathbf{y}_{t-r},\mathbf{x}_t \cdots \mathbf{x}_{t-s})
\end{split}
\end{equation*}
\sphinxAtStartPar
a solution \(\mathbf{y}_t^*\) is:
\begin{equation*}
\begin{split}
\mathbf{0} =\mathbf{G}(\mathbf{y}_{t+u} \cdots \mathbf{y}_t^* \cdots \mathbf{y}_{t-r},\mathbf{x}_t \cdots \mathbf{x}_{t-r})
\end{split}
\end{equation*}
\sphinxAtStartPar
The functions \(f^i\) can be linear or nonlinear. There is no guarantee that a model has a solution \sphinxhyphen{} or that it has only one solution. Hopeful Modelflow will be able to find a solution but it can depend on the starting point.


\chapter{Solution methods}
\label{\detokenize{content/notebooks/intro/model and solution:solution-methods}}
\sphinxAtStartPar
There are several ways to solve a model (a system of equations) as mentioned above. ModelFlow can apply three different types of model solution methods:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
If the model has \sphinxstylestrong{no contemporaneous feedback} the equations can be sorted
\sphinxhref{https://en.wikipedia.org/wiki/Topological\_sorting}{topologically} and can be solved in the topological order. This method is similar to the approach of an Excel spreadsheet.

\item {} 
\sphinxAtStartPar
If the model has \sphinxstylestrong{contemporaneous feedback}, the model should be solved in an iterative way. Using for example:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumii}{enumiii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxhref{https://en.wikipedia.org/wiki/Gauss\%E2\%80\%93Seidel\_method}{The Gauss\sphinxhyphen{}Seidle method} (\sphinxstylestrong{Gauss}) which can handle large systems, is fairly robust and does not need the calculation of derivatives.

\item {} 
\sphinxAtStartPar
\sphinxhref{https://en.wikipedia.org/wiki/Newton\%27s\_method}{The Newton\sphinxhyphen{}Raphson method} (\sphinxstylestrong{Newton}) which requires the calculation of derivatives and solving of a large linear system but typically converges in fewer iterations.

\end{enumerate}

\item {} 
\sphinxAtStartPar
If the model has \sphinxstylestrong{leaded endogenous variables}, the Gauss variation \sphinxhref{https://fairmodel.econ.yale.edu/rayfair/pdf/1983A.PDF}{Fair\sphinxhyphen{}Taylor} or Stacked\sphinxhyphen{}Newton Method should be used. The \sphinxstylestrong{stacked Newton} method can be used in all cases, but if not needed, it will usually use more memory and be slower.

\end{enumerate}

\sphinxAtStartPar
Nearly all of the models solved by ModelFlow don‚Äôt contain leaded endogenous variables. Therefore, they can be solved one period at a time. For large sparse nonlinear models Gauss works fine. It solves a model quite fast and we don‚Äôt need the additional handiwork of handling derivatives and solve large linear systems that Newton methods require. Moreover many models in question do not have smooth derivatives. The order in which the equation are calculated can however have a large impact on the convergence speed.

\sphinxAtStartPar
For some models the Newton algorithm works better. Some models are not able to converge with Gauss\sphinxhyphen{}Seidle other models are just faster using Newton. Also with Newton the ordering of equations does not matter for the convergence speed.

\sphinxAtStartPar
Some models like \sphinxhref{https://www.federalreserve.gov/econres/us-models-about.htm}{FRB/US}  and other with \sphinxstylestrong{rational expectations} or \sphinxstylestrong{model consistent expectations} contains leaded endogenous variables. Such models typical have to be solved as one system for all projection periods. In this case, the Gauss variation Fair\sphinxhyphen{}Taylor or Stacked\sphinxhyphen{}Newton Method should be used.


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Model
&\sphinxstyletheadfamily 
\sphinxAtStartPar
No contemporaneous feedback
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Contemporaneous feedback
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Leaded variables
\\
\hline
\sphinxAtStartPar
Normalized
&
\sphinxAtStartPar
Calculate
&
\sphinxAtStartPar
Gauss or  Newton
&
\sphinxAtStartPar
Fair Taylor or  Stacked Newton
\\
\hline
\sphinxAtStartPar
Un\sphinxhyphen{}normalized
&
\sphinxAtStartPar
Newton
&
\sphinxAtStartPar
Newton
&
\sphinxAtStartPar
Stacked Newton
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\section{Solution methods for normalized models}
\label{\detokenize{content/notebooks/intro/model and solution:solution-methods-for-normalized-models}}\label{\detokenize{content/notebooks/intro/model and solution:id3}}

\subsection{Calculation, No contemporaneous feedback}
\label{\detokenize{content/notebooks/intro/model and solution:calculation-no-contemporaneous-feedback}}
\sphinxAtStartPar
In systems with no lags each period can be solved in succession.
The equations have to be evaluated in a logical (topological sorted) order.

\sphinxAtStartPar
Let:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\(z\) be all predetermined values: all exogenous variables and lagged endogenous variables.

\end{itemize}

\sphinxAtStartPar
Order the \(n\) endogenous variables in topological order.

\sphinxAtStartPar
For each time period we can find a solution by:
\begin{quote}

\sphinxAtStartPar
for \(i\) = 1 to \(n\)
\begin{quote}

\sphinxAtStartPar
\(y_{i}^{k} = f_i(y_1^{k},\cdots,y_{i-1}^{k},y_{i+1}^{k-1},\cdots,y_{n}^{k-1},z)\)
\end{quote}
\end{quote}


\subsection{The Gauss\sphinxhyphen{}Seidel algorithm. Models with contemporaneous feedback}
\label{\detokenize{content/notebooks/intro/model and solution:the-gauss-seidel-algorithm-models-with-contemporaneous-feedback}}
\sphinxAtStartPar
The Gauss\sphinxhyphen{}Seidel algorithm is quite straight forward. It basically iterates over the formulas, until convergence.

\sphinxAtStartPar
Let:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\(z\) be all predetermined values: all exogenous variables and lagged endogenous variables.

\item {} 
\sphinxAtStartPar
\(n\) be the number of endogenous variables.

\item {} 
\sphinxAtStartPar
\(\alpha\) dampening factor which can be applied to selected equations.

\end{itemize}

\sphinxAtStartPar
For each time period we can find a solution by doing Gauss\sphinxhyphen{}Seidel iterations:
\begin{quote}

\sphinxAtStartPar
for \(k = 1\) to convergence
\begin{quote}

\sphinxAtStartPar
for \(i\) = 1 to \(n\)
\begin{quote}

\sphinxAtStartPar
\(y_{i}^{k} = (1-\alpha) * y_{i}^{{k-1}} + \alpha f_i(y_1^{k},\cdots,y_{i-1}^{k},y_{i+1}^{k-1},\cdots,y_{n}^{k-1},z)\)
\end{quote}
\end{quote}
\end{quote}


\subsection{The Newton\sphinxhyphen{}Raphson algorithm. Models with contemporaneous feedback}
\label{\detokenize{content/notebooks/intro/model and solution:the-newton-raphson-algorithm-models-with-contemporaneous-feedback}}
\sphinxAtStartPar
Let:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\(\bf{z}\) be a vector all predetermined values: All exogenous variables and lagged endogenous variables.

\item {} 
\sphinxAtStartPar
\(\textbf{A}_t = \cfrac{\partial \textbf{F}}{\partial \textbf{y}_t^T}\) Jacobi matrix of derivatives with respect to current endogenous variables.

\item {} 
\sphinxAtStartPar
\(\alpha\) dampening factor.

\end{itemize}

\sphinxAtStartPar
For each time period we can find a solution by doing Newton\sphinxhyphen{}Raphson iterations:
\begin{quote}

\sphinxAtStartPar
for \(k = 1\) to convergence
\begin{quote}

\sphinxAtStartPar
\(\bf{y} = \bf{F(y^{k-1},z)}\)
\(\bf{y}^{k} =  \bf{y} - \alpha \times  \bf{(A-I)}^{-1} \times ( \bf{y - y^{k-1} })\)
\end{quote}
\end{quote}


\subsection{On solving sets of linear equations}
\label{\detokenize{content/notebooks/intro/model and solution:on-solving-sets-of-linear-equations}}
\sphinxAtStartPar
The expression: \(\bf{(A-I)}^{-1}\times  (\bf{y - y^{k-1}})\) is the same as finding the solution \(\bf{x}\) to the set of linear equations:

\sphinxAtStartPar
\(\bf{y- y^{k-1} } = \bf{(A-I)} \times \bf{x}\)

\sphinxAtStartPar
This problem can be solved much more efficiently than performing \(\bf{(A-I)}^{-1}\times  ( \bf{y - y^{k-1} })\). One way is to
find a \sphinxhref{https://en.wikipedia.org/wiki/LU\_decomposition}{LU decomposition}. But other methods can also be used.

\sphinxAtStartPar
The Python Scipy library provides a number of solvers to this linear set of equations. There are both solvers using LU\sphinxhyphen{}decomposition and iterative methods, and there are solvers for dense and sparse matrices. Any linear solvers can be incorporated into ModelFlows Newton\sphinxhyphen{}Raphson nonlinear solver. The \sphinxhref{https://scipy.org/scipylib/index.html}{Scipy library} utilizes the \sphinxhref{https://software.intel.com/en-us/mkl}{Intel¬Æ Math Kernel Library}.

\sphinxAtStartPar
The default solver is using a sparse LU\sphinxhyphen{}decomposition. It can handle quite large (as in very large) problems.

\sphinxAtStartPar
The costly operation in this algorithm is the LU\sphinxhyphen{}decomposition. Therefore  \(\bf{A}\) is not updated in every iteration.


\subsection{Stacked Newton\sphinxhyphen{}Raphson. Models with both leaded and lagged endogenous variable}
\label{\detokenize{content/notebooks/intro/model and solution:stacked-newton-raphson-models-with-both-leaded-and-lagged-endogenous-variable}}
\sphinxAtStartPar
If the model has leaded endogenous variables, it can generally not be solved one time period at a time. The model should therefore be solved as one large model.

\sphinxAtStartPar
Let:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\(\bf{z}\) be a vector all predetermined values: all exogenous variables and lagged endogenous variables.

\item {} 
\sphinxAtStartPar
\(u\) Max number of leads

\item {} 
\sphinxAtStartPar
\(r\) Max number of lags

\item {} 
\sphinxAtStartPar
\(\alpha\) dampening factor

\item {} 
\sphinxAtStartPar
\(\textbf{A}_t = \cfrac{\partial \textbf{F}}{\partial \textbf{y}_t^T}\) Derivatives with respect to current endogenous variables

\item {} 
\sphinxAtStartPar
\(\textbf{D}_t^j =  \cfrac{\partial \textbf{F}}{\partial \textbf{y}_{t+j}^T } \hspace{5 mm} j=1, \cdots , u  \hspace{1 mm}\mbox{  Derivatives with respect to leaded endogeneous variables  }\)

\item {} 
\sphinxAtStartPar
\(\textbf{E}_t^i  =  \cfrac{\partial \textbf{F}}{\partial \textbf{y}_{t-i}^T } \hspace{5 mm} i=1, \cdots , r  \hspace{1 mm}\mbox{  Derivatives with respect to lagged endogeneous variables  }\)

\end{itemize}

\sphinxAtStartPar
Now the \(\bf{\bar A}\), \(\bar y\) and \(\bar F\) which covers the total model for all time frames can be constructed like this:
\begin{equation*}
\begin{split}\bf{\bar A} =\begin{bmatrix}
		\bf{A_1}   & \bf{D_1^1} & \bf{D_1^2} & \bf{0}     &\bf{0}      &\bf{0}      &\bf{0}      &\bf{0}  \\
        \bf{E_2^1} & \bf{A_2}   & \bf{D_2^1} & \bf{D_2^2} &\bf{0}      &\bf{0}      &\bf{0}      &\bf{0} \\
        \bf{E_3^2} & \bf{E_3^1} & \bf{A_3}   & \bf{D_3^1} & \bf{D_3^2} &\bf{0}      &\bf{0}      &\bf{0} \\
        \bf{E_4^3} & \bf{E_4^2} & \bf{E_4^1} & \bf{A_4}   & \bf{D_4^1} & \bf{D_4^2} &\bf{0}      & \bf{0} \\
        \bf{0}     & \bf{E_5^3} & \bf{E_5^2} & \bf{E_5^1} & \bf{A_5}   & \bf{D_5^1} & \bf{D_5^2} &\bf{0}\\
        \bf{0}     & \bf{0}     & \bf{E_6^3} & \bf{E_6^2} & \bf{E_6^1} & \bf{A_6}   & \bf{D_6^1} & \bf{D_6^2}\\
        \bf{0}     & \bf{0}     & \bf{0}     & \bf{E_7^3} & \bf{E_7^2} & \bf{E_7^1} & \bf{A_7}   & \bf{D_7^1} \\
        \bf{0}     & \bf{0}     & \bf{0}     & \bf{0}     & \bf{E_8^3} & \bf{E_8^2} & \bf{E_8^1} & \bf{A_8} \\
\end{bmatrix} \bar y = \begin{bmatrix}\bf{y_1}\\\bf{y_2}\\\bf{y_3}\\ \bf{y_4} \\\bf{y_5} \\\bf{y_6} \\ \bf{y_7} \\ \bf{y_8} \end{bmatrix} \bar F = \begin{bmatrix}\bf{F}\\\bf{F}\\\bf{F}\\ \bf{F} \\\bf{F} \\\bf{F} \\ \bf{F} \\ \bf{F} \end{bmatrix}\end{split}
\end{equation*}
\sphinxAtStartPar
And the solution algorithm looks like this:

\sphinxAtStartPar
Again, let \(\bf{z}\) be a vector of all predetermined values: All exogenous variables and endogenous variables before and after the simulation time.
\begin{quote}

\sphinxAtStartPar
for \(k = 1\) to convergence
\begin{quote}

\sphinxAtStartPar
\(\bf{\bar y} = \bf{\bar F(\bar y^{k-1},\bar z) }\)
\(\bf{\bar y^{k}} =  \bf{\bar y} - \alpha \times \bf{(\bar A-I)}^{-1}\times ( \bf{\bar y - \bar y^{k-1}})\)
\end{quote}
\end{quote}

\sphinxAtStartPar
The update frequency of \(\bf{\bar A}\) and \(\alpha\) and the value of \(\alpha\) can be set to manage the speed and stability of the algorithm.

\sphinxAtStartPar
We solve the problem: \((\bf{\bar y - \bar y^{k-1} }) = \bf{(\bar A-I)}\times \bf{x}\) instead of inverting  \(\bf{A}\).

\sphinxAtStartPar
The comments above on solving the sets of linear equations also apply for this case.


\section{Un\sphinxhyphen{}normalized model}
\label{\detokenize{content/notebooks/intro/model and solution:un-normalized-model}}

\subsection{Stacked Newton\sphinxhyphen{}Raphson algorithm}
\label{\detokenize{content/notebooks/intro/model and solution:stacked-newton-raphson-algorithm}}
\sphinxAtStartPar
If the model has leaded endogenous variables it can, in general, not be solved one time period at a time. We have to solve the model for all time frames as one large model.

\sphinxAtStartPar
For the Newton\sphinxhyphen{}Raphson algorithm we now have to stack all the derivative matrices. The stacked matrices of a model with a max lag of three and a max lead of two spanning over eight periods look like this 
\begin{equation*}
\begin{split}\bf{\bar A} =\begin{bmatrix}
		\bf{A_1}   & \bf{D_1^1} & \bf{D_1^2} & \bf{0}     &\bf{0}      &\bf{0}      &\bf{0}      &\bf{0}  \\
        \bf{E_2^1} & \bf{A_2}   & \bf{D_2^1} & \bf{D_2^2} &\bf{0}      &\bf{0}      &\bf{0}      &\bf{0} \\
        \bf{E_3^2} & \bf{E_3^1} & \bf{A_3}   & \bf{D_3^1} & \bf{D_3^2} &\bf{0}      &\bf{0}      &\bf{0} \\
        \bf{E_4^3} & \bf{E_4^2} & \bf{E_4^1} & \bf{A_4}   & \bf{D_4^1} & \bf{D_4^2} &\bf{0}      & \bf{0} \\
        \bf{0}     & \bf{E_5^3} & \bf{E_5^2} & \bf{E_5^1} & \bf{A_5}   & \bf{D_5^1} & \bf{D_5^2} &\bf{0}\\
        \bf{0}     & \bf{0}     & \bf{E_6^3} & \bf{E_6^2} & \bf{E_6^1} & \bf{A_6}   & \bf{D_6^1} & \bf{D_6^2}\\
        \bf{0}     & \bf{0}     & \bf{0}     & \bf{E_7^3} & \bf{E_7^2} & \bf{E_7^1} & \bf{A_7}   & \bf{D_7^1} \\
        \bf{0}     & \bf{0}     & \bf{0}     & \bf{0}     & \bf{E_8^3} & \bf{E_8^2} & \bf{E_8^1} & \bf{A_8} \\
\end{bmatrix} \bar y = \begin{bmatrix}\bf{y_1}\\\bf{y_2}\\\bf{y_3}\\ \bf{y_4} \\\bf{y_5} \\\bf{y_6} \\ \bf{y_7} \\ \bf{y_8} \end{bmatrix} \bar F = \begin{bmatrix}\bf{F}\\\bf{F}\\\bf{F}\\ \bf{F} \\\bf{F} \\\bf{F} \\ \bf{F} \\ \bf{F} \end{bmatrix}\end{split}
\end{equation*}
\sphinxAtStartPar
\$\(\bf \bar z\)\$ contains all predetermined variable.

\sphinxAtStartPar
Now the solution algorithm looks like this.
\begin{quote}

\sphinxAtStartPar
for \(k = 1\) to convergence
\begin{quote}

\sphinxAtStartPar
\(\bf{\bar y\_residual} = \bf {\bar G(\bar y^{k-1},\bar z) }\)
\(\bf{\bar y^{k}} =  \bf{\bar y} - \bf{\bar A}^{-1} \times \bf {\bar y\_residual}\)
\end{quote}
\end{quote}

\sphinxAtStartPar
Notice that the model \(\bf G\) is the same for all time periods

\sphinxAtStartPar
Again we don‚Äôt compute \(\bf{\bar y} - \bf{\bar A}^{-1} \times \bf {\bar y\_residual}\) which requires the ‚Äúexpensive‚Äù inversion of a matrix but solve the problem: \(\bf{\bar y\_residual}=\bf{\bar A} \times \bf  x\) which can be done much faster.

\sphinxAtStartPar
Models without leaded variables are solved period for period along the same lines.


\section{Modelflow and solving}
\label{\detokenize{content/notebooks/intro/model and solution:modelflow-and-solving}}
\sphinxAtStartPar
Solving of models can incorporate a lot of methods to improve the speed. The approach in modelflow has been to use existing python libraries as much as possible and to apply the methods useful for the models at hand.

\sphinxAtStartPar
With some knowledge of python and numerical methods it is possible to implement new methods and improvements.

\sphinxstepscope


\chapter{Example Solow model}
\label{\detokenize{content/notebooks/intro/Example Solow:example-solow-model}}\label{\detokenize{content/notebooks/intro/Example Solow::doc}}
\sphinxAtStartPar
In this jupyter notebook we will specify, solve and analyse a simple Solow model in ModelFlow.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}Required packages}
\PYG{k+kn}{import} \PYG{n+nn}{pandas} \PYG{k}{as} \PYG{n+nn}{pd}

\PYG{c+c1}{\PYGZsh{} Modelflow modules}
\PYG{k+kn}{from} \PYG{n+nn}{modelclass} \PYG{k+kn}{import} \PYG{n}{model}
   
\PYG{c+c1}{\PYGZsh{}for publication }
\PYG{n}{latex}\PYG{o}{=}\PYG{l+m+mi}{0}
\PYG{n}{model}\PYG{o}{.}\PYG{n}{widescreen}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}IPython.core.display.HTML object\PYGZgt{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Specify the model}
\label{\detokenize{content/notebooks/intro/Example Solow:specify-the-model}}
\sphinxAtStartPar
We start by defining the logic of the Solow model in the Business Logic Language.

\begin{sphinxShadowBox}
\sphinxstylesidebartitle{\sphinxstylestrong{Business Logic Language}}

\sphinxAtStartPar
More on how to specify models {\hyperref[\detokenize{content/notebooks/intro/model specification::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{here}}}}
\end{sphinxShadowBox}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{fsolow} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}\PYG{l+s+se}{\PYGZbs{}}
\PYG{l+s+s1}{Income          = a  * Capital**alfa * Labor **(1\PYGZhy{}alfa) }
\PYG{l+s+s1}{Consumption     = (1\PYGZhy{}saving\PYGZus{}rate)  * Income }
\PYG{l+s+s1}{Investment      = Income \PYGZhy{} Consumption }
\PYG{l+s+s1}{diff(Capital)   = Investment\PYGZhy{}Depreciation\PYGZus{}rate * Capital(\PYGZhy{}1)}
\PYG{l+s+s1}{diff(Labor)     = Labor\PYGZus{}growth * Labor(\PYGZhy{}1) }
\PYG{l+s+s1}{Capital\PYGZus{}intensity = Capital/Labor }
\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Create a model class instance}
\label{\detokenize{content/notebooks/intro/Example Solow:create-a-model-class-instance}}
\sphinxAtStartPar
After defining the Business Logic Language and storing it in the variable ‚Äòfsolow‚Äô, we create a class instance called msolow.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{msolow} \PYG{o}{=} \PYG{n}{model}\PYG{o}{.}\PYG{n}{from\PYGZus{}eq}\PYG{p}{(}\PYG{n}{fsolow}\PYG{p}{,}\PYG{n}{modelname}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Solow model}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\sphinxAtStartPar
Above the equation for Capital and Labor on the left hand side of the = (equal to) consist of an expressing \sphinxcode{\sphinxupquote{diff(Capital)}} and \sphinxcode{\sphinxupquote{diff(Labor)}}. \sphinxstylestrong{The equations are not normalized}.

\sphinxAtStartPar
To solve a model in modelflow \sphinxstylestrong{all equations has to be normalized}. Meaning that the left hand side only consist of variables not expressions. So the function \sphinxcode{\sphinxupquote{model.from\_eq}} will normalize the equations as the first step before the model can be solved.

\sphinxAtStartPar
In this case \sphinxstylestrong{first} \sphinxcode{\sphinxupquote{diff(Capital)}} is transformed to \(\Delta capital = capital-capital(-1)\). \sphinxstylestrong{Then} the lagged variables is moved to the right side of the =.
The same goes for diff(labor).

\sphinxAtStartPar
So the normalized business language of the model now looks like:

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{msolow}\PYG{o}{.}\PYG{n}{print\PYGZus{}model}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
FRML \PYGZlt{}\PYGZgt{} INCOME          = A  * CAPITAL**ALFA * LABOR **(1\PYGZhy{}ALFA)  \PYGZdl{}
FRML \PYGZlt{}\PYGZgt{} CONSUMPTION     = (1\PYGZhy{}SAVING\PYGZus{}RATE)  * INCOME  \PYGZdl{}
FRML \PYGZlt{}\PYGZgt{} INVESTMENT      = INCOME \PYGZhy{} CONSUMPTION  \PYGZdl{}
FRML \PYGZlt{}\PYGZgt{} CAPITAL=CAPITAL(\PYGZhy{}1)+(INVESTMENT\PYGZhy{}DEPRECIATION\PYGZus{}RATE * CAPITAL(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}\PYGZgt{} LABOR=LABOR(\PYGZhy{}1)+(LABOR\PYGZus{}GROWTH * LABOR(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}\PYGZgt{} CAPITAL\PYGZus{}INTENSITY = CAPITAL/LABOR  \PYGZdl{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Create some data}
\label{\detokenize{content/notebooks/intro/Example Solow:create-some-data}}
\sphinxAtStartPar
To show what Modelflow can do, we create a Pandas dataframe with input data. And print the first 5 out of 300 observations.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{N} \PYG{o}{=} \PYG{l+m+mi}{300}  
\PYG{n}{df} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{LABOR}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}\PYG{p}{[}\PYG{l+m+mi}{100}\PYG{p}{]}\PYG{o}{*}\PYG{n}{N}\PYG{p}{,}
                   \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{CAPITAL}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}\PYG{p}{[}\PYG{l+m+mi}{100}\PYG{p}{]}\PYG{o}{*}\PYG{n}{N}\PYG{p}{,} 
                   \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ALFA}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}\PYG{p}{[}\PYG{l+m+mf}{0.5}\PYG{p}{]}\PYG{o}{*}\PYG{n}{N}\PYG{p}{,} 
                   \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{*}\PYG{n}{N}\PYG{p}{,} 
                   \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{DEPRECIATION\PYGZus{}RATE}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mf}{0.05}\PYG{p}{]}\PYG{o}{*}\PYG{n}{N}\PYG{p}{,} 
                   \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{LABOR\PYGZus{}GROWTH}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mf}{0.01}\PYG{p}{]}\PYG{o}{*}\PYG{n}{N}\PYG{p}{,} 
                   \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{SAVING\PYGZus{}RATE}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}\PYG{p}{[}\PYG{l+m+mf}{0.05}\PYG{p}{]}\PYG{o}{*}\PYG{n}{N}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
\PYG{n}{df}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{}this prints out the first 5 rows of the dataframe}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
   LABOR  CAPITAL  ALFA  A  DEPRECIATION\PYGZus{}RATE  LABOR\PYGZus{}GROWTH  SAVING\PYGZus{}RATE
0    100      100   0.5  1               0.05          0.01         0.05
1    100      100   0.5  1               0.05          0.01         0.05
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Run the model}
\label{\detokenize{content/notebooks/intro/Example Solow:run-the-model}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{result} \PYG{o}{=} \PYG{n}{msolow}\PYG{p}{(}\PYG{n}{df}\PYG{p}{,}\PYG{n}{keep}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Baseline}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{} The model is simulated for all years possible }
\PYG{n}{result}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{l+m+mi}{29}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
         LABOR     CAPITAL  ALFA    A  DEPRECIATION\PYGZus{}RATE  LABOR\PYGZus{}GROWTH  \PYGZbs{}
0   100.000000  100.000000   0.5  1.0               0.05          0.01   
1   101.000000  100.025580   0.5  1.0               0.05          0.01   
2   102.010000  100.076226   0.5  1.0               0.05          0.01   
3   103.030100  100.151443   0.5  1.0               0.05          0.01   
4   104.060401  100.250762   0.5  1.0               0.05          0.01   
5   105.101005  100.373733   0.5  1.0               0.05          0.01   
6   106.152015  100.519926   0.5  1.0               0.05          0.01   
7   107.213535  100.688931   0.5  1.0               0.05          0.01   
8   108.285671  100.880357   0.5  1.0               0.05          0.01   
9   109.368527  101.093830   0.5  1.0               0.05          0.01   
10  110.462213  101.328993   0.5  1.0               0.05          0.01   
11  111.566835  101.585506   0.5  1.0               0.05          0.01   
12  112.682503  101.863045   0.5  1.0               0.05          0.01   
13  113.809328  102.161300   0.5  1.0               0.05          0.01   
14  114.947421  102.479976   0.5  1.0               0.05          0.01   
15  116.096896  102.818793   0.5  1.0               0.05          0.01   
16  117.257864  103.177483   0.5  1.0               0.05          0.01   
17  118.430443  103.555792   0.5  1.0               0.05          0.01   
18  119.614748  103.953478   0.5  1.0               0.05          0.01   
19  120.810895  104.370310   0.5  1.0               0.05          0.01   
20  122.019004  104.806070   0.5  1.0               0.05          0.01   
21  123.239194  105.260550   0.5  1.0               0.05          0.01   
22  124.471586  105.733554   0.5  1.0               0.05          0.01   
23  125.716302  106.224895   0.5  1.0               0.05          0.01   
24  126.973465  106.734397   0.5  1.0               0.05          0.01   
25  128.243200  107.261893   0.5  1.0               0.05          0.01   
26  129.525631  107.807224   0.5  1.0               0.05          0.01   
27  130.820888  108.370242   0.5  1.0               0.05          0.01   
28  132.129097  108.950808   0.5  1.0               0.05          0.01   

    SAVING\PYGZus{}RATE  CAPITAL\PYGZus{}INTENSITY  INVESTMENT  CONSUMPTION      INCOME  
0          0.05           0.000000    0.000000     0.000000    0.000000  
1          0.05           0.990352    5.025580    95.486029  100.511609  
2          0.05           0.981043    5.051924    95.986562  101.038487  
3          0.05           0.972060    5.079029    96.501546  101.580575  
4          0.05           0.963390    5.106891    97.030930  102.137821  
5          0.05           0.955022    5.135509    97.574667  102.710176  
6          0.05           0.946943    5.164880    98.132713  103.297593  
7          0.05           0.939144    5.195002    98.705029  103.900030  
8          0.05           0.931613    5.225872    99.291576  104.517449  
9          0.05           0.924341    5.257491    99.892323  105.149813  
10         0.05           0.917318    5.289855   100.507238  105.797092  
11         0.05           0.910535    5.322963   101.136294  106.459257  
12         0.05           0.903983    5.356814   101.779468  107.136282  
13         0.05           0.897653    5.391407   102.436738  107.828145  
14         0.05           0.891538    5.426741   103.108087  108.534829  
15         0.05           0.885629    5.462816   103.793501  109.256317  
16         0.05           0.879920    5.499630   104.492967  109.992597  
17         0.05           0.874402    5.537183   105.206478  110.743661  
18         0.05           0.869069    5.575475   105.934027  111.509502  
19         0.05           0.863915    5.614506   106.675612  112.290118  
20         0.05           0.858932    5.654275   107.431233  113.085509  
21         0.05           0.854116    5.694784   108.200894  113.895678  
22         0.05           0.849459    5.736032   108.984599  114.720631  
23         0.05           0.844957    5.778019   109.782359  115.560378  
24         0.05           0.840604    5.820747   110.594185  116.414931  
25         0.05           0.836394    5.864215   111.420090  117.284305  
26         0.05           0.832323    5.908426   112.260093  118.168518  
27         0.05           0.828386    5.953380   113.114212  119.067591  
28         0.05           0.824578    5.999077   113.982470  119.981548  
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Create a scenario and run again}
\label{\detokenize{content/notebooks/intro/Example Solow:create-a-scenario-and-run-again}}
\begin{sphinxShadowBox}
\sphinxstylesidebartitle{\sphinxstylestrong{dataframe.upd}}

\sphinxAtStartPar
When importing modelclass all pandas dataframes are enriched with a a handy way to create a new pandas dataframe with updated series.

\sphinxAtStartPar
In this case df.upd will create a a new dataframe with updated LABOR\_GROWTH

\sphinxAtStartPar
For additional explanation look {\hyperref[\detokenize{content/howto/update/model update::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{here}}}}
\end{sphinxShadowBox}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{dfscenario} \PYG{o}{=} \PYG{n}{df}\PYG{o}{.}\PYG{n}{upd}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{LABOR\PYGZus{}GROWTH + 0.002}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}  \PYG{c+c1}{\PYGZsh{} create a new dataframe, increase LABOR\PYGZus{}GROWTH by 0.002}
\PYG{n}{scenario}   \PYG{o}{=} \PYG{n}{msolow}\PYG{p}{(}\PYG{n}{dfscenario}\PYG{p}{,}\PYG{n}{keep}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Higher labor growth }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{} simulate the model }
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Now the results are also embedded in msolow.}
\label{\detokenize{content/notebooks/intro/Example Solow:now-the-results-are-also-embedded-in-msolow}}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{.basedf}} contains the first run of the model

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{.lastdf}} contains the last run of the model

\end{itemize}

\sphinxAtStartPar
Also in this case the keyword \sphinxcode{\sphinxupquote{keep}} is used. This causes the results to be  stored in a dictionary \sphinxcode{\sphinxupquote{msolow.keep\_solutions}}. This can be useful when comparing several scenarios.


\section{Inspect results}
\label{\detokenize{content/notebooks/intro/Example Solow:inspect-results}}

\subsection{Using the {[} {]} operator}
\label{\detokenize{content/notebooks/intro/Example Solow:using-the-operator}}
\sphinxAtStartPar
We can select the variables of interest with wildcards. This will operate the results stored in \sphinxcode{\sphinxupquote{basedf}} and \sphinxcode{\sphinxupquote{.lastdf}}


\subsubsection{Look at variables starting with a C}
\label{\detokenize{content/notebooks/intro/Example Solow:look-at-variables-starting-with-a-c}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{msolow}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsh{}ENDO}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Tab(children=(Tab(children=(HTML(value=\PYGZsq{}\PYGZlt{}?xml version=\PYGZdq{}1.0\PYGZdq{} encoding=\PYGZdq{}utf\PYGZhy{}8\PYGZdq{} standalone=\PYGZdq{}no\PYGZdq{}?\PYGZgt{}\PYGZbs{}n\PYGZlt{}!DOCTYPE svg ‚Ä¶
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsubsection{Look at all endogenous variables}
\label{\detokenize{content/notebooks/intro/Example Solow:look-at-all-endogenous-variables}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{msolow}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{labor*}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{dif}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{p}{)} 
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Example Solow_23_0}.png}

\noindent\sphinxincludegraphics{{Example Solow_23_1}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Using the keept solutions}
\label{\detokenize{content/notebooks/intro/Example Solow:using-the-keept-solutions}}
\sphinxAtStartPar
As mentioned above, because the keyword \sphinxcode{\sphinxupquote{keep}} was used. The results are also stored in a dictionary. These data can
also be used for charting.

\sphinxAtStartPar
The reason for placing the results in a dictionary is to enable comparison of many scenarios, not just the first and the last.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{with} \PYG{n}{msolow}\PYG{o}{.}\PYG{n}{set\PYGZus{}smpl}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{30}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{msolow}\PYG{o}{.}\PYG{n}{keep\PYGZus{}plot}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{income con*}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{)}\PYG{p}{;} 
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Example Solow_25_0}.png}

\noindent\sphinxincludegraphics{{Example Solow_25_1}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{msolow}\PYG{o}{.}\PYG{n}{modeldash}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{INCOME}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{jupyter}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
apprun
Dash app running on http://127.0.0.1:5001/
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Dash\PYGZus{}graph(mmodel=\PYGZlt{}
Model name                              :          Solow model 
Model structure                         :         Simultaneous 
Number of variables                     :                   11 
Number of exogeneous  variables         :                    5 
Number of endogeneous variables         :                    6 
\PYGZgt{}, pre\PYGZus{}var=\PYGZsq{}INCOME\PYGZsq{}, filter=0, up=1, down=0, time\PYGZus{}att=False, attshow=False, all=False, dashport=5001, debug=False, jupyter=1, show\PYGZus{}trigger=False, inline=False, lag=False, threshold=0.5, growthshow=False)
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{More advanced topics}
\label{\detokenize{content/notebooks/intro/Example Solow:more-advanced-topics}}

\subsection{The logical stucture}
\label{\detokenize{content/notebooks/intro/Example Solow:the-logical-stucture}}
\sphinxAtStartPar
Now the model has been analyzed, and the structure can be displayed.

\sphinxAtStartPar
You will find more on the logical structure {\hyperref[\detokenize{content/howto/structure/Logical_structure::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{here}}}}


\subsubsection{Model structure}
\label{\detokenize{content/notebooks/intro/Example Solow:model-structure}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{msolow}\PYG{o}{.}\PYG{n}{drawmodel}\PYG{p}{(} \PYG{n}{title}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Model Structure}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{png}\PYG{o}{=}\PYG{n}{latex}\PYG{p}{,}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{15}\PYG{p}{,}\PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}IPython.core.display.SVG object\PYGZgt{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsubsection{Adjacency matrix}
\label{\detokenize{content/notebooks/intro/Example Solow:adjacency-matrix}}
\sphinxAtStartPar
Another way to illustrate the dependency graph is an adjacency matrix.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{msolow}\PYG{o}{.}\PYG{n}{plotadjacency}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Example Solow_32_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxAtStartPar
The variables  {[}‚ÄòINVESTMENT‚Äô, ‚ÄòCONSUMPTION‚Äô, ‚ÄòCAPITAL‚Äô, ‚ÄòINCOME‚Äô{]} in the red area are the core of the model and has to be solved as a system.

\sphinxAtStartPar
LABOR is the prolog and can be calculated before the core is solved. While CAPITAL\_INTENSE is the epilog which can be calculated after the core is solved.

\sphinxAtStartPar
Many models comform to this pattern. And for solving purpose a model is divided into a prolog, core and an epilog. Even if the core is actually consistent of several strong components.


\subsection{The python function used to solve the model}
\label{\detokenize{content/notebooks/intro/Example Solow:the-python-function-used-to-solve-the-model}}\label{\detokenize{content/notebooks/intro/Example Solow:solow-python-code}}
\sphinxAtStartPar
In order to solve the model Modelflow will generate a python function which implements the model. The user will hopeful  newer have to relate to the generated python code. \sphinxstylestrong{The point of modelflow is, that the user has to relate to the specification of the business logic, not the implementation in code}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{msolow}\PYG{o}{.}\PYG{n}{make\PYGZus{}los\PYGZus{}text}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
def make\PYGZus{}los(funks=[],errorfunk=None):
    import time
    import tqdm
    from numba import jit
    from modeluserfunk import jit, recode
    from modelBLfunk import array, classfunk, clognorm, exp, gamma, inspect, jit, lifetime\PYGZus{}credit\PYGZus{}loss, log, logit, logit\PYGZus{}inverse, lognorm, matrix, mv\PYGZus{}opt, mv\PYGZus{}opt\PYGZus{}prop, norm, normcdf, qgamma, sqrt, sum\PYGZus{}excel, transpose
    def prolog0(values,outvalues,row,alfa=1.0):
        try :
            pass
            values[row,0]=values[row\PYGZhy{}1,0]+(values[row,5]*values[row\PYGZhy{}1,0])
        except :
            errorfunk(values,sys.exc\PYGZus{}info()[2].tb\PYGZus{}lineno,overhead=9,overeq=0)
            raise
        return 
    def prolog(values,outvalues,row,alfa=1.0):
        prolog0(values,outvalues,row,alfa=alfa)
        return  
    def core0(values,outvalues,row,alfa=1.0):
        try :
            pass
            values[row,10]=values[row,3]*values[row,1]**values[row,2]*values[row,0]**(1\PYGZhy{}values[row,2])
            values[row,9]=(1\PYGZhy{}values[row,6])*values[row,10]
            values[row,8]=values[row,10]\PYGZhy{}values[row,9]
            values[row,1]=values[row\PYGZhy{}1,1]+(values[row,8]\PYGZhy{}values[row,4]*values[row\PYGZhy{}1,1])
        except :
            errorfunk(values,sys.exc\PYGZus{}info()[2].tb\PYGZus{}lineno,overhead=20,overeq=1)
            raise
        return 
    def core(values,outvalues,row,alfa=1.0):
        core0(values,outvalues,row,alfa=alfa)
        return  
    def epilog0(values,outvalues,row,alfa=1.0):
        try :
            pass
            values[row,7]=values[row,1]/values[row,0]
        except :
            errorfunk(values,sys.exc\PYGZus{}info()[2].tb\PYGZus{}lineno,overhead=34,overeq=5)
            raise
        return 
    def epilog(values,outvalues,row,alfa=1.0):
        epilog0(values,outvalues,row,alfa=alfa)
        return  
    return prolog,core,epilog
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxstepscope


\part{Python and pandas stuff}

\sphinxstepscope


\chapter{Introduction to the Jupyter Notebook}
\label{\detokenize{content/Python/Intro_Jupyter_notebook:introduction-to-the-jupyter-notebook}}\label{\detokenize{content/Python/Intro_Jupyter_notebook::doc}}

\section{Multiple ways to interact with Python}
\label{\detokenize{content/Python/Intro_Jupyter_notebook:multiple-ways-to-interact-with-python}}\begin{itemize}
\item {} 
\sphinxAtStartPar
From the command line (simply type ‚Äòpython‚Äô or ‚Äòipython‚Äô)

\item {} 
\sphinxAtStartPar
Plain text editor (e.g. Notepad++)

\item {} 
\sphinxAtStartPar
IDE (like  ‚ÄòSpyder‚Äô which is part of the Anaconda distribution but there are many)

\item {} 
\sphinxAtStartPar
Jupyter notebooks

\item {} 
\sphinxAtStartPar
And many more

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{This manual is based on Jupyter}

\sphinxAtStartPar
\sphinxhref{https://docs.jupyter.org/en/latest/}{The official Jupyter site} is a good starting point. But there are many good sites out there.


\section{The idea of the notebook}
\label{\detokenize{content/Python/Intro_Jupyter_notebook:the-idea-of-the-notebook}}\begin{itemize}
\item {} 
\sphinxAtStartPar
Keep code and output close together (in ‚Äúcells‚Äù)

\item {} 
\sphinxAtStartPar
Great for documenting the analytical steps

\item {} 
\sphinxAtStartPar
‚Ä¶ and teaching

\end{itemize}
\begin{quote}

\sphinxAtStartPar
The notebook format supports the idea of \sphinxstyleemphasis{replicability}: a scientific analysis should contain \sphinxhyphen{} in addition to the final output (text, graphs, tables) \sphinxhyphen{} all the computational steps needed to get from raw input data to the results.
\end{quote}
\begin{itemize}
\item {} 
\sphinxAtStartPar
A possible workflow:
prototype code in the notebook and consolidate it into scripts later on

\end{itemize}


\section{Jupyter Notebook basics}
\label{\detokenize{content/Python/Intro_Jupyter_notebook:jupyter-notebook-basics}}\begin{itemize}
\item {} 
\sphinxAtStartPar
Jupyter derives from \sphinxstylestrong{Ju}lia + \sphinxstylestrong{Pyt}hon + \sphinxstylestrong{R}

\item {} 
\sphinxAtStartPar
A separate Python process (a \sphinxstylestrong{‚Äòkernel‚Äô}) is started for each notebook
\begin{itemize}
\item {} 
\sphinxAtStartPar
Can be seen as a open window in the background (do not close)

\item {} 
\sphinxAtStartPar
Can be interrupted and restarted from the ‚ÄòKernel‚Äô menu

\end{itemize}

\item {} 
\sphinxAtStartPar
Multiple \sphinxstylestrong{cell types}, e.g. ‚ÄòCode‚Äô and ‚ÄòMarkdown‚Äô
\begin{itemize}
\item {} 
\sphinxAtStartPar
Code is for executable Python code

\item {} 
\sphinxAtStartPar
Markdown is for (formatted) text, e.g. descriptions of results

\end{itemize}

\item {} 
\sphinxAtStartPar
Cells can be in \sphinxstylestrong{two modes}
\begin{itemize}
\item {} 
\sphinxAtStartPar
Green vertical bar: ‚ÄòEdit‚Äô mode

\item {} 
\sphinxAtStartPar
Blue vertical bar: ‚ÄòSelect/copy‚Äô mode

\end{itemize}

\end{itemize}


\subsection{How to execute cells and display results}
\label{\detokenize{content/Python/Intro_Jupyter_notebook:how-to-execute-cells-and-display-results}}
\sphinxAtStartPar
Useful shortcuts: (see also ‚ÄúHelp‚Äù => ‚ÄúKeyboard Shortcuts‚Äù or simply press keyboard icon in the toolbar)
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{shift + ctrl}: run cell and stay in cell

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{shift + enter}: run cell and jump to next cell

\item {} 
\sphinxAtStartPar
Note that Notebook always prints last statement of a cell to screen. Except if the line ends in ‚Äò;‚Äô

\item {} 
\sphinxAtStartPar
Can force print of other statement with ‚Äúprint‚Äù command for other lines

\end{itemize}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{x} \PYG{o}{=} \PYG{l+m+mi}{10}
\PYG{n}{y} \PYG{o}{=} \PYG{l+m+mi}{45}
\PYG{n}{y}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
45
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{x} \PYG{o}{=} \PYG{l+m+mi}{10}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)}
\PYG{n}{y} \PYG{o}{=} \PYG{l+m+mi}{20}
\PYG{n}{y}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
10
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
20
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsubsection{But no display when line ends in ;}
\label{\detokenize{content/Python/Intro_Jupyter_notebook:but-no-display-when-line-ends-in}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{y} \PYG{o}{=} \PYG{l+m+mi}{20}
\PYG{n}{y}\PYG{p}{;} 
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\subsection{How to add, delete and move cells}
\label{\detokenize{content/Python/Intro_Jupyter_notebook:how-to-add-delete-and-move-cells}}
\sphinxAtStartPar
Toolbar
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{+ button}: add a cell below

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{scissors}: delete cell (can be undone from ‚ÄúEdit‚Äù tab)

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{up\sphinxhyphen{} and down arrows}: move cells

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{hold shift + click cells in left margin}: select multiple cells (vertical bar must be blue)

\end{itemize}


\subsection{Auto\sphinxhyphen{}complete and context\sphinxhyphen{}sensitive help}
\label{\detokenize{content/Python/Intro_Jupyter_notebook:auto-complete-and-context-sensitive-help}}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{tab}: autocomplete and  method selection

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{double tab}: documention (double tab for full doc)

\end{itemize}


\subsection{LaTeX support}
\label{\detokenize{content/Python/Intro_Jupyter_notebook:latex-support}}
\sphinxAtStartPar
Markdown mode includes LaTeX support.
Inline enclose the latex in \sphinxcode{\sphinxupquote{\$}}:

\sphinxAtStartPar
An Equation: \sphinxcode{\sphinxupquote{\$y\_t = \textbackslash{}beta\_0 + \textbackslash{}beta\_1 x\_t + u\_t\textbackslash{}\$}} will show like this:

\sphinxAtStartPar
An Equation: \(y_t = \beta_0 + \beta_1 x_t + u_t\)

\sphinxAtStartPar
Math blocks can be enclosed in \sphinxcode{\sphinxupquote{\$\$}}


\section{A few words on ‚Äòimport‚Äô statements}
\label{\detokenize{content/Python/Intro_Jupyter_notebook:a-few-words-on-import-statements}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Import and call a built\PYGZhy{}in module}
\PYG{k+kn}{import} \PYG{n+nn}{math}
\PYG{n}{math}\PYG{o}{.}\PYG{n}{pi}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
3.141592653589793
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Importing only part of a module\PYGZsq{}s functionality}
\PYG{k+kn}{from} \PYG{n+nn}{math} \PYG{k+kn}{import} \PYG{n}{pi}\PYG{p}{,} \PYG{n}{e}\PYG{p}{,} \PYG{n}{cos}
\PYG{n}{pi}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
3.141592653589793
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Use of aliases for modules}
\PYG{k+kn}{import} \PYG{n+nn}{math} \PYG{k}{as} \PYG{n+nn}{M}
\PYG{n}{M}\PYG{o}{.}\PYG{n}{pi}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
3.141592653589793
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Conventions for some aliases}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{pandas} \PYG{k}{as} \PYG{n+nn}{pd}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Import the model class from modelflow}
\PYG{k+kn}{from} \PYG{n+nn}{modelclass} \PYG{k+kn}{import} \PYG{n}{model} 
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\sphinxstepscope


\chapter{Introduction to Pandas dataframes}
\label{\detokenize{content/notebooks/pandas/dataframes:introduction-to-pandas-dataframes}}\label{\detokenize{content/notebooks/pandas/dataframes::doc}}
\sphinxAtStartPar
Modelflow is built on top of the Pandas library. Pandas is the Swiss knife of data science and can perform an impressing array of tasks.

\sphinxAtStartPar
This tutorial is a very short introduction to how pandas dataframes are used with Modelflow.

\sphinxAtStartPar
For more info on pandas:

\sphinxAtStartPar
\sphinxhref{https://pandas.pydata.org/}{Pandas homepage}

\sphinxAtStartPar
\sphinxhref{https://pandas.pydata.org/pandas-docs/stable/getting\_started/tutorials.html}{Pandas community tutorials}


\section{Import the pandas library}
\label{\detokenize{content/notebooks/pandas/dataframes:import-the-pandas-library}}
\sphinxAtStartPar
The convention is, that pandas is imported as pd

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{pandas} \PYG{k}{as} \PYG{n+nn}{pd} 
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{What is a dataframe}
\label{\detokenize{content/notebooks/pandas/dataframes:what-is-a-dataframe}}
\sphinxAtStartPar
A dataframe is a two\sphinxhyphen{}dimensional data structure with named rows and columns 

\sphinxAtStartPar
Creating a dataframe can be done in many ways. Here we are creating a Dataframe from a dictionary and  assigning a list of years as the index.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{B}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{6}\PYG{p}{]}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{E}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}\PYG{p}{[}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{]}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{n}{index}\PYG{o}{=}\PYG{p}{[}\PYG{l+m+mi}{2018}\PYG{p}{,}\PYG{l+m+mi}{2019}\PYG{p}{,}\PYG{l+m+mi}{2020}\PYG{p}{,}\PYG{l+m+mi}{2021}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{df} 
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
      B  C  E
2018  1  1  4
2019  1  2  4
2020  1  3  4
2021  1  6  4
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxAtStartPar
In modelflow each column is a  time serie for an economic variable. So in this dataframe A, B and C are economic time series.

\sphinxAtStartPar
In this manual all variables will be timeseries scalars (numbers). 
However for more advanced use a variable can also be a timeserie of matrices or vectors.


\section{Attributes}
\label{\detokenize{content/notebooks/pandas/dataframes:attributes}}
\sphinxAtStartPar
Lets take a look at some of the most important attributes of a dataframe.

\sphinxAtStartPar
To learn more check out the \sphinxhref{https://pandas.pydata.org/docs/reference/frame.html}{official pandas website}.

\begin{sphinxShadowBox}
\sphinxstylesidebartitle{Python object properties}

\sphinxAtStartPar
A python object such as \sphinxcode{\sphinxupquote{df}} has properties and methods.
They are accessed by the . operator
\end{sphinxShadowBox}


\subsection{.columns, column names}
\label{\detokenize{content/notebooks/pandas/dataframes:columns-column-names}}
\sphinxAtStartPar
.columns gives you the names of the columns in the dataframe.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df}\PYG{o}{.}\PYG{n}{columns}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Index([\PYGZsq{}B\PYGZsq{}, \PYGZsq{}C\PYGZsq{}, \PYGZsq{}E\PYGZsq{}], dtype=\PYGZsq{}object\PYGZsq{})
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxAtStartPar
The dataframe df has 3 columns.


\subsection{Column names in  Modelflow}
\label{\detokenize{content/notebooks/pandas/dataframes:column-names-in-modelflow}}
\begin{sphinxShadowBox}
\sphinxstylesidebartitle{Modelflow variable names}

\sphinxAtStartPar
Many python Objects are legal as column names in a dataframe, but not as variable names (column names)  in modelflow
\end{sphinxShadowBox}

\sphinxAtStartPar
The columns have names.In A dataframe column names can be many different python objects. So for instance 123.4  is a legal column name. That would make construction of models very impossible.
To facilitate construction of models modelflow a column name has to be a  string and start with a letter or \_  and followed by letters, underscore or digits.
\sphinxstylestrong{All letters in column names should be upper case.}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{IB}} is legal

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{ib}} is illegal

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{42ANSVER}} is illegal

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{\_HORSE1}} is legal

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{AVERY\_LONG\_VAIABLE\_NAME\_WHIS\_IS\_LEGAL}} is legal

\end{itemize}


\subsection{.index and time dimensions in Modelflow}
\label{\detokenize{content/notebooks/pandas/dataframes:index-and-time-dimensions-in-modelflow}}
\sphinxAtStartPar
The row names are called .index. For yearly models a list of integers like in \sphinxcode{\sphinxupquote{df}} is fine.
Pandas has a number of data types for different date and time objects. They can all be used for models with other frequencies.However be aware that plots will not necessary be working well with all index names.

\sphinxAtStartPar
When modelflow uses a lagged variable like \sphinxcode{\sphinxupquote{A(\sphinxhyphen{}1)}} It will take the value from the row above the current row. No matter if the index is an integer, a year, quarter or a millisecond. The same goes for leads \sphinxcode{\sphinxupquote{A(+1)}}  That will be the value in the next row.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df}\PYG{o}{.}\PYG{n}{index}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Int64Index([2018, 2019, 2020, 2021], dtype=\PYGZsq{}int64\PYGZsq{})
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{.eval() evalueation expressions}
\label{\detokenize{content/notebooks/pandas/dataframes:eval-evalueation-expressions}}
\sphinxAtStartPar
With this method expressions can be evaluated and new columns created.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df}\PYG{o}{.}\PYG{n}{eval}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}\PYG{l+s+s1}{X = B*C}
\PYG{l+s+s1}{           THE\PYGZus{}ANSWER = 42}\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
      B  C  E  X  THE\PYGZus{}ANSWER
2018  1  1  4  1          42
2019  1  2  4  2          42
2020  1  3  4  3          42
2021  1  6  4  6          42
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxAtStartPar
However, .eval cannot handle lagged variables and no systems of equations. Modelflow can!


\subsection{.loc{[}{]} when slicing a dataframe}
\label{\detokenize{content/notebooks/pandas/dataframes:loc-when-slicing-a-dataframe}}

\subsubsection{.loc{[}row,column{]} A single element}
\label{\detokenize{content/notebooks/pandas/dataframes:loc-row-column-a-single-element}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{l+m+mi}{2019}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
2
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsubsection{.loc{[}:,column{]} A single column}
\label{\detokenize{content/notebooks/pandas/dataframes:loc-column-a-single-column}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
2018    1
2019    2
2020    3
2021    6
Name: C, dtype: int64
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsubsection{.loc{[}row,:{]} A single row}
\label{\detokenize{content/notebooks/pandas/dataframes:loc-row-a-single-row}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{l+m+mi}{2019}\PYG{p}{,}\PYG{p}{:}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
B    1
C    2
E    4
Name: 2019, dtype: int64
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsubsection{.loc{[}:,{[}names‚Ä¶{]}{]} Several columns}
\label{\detokenize{content/notebooks/pandas/dataframes:loc-names-several-columns}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{B}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
      B  C
2018  1  1
2019  1  2
2020  1  3
2021  1  6
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsubsection{.loc{[}{]} Slices of the dataframe can also be assigned values}
\label{\detokenize{content/notebooks/pandas/dataframes:loc-slices-of-the-dataframe-can-also-be-assigned-values}}
\sphinxAtStartPar
This can be very handy when updating scenarios.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{l+m+mi}{2019}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{42}
\PYG{n}{df}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
      B   C  E
2018  1   1  4
2019  1  42  4
2020  1   3  4
2021  1   6  4
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxadmonition}{warning}{Warning:}
\sphinxAtStartPar
The dimensions on the right hand side of = and the left hand side should match. That is: either the dimensions should be the same, or the right hand side should be broadcasted into the left hand slice.
A link \sphinxhref{https://jakevdp.github.io/PythonDataScienceHandbook/02.05-computation-on-arrays-broadcasting.html}{here}
\end{sphinxadmonition}

\sphinxstepscope


\part{Updating variables}

\sphinxstepscope


\chapter{Update, modifying series in a dataframe using modelflow}
\label{\detokenize{content/howto/update/model update:update-modifying-series-in-a-dataframe-using-modelflow}}\label{\detokenize{content/howto/update/model update:upd}}\label{\detokenize{content/howto/update/model update::doc}}
\sphinxAtStartPar
Often when we are working with a model we will want to modify individual data points or series in a model (for example when doing a simulation, or if there is a data update to one or more series.
This can be done straight using pandas methods.

\sphinxAtStartPar
However the \sphinxstylestrong{dataframe.upd} function in Modelflow simplifies this exercise.
It gives the user a concise and expressive way to specify
typical updates of economic variables.

\sphinxAtStartPar
A line like:
\begin{quote}

\sphinxAtStartPar
newdf = df.upd(‚Äòthe\_answer = 42‚Äô)
\end{quote}

\sphinxAtStartPar
will create a new dataframe based on the dataframe df where the variable \sphinxcode{\sphinxupquote{THE\_ANSWER}} has the value 42.

\begin{sphinxadmonition}{danger}{Danger:}
\sphinxAtStartPar
The df dataframe remains unchanged. The newdf contains the new updated values (and all non\sphinxhyphen{}updated variables from df.
\end{sphinxadmonition}

\sphinxAtStartPar
To make df.update useful you can also:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Perform different types of  updates

\item {} 
\sphinxAtStartPar
Perform multiple updates each on a new line

\item {} 
\sphinxAtStartPar
Control the time for which the update has effect

\item {} 
\sphinxAtStartPar
Use one input which is used for all time frames, or a input for each time

\item {} 
\sphinxAtStartPar
Keep the growth rate after the update time frame

\item {} 
\sphinxAtStartPar
Display the results

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Types of update:}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Update to perform
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Use this operator
\\
\hline
\sphinxAtStartPar
Set a variable equal to the input
&
\sphinxAtStartPar
=
\\
\hline
\sphinxAtStartPar
Add the input to the input
&
\sphinxAtStartPar
+
\\
\hline
\sphinxAtStartPar
Set the variable to itself multiplied by the input
&
\sphinxAtStartPar
*
\\
\hline
\sphinxAtStartPar
Set the variable to itself multiplied by (1+input/100)
&
\sphinxAtStartPar
\%
\\
\hline
\sphinxAtStartPar
Set the growth rate of the variable to the input
&
\sphinxAtStartPar
=growth
\\
\hline
\sphinxAtStartPar
Set the growth rate of the variable to the current growth rate plus the input
&
\sphinxAtStartPar
+growth
\\
\hline
\sphinxAtStartPar
Set \(\Delta = var_t - var_{t-1}\) of  the variable to the input
&
\sphinxAtStartPar
=diff
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
\sphinxstyleemphasis{\sphinxstylestrong{Setting the time scope}}

\sphinxAtStartPar
The update command takes a variety of mathematical operators \sphinxcode{\sphinxupquote{=, +, \textbackslash{}*, \% =GROWTH, +GROWTH, =DIFF}} and applies them to data for the period set in the leading <>.
\begin{itemize}
\item {} 
\sphinxAtStartPar
If \sphinxstylestrong{one date} is specified the operation is applied to a single point in time

\item {} 
\sphinxAtStartPar
If \sphinxstylestrong{two dates}  are specifies the operation is applied over a period of time.

\end{itemize}

\sphinxAtStartPar
The time will persist until set next time. Useful to avoid visual noise if several variables are going to be updated for the same time period.
\begin{itemize}
\item {} 
\sphinxAtStartPar
To indicate the start of the dataframe use \sphinxhyphen{}0

\item {} 
\sphinxAtStartPar
To indicate the end of the dataframe use \sphinxhyphen{}1

\end{itemize}

\sphinxAtStartPar
If no time is provided the dataframe start and end period will be used.

\sphinxAtStartPar
\sphinxstylestrong{Keep growth rates after the update time}

\sphinxAtStartPar
In a long projection it can sometime be useful to be able to update variables for which new information is available, but keep the growth rate the same as before the update  after the update time.

\sphinxAtStartPar
For each \sphinxstyleemphasis{update line} it is governed
by the \sphinxcode{\sphinxupquote{\sphinxhyphen{}\sphinxhyphen{}keep\_growth}} and \sphinxcode{\sphinxupquote{\sphinxhyphen{}\sphinxhyphen{}no\_keep\_growth}} option.

\sphinxAtStartPar
For the \sphinxstyleemphasis{.update call} (which can contain many update lines) this is ruled by the \sphinxcode{\sphinxupquote{keep\_growth}} parameter.
The default value for \sphinxcode{\sphinxupquote{keep\_growth}} is \sphinxcode{\sphinxupquote{False}}. If \sphinxcode{\sphinxupquote{keep\_growth=True}} all lines will use the \sphinxcode{\sphinxupquote{keep\_growth}}
except lines with the ‚Äìno\_keep\_growth option

\sphinxAtStartPar
Examples later.

\sphinxAtStartPar
\sphinxstylestrong{Comments}

\sphinxAtStartPar
Everyting after a \# until line end is regarded as a comment


\section{Setting up the workspace}
\label{\detokenize{content/howto/update/model update:setting-up-the-workspace}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{pandas} \PYG{k}{as} \PYG{n+nn}{pd}

\PYG{k+kn}{from} \PYG{n+nn}{modelclass} \PYG{k+kn}{import} \PYG{n}{model} 
\PYG{n}{model}\PYG{o}{.}\PYG{n}{widescreen}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{model}\PYG{o}{.}\PYG{n}{scroll\PYGZus{}off}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}IPython.core.display.HTML object\PYGZgt{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Create dataframe to update:}
\label{\detokenize{content/howto/update/model update:create-dataframe-to-update}}
\sphinxAtStartPar
Now a pandas dataframe with one column and 6 rows are created. The column is has the name \sphinxcode{\sphinxupquote{A}} and the rows have index 2020 to 2025.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{number\PYGZus{}of\PYGZus{}rows} \PYG{o}{=} \PYG{l+m+mi}{6} 
\PYG{n}{df} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{l+m+mi}{100}\PYG{p}{,}
       \PYG{n}{index}\PYG{o}{=}\PYG{p}{[}\PYG{l+m+mi}{2020}\PYG{o}{+}\PYG{n}{v} \PYG{k}{for} \PYG{n}{v} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{number\PYGZus{}of\PYGZus{}rows}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,} \PYG{c+c1}{\PYGZsh{} create row index}
       \PYG{n}{columns}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}                                 \PYG{c+c1}{\PYGZsh{} create column name }
\PYG{n}{df}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
        A
2020  100
2021  100
2022  100
2023  100
2024  100
2025  100
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{pd.DataFrame}} creates a dataframe  \sphinxhref{https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html\#pandas.DataFrame}{Description}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{{[}2020+v for v in range(number\_of\_rows){]}}} defines a list comprehension which creates a list of the integers from 2020 to 2025 (see below for list comprehensions)

\end{itemize}


\section{Use dataframe.loc to make a new variable}
\label{\detokenize{content/howto/update/model update:use-dataframe-loc-to-make-a-new-variable}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{.loc}} is used to access or set values in a dataframe based on row and column labels.
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxhref{https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.loc.html}{Description}

\item {} 
\sphinxAtStartPar
\sphinxhref{https://www.google.com/search?q=pandas+dataframe+loc\&newwindow=1}{Search}

\end{itemize}

\sphinxAtStartPar
A new series (a column) called B is set to 100

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{B}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{]} \PYG{o}{=} \PYG{l+m+mf}{100.}
\PYG{n}{df}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
        A      B
2020  100  100.0
2021  100  100.0
2022  100  100.0
2023  100  100.0
2024  100  100.0
2025  100  100.0
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Use dataframe.upd()  to  modify a series in a dataframe or to add a series to a dataframe}
\label{\detokenize{content/howto/update/model update:use-dataframe-upd-to-modify-a-series-in-a-dataframe-or-to-add-a-series-to-a-dataframe}}
\sphinxAtStartPar
Upd makes it much easier to create new series (compare the below, with the complicated pandas code above).


\subsection{= Setting value equal to input}
\label{\detokenize{content/howto/update/model update:setting-value-equal-to-input}}

\subsubsection{Creates a new data series called c in the dataframe with values of 142 everywhere}
\label{\detokenize{content/howto/update/model update:creates-a-new-data-series-called-c-in-the-dataframe-with-values-of-142-everywhere}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df2}\PYG{o}{=}\PYG{n}{df}\PYG{o}{.}\PYG{n}{upd}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{c = 142}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} 
\PYG{n}{df2}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
        A      B      C
2020  100  100.0  142.0
2021  100  100.0  142.0
2022  100  100.0  142.0
2023  100  100.0  142.0
2024  100  100.0  142.0
2025  100  100.0  142.0
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsubsection{Setting specific datapoints to specific values}
\label{\detokenize{content/howto/update/model update:setting-specific-datapoints-to-specific-values}}
\sphinxAtStartPar
In this example, upd uses the equals operator.  This indicates that the variable a should be set equal to the indicated values following the = operator (42 44 45 46 in this example). The dates enclosed in <> indicate the period over which the change should be applied.

\sphinxAtStartPar
Either:
\begin{itemize}
\item {} 
\sphinxAtStartPar
The number of data points provided must match the number of dates in the period, Or

\item {} 
\sphinxAtStartPar
Only one data point is provided, it is applied to all dates in the period.

\end{itemize}

\sphinxAtStartPar
If only one period is to be modified then it can be followed by just one date.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df}\PYG{o}{.}\PYG{n}{upd}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{l+s+s2}{\PYGZsh{} Same number of values as years}
\PYG{l+s+s2}{\PYGZlt{}2021 2024\PYGZgt{} A = 42 44 45 46    \PYGZsh{} 4 years}
\PYG{l+s+s2}{\PYGZlt{}2020     \PYGZgt{} B = 200            \PYGZsh{} 1 year }
\PYG{l+s+s2}{c = 500}
\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
        A      B      C
2020  100  200.0  500.0
2021   42  100.0    0.0
2022   44  100.0    0.0
2023   45  100.0    0.0
2024   46  100.0    0.0
2025  100  100.0    0.0
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Adding  the specified  values to all values in a range (the + operator)}
\label{\detokenize{content/howto/update/model update:adding-the-specified-values-to-all-values-in-a-range-the-operator}}
\sphinxAtStartPar
NB: Here upd with the  + operator indicates that we are adding 42.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df}\PYG{o}{.}\PYG{n}{upd}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\PYG{l+s+s1}{\PYGZsh{} Or one number to all years in between start and end }
\PYG{l+s+s1}{\PYGZlt{}2022 2024\PYGZgt{} B  +  42    \PYGZsh{} one value broadcast to 3 years }
\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
        A      B
2020  100  100.0
2021  100  100.0
2022  100  142.0
2023  100  142.0
2024  100  142.0
2025  100  100.0
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Multiplying all values in a range by the specified values (the * operator)}
\label{\detokenize{content/howto/update/model update:multiplying-all-values-in-a-range-by-the-specified-values-the-operator}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df}\PYG{o}{.}\PYG{n}{upd}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\PYG{l+s+s1}{\PYGZsh{} Same number of values as years}
\PYG{l+s+s1}{\PYGZlt{}2021 2023\PYGZgt{} A *  42 44 55}
\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
         A      B
2020   100  100.0
2021  4200  100.0
2022  4400  100.0
2023  5500  100.0
2024   100  100.0
2025   100  100.0
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Increasing all  values in a range by a  specified percent amount (the \% operator)}
\label{\detokenize{content/howto/update/model update:increasing-all-values-in-a-range-by-a-specified-percent-amount-the-operator}}
\sphinxAtStartPar
In this example:
\begin{itemize}
\item {} 
\sphinxAtStartPar
A is increased by 42 and 44\% over the range 2021 through 2022.

\item {} 
\sphinxAtStartPar
B is increased by 10 percent in all years

\item {} 
\sphinxAtStartPar
C, a new variable, is created and set to 100 for the whole range

\item {} 
\sphinxAtStartPar
C is decreased by 12 percent over the range 2023 through 2025.

\end{itemize}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df}\PYG{o}{.}\PYG{n}{upd}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\PYG{l+s+s1}{\PYGZlt{}2021 2022 \PYGZgt{} A }\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{  42 44   }
\PYG{l+s+s1}{\PYGZlt{}\PYGZhy{}0 \PYGZhy{}1\PYGZgt{} B }\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{ 10            \PYGZsh{} all rows }
\PYG{l+s+s1}{C = 100                   \PYGZsh{} all rows persist }
\PYG{l+s+s1}{\PYGZlt{}2023 2025\PYGZgt{} C }\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{ \PYGZhy{}12       \PYGZsh{} now only fo 3 years }
\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
        A      B      C
2020  100  110.0  100.0
2021  142  110.0  100.0
2022  144  110.0  100.0
2023  100  110.0   88.0
2024  100  110.0   88.0
2025  100  110.0   88.0
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Set the percent growth rate to specified values (=GROWTH)}
\label{\detokenize{content/howto/update/model update:set-the-percent-growth-rate-to-specified-values-growth}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{res} \PYG{o}{=} \PYG{n}{df}\PYG{o}{.}\PYG{n}{upd}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\PYG{l+s+s1}{\PYGZsh{} Same number of values as years}
\PYG{l+s+s1}{\PYGZlt{}2021 2022\PYGZgt{} A =GROWTH  1 5  }
\PYG{l+s+s1}{\PYGZlt{}2020\PYGZgt{} c = 100 }
\PYG{l+s+s1}{\PYGZlt{}2021 2025\PYGZgt{} c =GROWTH 2 }
\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Dataframe:}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{res}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{Growth:}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{res}\PYG{o}{.}\PYG{n}{pct\PYGZus{}change}\PYG{p}{(}\PYG{p}{)}\PYG{o}{*}\PYG{l+m+mi}{100}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{} Explained b}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Dataframe:
           A      B           C
2020  100.00  100.0  100.000000
2021  101.00  100.0  102.000000
2022  106.05  100.0  104.040000
2023  100.00  100.0  106.120800
2024  100.00  100.0  108.243216
2025  100.00  100.0  110.408080

Growth:
             A    B    C
2020       NaN  NaN  NaN
2021  1.000000  0.0  2.0
2022  5.000000  0.0  2.0
2023 \PYGZhy{}5.704856  0.0  2.0
2024  0.000000  0.0  2.0
2025  0.000000  0.0  2.0
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
\sphinxstylestrong{Python constructs}
\begin{quote}

\sphinxAtStartPar
print(f‚ÄôDataframe:\textbackslash{}n\{res\}\textbackslash{}n\textbackslash{}nGrowth:\textbackslash{}n\{res.pct\_change()*100\}\textbackslash{}n‚Äô)
\end{quote}

\sphinxAtStartPar
Uses


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Python construct
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Explanation
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Links
\\
\hline
\sphinxAtStartPar
‚Äò\textbackslash{}n‚Äô
&
\sphinxAtStartPar
A line break
&
\sphinxAtStartPar

\\
\hline
\sphinxAtStartPar
dataframe.pct\_change
&
\sphinxAtStartPar
Percentage change between the current and a prior element.
&
\sphinxAtStartPar
\sphinxhref{https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.pct\_change.html}{Description}
\\
\hline
\sphinxAtStartPar
f‚Äô\{varname\} = ‚Ä¶.‚Äô
&
\sphinxAtStartPar
A f\sphinxhyphen{}string, \{expression\} is replaced by the value of expression
&
\sphinxAtStartPar
\sphinxhref{https://www.google.com/search?q=python+f-string\&newwindow=1}{Search}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}
\end{sphinxadmonition}


\subsection{Add or subtract from the existing percent growth rate (+GROWTH operator)}
\label{\detokenize{content/howto/update/model update:add-or-subtract-from-the-existing-percent-growth-rate-growth-operator}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{res} \PYG{o}{=}\PYG{n}{df}\PYG{o}{.}\PYG{n}{upd}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\PYG{l+s+s1}{\PYGZsh{} Same number of values as years}
\PYG{l+s+s1}{\PYGZlt{}2021 2025\PYGZgt{} A =GROWTH  1  }
\PYG{l+s+s1}{\PYGZsh{} now we add values  to the growth rate, }
\PYG{l+s+s1}{a +growth   2 3 4 5 6 }
\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Dataframe:}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{res}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{Growth:}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{res}\PYG{o}{.}\PYG{n}{pct\PYGZus{}change}\PYG{p}{(}\PYG{p}{)}\PYG{o}{*}\PYG{l+m+mi}{100}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Dataframe:
               A      B
2020  100.000000  100.0
2021  103.000000  100.0
2022  107.120000  100.0
2023  112.476000  100.0
2024  119.224560  100.0
2025  127.570279  100.0

Growth:
        A    B
2020  NaN  NaN
2021  3.0  0.0
2022  4.0  0.0
2023  5.0  0.0
2024  6.0  0.0
2025  7.0  0.0
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Set \protect\(\Delta = var_t - var_{t-1}\protect\) to specified values (=diff operator)}
\label{\detokenize{content/howto/update/model update:set-delta-var-t-var-t-1-to-specified-values-diff-operator}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df}\PYG{o}{.}\PYG{n}{upd}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\PYG{l+s+s1}{\PYGZsh{} Same number of values as years}
\PYG{l+s+s1}{\PYGZlt{} 2021 2022\PYGZgt{} A =diff  2 4   }
\PYG{l+s+s1}{\PYGZsh{} cv number to all years in between start and end }

\PYG{l+s+s1}{\PYGZlt{}2020 \PYGZgt{} same = 100 }
\PYG{l+s+s1}{\PYGZlt{}2021 2025\PYGZgt{} same =diff  2  }
\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
        A      B   SAME
2020  100  100.0  100.0
2021  102  100.0  102.0
2022  106  100.0  104.0
2023  100  100.0  106.0
2024  100  100.0  108.0
2025  100  100.0  110.0
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Recall  that we have not overwritten df, so the df dataframe is unchanged.}
\label{\detokenize{content/howto/update/model update:recall-that-we-have-not-overwritten-df-so-the-df-dataframe-is-unchanged}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
        A      B
2020  100  100.0
2021  100  100.0
2022  100  100.0
2023  100  100.0
2024  100  100.0
2025  100  100.0
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{.upd(,,,keep\_growth)/‚Äìkeep\_growth, keep the growth rate in the years after the update}
\label{\detokenize{content/howto/update/model update:upd-keep-growth-keep-growth-keep-the-growth-rate-in-the-years-after-the-update}}
\sphinxAtStartPar
Before a series is updated the growth rate of the series is calculated. After a series has been updated, it is possible to use the saved growth rate to do an automatic update of the series from the end of the ‚Äúproper‚Äù update period until the end of the dataframe.

\sphinxAtStartPar
This allows to update variables for which new information is available, but keep the growth rate the same as before the update in the period after the update time.


\subsection{First make a dataframe with some growth rate}
\label{\detokenize{content/howto/update/model update:first-make-a-dataframe-with-some-growth-rate}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{res} \PYG{o}{=} \PYG{n}{df}\PYG{o}{.}\PYG{n}{upd}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZlt{}2021 2025\PYGZgt{} a =growth 1 2 3 4 5}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}  
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Dataframe:}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{res}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{Growth:}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{res}\PYG{o}{.}\PYG{n}{pct\PYGZus{}change}\PYG{p}{(}\PYG{p}{)}\PYG{o}{*}\PYG{l+m+mi}{100}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Dataframe:
               A      B
2020  100.000000  100.0
2021  101.000000  100.0
2022  103.020000  100.0
2023  106.110600  100.0
2024  110.355024  100.0
2025  115.872775  100.0

Growth:
        A    B
2020  NaN  NaN
2021  1.0  0.0
2022  2.0  0.0
2023  3.0  0.0
2024  4.0  0.0
2025  5.0  0.0
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{now update A in 2021 to 2023 to a new value,}
\label{\detokenize{content/howto/update/model update:now-update-a-in-2021-to-2023-to-a-new-value}}
\sphinxAtStartPar
and watch how values after 2023 are updated, so the gowth rate after the update is unchanged

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{res} \PYG{o}{=} \PYG{n}{df}\PYG{o}{.}\PYG{n}{upd}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\PYG{l+s+s1}{\PYGZlt{}2021 2025\PYGZgt{}  a =growth 1 2 3 4 5 }
\PYG{l+s+s1}{\PYGZlt{}2021 2023\PYGZgt{}  a = 120  \PYGZhy{}\PYGZhy{}kg}
\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}\PYG{p}{,}\PYG{n}{lprint}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Dataframe:}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{res}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{Growth:}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{res}\PYG{o}{.}\PYG{n}{pct\PYGZus{}change}\PYG{p}{(}\PYG{p}{)}\PYG{o}{*}\PYG{l+m+mi}{100}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Dataframe:
           A      B
2020  100.00  100.0
2021  120.00  100.0
2022  120.00  100.0
2023  120.00  100.0
2024  124.80  100.0
2025  131.04  100.0

Growth:
         A    B
2020   NaN  NaN
2021  20.0  0.0
2022   0.0  0.0
2023   0.0  0.0
2024   4.0  0.0
2025   5.0  0.0
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{A more advanced example}
\label{\detokenize{content/howto/update/model update:a-more-advanced-example}}
\sphinxAtStartPar
Where more advanced python is used


\subsubsection{First create a string with update lines}
\label{\detokenize{content/howto/update/model update:first-create-a-string-with-update-lines}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{lines} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}                               
 \PYG{p}{[}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}\PYG{l+s+s1}{\PYGZlt{}2020     \PYGZgt{} }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{varname}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{ = 100 }
\PYG{l+s+s1}{      \PYGZlt{}2021 2025\PYGZgt{} }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{varname}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{ =growth 1 2 3 4 5}\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
     \PYG{k}{for} \PYG{n}{varname} \PYG{o+ow}{in} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{c d e f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{lines}\PYG{p}{)} 
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}2020     \PYGZgt{} c = 100 
      \PYGZlt{}2021 2025\PYGZgt{} c =growth 1 2 3 4 5
\PYGZlt{}2020     \PYGZgt{} d = 100 
      \PYGZlt{}2021 2025\PYGZgt{} d =growth 1 2 3 4 5
\PYGZlt{}2020     \PYGZgt{} e = 100 
      \PYGZlt{}2021 2025\PYGZgt{} e =growth 1 2 3 4 5
\PYGZlt{}2020     \PYGZgt{} f = 100 
      \PYGZlt{}2021 2025\PYGZgt{} f =growth 1 2 3 4 5
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
\sphinxstyleemphasis{\sphinxstylestrong{Python constructs}}

\sphinxAtStartPar
The creation of update lines involves a number of useful python constructs. A short
description:


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Python construct
&\sphinxstyletheadfamily 
\sphinxAtStartPar
explanation
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Google
\\
\hline
\sphinxAtStartPar
‚Äòa b‚Äô.split()
&
\sphinxAtStartPar
splits a string by \sphinxcode{\sphinxupquote{blanks}}into a list
&
\sphinxAtStartPar
\sphinxhref{https://www.google.com/search?q=python+split\&newwindow=1}{Search}
\\
\hline
\sphinxAtStartPar
‚Äò\textbackslash{}n‚Äô.join()
&
\sphinxAtStartPar
Creates a string from a list of string separated by \textbackslash{}n (linebreak)
&
\sphinxAtStartPar
\sphinxhref{https://www.google.com/search?q=python+string+join\&newwindow=1}{Search}
\\
\hline
\sphinxAtStartPar
f‚Äô\{varname\} = ‚Ä¶.‚Äô
&
\sphinxAtStartPar
A f\sphinxhyphen{}string, \{varname\} is replaced by the value of varname
&
\sphinxAtStartPar
\sphinxhref{https://www.google.com/search?q=python+f-string\&newwindow=1}{Search}
\\
\hline
\sphinxAtStartPar
{[}varname for varname in a\_list{]}
&
\sphinxAtStartPar
List comprehension which creates an implicit loop
&
\sphinxAtStartPar
\sphinxhref{https://www.google.com/search?q=python+list+comprehension\&newwindow=1}{Search}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}
\end{sphinxadmonition}


\subsubsection{Use the update lines to update a dataframe}
\label{\detokenize{content/howto/update/model update:use-the-update-lines-to-update-a-dataframe}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{dfnew} \PYG{o}{=} \PYG{n}{df}\PYG{o}{.}\PYG{n}{upd}\PYG{p}{(}\PYG{n}{lines}\PYG{p}{)}
\PYG{n}{dfnew}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
        A      B           C           D           E           F
2020  100  100.0  100.000000  100.000000  100.000000  100.000000
2021  100  100.0  101.000000  101.000000  101.000000  101.000000
2022  100  100.0  103.020000  103.020000  103.020000  103.020000
2023  100  100.0  106.110600  106.110600  106.110600  106.110600
2024  100  100.0  110.355024  110.355024  110.355024  110.355024
2025  100  100.0  115.872775  115.872775  115.872775  115.872775
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsubsection{Update the new dataframe and keep some of the growth rates}
\label{\detokenize{content/howto/update/model update:update-the-new-dataframe-and-keep-some-of-the-growth-rates}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{keep\_growth=True}} now all lines as default keep the growth rate
\begin{itemize}
\item {} 
\sphinxAtStartPar
c,d are updated in 2022 and 2023 and keep the growth rates afterwards

\item {} 
\sphinxAtStartPar
e the ‚Äìno\_keep\_growth in this line prevents the updating 2024\sphinxhyphen{}2025

\end{itemize}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{dfres} \PYG{o}{=} \PYG{n}{dfnew}\PYG{o}{.}\PYG{n}{upd}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\PYG{l+s+s1}{\PYGZlt{}2022 2023\PYGZgt{} c = 200 }
\PYG{l+s+s1}{\PYGZlt{}2022 2023\PYGZgt{} d = 300  }
\PYG{l+s+s1}{\PYGZlt{}2022 2023\PYGZgt{} e = 400  \PYGZhy{}\PYGZhy{}no\PYGZus{}keep\PYGZus{}growth}
\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}\PYG{p}{,}\PYG{n}{keep\PYGZus{}growth}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Dataframe:}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{dfres}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{Growth:}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{dfres}\PYG{o}{.}\PYG{n}{pct\PYGZus{}change}\PYG{p}{(}\PYG{p}{)}\PYG{o}{*}\PYG{l+m+mi}{100}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Dataframe:
        A      B      C      D           E           F
2020  100  100.0  100.0  100.0  100.000000  100.000000
2021  100  100.0  101.0  101.0  101.000000  101.000000
2022  100  100.0  200.0  300.0  400.000000  103.020000
2023  100  100.0  200.0  300.0  400.000000  106.110600
2024  100  100.0  208.0  312.0  110.355024  110.355024
2025  100  100.0  218.4  327.6  115.872775  115.872775

Growth:
        A    B          C           D           E    F
2020  NaN  NaN        NaN         NaN         NaN  NaN
2021  0.0  0.0   1.000000    1.000000    1.000000  1.0
2022  0.0  0.0  98.019802  197.029703  296.039604  2.0
2023  0.0  0.0   0.000000    0.000000    0.000000  3.0
2024  0.0  0.0   4.000000    4.000000  \PYGZhy{}72.411244  4.0
2025  0.0  0.0   5.000000    5.000000    5.000000  5.0
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{‚Äìkg can replace ‚Äìkeep\_growth and ‚Äìnkg can replace ‚Äìnon\_keep\_growth}
\label{\detokenize{content/howto/update/model update:kg-can-replace-keep-growth-and-nkg-can-replace-non-keep-growth}}
\sphinxAtStartPar
Just to make typing more easy


\section{Update several variable in one line}
\label{\detokenize{content/howto/update/model update:update-several-variable-in-one-line}}
\sphinxAtStartPar
Sometime there is a need to update several variable with the same value over the same time frame. To ease this case .update can accept several variables in one line

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df}\PYG{o}{.}\PYG{n}{upd}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\PYG{l+s+s1}{\PYGZlt{}2022 2024\PYGZgt{} h i j k =      40 }
\PYG{l+s+s1}{\PYGZlt{}2020\PYGZgt{}      p q r s =       1000}
\PYG{l+s+s1}{\PYGZlt{}2021 \PYGZhy{}1\PYGZgt{}   p q r s =growth 2     \PYGZsh{} \PYGZhy{}1 indicates the last year }
\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
        A      B     H     I     J     K            P            Q  \PYGZbs{}
2020  100  100.0   0.0   0.0   0.0   0.0  1000.000000  1000.000000   
2021  100  100.0   0.0   0.0   0.0   0.0  1020.000000  1020.000000   
2022  100  100.0  40.0  40.0  40.0  40.0  1040.400000  1040.400000   
2023  100  100.0  40.0  40.0  40.0  40.0  1061.208000  1061.208000   
2024  100  100.0  40.0  40.0  40.0  40.0  1082.432160  1082.432160   
2025  100  100.0   0.0   0.0   0.0   0.0  1104.080803  1104.080803   

                R            S  
2020  1000.000000  1000.000000  
2021  1020.000000  1020.000000  
2022  1040.400000  1040.400000  
2023  1061.208000  1061.208000  
2024  1082.432160  1082.432160  
2025  1104.080803  1104.080803  
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{.upd(,,scale=<number, default=1>) Scale the updates}
\label{\detokenize{content/howto/update/model update:upd-scale-number-default-1-scale-the-updates}}
\sphinxAtStartPar
When creating scenarios consistent of several updates it can be useful to be able to create
a number of scenarios based on one update but with different scale. For instance scale=0 is the baseline while scale=0.5 is a scenario half
the severity.

\sphinxAtStartPar
In the example below the values of the dataframes are printed.
In a more realistic example  the \sphinxcode{\sphinxupquote{print()}} below  would be changed to a call to a model instance, so the model would be simulated.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{input dataframe: }\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{df}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{k}{for} \PYG{n}{severity} \PYG{o+ow}{in} \PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mf}{0.5}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{:} 
    \PYG{c+c1}{\PYGZsh{} First make a dataframe with some growth rate }
    \PYG{n}{res} \PYG{o}{=} \PYG{n}{df}\PYG{o}{.}\PYG{n}{upd}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\PYG{l+s+s1}{    \PYGZlt{}2021 2025\PYGZgt{}}
\PYG{l+s+s1}{    a =growth 1 2 3 4 5 }
\PYG{l+s+s1}{    b + 10}
\PYG{l+s+s1}{    }\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}\PYG{p}{,}\PYG{n}{scale}\PYG{o}{=}\PYG{n}{severity}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{severity}\PYG{l+s+si}{=\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{Dataframe:}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{res}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{Growth:}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{res}\PYG{o}{.}\PYG{n}{pct\PYGZus{}change}\PYG{p}{(}\PYG{p}{)}\PYG{o}{*}\PYG{l+m+mi}{100}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{c+c1}{\PYGZsh{}  }
    \PYG{c+c1}{\PYGZsh{} Here the updated dataframe is only printet. }
    \PYG{c+c1}{\PYGZsh{} A more realistic use case is to simulate a model like this: }
    \PYG{c+c1}{\PYGZsh{} dummy\PYGZus{} = mpak(res,keep=\PYGZsq{}Severity \PYGZob{}serverity\PYGZcb{}\PYGZsq{})    \PYGZsh{} more realistic }
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
input dataframe: 
        A      B
2020  100  100.0
2021  100  100.0
2022  100  100.0
2023  100  100.0
2024  100  100.0
2025  100  100.0


severity=0
Dataframe:
        A      B
2020  100  100.0
2021  100  100.0
2022  100  100.0
2023  100  100.0
2024  100  100.0
2025  100  100.0

Growth:
        A    B
2020  NaN  NaN
2021  0.0  0.0
2022  0.0  0.0
2023  0.0  0.0
2024  0.0  0.0
2025  0.0  0.0


severity=0.5
Dataframe:
               A      B
2020  100.000000  100.0
2021  100.500000  105.0
2022  101.505000  105.0
2023  103.027575  105.0
2024  105.088126  105.0
2025  107.715330  105.0

Growth:
        A    B
2020  NaN  NaN
2021  0.5  5.0
2022  1.0  0.0
2023  1.5  0.0
2024  2.0  0.0
2025  2.5  0.0
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
severity=1
Dataframe:
               A      B
2020  100.000000  100.0
2021  101.000000  110.0
2022  103.020000  110.0
2023  106.110600  110.0
2024  110.355024  110.0
2025  115.872775  110.0

Growth:
        A     B
2020  NaN   NaN
2021  1.0  10.0
2022  2.0   0.0
2023  3.0   0.0
2024  4.0   0.0
2025  5.0   0.0
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{.upd(,,lprint=True ) prints vaues the before and after update}
\label{\detokenize{content/howto/update/model update:upd-lprint-true-prints-vaues-the-before-and-after-update}}
\sphinxAtStartPar
When creating scenarios consistent of several updates it can be useful to be able to create
a number of scenarios based on one update but with different scale. For instance scale=0 is the baseline wile scale=0.5 is a scenario half
the severity.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df}\PYG{o}{.}\PYG{n}{upd}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\PYG{l+s+s1}{\PYGZsh{} Same number of values as years}
\PYG{l+s+s1}{\PYGZlt{}2021 2022\PYGZgt{} A *  42 44}
\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}\PYG{p}{,}\PYG{n}{lprint}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Update * [42.0, 44.0] 2021 2022
A                    Before                After                 Diff
2021               100.0000            4200.0000            4100.0000
2022               100.0000            4400.0000            4300.0000
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
         A      B
2020   100  100.0
2021  4200  100.0
2022  4400  100.0
2023   100  100.0
2024   100  100.0
2025   100  100.0
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{.upd(,,create=True ) Requires the variable to exist}
\label{\detokenize{content/howto/update/model update:upd-create-true-requires-the-variable-to-exist}}
\sphinxAtStartPar
Until now .upd has created variables if they did not exist in the input dataframe.

\sphinxAtStartPar
To catch misspellings the parameter \sphinxcode{\sphinxupquote{create}} can be set to False.
New variables will not be created, and an exception will be raised.

\sphinxAtStartPar
Here Pythons exception handling is uses, so the notebook will continue to run the cells below.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{try}\PYG{p}{:}
    \PYG{n}{xx} \PYG{o}{=} \PYG{n}{df}\PYG{o}{.}\PYG{n}{upd}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\PYG{l+s+s1}{    \PYGZsh{} Same number of values as years}
\PYG{l+s+s1}{    \PYGZlt{}2021 2022\PYGZgt{} Aa *  42 44}
\PYG{l+s+s1}{    }\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}\PYG{p}{,}\PYG{n}{create}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{xx}\PYG{p}{)}
\PYG{k}{except} \PYG{n+ne}{Exception} \PYG{k}{as} \PYG{n}{inst}\PYG{p}{:}
    \PYG{n}{xx} \PYG{o}{=} \PYG{k+kc}{None}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{inst}\PYG{p}{)} 
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Variable to update not found:AA, timespan = [2021 2022] 
Set create=True if you want the variable created: 
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{The call}
\label{\detokenize{content/howto/update/model update:the-call}}
\sphinxAtStartPar
def update(indf, updates, lprint=False,scale = 1.0,create=True,keep\_growth=False,start=‚Äô‚Äô,end=‚Äô‚Äô)

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Args:
        indf (DataFrame): input dataframe.
        basis (string): lines with variable updates look below.
        lprint (bool, optional): if True each update is printed  Defaults to False.
        scale (float, optional): A multiplier used on all update input . Defaults to 1.0.
        create (bool, optional): Creates a variables if not in the dataframe . Defaults to True.
        keep\PYGZus{}growth(bool, optional): Keep the growth rate after the update time frame. Defaults to False.

    Returns:
        df (TYPE): the updated dataframe .
        
    A line in updates looks like this:     
           
    \PYGZdq{}\PYGZlt{}\PYGZdq{}[[start] end]\PYGZdq{}\PYGZgt{}\PYGZdq{} \PYGZlt{}var....\PYGZgt{} \PYGZlt{}=|+|*|\PYGZpc{}|=growth|+growth|=diff\PYGZgt{} \PYGZlt{}value\PYGZgt{}...  [\PYGZhy{}\PYGZhy{}keep\PYGZus{}growth\PYGZus{}rate|\PYGZhy{}\PYGZhy{}no\PYGZus{}keep\PYGZus{}growth\PYGZus{}rate]
\end{sphinxVerbatim}

\sphinxstepscope


\chapter{Extend Pandas dataframes with ModelFLow capabilities.}
\label{\detokenize{content/howto/update/extending_dataframes:extend-pandas-dataframes-with-modelflow-capabilities}}\label{\detokenize{content/howto/update/extending_dataframes::doc}}
\sphinxAtStartPar
This Jupyter notebook show how ModelFlow can extend pandas dataframes to run models.

\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
I would find a home for this which is more general concerning modelflow /Ib

\sphinxAtStartPar
Modelflow is a library based on the needs of Economists in particular. Economists often work with time series and want to make calculations based on the time indexed values of a number of variables.

\sphinxAtStartPar
For example we may say that

\sphinxAtStartPar
\(\hat p_t = \hat p^e_{t}+  \alpha * (Y_t/Y^{pot}_t -1) + \beta *  (\hat p_{t-1}- \hat p^e_{t-1})\)

\sphinxAtStartPar
The inflation rate (\(\hat p_t\)) in time t is a function of expected inflation (\(p^e_{t}\)), the output gap \((Y_t/Y^{pot}_t -1)\) and the one period earlier difference between the inflation rate and expected inflation  \(\hat p_{t-1}\)

\sphinxAtStartPar
Or we may want to have a system of simultaneous equations that allow for circular references, such that

\sphinxAtStartPar
\(Y_t = C_t +I_t +G_t +X_t - M_t\)

\sphinxAtStartPar
\(C_t= f(Y_t)\)

\sphinxAtStartPar
\(I_t= f(Y_t)\)

\sphinxAtStartPar
\(M_t= f(C_t,I_t)\)
\end{sphinxadmonition}


\section{Imports}
\label{\detokenize{content/howto/update/extending_dataframes:imports}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{pandas} \PYG{k}{as} \PYG{n+nn}{pd}  \PYG{c+c1}{\PYGZsh{} Python data science library}
\PYG{k+kn}{import} \PYG{n+nn}{modelmf}       \PYG{c+c1}{\PYGZsh{} Add useful features to pandas dataframes }
                     \PYG{c+c1}{\PYGZsh{} using utlities initially developed for modelflow}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Set up experiment}
\label{\detokenize{content/howto/update/extending_dataframes:set-up-experiment}}

\subsection{Create a  simple dataframe}
\label{\detokenize{content/howto/update/extending_dataframes:create-a-simple-dataframe}}
\sphinxAtStartPar
Create a Pandas dataframe with one column with the name A and 6 rows.

\sphinxAtStartPar
Set set the index to 2020 through 2026 and set the values of all the cells to 100.
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{pd.DataFrame}} creates a dataframe  \sphinxhref{https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html\#pandas.DataFrame}{Description}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{{[}2020+v for v in range(2020,2026){]}}} defines a python list comprehension which creates a list of the integers from 2020 to 2025

\end{itemize}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}                                 \PYG{c+c1}{\PYGZsh{} call the dataframe constructure }
    \PYG{l+m+mf}{100.000}\PYG{p}{,}                                           \PYG{c+c1}{\PYGZsh{} the values }
    \PYG{n}{index}\PYG{o}{=}\PYG{p}{[}\PYG{n}{v} \PYG{k}{for} \PYG{n}{v} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{2020}\PYG{p}{,}\PYG{l+m+mi}{2026}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}           \PYG{c+c1}{\PYGZsh{}index}
    \PYG{n}{columns}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}                                  \PYG{c+c1}{\PYGZsh{} the column name }
                 \PYG{p}{)}
\PYG{n}{df}   \PYG{c+c1}{\PYGZsh{} the result of the last statement is displayed in the output cell }
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
          A
2020  100.0
2021  100.0
2022  100.0
2023  100.0
2024  100.0
2025  100.0
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Use  mfcalc to calculate a new column (series) as a function of the existing A column series}
\label{\detokenize{content/howto/update/extending_dataframes:use-mfcalc-to-calculate-a-new-column-series-as-a-function-of-the-existing-a-column-series}}
\sphinxAtStartPar
X is a new column. Before it is calculated it is initialized to 0.0 for all years.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df}\PYG{o}{.}\PYG{n}{mfcalc}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x = x(\PYGZhy{}1) + a}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
          A      X
2020  100.0    0.0
2021  100.0  100.0
2022  100.0  200.0
2023  100.0  300.0
2024  100.0  400.0
2025  100.0  500.0
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
In the above example a  dataframe with the result is created and displayed, but the df dataframe did not change.  To have it change we would have had to assign it the result of the initial operation, as below.
\end{sphinxadmonition}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
          A
2020  100.0
2021  100.0
2022  100.0
2023  100.0
2024  100.0
2025  100.0
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df2}\PYG{o}{=}\PYG{n}{df}\PYG{o}{.}\PYG{n}{mfcalc}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x = x(\PYGZhy{}1) + a}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{} Assign the result to df2}
\PYG{n}{df2}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
          A      X
2020  100.0    0.0
2021  100.0  100.0
2022  100.0  200.0
2023  100.0  300.0
2024  100.0  400.0
2025  100.0  500.0
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Recalculate A so  it grows by 2 percent}
\label{\detokenize{content/howto/update/extending_dataframes:recalculate-a-so-it-grows-by-2-percent}}
\sphinxAtStartPar
mfcalcs knows that it can not start to calculate in 2020 as there is no lagged variable. So it will start calculating in 2021 and leave the pre\sphinxhyphen{}existing value unchanged.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{res} \PYG{o}{=} \PYG{n}{df}\PYG{o}{.}\PYG{n}{mfcalc}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{a =  1.02 *  a(\PYGZhy{}1)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{res}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
               A
2020  100.000000
2021  102.000000
2022  104.040000
2023  106.120800
2024  108.243216
2025  110.408080
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{res}\PYG{o}{.}\PYG{n}{pct\PYGZus{}change}\PYG{p}{(}\PYG{p}{)}\PYG{o}{*}\PYG{l+m+mi}{100} \PYG{c+c1}{\PYGZsh{} to display the percent changes}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
        A
2020  NaN
2021  2.0
2022  2.0
2023  2.0
2024  2.0
2025  2.0
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxAtStartPar
 ORIGINAL 


\subsection{mfcalc does simple normalizations}
\label{\detokenize{content/howto/update/extending_dataframes:mfcalc-does-simple-normalizations}}
\sphinxAtStartPar
Another way to set the growth rate of a variable by setting the difference in its natural logarithm.

\sphinxAtStartPar
Here  dlog(a) refers to the differene in the natural logarithm and is equal to the growth rate for the variable.
\begin{quote}

\sphinxAtStartPar
dlog(x) translates to  (\(log(x_t)-log(x_{t-1}))\)
\end{quote}

\sphinxAtStartPar
In the current example dlog(a) is not defined for 2020 (there is no lagged value for 2019) so the 2020 value is left unchanged.

\sphinxAtStartPar
For 2021 2025 mfcalc normalizes the equation such that the systems solves for a:
\(dlog(a)  = 0.02\) 
\(log(a)-log(a_{t-1}) = .02\)
\(log(a)=log(a_{t-1})+.02\) 
\(a = e^{log(a_{t-1})+0.02}\) 
\(a =a_{t-1}*e^{0.02}\)

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{res} \PYG{o}{=} \PYG{n}{df}\PYG{o}{.}\PYG{n}{mfcalc}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{dlog( a) =  0.02}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{showeq}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
\PYG{n}{res}\PYG{o}{.}\PYG{n}{pct\PYGZus{}change}\PYG{p}{(}\PYG{p}{)}\PYG{o}{*}\PYG{l+m+mi}{100}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
FRML \PYGZlt{}\PYGZgt{} A=EXP(LOG(A(\PYGZhy{}1))+0.02)\PYGZdl{}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
             A
2020       NaN
2021  2.020134
2022  2.020134
2023  2.020134
2024  2.020134
2025  2.020134
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Using .diff (\protect\(\Delta\protect\)) with mfcalc}
\label{\detokenize{content/howto/update/extending_dataframes:using-diff-delta-with-mfcalc}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{res} \PYG{o}{=} \PYG{n}{df}\PYG{o}{.}\PYG{n}{mfcalc}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{diff(a) =  2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{} Set delta to 2 }
\PYG{n}{res}\PYG{o}{.}\PYG{n}{diff}\PYG{p}{(}\PYG{p}{)}                      \PYG{c+c1}{\PYGZsh{} Display the delta }
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
        A
2020  NaN
2021  2.0
2022  2.0
2023  2.0
2024  2.0
2025  2.0
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{mfcalc with several equations and arguments}
\label{\detokenize{content/howto/update/extending_dataframes:mfcalc-with-several-equations-and-arguments}}
\sphinxAtStartPar
In addition to a single equation multiple commands can be executed with one command.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{res} \PYG{o}{=} \PYG{n}{df}\PYG{o}{.}\PYG{n}{mfcalc}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\PYG{l+s+s1}{diff(a) =  2}
\PYG{l+s+s1}{x = a + 42 }
\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}\PYG{p}{)}

\PYG{n}{res}

\PYG{c+c1}{\PYGZsh{} use res.diff() to see the difference}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
          A      X
2020  100.0    0.0
2021  102.0  144.0
2022  104.0  146.0
2023  106.0  148.0
2024  108.0  150.0
2025  110.0  152.0
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxadmonition}{warning}{Warning:}
\sphinxAtStartPar
Take care. As the max lag is 1 the expressions will not be calculated for 2020. So A keeps its
value of 100 in 2020 and X is initialized to 0 before calculating. And then keeps the value of 0
for 2020, as 2020 is not calculated.
\end{sphinxadmonition}

\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
Below, as in the example above we have zeroes for x prior to 2023 when the expressions are executed.

\sphinxAtStartPar
 Ib, Is this  because you returns zeroes by default for a declared variable? As the command was not exected for the earlier period, NaNs for nissing might be more logical.

\sphinxAtStartPar
 From Ib, Is this  because you returns zeroes by default for a declared variable? Yes. It will require some efford as some functionalities depend on this, for instance when equations are enriched with with add factors and exogenizing.
\end{sphinxadmonition}


\subsection{Setting a time frame with mfcalc.}
\label{\detokenize{content/howto/update/extending_dataframes:setting-a-time-frame-with-mfcalc}}
\sphinxAtStartPar
It can useful in some circumstances to limit the time frame for which the calculations are performed. By specifying a start date and end date enclosed in <> in a  line we can restrict the time period over which calculation is performed.

\sphinxAtStartPar
Below, as in the example above we have zeroes for x prior to 2023 when the expressions are executed.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{res} \PYG{o}{=} \PYG{n}{df}\PYG{o}{.}\PYG{n}{mfcalc}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\PYG{l+s+s1}{\PYGZlt{}2023 2025\PYGZgt{}}
\PYG{l+s+s1}{diff(a) =  2}
\PYG{l+s+s1}{x = a + 42 }
\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}\PYG{p}{)}

\PYG{n}{res}\PYG{o}{.}\PYG{n}{diff}\PYG{p}{(}\PYG{p}{)}

\PYG{n}{res}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
          A      X
2020  100.0    0.0
2021  100.0    0.0
2022  100.0    0.0
2023  102.0  144.0
2024  104.0  146.0
2025  106.0  148.0
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{.mfcalc usage}
\label{\detokenize{content/howto/update/extending_dataframes:mfcalc-usage}}
\sphinxAtStartPar
.mfcalc can be a useful extension to dataframe.upd() when creating scenarios. Or just for simple and fast calculations.

\sphinxstepscope


\part{A small demo model}

\sphinxstepscope


\chapter{Create a small model from scratch and save it}
\label{\detokenize{content/howto/smallmodel/modelstart:create-a-small-model-from-scratch-and-save-it}}\label{\detokenize{content/howto/smallmodel/modelstart::doc}}
\sphinxAtStartPar
\sphinxstylestrong{Modelflow can manage models but it can‚Äôt estimate equations}. There are many different estimation programs around, each with certain  capabilities.

\sphinxAtStartPar
In this notebook a small model estimated in Eviews is created in modelflow and solved.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZpc{}}\PYG{k}{load\PYGZus{}ext} autoreload
\PYG{o}{\PYGZpc{}}\PYG{k}{autoreload} 2
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{pandas} \PYG{k}{as} \PYG{n+nn}{pd}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from}  \PYG{n+nn}{modelmacrograb} \PYG{k+kn}{import} \PYG{n}{GrabMacroModel}
\PYG{k+kn}{from} \PYG{n+nn}{modelclass} \PYG{k+kn}{import} \PYG{n}{model}
\PYG{n}{model}\PYG{o}{.}\PYG{n}{widescreen}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}IPython.core.display.HTML object\PYGZgt{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{modeljupytermagic}  \PYG{c+c1}{\PYGZsh{} to activate \PYGZpc{}\PYGZpc{}dataframe}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Load the  national account data}
\label{\detokenize{content/howto/smallmodel/modelstart:load-the-national-account-data}}
\sphinxAtStartPar
Using a jupyter magic command (something starting with \%\%) defined in modeljupytermagic

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZpc{}\PYGZpc{}}\PYG{k}{dataframe} smalldata start=2011
Y CPV I G X M YDISC
2011 1562682. 1320302. 373938.8 131272.0 121715.0 444232.2 59686.22
2012 1632040. 1360376. 381170.2 128860.1 146292.9 457745.7 73087.14
2013 1689572. 1396402. 414556.8 124254.9 165234.6 522447.7 111572.0
2014 1791141. 1438904. 466473.0 138532.7 194705.5 632207.9 184733.1
2015 1862357. 1476067. 536416.7 154466.9 199214.9 692794.8 188986.9
2016 1870424. 1537410. 570679.5 135990.5 164738.9 714625.6 176230.0
2017 2038337. 1549515. 702407.5 165119.3 179327.0 916469.9 358437.5
2018 2193706. 1645118. 785371.4 168506.8 193124.7 1090956. 492542.0
2019 2339741. 1737872. 874480.5 180872.4 203830.6 1154398. 497084.1
2020 2295808. 1802824. 843961.1 192010.8 171282.5 978064.9 263794.1
2021 2327410. 1846635. 866899.3 211728.7 140302.8 1009072. 270916.5
2022 2402827. 1914157. 941428.0 240255.2 152623.9 1127119. 281482.2
2023 2536741. 2007600. 1060909. 252761.7 179968.7 1260336. 295838.0
2024 2715810. 2151422. 1205927. 278364.4 199108.6 1414850. 295837.8
2025 2924763. 2300322. 1359892. 307746.9 220190.6 1559226. 295837.8
2026 3140827. 2444181. 1512696. 337450.3 242638.9 1691977. 295837.8
2027 3335992. 2552411. 1652032. 363373.5 266225.5 1793888. 295837.8
2028 3528125. 2635657. 1787782. 388431.1 290729.5 1870312. 295837.8
2029 3729062. 2714120. 1927845. 414569.4 316021.6 1939332. 295837.8
2030 3945452. 2802550. 2076752. 441658.4 342117.3 2013464. 295837.8
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\subsection{Now we got a pandas dataframe with the values}
\label{\detokenize{content/howto/smallmodel/modelstart:now-we-got-a-pandas-dataframe-with-the-values}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{smalldata}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
               Y        CPV          I         G         X          M  \PYGZbs{}
index                                                                   
2011   1562682.0  1320302.0   373938.8  131272.0  121715.0   444232.2   
2012   1632040.0  1360376.0   381170.2  128860.1  146292.9   457745.7   
2013   1689572.0  1396402.0   414556.8  124254.9  165234.6   522447.7   
2014   1791141.0  1438904.0   466473.0  138532.7  194705.5   632207.9   
2015   1862357.0  1476067.0   536416.7  154466.9  199214.9   692794.8   
2016   1870424.0  1537410.0   570679.5  135990.5  164738.9   714625.6   
2017   2038337.0  1549515.0   702407.5  165119.3  179327.0   916469.9   
2018   2193706.0  1645118.0   785371.4  168506.8  193124.7  1090956.0   
2019   2339741.0  1737872.0   874480.5  180872.4  203830.6  1154398.0   
2020   2295808.0  1802824.0   843961.1  192010.8  171282.5   978064.9   
2021   2327410.0  1846635.0   866899.3  211728.7  140302.8  1009072.0   
2022   2402827.0  1914157.0   941428.0  240255.2  152623.9  1127119.0   
2023   2536741.0  2007600.0  1060909.0  252761.7  179968.7  1260336.0   
2024   2715810.0  2151422.0  1205927.0  278364.4  199108.6  1414850.0   
2025   2924763.0  2300322.0  1359892.0  307746.9  220190.6  1559226.0   
2026   3140827.0  2444181.0  1512696.0  337450.3  242638.9  1691977.0   
2027   3335992.0  2552411.0  1652032.0  363373.5  266225.5  1793888.0   
2028   3528125.0  2635657.0  1787782.0  388431.1  290729.5  1870312.0   
2029   3729062.0  2714120.0  1927845.0  414569.4  316021.6  1939332.0   
2030   3945452.0  2802550.0  2076752.0  441658.4  342117.3  2013464.0   

           YDISC  
index             
2011    59686.22  
2012    73087.14  
2013   111572.00  
2014   184733.10  
2015   188986.90  
2016   176230.00  
2017   358437.50  
2018   492542.00  
2019   497084.10  
2020   263794.10  
2021   270916.50  
2022   281482.20  
2023   295838.00  
2024   295837.80  
2025   295837.80  
2026   295837.80  
2027   295837.80  
2028   295837.80  
2029   295837.80  
2030   295837.80  
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Specify  a (small demo) model}
\label{\detokenize{content/howto/smallmodel/modelstart:specify-a-small-demo-model}}
\sphinxAtStartPar
Consumption
Lets make consumption a function of GDP (a proxy for incomes) and just to be fancy we will do it an error correction format.

\sphinxAtStartPar
\sphinxstylestrong{Long run equation}

\sphinxAtStartPar
\( CPV_t= \alpha + \beta * Y_t +\eta_t \)

\sphinxAtStartPar
In error correction format:

\sphinxAtStartPar
\( \Delta cpv_t = - \gamma *(cpv_{t-1}- y_{t-1} - \beta_2 ) + \Delta y_t \) where lowercase variables preprsent the logarithm of the original variable

\sphinxAtStartPar
For this model we assume that CPV, G, I, M can be specified in the same format.

\sphinxAtStartPar
So we have these \sphinxstylestrong{stochastic equations}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
 \PYG{n}{dlog}\PYG{p}{(}\PYG{n}{cpv}\PYG{p}{)}\PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{n}{gamma\PYGZus{}cpv}\PYG{o}{*}\PYG{p}{(}\PYG{n}{log}\PYG{p}{(}\PYG{n}{cpv}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}\PYG{o}{\PYGZhy{}}\PYG{n}{log}\PYG{p}{(}\PYG{n}{y}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{beta\PYGZus{}cpv}\PYG{p}{)}\PYG{o}{+}\PYG{n}{beta2\PYGZus{}cpv}\PYG{o}{*}\PYG{n}{dlog}\PYG{p}{(}\PYG{n}{y}\PYG{p}{)}

 \PYG{n}{dlog}\PYG{p}{(}\PYG{n}{g}\PYG{p}{)}\PYG{o}{=}\PYG{o}{\PYGZhy{}}\PYG{n}{gamma\PYGZus{}g}\PYG{o}{*}\PYG{p}{(}\PYG{n}{log}\PYG{p}{(}\PYG{n}{g}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}\PYG{o}{\PYGZhy{}}\PYG{n}{log}\PYG{p}{(}\PYG{n}{y}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{beta\PYGZus{}g}\PYG{p}{)}\PYG{o}{+}\PYG{n}{beta2\PYGZus{}g}\PYG{o}{*}\PYG{n}{dlog}\PYG{p}{(}\PYG{n}{y}\PYG{p}{)}

 \PYG{n}{dlog}\PYG{p}{(}\PYG{n}{i}\PYG{p}{)}\PYG{o}{=}\PYG{o}{\PYGZhy{}}\PYG{n}{gamma\PYGZus{}i}\PYG{o}{*}\PYG{p}{(}\PYG{n}{log}\PYG{p}{(}\PYG{n}{i}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}\PYG{o}{\PYGZhy{}}\PYG{n}{log}\PYG{p}{(}\PYG{n}{y}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{\PYGZhy{}}\PYG{n}{g}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{beta\PYGZus{}i}\PYG{p}{)}\PYG{o}{+}\PYG{n}{beta2\PYGZus{}i}\PYG{o}{*}\PYG{n}{dlog}\PYG{p}{(}\PYG{n}{y}\PYG{p}{)} 
 
 \PYG{n}{dlog}\PYG{p}{(}\PYG{n}{m}\PYG{p}{)}\PYG{o}{=}\PYG{o}{\PYGZhy{}}\PYG{n}{gamma\PYGZus{}m}\PYG{o}{*}\PYG{p}{(}\PYG{n}{log}\PYG{p}{(}\PYG{n}{m}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}\PYG{o}{\PYGZhy{}}\PYG{n}{log}\PYG{p}{(}\PYG{n}{gde}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{beta\PYGZus{}m}\PYG{p}{)}\PYG{o}{+}\PYG{n}{beta2\PYGZus{}m}\PYG{o}{*}\PYG{n}{dlog}\PYG{p}{(}\PYG{n}{gde}\PYG{p}{)}
 
\end{sphinxVerbatim}

\sphinxAtStartPar
In addition we have \sphinxstylestrong{two identities}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
 \PYG{n}{y}\PYG{o}{=}\PYG{n}{cpv}\PYG{o}{+}\PYG{n}{i}\PYG{o}{+}\PYG{n}{g}\PYG{o}{+}\PYG{n}{x}\PYG{o}{\PYGZhy{}}\PYG{n}{m}\PYG{o}{+}\PYG{n}{ydisc}
 
 \PYG{n}{gde}\PYG{o}{=}\PYG{n}{cpv}\PYG{o}{+}\PYG{n}{i}\PYG{o}{+}\PYG{n}{g}
\end{sphinxVerbatim}


\section{The Equations}
\label{\detokenize{content/howto/smallmodel/modelstart:the-equations}}
\sphinxAtStartPar
Now these equations are written in modelflow format and letting the parameters start with c as it makes it more easy to translate estimates from eviews.

\sphinxAtStartPar
Each equation can be prefixed by options enclosed in <>.


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Option
&\sphinxstyletheadfamily 
\sphinxAtStartPar
meaning
\\
\hline
\sphinxAtStartPar
fixable
&
\sphinxAtStartPar
The variable can have its value fixed when simulating
\\
\hline
\sphinxAtStartPar
damp
&
\sphinxAtStartPar
When using Gauss\sphinxhyphen{}Seidle solution method the equation can be damped
\\
\hline
\sphinxAtStartPar
ident
&
\sphinxAtStartPar
This is an identity, used when we have to calculate the values
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
The specification is a \sphinxstylestrong{string} object and assigned to a variable called: fsmallmodel.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{fsmallmodel} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\PYG{l+s+s1}{\PYGZlt{}fixable, damp\PYGZgt{} dlog(cpv)= \PYGZhy{}c2\PYGZus{}cpv*(log(cpv(\PYGZhy{}1))\PYGZhy{}log(y(\PYGZhy{}1)) \PYGZhy{}        c1\PYGZus{}cpv)+c3\PYGZus{}cpv*dlog(y)}

\PYG{l+s+s1}{\PYGZlt{}fixable, damp\PYGZgt{} dlog(g)  = \PYGZhy{}c2\PYGZus{}g*  (log(g(\PYGZhy{}1))\PYGZhy{}  log(y(\PYGZhy{}1)) \PYGZhy{}        c1\PYGZus{}g)  +c3\PYGZus{}g*dlog(y)}

\PYG{l+s+s1}{\PYGZlt{}fixable, damp\PYGZgt{} dlog(i)  =    \PYGZhy{}c2\PYGZus{}i*  (log(i(\PYGZhy{}1))\PYGZhy{}  log(y(\PYGZhy{}1)\PYGZhy{}g(\PYGZhy{}1)) \PYGZhy{} c1\PYGZus{}i)   +c3\PYGZus{}i*dlog(y) }
\PYG{l+s+s1}{ }
\PYG{l+s+s1}{\PYGZlt{}fixable, damp\PYGZgt{} dlog(m) =     \PYGZhy{}c2\PYGZus{}m*  (log(m(\PYGZhy{}1))\PYGZhy{}   log(gde(\PYGZhy{}1))    \PYGZhy{} c1\PYGZus{}m)   +c3\PYGZus{}m*dlog(gde)}
\PYG{l+s+s1}{ }
\PYG{l+s+s1}{\PYGZlt{}ident\PYGZgt{} y=cpv+i+g+x\PYGZhy{}m+ydisc }
\PYG{l+s+s1}{ }
\PYG{l+s+s1}{\PYGZlt{}ident\PYGZgt{} gde=cpv+i+g}

\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Convert the specification to modelflow}
\label{\detokenize{content/howto/smallmodel/modelstart:convert-the-specification-to-modelflow}}
\sphinxAtStartPar
The \sphinxstylestrong{specification} in itself can not be used for anything useful \sphinxhyphen{} it is just a string. The next step is to use the
specification to create an instance of the  \sphinxstylestrong{model class} which can solve the model. Instances of the \sphinxcode{\sphinxupquote{model class}} wraps most of the capabilities of modelflow. Actually we will create a numberinstances of model, as there are additional calculations to be done. So for this particular type of model another class: *\sphinxstylestrong{GrabMacroModel} is used to process the model specification. It will handle:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Introducing add\_factors

\item {} 
\sphinxAtStartPar
Normalize equations

\item {} 
\sphinxAtStartPar
Make equations fixable

\item {} 
\sphinxAtStartPar
Generate equations for fitted values

\item {} 
\sphinxAtStartPar
Create model to calculate add factors

\item {} 
\sphinxAtStartPar
Create model to calculate fitted values

\item {} 
\sphinxAtStartPar
Create model to calculate identities

\end{itemize}

\sphinxAtStartPar
In the next cell it is shown how each equation flows trough several steps.


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
information
&\sphinxstyletheadfamily 
\sphinxAtStartPar
meaning
\\
\hline
\sphinxAtStartPar
Frml name
&
\sphinxAtStartPar
The options provided
\\
\hline
\sphinxAtStartPar
Endo\_var
&
\sphinxAtStartPar
The left hand side variable
\\
\hline
\sphinxAtStartPar
Original
&
\sphinxAtStartPar
The original specification
\\
\hline
\sphinxAtStartPar
Preprocessed
&
\sphinxAtStartPar
Some preprocessing like: dlog(x>) ‚Äì> (log(x)\sphinxhyphen{}log(x(\sphinxhyphen{}1)))
\\
\hline
\sphinxAtStartPar
Normalized
&
\sphinxAtStartPar
Isolation of the endogenous variable on the left hand side
\\
\hline
\sphinxAtStartPar
Calc\_add\_factor
&
\sphinxAtStartPar
An equation for calculating addfactor which makes left and right hand side match
\\
\hline
\sphinxAtStartPar
Fitted
&
\sphinxAtStartPar
An equation which calculate the original equation without add factor and fixing
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\section{On normalization and enrichment of equations}
\label{\detokenize{content/howto/smallmodel/modelstart:on-normalization-and-enrichment-of-equations}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{modelnormalize} \PYG{k+kn}{import} \PYG{n}{normal} 
\PYG{n}{normal}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{dlog(a) = dlog(b(\PYGZhy{}7)) }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Endo\PYGZus{}var        : A
Original        : dlog(a) = dlog(b(\PYGZhy{}7)) 
Preprocessed    : ((LOG(A))\PYGZhy{}(LOG(A(\PYGZhy{}1))))=((LOG(B(\PYGZhy{}7)))\PYGZhy{}(LOG(B(\PYGZhy{}8))))
Normalized      : A = A(\PYGZhy{}1)*EXP(A\PYGZus{}A+ (((LOG(B(\PYGZhy{}7)))\PYGZhy{}(LOG(B(\PYGZhy{}8))))) )
Calc\PYGZus{}add\PYGZus{}factor : A\PYGZus{}A = \PYGZhy{} ((((LOG(B(\PYGZhy{}7)))\PYGZhy{}(LOG(B(\PYGZhy{}8)))))) +LOG(A)\PYGZhy{}LOG(A(\PYGZhy{}1))
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{normal}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{a = b}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{make\PYGZus{}fixable}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{make\PYGZus{}fitted}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{add\PYGZus{}add\PYGZus{}factor}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Endo\PYGZus{}var        : A
Original        : a = b
Preprocessed    : A=B
Normalized      : A = (B + A\PYGZus{}A)* (1\PYGZhy{}A\PYGZus{}D)+ A\PYGZus{}X*A\PYGZus{}D 
Calc\PYGZus{}add\PYGZus{}factor : A\PYGZus{}A = (A) \PYGZhy{} (B)
Fitted          : A\PYGZus{}FITTED = B
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{thismodel} \PYG{o}{=} \PYG{n}{GrabMacroModel}\PYG{p}{(}\PYG{n}{fsmallmodel}\PYG{p}{,}\PYG{n}{modelname} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Small demo model}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{make\PYGZus{}fitted} \PYG{o}{=} \PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{debug} \PYG{o}{=} \PYG{k+kc}{True}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Frml name:\PYGZlt{}FIXABLE, DAMP\PYGZgt{}
Endo\PYGZus{}var        : CPV
Original        :  DLOG(CPV)= \PYGZhy{}C2\PYGZus{}CPV*(LOG(CPV(\PYGZhy{}1))\PYGZhy{}LOG(Y(\PYGZhy{}1)) \PYGZhy{}        C1\PYGZus{}CPV)+C3\PYGZus{}CPV*DLOG(Y)
Preprocessed    : ((LOG(CPV))\PYGZhy{}(LOG(CPV(\PYGZhy{}1))))=\PYGZhy{}C2\PYGZus{}CPV*(LOG(CPV(\PYGZhy{}1))\PYGZhy{}LOG(Y(\PYGZhy{}1))\PYGZhy{}C1\PYGZus{}CPV)+C3\PYGZus{}CPV*((LOG(Y))\PYGZhy{}(LOG(Y(\PYGZhy{}1))))
Normalized      : CPV = (CPV(\PYGZhy{}1)*EXP(CPV\PYGZus{}A+ (\PYGZhy{}C2\PYGZus{}CPV*(LOG(CPV(\PYGZhy{}1))\PYGZhy{}LOG(Y(\PYGZhy{}1))\PYGZhy{}C1\PYGZus{}CPV)+C3\PYGZus{}CPV*((LOG(Y))\PYGZhy{}(LOG(Y(\PYGZhy{}1))))) )) * (1\PYGZhy{}CPV\PYGZus{}D)+ CPV\PYGZus{}X*CPV\PYGZus{}D 
Calc\PYGZus{}add\PYGZus{}factor : CPV\PYGZus{}A = \PYGZhy{} ((\PYGZhy{}C2\PYGZus{}CPV*(LOG(CPV(\PYGZhy{}1))\PYGZhy{}LOG(Y(\PYGZhy{}1))\PYGZhy{}C1\PYGZus{}CPV)+C3\PYGZus{}CPV*((LOG(Y))\PYGZhy{}(LOG(Y(\PYGZhy{}1)))))) +LOG(CPV)\PYGZhy{}LOG(CPV(\PYGZhy{}1))
Fitted          : CPV\PYGZus{}FITTED = CPV(\PYGZhy{}1)*EXP( (\PYGZhy{}C2\PYGZus{}CPV*(LOG(CPV(\PYGZhy{}1))\PYGZhy{}LOG(Y(\PYGZhy{}1))\PYGZhy{}C1\PYGZus{}CPV)+C3\PYGZus{}CPV*((LOG(Y))\PYGZhy{}(LOG(Y(\PYGZhy{}1))))) )

Frml name:\PYGZlt{}FIXABLE, DAMP\PYGZgt{}
Endo\PYGZus{}var        : G
Original        :  DLOG(G)  = \PYGZhy{}C2\PYGZus{}G*  (LOG(G(\PYGZhy{}1))\PYGZhy{}  LOG(Y(\PYGZhy{}1)) \PYGZhy{}        C1\PYGZus{}G)  +C3\PYGZus{}G*DLOG(Y)
Preprocessed    : ((LOG(G))\PYGZhy{}(LOG(G(\PYGZhy{}1))))=\PYGZhy{}C2\PYGZus{}G*(LOG(G(\PYGZhy{}1))\PYGZhy{}LOG(Y(\PYGZhy{}1))\PYGZhy{}C1\PYGZus{}G)+C3\PYGZus{}G*((LOG(Y))\PYGZhy{}(LOG(Y(\PYGZhy{}1))))
Normalized      : G = (G(\PYGZhy{}1)*EXP(G\PYGZus{}A+ (\PYGZhy{}C2\PYGZus{}G*(LOG(G(\PYGZhy{}1))\PYGZhy{}LOG(Y(\PYGZhy{}1))\PYGZhy{}C1\PYGZus{}G)+C3\PYGZus{}G*((LOG(Y))\PYGZhy{}(LOG(Y(\PYGZhy{}1))))) )) * (1\PYGZhy{}G\PYGZus{}D)+ G\PYGZus{}X*G\PYGZus{}D 
Calc\PYGZus{}add\PYGZus{}factor : G\PYGZus{}A = \PYGZhy{} ((\PYGZhy{}C2\PYGZus{}G*(LOG(G(\PYGZhy{}1))\PYGZhy{}LOG(Y(\PYGZhy{}1))\PYGZhy{}C1\PYGZus{}G)+C3\PYGZus{}G*((LOG(Y))\PYGZhy{}(LOG(Y(\PYGZhy{}1)))))) +LOG(G)\PYGZhy{}LOG(G(\PYGZhy{}1))
Fitted          : G\PYGZus{}FITTED = G(\PYGZhy{}1)*EXP( (\PYGZhy{}C2\PYGZus{}G*(LOG(G(\PYGZhy{}1))\PYGZhy{}LOG(Y(\PYGZhy{}1))\PYGZhy{}C1\PYGZus{}G)+C3\PYGZus{}G*((LOG(Y))\PYGZhy{}(LOG(Y(\PYGZhy{}1))))) )

Frml name:\PYGZlt{}FIXABLE, DAMP\PYGZgt{}
Endo\PYGZus{}var        : I
Original        :  DLOG(I)  =    \PYGZhy{}C2\PYGZus{}I*  (LOG(I(\PYGZhy{}1))\PYGZhy{}  LOG(Y(\PYGZhy{}1)\PYGZhy{}G(\PYGZhy{}1)) \PYGZhy{} C1\PYGZus{}I)   +C3\PYGZus{}I*DLOG(Y) 
Preprocessed    : ((LOG(I))\PYGZhy{}(LOG(I(\PYGZhy{}1))))=\PYGZhy{}C2\PYGZus{}I*(LOG(I(\PYGZhy{}1))\PYGZhy{}LOG(Y(\PYGZhy{}1)\PYGZhy{}G(\PYGZhy{}1))\PYGZhy{}C1\PYGZus{}I)+C3\PYGZus{}I*((LOG(Y))\PYGZhy{}(LOG(Y(\PYGZhy{}1))))
Normalized      : I = (I(\PYGZhy{}1)*EXP(I\PYGZus{}A+ (\PYGZhy{}C2\PYGZus{}I*(LOG(I(\PYGZhy{}1))\PYGZhy{}LOG(Y(\PYGZhy{}1)\PYGZhy{}G(\PYGZhy{}1))\PYGZhy{}C1\PYGZus{}I)+C3\PYGZus{}I*((LOG(Y))\PYGZhy{}(LOG(Y(\PYGZhy{}1))))) )) * (1\PYGZhy{}I\PYGZus{}D)+ I\PYGZus{}X*I\PYGZus{}D 
Calc\PYGZus{}add\PYGZus{}factor : I\PYGZus{}A = \PYGZhy{} ((\PYGZhy{}C2\PYGZus{}I*(LOG(I(\PYGZhy{}1))\PYGZhy{}LOG(Y(\PYGZhy{}1)\PYGZhy{}G(\PYGZhy{}1))\PYGZhy{}C1\PYGZus{}I)+C3\PYGZus{}I*((LOG(Y))\PYGZhy{}(LOG(Y(\PYGZhy{}1)))))) +LOG(I)\PYGZhy{}LOG(I(\PYGZhy{}1))
Fitted          : I\PYGZus{}FITTED = I(\PYGZhy{}1)*EXP( (\PYGZhy{}C2\PYGZus{}I*(LOG(I(\PYGZhy{}1))\PYGZhy{}LOG(Y(\PYGZhy{}1)\PYGZhy{}G(\PYGZhy{}1))\PYGZhy{}C1\PYGZus{}I)+C3\PYGZus{}I*((LOG(Y))\PYGZhy{}(LOG(Y(\PYGZhy{}1))))) )

Frml name:\PYGZlt{}FIXABLE, DAMP\PYGZgt{}
Endo\PYGZus{}var        : M
Original        :  DLOG(M) =     \PYGZhy{}C2\PYGZus{}M*  (LOG(M(\PYGZhy{}1))\PYGZhy{}   LOG(GDE(\PYGZhy{}1))    \PYGZhy{} C1\PYGZus{}M)   +C3\PYGZus{}M*DLOG(GDE)
Preprocessed    : ((LOG(M))\PYGZhy{}(LOG(M(\PYGZhy{}1))))=\PYGZhy{}C2\PYGZus{}M*(LOG(M(\PYGZhy{}1))\PYGZhy{}LOG(GDE(\PYGZhy{}1))\PYGZhy{}C1\PYGZus{}M)+C3\PYGZus{}M*((LOG(GDE))\PYGZhy{}(LOG(GDE(\PYGZhy{}1))))
Normalized      : M = (M(\PYGZhy{}1)*EXP(M\PYGZus{}A+ (\PYGZhy{}C2\PYGZus{}M*(LOG(M(\PYGZhy{}1))\PYGZhy{}LOG(GDE(\PYGZhy{}1))\PYGZhy{}C1\PYGZus{}M)+C3\PYGZus{}M*((LOG(GDE))\PYGZhy{}(LOG(GDE(\PYGZhy{}1))))) )) * (1\PYGZhy{}M\PYGZus{}D)+ M\PYGZus{}X*M\PYGZus{}D 
Calc\PYGZus{}add\PYGZus{}factor : M\PYGZus{}A = \PYGZhy{} ((\PYGZhy{}C2\PYGZus{}M*(LOG(M(\PYGZhy{}1))\PYGZhy{}LOG(GDE(\PYGZhy{}1))\PYGZhy{}C1\PYGZus{}M)+C3\PYGZus{}M*((LOG(GDE))\PYGZhy{}(LOG(GDE(\PYGZhy{}1)))))) +LOG(M)\PYGZhy{}LOG(M(\PYGZhy{}1))
Fitted          : M\PYGZus{}FITTED = M(\PYGZhy{}1)*EXP( (\PYGZhy{}C2\PYGZus{}M*(LOG(M(\PYGZhy{}1))\PYGZhy{}LOG(GDE(\PYGZhy{}1))\PYGZhy{}C1\PYGZus{}M)+C3\PYGZus{}M*((LOG(GDE))\PYGZhy{}(LOG(GDE(\PYGZhy{}1))))) )

Frml name:\PYGZlt{}IDENT\PYGZgt{}
Endo\PYGZus{}var        : Y
Original        :  Y=CPV+I+G+X\PYGZhy{}M+YDISC 
Preprocessed    : Y=CPV+I+G+X\PYGZhy{}M+YDISC
Normalized      : Y = CPV+I+G+X\PYGZhy{}M+YDISC

Frml name:\PYGZlt{}IDENT\PYGZgt{}
Endo\PYGZus{}var        : GDE
Original        :  GDE=CPV+I+G
Preprocessed    : GDE=CPV+I+G
Normalized      : GDE = CPV+I+G
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Get the model}
\label{\detokenize{content/howto/smallmodel/modelstart:get-the-model}}
\sphinxAtStartPar
As a convention \sphinxstylestrong{m} is used as prefix for model objects.

\sphinxAtStartPar
So the model is called \sphinxcode{\sphinxupquote{msmallmodel}}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{msmallmodel} \PYG{o}{=} \PYG{n}{thismodel}\PYG{o}{.}\PYG{n}{mmodel}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\subsection{Inject some variable descriptions.}
\label{\detokenize{content/howto/smallmodel/modelstart:inject-some-variable-descriptions}}
\sphinxAtStartPar
A Python dictionary is used for storing variable descriptions.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{descriptions} \PYG{o}{=} \PYG{p}{\PYGZob{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{CPV}\PYG{l+s+s1}{\PYGZsq{}}   \PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Private Consumption}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}     \PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{GDP}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{G}\PYG{l+s+s1}{\PYGZsq{}}     \PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Government}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{I}\PYG{l+s+s1}{\PYGZsq{}}     \PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Investment}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{GDE}\PYG{l+s+s1}{\PYGZsq{}}   \PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Gross Domestic Expenditure}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{X}\PYG{l+s+s1}{\PYGZsq{}}     \PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Export}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{M}\PYG{l+s+s1}{\PYGZsq{}}     \PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Import}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{YDISC}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{:}  \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Discrepance}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{p}{\PYGZcb{}}
\PYG{n}{msmallmodel}\PYG{o}{.}\PYG{n}{set\PYGZus{}var\PYGZus{}description}\PYG{p}{(}\PYG{n}{msmallmodel}\PYG{o}{.}\PYG{n}{enrich\PYGZus{}var\PYGZus{}description}\PYG{p}{(}\PYG{n}{descriptions}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\subsection{The model equations}
\label{\detokenize{content/howto/smallmodel/modelstart:the-model-equations}}
\sphinxAtStartPar
Each equation has the form:
\begin{quote}

\sphinxAtStartPar
FRML <{[}options{]}‚Ä¶> <left hand variable> = <right hand side expression>\$
\end{quote}

\sphinxAtStartPar
Equations with the option \sphinxcode{\sphinxupquote{CALC\_ADD\_FACTOR}} specifies a separate model which can be used to calculate the add factors
which makes left hand side equals to the right hand side (without any fixing)

\sphinxAtStartPar
So there are actually specified two models.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{msmallmodel}\PYG{o}{.}\PYG{n}{equations}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
FRML \PYGZlt{}FIXABLE, DAMP\PYGZgt{} CPV = (CPV(\PYGZhy{}1)*EXP(CPV\PYGZus{}A+ (\PYGZhy{}C2\PYGZus{}CPV*(LOG(CPV(\PYGZhy{}1))\PYGZhy{}LOG(Y(\PYGZhy{}1))\PYGZhy{}C1\PYGZus{}CPV)+C3\PYGZus{}CPV*((LOG(Y))\PYGZhy{}(LOG(Y(\PYGZhy{}1))))) )) * (1\PYGZhy{}CPV\PYGZus{}D)+ CPV\PYGZus{}X*CPV\PYGZus{}D \PYGZdl{}
FRML \PYGZlt{}FIXABLE, DAMP\PYGZgt{} G = (G(\PYGZhy{}1)*EXP(G\PYGZus{}A+ (\PYGZhy{}C2\PYGZus{}G*(LOG(G(\PYGZhy{}1))\PYGZhy{}LOG(Y(\PYGZhy{}1))\PYGZhy{}C1\PYGZus{}G)+C3\PYGZus{}G*((LOG(Y))\PYGZhy{}(LOG(Y(\PYGZhy{}1))))) )) * (1\PYGZhy{}G\PYGZus{}D)+ G\PYGZus{}X*G\PYGZus{}D \PYGZdl{}
FRML \PYGZlt{}FIXABLE, DAMP\PYGZgt{} I = (I(\PYGZhy{}1)*EXP(I\PYGZus{}A+ (\PYGZhy{}C2\PYGZus{}I*(LOG(I(\PYGZhy{}1))\PYGZhy{}LOG(Y(\PYGZhy{}1)\PYGZhy{}G(\PYGZhy{}1))\PYGZhy{}C1\PYGZus{}I)+C3\PYGZus{}I*((LOG(Y))\PYGZhy{}(LOG(Y(\PYGZhy{}1))))) )) * (1\PYGZhy{}I\PYGZus{}D)+ I\PYGZus{}X*I\PYGZus{}D \PYGZdl{}
FRML \PYGZlt{}FIXABLE, DAMP\PYGZgt{} M = (M(\PYGZhy{}1)*EXP(M\PYGZus{}A+ (\PYGZhy{}C2\PYGZus{}M*(LOG(M(\PYGZhy{}1))\PYGZhy{}LOG(GDE(\PYGZhy{}1))\PYGZhy{}C1\PYGZus{}M)+C3\PYGZus{}M*((LOG(GDE))\PYGZhy{}(LOG(GDE(\PYGZhy{}1))))) )) * (1\PYGZhy{}M\PYGZus{}D)+ M\PYGZus{}X*M\PYGZus{}D \PYGZdl{}
FRML \PYGZlt{}IDENT\PYGZgt{} Y = CPV+I+G+X\PYGZhy{}M+YDISC\PYGZdl{}
FRML \PYGZlt{}IDENT\PYGZgt{} GDE = CPV+I+G\PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} CPV\PYGZus{}FITTED = CPV(\PYGZhy{}1)*EXP( (\PYGZhy{}C2\PYGZus{}CPV*(LOG(CPV(\PYGZhy{}1))\PYGZhy{}LOG(Y(\PYGZhy{}1))\PYGZhy{}C1\PYGZus{}CPV)+C3\PYGZus{}CPV*((LOG(Y))\PYGZhy{}(LOG(Y(\PYGZhy{}1))))) )\PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} G\PYGZus{}FITTED = G(\PYGZhy{}1)*EXP( (\PYGZhy{}C2\PYGZus{}G*(LOG(G(\PYGZhy{}1))\PYGZhy{}LOG(Y(\PYGZhy{}1))\PYGZhy{}C1\PYGZus{}G)+C3\PYGZus{}G*((LOG(Y))\PYGZhy{}(LOG(Y(\PYGZhy{}1))))) )\PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} I\PYGZus{}FITTED = I(\PYGZhy{}1)*EXP( (\PYGZhy{}C2\PYGZus{}I*(LOG(I(\PYGZhy{}1))\PYGZhy{}LOG(Y(\PYGZhy{}1)\PYGZhy{}G(\PYGZhy{}1))\PYGZhy{}C1\PYGZus{}I)+C3\PYGZus{}I*((LOG(Y))\PYGZhy{}(LOG(Y(\PYGZhy{}1))))) )\PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} M\PYGZus{}FITTED = M(\PYGZhy{}1)*EXP( (\PYGZhy{}C2\PYGZus{}M*(LOG(M(\PYGZhy{}1))\PYGZhy{}LOG(GDE(\PYGZhy{}1))\PYGZhy{}C1\PYGZus{}M)+C3\PYGZus{}M*((LOG(GDE))\PYGZhy{}(LOG(GDE(\PYGZhy{}1))))) )\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} CPV\PYGZus{}A = \PYGZhy{} ((\PYGZhy{}C2\PYGZus{}CPV*(LOG(CPV(\PYGZhy{}1))\PYGZhy{}LOG(Y(\PYGZhy{}1))\PYGZhy{}C1\PYGZus{}CPV)+C3\PYGZus{}CPV*((LOG(Y))\PYGZhy{}(LOG(Y(\PYGZhy{}1)))))) +LOG(CPV)\PYGZhy{}LOG(CPV(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} G\PYGZus{}A = \PYGZhy{} ((\PYGZhy{}C2\PYGZus{}G*(LOG(G(\PYGZhy{}1))\PYGZhy{}LOG(Y(\PYGZhy{}1))\PYGZhy{}C1\PYGZus{}G)+C3\PYGZus{}G*((LOG(Y))\PYGZhy{}(LOG(Y(\PYGZhy{}1)))))) +LOG(G)\PYGZhy{}LOG(G(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} I\PYGZus{}A = \PYGZhy{} ((\PYGZhy{}C2\PYGZus{}I*(LOG(I(\PYGZhy{}1))\PYGZhy{}LOG(Y(\PYGZhy{}1)\PYGZhy{}G(\PYGZhy{}1))\PYGZhy{}C1\PYGZus{}I)+C3\PYGZus{}I*((LOG(Y))\PYGZhy{}(LOG(Y(\PYGZhy{}1)))))) +LOG(I)\PYGZhy{}LOG(I(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} M\PYGZus{}A = \PYGZhy{} ((\PYGZhy{}C2\PYGZus{}M*(LOG(M(\PYGZhy{}1))\PYGZhy{}LOG(GDE(\PYGZhy{}1))\PYGZhy{}C1\PYGZus{}M)+C3\PYGZus{}M*((LOG(GDE))\PYGZhy{}(LOG(GDE(\PYGZhy{}1)))))) +LOG(M)\PYGZhy{}LOG(M(\PYGZhy{}1))\PYGZdl{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{The model structure can be drawn}
\label{\detokenize{content/howto/smallmodel/modelstart:the-model-structure-can-be-drawn}}
\sphinxAtStartPar
Notice that mouseover shows additional information

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{msmallmodel}\PYG{o}{.}\PYG{n}{drawmodel}\PYG{p}{(}\PYG{n}{size} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{10}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}IPython.core.display.SVG object\PYGZgt{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Only the endogenous variables}
\label{\detokenize{content/howto/smallmodel/modelstart:only-the-endogenous-variables}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{msmallmodel}\PYG{o}{.}\PYG{n}{drawendo}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}IPython.core.display.SVG object\PYGZgt{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{The adjacendy matrix for the endogenous variables.}
\label{\detokenize{content/howto/smallmodel/modelstart:the-adjacendy-matrix-for-the-endogenous-variables}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{msmallmodel}\PYG{o}{.}\PYG{n}{plotadjacency}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{modelstart_30_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{msmallmodel}\PYG{o}{.}\PYG{n}{endogene}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZob{}\PYGZsq{}CPV\PYGZsq{},
 \PYGZsq{}CPV\PYGZus{}FITTED\PYGZsq{},
 \PYGZsq{}G\PYGZsq{},
 \PYGZsq{}GDE\PYGZsq{},
 \PYGZsq{}G\PYGZus{}FITTED\PYGZsq{},
 \PYGZsq{}I\PYGZsq{},
 \PYGZsq{}I\PYGZus{}FITTED\PYGZsq{},
 \PYGZsq{}M\PYGZsq{},
 \PYGZsq{}M\PYGZus{}FITTED\PYGZsq{},
 \PYGZsq{}Y\PYGZsq{}\PYGZcb{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{msmallmodel}\PYG{o}{.}\PYG{n}{exogene}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZob{}\PYGZsq{}C1\PYGZus{}CPV\PYGZsq{},
 \PYGZsq{}C1\PYGZus{}G\PYGZsq{},
 \PYGZsq{}C1\PYGZus{}I\PYGZsq{},
 \PYGZsq{}C1\PYGZus{}M\PYGZsq{},
 \PYGZsq{}C2\PYGZus{}CPV\PYGZsq{},
 \PYGZsq{}C2\PYGZus{}G\PYGZsq{},
 \PYGZsq{}C2\PYGZus{}I\PYGZsq{},
 \PYGZsq{}C2\PYGZus{}M\PYGZsq{},
 \PYGZsq{}C3\PYGZus{}CPV\PYGZsq{},
 \PYGZsq{}C3\PYGZus{}G\PYGZsq{},
 \PYGZsq{}C3\PYGZus{}I\PYGZsq{},
 \PYGZsq{}C3\PYGZus{}M\PYGZsq{},
 \PYGZsq{}CPV\PYGZus{}A\PYGZsq{},
 \PYGZsq{}CPV\PYGZus{}D\PYGZsq{},
 \PYGZsq{}CPV\PYGZus{}X\PYGZsq{},
 \PYGZsq{}G\PYGZus{}A\PYGZsq{},
 \PYGZsq{}G\PYGZus{}D\PYGZsq{},
 \PYGZsq{}G\PYGZus{}X\PYGZsq{},
 \PYGZsq{}I\PYGZus{}A\PYGZsq{},
 \PYGZsq{}I\PYGZus{}D\PYGZsq{},
 \PYGZsq{}I\PYGZus{}X\PYGZsq{},
 \PYGZsq{}M\PYGZus{}A\PYGZsq{},
 \PYGZsq{}M\PYGZus{}D\PYGZsq{},
 \PYGZsq{}M\PYGZus{}X\PYGZsq{},
 \PYGZsq{}X\PYGZsq{},
 \PYGZsq{}YDISC\PYGZsq{}\PYGZcb{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{The Dataframe has to be enriched:}
\label{\detokenize{content/howto/smallmodel/modelstart:the-dataframe-has-to-be-enriched}}\begin{itemize}
\item {} 
\sphinxAtStartPar
The the parameter values

\item {} 
\sphinxAtStartPar
Variables mentioned in the model, but not present in the dataframe

\item {} 
\sphinxAtStartPar
Calculated variables from the model has to be calculated

\item {} 
\sphinxAtStartPar
Add factors ensuring that the solution match the data has to be calculated.

\end{itemize}


\subsection{The parameter values}
\label{\detokenize{content/howto/smallmodel/modelstart:the-parameter-values}}
\sphinxAtStartPar
Modelflow is \sphinxstylestrong{not an estimation tool}. So we have to provide the estimated parameters. 
This can be done in several way:
\begin{itemize}
\item {} 
\sphinxAtStartPar
The parameters can be input into the equations. This can be automated.

\item {} 
\sphinxAtStartPar
The parameters can be broadcast into a dataframe. Which is what we will do here.

\end{itemize}

\sphinxAtStartPar
For this purpose a ‚Äúmagic‚Äù jupyter command will be used. It will create a dataframe with the right values:

\sphinxAtStartPar
\sphinxstylestrong{Modelflow don‚Äôt have a special datatype for parameters} so we just repeat the same value for all years

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZpc{}\PYGZpc{}}\PYG{k}{dataframe} parameters   periods=20 start=2011 melt t 

      c2      c1      c3 
cpv   0.38 \PYGZhy{}0.11 0.02946
g     0.3 \PYGZhy{}2.5974  1.332   
i     0.027947 \PYGZhy{}0.515348 1.6967
m     0.37  \PYGZhy{}1.57 5.0929 
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{baseline\PYGZus{}first}  \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{concat}\PYG{p}{(}\PYG{p}{[}\PYG{n}{smalldata}\PYG{p}{,}\PYG{n}{parameters\PYGZus{}melted}\PYG{p}{]}\PYG{p}{,}\PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{} the original data plus the parameters }
\PYG{n}{baseline\PYGZus{}first}  \PYG{o}{=} \PYG{n}{msmallmodel}\PYG{o}{.}\PYG{n}{insertModelVar}\PYG{p}{(}\PYG{n}{baseline\PYGZus{}first}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{} to make sure all modelvariable are in the dataframe }
\PYG{n}{baseline\PYGZus{}first}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{T} \PYG{c+c1}{\PYGZsh{} show the result, transposed}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
index               2011          2012          2013          2014  \PYGZbs{}
Y           1.562682e+06  1.632040e+06  1.689572e+06  1.791141e+06   
CPV         1.320302e+06  1.360376e+06  1.396402e+06  1.438904e+06   
I           3.739388e+05  3.811702e+05  4.145568e+05  4.664730e+05   
G           1.312720e+05  1.288601e+05  1.242549e+05  1.385327e+05   
X           1.217150e+05  1.462929e+05  1.652346e+05  1.947055e+05   
M           4.442322e+05  4.577457e+05  5.224477e+05  6.322079e+05   
YDISC       5.968622e+04  7.308714e+04  1.115720e+05  1.847331e+05   
C2\PYGZus{}CPV      3.800000e\PYGZhy{}01  3.800000e\PYGZhy{}01  3.800000e\PYGZhy{}01  3.800000e\PYGZhy{}01   
C1\PYGZus{}CPV     \PYGZhy{}1.100000e\PYGZhy{}01 \PYGZhy{}1.100000e\PYGZhy{}01 \PYGZhy{}1.100000e\PYGZhy{}01 \PYGZhy{}1.100000e\PYGZhy{}01   
C3\PYGZus{}CPV      2.946000e\PYGZhy{}02  2.946000e\PYGZhy{}02  2.946000e\PYGZhy{}02  2.946000e\PYGZhy{}02   
C2\PYGZus{}G        3.000000e\PYGZhy{}01  3.000000e\PYGZhy{}01  3.000000e\PYGZhy{}01  3.000000e\PYGZhy{}01   
C1\PYGZus{}G       \PYGZhy{}2.597400e+00 \PYGZhy{}2.597400e+00 \PYGZhy{}2.597400e+00 \PYGZhy{}2.597400e+00   
C3\PYGZus{}G        1.332000e+00  1.332000e+00  1.332000e+00  1.332000e+00   
C2\PYGZus{}I        2.794700e\PYGZhy{}02  2.794700e\PYGZhy{}02  2.794700e\PYGZhy{}02  2.794700e\PYGZhy{}02   
C1\PYGZus{}I       \PYGZhy{}5.153480e\PYGZhy{}01 \PYGZhy{}5.153480e\PYGZhy{}01 \PYGZhy{}5.153480e\PYGZhy{}01 \PYGZhy{}5.153480e\PYGZhy{}01   
C3\PYGZus{}I        1.696700e+00  1.696700e+00  1.696700e+00  1.696700e+00   
C2\PYGZus{}M        3.700000e\PYGZhy{}01  3.700000e\PYGZhy{}01  3.700000e\PYGZhy{}01  3.700000e\PYGZhy{}01   
C1\PYGZus{}M       \PYGZhy{}1.570000e+00 \PYGZhy{}1.570000e+00 \PYGZhy{}1.570000e+00 \PYGZhy{}1.570000e+00   
C3\PYGZus{}M        5.092900e+00  5.092900e+00  5.092900e+00  5.092900e+00   
CPV\PYGZus{}D       0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00   
I\PYGZus{}D         0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00   
M\PYGZus{}X         0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00   
I\PYGZus{}X         0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00   
G\PYGZus{}FITTED    0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00   
CPV\PYGZus{}X       0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00   
I\PYGZus{}A         0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00   
G\PYGZus{}A         0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00   
CPV\PYGZus{}FITTED  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00   
G\PYGZus{}D         0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00   
CPV\PYGZus{}A       0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00   
GDE         0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00   
M\PYGZus{}D         0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00   
M\PYGZus{}FITTED    0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00   
M\PYGZus{}A         0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00   
G\PYGZus{}X         0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00   
I\PYGZus{}FITTED    0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00   

index               2015  
Y           1.862357e+06  
CPV         1.476067e+06  
I           5.364167e+05  
G           1.544669e+05  
X           1.992149e+05  
M           6.927948e+05  
YDISC       1.889869e+05  
C2\PYGZus{}CPV      3.800000e\PYGZhy{}01  
C1\PYGZus{}CPV     \PYGZhy{}1.100000e\PYGZhy{}01  
C3\PYGZus{}CPV      2.946000e\PYGZhy{}02  
C2\PYGZus{}G        3.000000e\PYGZhy{}01  
C1\PYGZus{}G       \PYGZhy{}2.597400e+00  
C3\PYGZus{}G        1.332000e+00  
C2\PYGZus{}I        2.794700e\PYGZhy{}02  
C1\PYGZus{}I       \PYGZhy{}5.153480e\PYGZhy{}01  
C3\PYGZus{}I        1.696700e+00  
C2\PYGZus{}M        3.700000e\PYGZhy{}01  
C1\PYGZus{}M       \PYGZhy{}1.570000e+00  
C3\PYGZus{}M        5.092900e+00  
CPV\PYGZus{}D       0.000000e+00  
I\PYGZus{}D         0.000000e+00  
M\PYGZus{}X         0.000000e+00  
I\PYGZus{}X         0.000000e+00  
G\PYGZus{}FITTED    0.000000e+00  
CPV\PYGZus{}X       0.000000e+00  
I\PYGZus{}A         0.000000e+00  
G\PYGZus{}A         0.000000e+00  
CPV\PYGZus{}FITTED  0.000000e+00  
G\PYGZus{}D         0.000000e+00  
CPV\PYGZus{}A       0.000000e+00  
GDE         0.000000e+00  
M\PYGZus{}D         0.000000e+00  
M\PYGZus{}FITTED    0.000000e+00  
M\PYGZus{}A         0.000000e+00  
G\PYGZus{}X         0.000000e+00  
I\PYGZus{}FITTED    0.000000e+00  
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Generate the variables defined by identities in the specification.}
\label{\detokenize{content/howto/smallmodel/modelstart:generate-the-variables-defined-by-identities-in-the-specification}}
\sphinxAtStartPar
The two variable Y and GDE are not in the original data, but are defined in identities. This can be
handled by modelflow. Identities are marked by the option  <IDENT>.

\sphinxAtStartPar
A model which can calculate the identities based on the option can be extracted from the model instance by \sphinxcode{\sphinxupquote{.get\_histmodel()}}.

\sphinxAtStartPar
This small model is run for all years.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{hist\PYGZus{}smallmodel} \PYG{o}{=} \PYG{n}{msmallmodel}\PYG{o}{.}\PYG{n}{get\PYGZus{}histmodel}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{hist\PYGZus{}smallmodel}\PYG{o}{.}\PYG{n}{equations}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{} .equations shows the equations in this model }
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
FRML \PYGZlt{}IDENT\PYGZgt{} Y = CPV+I+G+X\PYGZhy{}M+YDISC\PYGZdl{}
FRML \PYGZlt{}IDENT\PYGZgt{} GDE = CPV+I+G\PYGZdl{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{baseline} \PYG{o}{=} \PYG{n}{hist\PYGZus{}smallmodel}\PYG{p}{(}\PYG{n}{baseline\PYGZus{}first}\PYG{p}{,}\PYG{n}{silent}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{} run the model }
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{baseline}\PYG{p}{[}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{GDE}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{]}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{p}{)}  \PYG{c+c1}{\PYGZsh{} .head() returns the first 5 rows}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
                Y        GDE
index                       
2011   1562681.82  1825512.8
2012   1632040.64  1870406.3
2013   1689572.60  1935213.7
2014   1791140.40  2043909.7
2015   1862357.60  2166950.6
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Generate the add factors which will ensure that the model result match the data}
\label{\detokenize{content/howto/smallmodel/modelstart:generate-the-add-factors-which-will-ensure-that-the-model-result-match-the-data}}
\sphinxAtStartPar
If we run the model now the result might be far from the actual values. To take care of this we have to calculate the add factors which makes this happen. The model for doing that is imbedded in the model \sphinxhyphen{} remember the equations for this where prepared in an earlier step.

\sphinxAtStartPar
The model is named \sphinxcode{\sphinxupquote{.calc\_add\_factor\_model()}} and run for the relevant years:

\sphinxAtStartPar
In addition if a model to create fitted values is present it will also be run.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{fitbaseline} \PYG{o}{=} \PYG{n}{msmallmodel}\PYG{o}{.}\PYG{n}{calc\PYGZus{}add\PYGZus{}factor\PYGZus{}model}\PYG{p}{(}\PYG{n}{baseline}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2016}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2030}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{fitbaseline} \PYG{o}{=} \PYG{n}{thismodel}\PYG{o}{.}\PYG{n}{mfitmodel}\PYG{p}{(}\PYG{n}{fitbaseline}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Will start calculating: Calculate add factors
2016  solved
2017  solved
2018  solved
2019  solved
2020  solved
2021  solved
2022  solved
2023  solved
2024  solved
2025  solved
2026  solved
2027  solved
2028  solved
2029  solved
2030  solved
Calculate add factors calculated 
Will start calculating: Small demo model calc fittet values
2012  solved
2013  solved
2014  solved
2015  solved
2016  solved
2017  solved
2018  solved
2019  solved
2020  solved
2021  solved
2022  solved
2023  solved
2024  solved
2025  solved
2026  solved
2027  solved
2028  solved
2029  solved
2030  solved
Small demo model calc fittet values calculated 
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{fitbaseline}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2014}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2020}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{p}{]}\PYG{o}{.}\PYG{n}{T}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
index               2014          2015          2016          2017  \PYGZbs{}
Y           1.791140e+06  1.862358e+06  1.870423e+06  2.038336e+06   
CPV         1.438904e+06  1.476067e+06  1.537410e+06  1.549515e+06   
I           4.664730e+05  5.364167e+05  5.706795e+05  7.024075e+05   
G           1.385327e+05  1.544669e+05  1.359905e+05  1.651193e+05   
X           1.947055e+05  1.992149e+05  1.647389e+05  1.793270e+05   
M           6.322079e+05  6.927948e+05  7.146256e+05  9.164699e+05   
YDISC       1.847331e+05  1.889869e+05  1.762300e+05  3.584375e+05   
C2\PYGZus{}CPV      3.800000e\PYGZhy{}01  3.800000e\PYGZhy{}01  3.800000e\PYGZhy{}01  3.800000e\PYGZhy{}01   
C1\PYGZus{}CPV     \PYGZhy{}1.100000e\PYGZhy{}01 \PYGZhy{}1.100000e\PYGZhy{}01 \PYGZhy{}1.100000e\PYGZhy{}01 \PYGZhy{}1.100000e\PYGZhy{}01   
C3\PYGZus{}CPV      2.946000e\PYGZhy{}02  2.946000e\PYGZhy{}02  2.946000e\PYGZhy{}02  2.946000e\PYGZhy{}02   
C2\PYGZus{}G        3.000000e\PYGZhy{}01  3.000000e\PYGZhy{}01  3.000000e\PYGZhy{}01  3.000000e\PYGZhy{}01   
C1\PYGZus{}G       \PYGZhy{}2.597400e+00 \PYGZhy{}2.597400e+00 \PYGZhy{}2.597400e+00 \PYGZhy{}2.597400e+00   
C3\PYGZus{}G        1.332000e+00  1.332000e+00  1.332000e+00  1.332000e+00   
C2\PYGZus{}I        2.794700e\PYGZhy{}02  2.794700e\PYGZhy{}02  2.794700e\PYGZhy{}02  2.794700e\PYGZhy{}02   
C1\PYGZus{}I       \PYGZhy{}5.153480e\PYGZhy{}01 \PYGZhy{}5.153480e\PYGZhy{}01 \PYGZhy{}5.153480e\PYGZhy{}01 \PYGZhy{}5.153480e\PYGZhy{}01   
C3\PYGZus{}I        1.696700e+00  1.696700e+00  1.696700e+00  1.696700e+00   
C2\PYGZus{}M        3.700000e\PYGZhy{}01  3.700000e\PYGZhy{}01  3.700000e\PYGZhy{}01  3.700000e\PYGZhy{}01   
C1\PYGZus{}M       \PYGZhy{}1.570000e+00 \PYGZhy{}1.570000e+00 \PYGZhy{}1.570000e+00 \PYGZhy{}1.570000e+00   
C3\PYGZus{}M        5.092900e+00  5.092900e+00  5.092900e+00  5.092900e+00   
CPV\PYGZus{}D       0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00   
I\PYGZus{}D         0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00   
M\PYGZus{}X         0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00   
I\PYGZus{}X         0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00   
G\PYGZus{}FITTED    1.348067e+05  1.442680e+05  1.504155e+05  1.535884e+05   
CPV\PYGZus{}X       0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00   
I\PYGZus{}A         0.000000e+00  0.000000e+00  3.662101e\PYGZhy{}02  4.515832e\PYGZhy{}02   
G\PYGZus{}A         0.000000e+00  0.000000e+00 \PYGZhy{}1.008167e\PYGZhy{}01  7.239171e\PYGZhy{}02   
CPV\PYGZus{}FITTED  1.442298e+06  1.501462e+06  1.546577e+06  1.592550e+06   
G\PYGZus{}D         0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00   
CPV\PYGZus{}A       0.000000e+00  0.000000e+00 \PYGZhy{}5.944844e\PYGZhy{}03 \PYGZhy{}2.739478e\PYGZhy{}02   
GDE         2.043910e+06  2.166951e+06  2.244080e+06  2.417042e+06   
M\PYGZus{}D         0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00   
M\PYGZus{}FITTED    6.266769e+05  7.352346e+05  7.061892e+05  8.910391e+05   
M\PYGZus{}A         0.000000e+00  0.000000e+00  1.187554e\PYGZhy{}02  2.814086e\PYGZhy{}02   
G\PYGZus{}X         0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00   
I\PYGZus{}FITTED    4.682428e+05  5.089265e+05  5.501587e+05  6.713935e+05   

index               2018          2019          2020  
Y           2.193707e+06  2.339742e+06  2.295808e+06  
CPV         1.645118e+06  1.737872e+06  1.802824e+06  
I           7.853714e+05  8.744805e+05  8.439611e+05  
G           1.685068e+05  1.808724e+05  1.920108e+05  
X           1.931247e+05  2.038306e+05  1.712825e+05  
M           1.090956e+06  1.154398e+06  9.780649e+05  
YDISC       4.925420e+05  4.970841e+05  2.637941e+05  
C2\PYGZus{}CPV      3.800000e\PYGZhy{}01  3.800000e\PYGZhy{}01  3.800000e\PYGZhy{}01  
C1\PYGZus{}CPV     \PYGZhy{}1.100000e\PYGZhy{}01 \PYGZhy{}1.100000e\PYGZhy{}01 \PYGZhy{}1.100000e\PYGZhy{}01  
C3\PYGZus{}CPV      2.946000e\PYGZhy{}02  2.946000e\PYGZhy{}02  2.946000e\PYGZhy{}02  
C2\PYGZus{}G        3.000000e\PYGZhy{}01  3.000000e\PYGZhy{}01  3.000000e\PYGZhy{}01  
C1\PYGZus{}G       \PYGZhy{}2.597400e+00 \PYGZhy{}2.597400e+00 \PYGZhy{}2.597400e+00  
C3\PYGZus{}G        1.332000e+00  1.332000e+00  1.332000e+00  
C2\PYGZus{}I        2.794700e\PYGZhy{}02  2.794700e\PYGZhy{}02  2.794700e\PYGZhy{}02  
C1\PYGZus{}I       \PYGZhy{}5.153480e\PYGZhy{}01 \PYGZhy{}5.153480e\PYGZhy{}01 \PYGZhy{}5.153480e\PYGZhy{}01  
C3\PYGZus{}I        1.696700e+00  1.696700e+00  1.696700e+00  
C2\PYGZus{}M        3.700000e\PYGZhy{}01  3.700000e\PYGZhy{}01  3.700000e\PYGZhy{}01  
C1\PYGZus{}M       \PYGZhy{}1.570000e+00 \PYGZhy{}1.570000e+00 \PYGZhy{}1.570000e+00  
C3\PYGZus{}M        5.092900e+00  5.092900e+00  5.092900e+00  
CPV\PYGZus{}D       0.000000e+00  0.000000e+00  0.000000e+00  
I\PYGZus{}D         0.000000e+00  0.000000e+00  0.000000e+00  
M\PYGZus{}X         0.000000e+00  0.000000e+00  0.000000e+00  
I\PYGZus{}X         0.000000e+00  0.000000e+00  0.000000e+00  
G\PYGZus{}FITTED    1.775517e+05  1.819100e+05  1.743952e+05  
CPV\PYGZus{}X       0.000000e+00  0.000000e+00  0.000000e+00  
I\PYGZus{}A        \PYGZhy{}2.600525e\PYGZhy{}02 \PYGZhy{}1.394604e\PYGZhy{}02 \PYGZhy{}1.421480e\PYGZhy{}02  
G\PYGZus{}A        \PYGZhy{}5.228553e\PYGZhy{}02 \PYGZhy{}5.720258e\PYGZhy{}03  9.622777e\PYGZhy{}02  
CPV\PYGZus{}FITTED  1.652847e+06  1.763442e+06  1.865086e+06  
G\PYGZus{}D         0.000000e+00  0.000000e+00  0.000000e+00  
CPV\PYGZus{}A      \PYGZhy{}4.686922e\PYGZhy{}03 \PYGZhy{}1.460601e\PYGZhy{}02 \PYGZhy{}3.395268e\PYGZhy{}02  
GDE         2.598996e+06  2.793225e+06  2.838796e+06  
M\PYGZus{}D         0.000000e+00  0.000000e+00  0.000000e+00  
M\PYGZus{}FITTED    1.062194e+06  1.214574e+06  9.724242e+05  
M\PYGZus{}A         2.671811e\PYGZhy{}02 \PYGZhy{}5.081463e\PYGZhy{}02  5.783861e\PYGZhy{}03  
G\PYGZus{}X         0.000000e+00  0.000000e+00  0.000000e+00  
I\PYGZus{}FITTED    8.060631e+05  8.867615e+05  8.560435e+05  
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Now all data is ready and the model can be simulated}
\label{\detokenize{content/howto/smallmodel/modelstart:now-all-data-is-ready-and-the-model-can-be-simulated}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{result} \PYG{o}{=} \PYG{n}{msmallmodel}\PYG{p}{(}\PYG{n}{fitbaseline}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2020}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2030}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{silent}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{solver}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{sim}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{alfa}\PYG{o}{=}\PYG{l+m+mf}{0.5}\PYG{p}{)}
\PYG{n}{msmallmodel}\PYG{o}{.}\PYG{n}{basedf} \PYG{o}{=} \PYG{n}{fitbaseline} \PYG{c+c1}{\PYGZsh{} To make comparasion possible. }
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Will start solving: Small demo model
Create compiled solving function for Small demo model
ljit=False stringjit=True  transpile\PYGZus{}reset=False  hasattr(self, f\PYGZdq{}pro\PYGZus{}\PYGZob{}jitname\PYGZcb{}\PYGZdq{})=False
now makelos makes a sim solvefunction
2020 Solved in 6 iterations
2021 Solved in 6 iterations
2022 Solved in 6 iterations
2023 Solved in 6 iterations
2024 Solved in 6 iterations
2025 Solved in 6 iterations
2026 Solved in 6 iterations
2027 Solved in 6 iterations
2028 Solved in 6 iterations
2029 Solved in 6 iterations
2030 Solved in 6 iterations
Small demo model solved  
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{The solution match the actual values}
\label{\detokenize{content/howto/smallmodel/modelstart:the-solution-match-the-actual-values}}
\sphinxAtStartPar
So it is a starting point for scenario experiments

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{msmallmodel}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsh{}endo}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} 
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Tab(children=(Tab(children=(HTML(value=\PYGZsq{}\PYGZlt{}?xml version=\PYGZdq{}1.0\PYGZdq{} encoding=\PYGZdq{}utf\PYGZhy{}8\PYGZdq{} standalone=\PYGZdq{}no\PYGZdq{}?\PYGZgt{}\PYGZbs{}n\PYGZlt{}!DOCTYPE svg ‚Ä¶
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Dump the model and the data in a file to be used in the next episode}
\label{\detokenize{content/howto/smallmodel/modelstart:dump-the-model-and-the-data-in-a-file-to-be-used-in-the-next-episode}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{msmallmodel}\PYG{o}{.}\PYG{n}{modeldump}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{models/smallmodel.pcim}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\sphinxstepscope


\chapter{Experiment: Export up}
\label{\detokenize{content/howto/smallmodel/modelstart export up:experiment-export-up}}\label{\detokenize{content/howto/smallmodel/modelstart export up::doc}}
\sphinxAtStartPar
Take a small very small model and make some experiments

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{pandas} \PYG{k}{as} \PYG{n+nn}{pd}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{modelclass} \PYG{k+kn}{import} \PYG{n}{model}
\PYG{n}{model}\PYG{o}{.}\PYG{n}{widescreen}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}IPython.core.display.HTML object\PYGZgt{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Load the precooked model}
\label{\detokenize{content/howto/smallmodel/modelstart export up:load-the-precooked-model}}
\sphinxAtStartPar
This model was generated from scratch {\hyperref[\detokenize{content/howto/smallmodel/modelstart::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{here}}}}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{msmallmodel}\PYG{p}{,}\PYG{n}{baseline} \PYG{o}{=} \PYG{n}{model}\PYG{o}{.}\PYG{n}{modelload}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{models/smallmodel.pcim}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{run}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{keep}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Baseline}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{silent}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Create new dataframe where the export is increased by 10 percent}
\label{\detokenize{content/howto/smallmodel/modelstart export up:create-new-dataframe-where-the-export-is-increased-by-10-percent}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{impuls\PYGZus{}x\PYGZus{}10pct} \PYG{o}{=} \PYG{n}{baseline}\PYG{o}{.}\PYG{n}{upd}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZlt{}2024 2027\PYGZgt{} x }\PYG{l+s+s2}{\PYGZpc{}}\PYG{l+s+s2}{ 10}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{impuls\PYGZus{}x\PYGZus{}5pct} \PYG{o}{=} \PYG{n}{baseline}\PYG{o}{.}\PYG{n}{upd}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZlt{}2024 2027\PYGZgt{} x }\PYG{l+s+s2}{\PYGZpc{}}\PYG{l+s+s2}{ 5}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Simulate the model}
\label{\detokenize{content/howto/smallmodel/modelstart export up:simulate-the-model}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{result\PYGZus{}x} \PYG{o}{=} \PYG{n}{msmallmodel}\PYG{p}{(}\PYG{n}{impuls\PYGZus{}x\PYGZus{}10pct}\PYG{p}{,}\PYG{n}{keep}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Export increased by 10 percent}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{alfa}\PYG{o}{=}\PYG{l+m+mf}{0.2}\PYG{p}{,}\PYG{n}{solver}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{newton}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{silent}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{\PYGZus{}} \PYG{o}{=} \PYG{n}{msmallmodel}\PYG{p}{(}\PYG{n}{impuls\PYGZus{}x\PYGZus{}5pct}\PYG{p}{,}\PYG{n}{keep}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Export increased by 5 percent}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{alfa}\PYG{o}{=}\PYG{l+m+mf}{0.2}\PYG{p}{,}\PYG{n}{solver}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{newton}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{silent}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Display results}
\label{\detokenize{content/howto/smallmodel/modelstart export up:display-results}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{with} \PYG{n}{msmallmodel}\PYG{o}{.}\PYG{n}{set\PYGZus{}smpl}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2020}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2030}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{display}\PYG{p}{(}\PYG{n}{msmallmodel}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y cpv g x m gde}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{]}\PYG{p}{)} 
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Tab(children=(Tab(children=(HTML(value=\PYGZsq{}\PYGZlt{}?xml version=\PYGZdq{}1.0\PYGZdq{} encoding=\PYGZdq{}utf\PYGZhy{}8\PYGZdq{} standalone=\PYGZdq{}no\PYGZdq{}?\PYGZgt{}\PYGZbs{}n\PYGZlt{}!DOCTYPE svg ‚Ä¶
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{msmallmodel}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y cpv g  m gde}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{difpctlevel}\PYG{o}{.}\PYG{n}{rename}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{mul100}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{sharey}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{modelstart export up_14_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{try}\PYG{p}{:}
    
    \PYG{k}{if} \PYG{l+m+mi}{1}\PYG{p}{:} 
        \PYG{n}{msmallmodel}\PYG{o}{.}\PYG{n}{modeldash}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{jupyter}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{inline}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{dashport}\PYG{o}{=}\PYG{l+m+mi}{5006}\PYG{p}{)}
    \PYG{k}{else}\PYG{p}{:}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+m+mi}{42}\PYG{p}{)}
\PYG{k}{except} \PYG{n+ne}{Exception} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Can}\PYG{l+s+s2}{\PYGZsq{}}\PYG{l+s+s2}{t run modeldash here}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
apprun
Dash app running on http://127.0.0.1:5006/
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{msmallmodel}\PYG{o}{.}\PYG{n}{keep\PYGZus{}plot}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y m c}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{diff}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{legend}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{modelstart export up_17_0}.png}

\noindent\sphinxincludegraphics{{modelstart export up_17_1}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{msmallmodel}\PYG{o}{.}\PYG{n}{keep\PYGZus{}viz}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
VBox(children=(HBox(children=(SelectMultiple(description=\PYGZsq{}Select one or more\PYGZsq{}, index=(34,), layout=Layout(heig‚Ä¶
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Output()
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{The charts generated in the interactive widget are stored in a Dictionary}
\label{\detokenize{content/howto/smallmodel/modelstart export up:the-charts-generated-in-the-interactive-widget-are-stored-in-a-dictionary}}
\sphinxAtStartPar
So all the charts can be processed using the tools from Matplotlib

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{msmallmodel}\PYG{o}{.}\PYG{n}{keep\PYGZus{}wiz\PYGZus{}figs}   \PYG{c+c1}{\PYGZsh{} Which charts have been generated }
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZob{}\PYGZsq{}Y\PYGZsq{}: \PYGZlt{}Figure size 1000x600 with 1 Axes\PYGZgt{}\PYGZcb{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{yfig} \PYG{o}{=} \PYG{n}{msmallmodel}\PYG{o}{.}\PYG{n}{keep\PYGZus{}wiz\PYGZus{}figs}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}  \PYG{c+c1}{\PYGZsh{} Select one of the graphs }
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{yfig}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{graph/GDP.pdf}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}   \PYG{c+c1}{\PYGZsh{} Safe the graph as a pdf file }
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{!}dir graph
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 Volume in drive C has no label.
 Volume Serial Number is C2DB\PYGZhy{}095E

 Directory of c:\PYGZbs{}wb new\PYGZbs{}Modelflow\PYGZbs{}working\PYGZus{}paper\PYGZbs{}thebook\PYGZbs{}content\PYGZbs{}howto\PYGZbs{}smallmodel\PYGZbs{}graph

28\PYGZhy{}06\PYGZhy{}2022  16:21    \PYGZlt{}DIR\PYGZgt{}          .
18\PYGZhy{}09\PYGZhy{}2022  13:21    \PYGZlt{}DIR\PYGZgt{}          ..
11\PYGZhy{}10\PYGZhy{}2022  19:25             6.199 A\PYGZus{}model\PYGZus{}graph.gv
11\PYGZhy{}10\PYGZhy{}2022  19:25            80.263 A\PYGZus{}model\PYGZus{}graph.png
11\PYGZhy{}10\PYGZhy{}2022  19:25            12.590 A\PYGZus{}model\PYGZus{}graph.svg
11\PYGZhy{}10\PYGZhy{}2022  19:26            13.953 GDP.pdf
               4 File(s)        113.005 bytes
               2 Dir(s)  751.340.060.672 bytes free
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{display}\PYG{p}{(}\PYG{n}{yfig}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{modelstart export up_24_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{The result  can be saved to an excel sheet}
\label{\detokenize{content/howto/smallmodel/modelstart export up:the-result-can-be-saved-to-an-excel-sheet}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{msmallmodel}\PYG{o}{.}\PYG{n}{lastdf}\PYG{o}{.}\PYG{n}{to\PYGZus{}excel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{smallmodel.xlsx}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{!}dir *.xlsx
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 Volume in drive C has no label.
 Volume Serial Number is C2DB\PYGZhy{}095E

 Directory of c:\PYGZbs{}wb new\PYGZbs{}Modelflow\PYGZbs{}working\PYGZus{}paper\PYGZbs{}thebook\PYGZbs{}content\PYGZbs{}howto\PYGZbs{}smallmodel

11\PYGZhy{}10\PYGZhy{}2022  19:26            10.916 smallmodel.xlsx
18\PYGZhy{}09\PYGZhy{}2022  13:13            10.920 test.xlsx
               2 File(s)         21.836 bytes
               0 Dir(s)  751.340.060.672 bytes free
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxstepscope


\part{Make experiments}

\sphinxstepscope

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZpc{}}\PYG{k}{matplotlib} notebook
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\chapter{Create an experiment, simulate it and access results}
\label{\detokenize{content/howto/experiments/create_experiment:create-an-experiment-simulate-it-and-access-results}}\label{\detokenize{content/howto/experiments/create_experiment::doc}}
\sphinxAtStartPar
This notebook shows how to make a single simple experiment
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Loading a pre\sphinxhyphen{}existing model in Modelflow

\item {} 
\sphinxAtStartPar
Creating an experimet by updating some variables

\item {} 
\sphinxAtStartPar
Simulating the model

\item {} 
\sphinxAtStartPar
Visualizing the results

\end{enumerate}

\sphinxAtStartPar
This Notebook uses a  model for Pakistan described here: \hyperlink{cite.content/litterature:id14}{Burns \sphinxstyleemphasis{et al.}}


\section{Imports}
\label{\detokenize{content/howto/experiments/create_experiment:imports}}
\sphinxAtStartPar
Modelflow‚Äôs modelclass includes most of the methods needed to manage a model in Modelflow.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{modelclass} \PYG{k+kn}{import} \PYG{n}{model} 
\PYG{n}{model}\PYG{o}{.}\PYG{n}{widescreen}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{model}\PYG{o}{.}\PYG{n}{scroll\PYGZus{}off}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}IPython.core.display.HTML object\PYGZgt{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Load a pre\sphinxhyphen{}existing model, data and descriptions}
\label{\detokenize{content/howto/experiments/create_experiment:load-a-pre-existing-model-data-and-descriptions}}
\sphinxAtStartPar
The file \sphinxcode{\sphinxupquote{pak.pcim}} contains a dump of model equations, dataframe, simulation options and variable descriptions. The file has been created when onboarding the model.
Examples can be found \sphinxhref{../../onboard/eviews/onboard\%20one\%20model\%20from\%20\%20wf1.html\#onboard-a-model-defined-in-a-wf1-file}{here}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{p}{,}\PYG{n}{baseline} \PYG{o}{=} \PYG{n}{model}\PYG{o}{.}\PYG{n}{modelload}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{../../models/pak.pcim}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{alfa}\PYG{o}{=}\PYG{l+m+mf}{0.7}\PYG{p}{,}\PYG{n}{run}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Create an experiment}
\label{\detokenize{content/howto/experiments/create_experiment:create-an-experiment}}
\sphinxAtStartPar
The variable \sphinxcode{\sphinxupquote{mpak}} contains the model instance and the variable   \sphinxcode{\sphinxupquote{baseline}} contains the pandas dataframe with all series.

\sphinxAtStartPar
We want to make an experiment where these variables: PAKGGREVCO2CER PAKGGREVCO2GER PAKGGREVCO2OER are updated.

\sphinxAtStartPar
The  variables contains tax rates for CO2 emission from different sources. The descriptions can be retrieved like this:

\begin{sphinxShadowBox}
\sphinxstylesidebartitle{\sphinxstylestrong{Variable descriptions}}

\sphinxAtStartPar
Are contained in the variable ‚Äò‚Äô‚Äômpak.var\_description‚Äô‚Äô‚Äô
which is a dictionary
\end{sphinxShadowBox}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{for} \PYG{n}{variable} \PYG{o+ow}{in} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKGGREVCO2CER}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKGGREVCO2GER}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKGGREVCO2OER}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{:}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{variable}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{var\PYGZus{}description}\PYG{p}{[}\PYG{n}{variable}\PYG{p}{]}\PYG{p}{)}
    
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
PAKGGREVCO2CER : Tax/subsidy (Coal) (USD p/tco2)
PAKGGREVCO2GER : Tax/subsidy (Gas) (USD p/tco2)
PAKGGREVCO2OER : Tax/subsidy (Oil) (USD p/tco2)
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{extra\PYGZus{}description} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{GDP}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
 \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNECONPRVTKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Consumption}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
 \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNEGDIFTOTKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Investment}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
 \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNEEXPGNFSKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Exports}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
 \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNEIMPGNFSKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Import}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
 \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKLMUNRTOTLCN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Unemployment rate}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
 \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKGGDBTTOTLCN\PYGZus{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Debt (}\PYG{l+s+si}{\PYGZpc{}G}\PYG{l+s+s1}{DP)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
 \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKCCEMISCO2TKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Total emissions from fossil fuels}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
 \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKCCEMISCO2CKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Emissions from Coal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
 \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKCCEMISCO2OKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Emissions from Oil}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
 \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKCCEMISCO2GKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Emissions from Natural Gas}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
 \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKGGREVTOTLCN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Fiscal revenues}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
 \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKWDL}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Working days lost due to pollution}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{\PYGZcb{}}
\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{set\PYGZus{}var\PYGZus{}description}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{o}{*}\PYG{o}{*}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{var\PYGZus{}description}\PYG{p}{,}\PYG{o}{*}\PYG{o}{*}\PYG{n}{extra\PYGZus{}description}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\chapter{Update}
\label{\detokenize{content/howto/experiments/create_experiment:update}}
\sphinxAtStartPar
In order to update series in a pandas dataframe, one can use the pandas functions.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{alternative\PYGZus{}pd} \PYG{o}{=} \PYG{n}{baseline}\PYG{o}{.}\PYG{n}{copy}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{alternative\PYGZus{}pd}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{l+m+mi}{2023}\PYG{p}{:}\PYG{l+m+mi}{2100}\PYG{p}{,}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKGGREVCO2CER}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKGGREVCO2GER}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKGGREVCO2OER}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{29} 
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\sphinxAtStartPar
However modelflow contains some functions which has been designed to make updating economic series parsimonious and effective.

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{dataframe.upd}} creates a new dataframe where the tree tax variables are updated. You will find more {\hyperref[\detokenize{content/howto/update/model update::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{here}}}}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{alternative}  \PYG{o}{=}  \PYG{n}{baseline}\PYG{o}{.}\PYG{n}{upd}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZlt{}2023 2100\PYGZgt{} PAKGGREVCO2CER PAKGGREVCO2GER PAKGGREVCO2OER = 29}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Run the model with all the scenarios}
\label{\detokenize{content/howto/experiments/create_experiment:run-the-model-with-all-the-scenarios}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{result} \PYG{o}{=} \PYG{n}{mpak}\PYG{p}{(}\PYG{n}{alternative}\PYG{p}{,}\PYG{l+m+mi}{2020}\PYG{p}{,}\PYG{l+m+mi}{2100}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{} simulates the model }
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Access results}
\label{\detokenize{content/howto/experiments/create_experiment:access-results}}
\sphinxAtStartPar
Now we have two dataframes with results \sphinxcode{\sphinxupquote{baseline}} and \sphinxcode{\sphinxupquote{result}}. These dataframes can be manipulated and visualized
with the tools provided by the \sphinxstylestrong{pandas} library and other like \sphinxstylestrong{Matplotlib} and \sphinxstylestrong{Plotly}. However to make things easy the first and
latest simulation result is also in the mpak object:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{mpak.basedf}: Dataframe with the values for baseline

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{mpak.lastdf}: Dataframe with the values for alternative

\end{itemize}


\subsection{An overview of GDP}
\label{\detokenize{content/howto/experiments/create_experiment:an-overview-of-gdp}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{with} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{set\PYGZus{}smpl}\PYG{p}{(}\PYG{l+m+mi}{2020}\PYG{p}{,}\PYG{l+m+mi}{2023}\PYG{p}{)}\PYG{p}{:}   \PYG{c+c1}{\PYGZsh{} set smpl in the indented block}
    \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{PAKNYGDPMKTPKN}\PYG{o}{.}\PYG{n}{show}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Endogeneous: PAKNYGDPMKTPKN: GDP
Formular: FRML  \PYGZlt{}\PYGZgt{} PAKNYGDPMKTPKN = PAKNECONPRVTKN+PAKNECONGOVTKN+PAKNEGDIFTOTKN+PAKNEGDISTKBKN+PAKNEEXPGNFSKN\PYGZhy{}PAKNEIMPGNFSKN+PAKNYGDPDISCKN+PAKADAP*PAKDISPREPKN \PYGZdl{}

PAKNYGDPMKTPKN: GDP
PAKADAP       : Switch on adaptation mode (0 or 1)
PAKDISPREPKN  : Investment in disaster risk preparation, constant prices
PAKNECONGOVTKN: Government Consumption
PAKNECONPRVTKN: Consumption
PAKNEEXPGNFSKN: Exports
PAKNEGDIFTOTKN: Investment
PAKNEGDISTKBKN: Change in Inventories
PAKNEIMPGNFSKN: Import
PAKNYGDPDISCKN: Statistical Discrepency (Expenditure Side)

Values :
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}pandas.io.formats.style.Styler at 0x24df60289d0\PYGZgt{}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Input last run:
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}pandas.io.formats.style.Styler at 0x24df6028e20\PYGZgt{}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Input base run:
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}pandas.io.formats.style.Styler at 0x24df6088130\PYGZgt{}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Difference for input variables
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}pandas.io.formats.style.Styler at 0x24df5fbb610\PYGZgt{}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Look at selected variables with the {[}{]} operator}
\label{\detokenize{content/howto/experiments/create_experiment:look-at-selected-variables-with-the-operator}}
\sphinxAtStartPar
If you want to look at multiple variables the index {[}{]} operator can be used to select the variables to analyze/visualize. Here only a few operations will be shown. There is more {\hyperref[\detokenize{content/Python/modelflow_features:index-operator}]{\sphinxcrossref{\DUrole{std,std-ref}{here}}}}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN PAKNECONGOVTKN PAKNEGDIFTOTKN PAKNEIMPGNFSKN PAKCCEMISCO2TKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Tab(children=(Tab(children=(HTML(value=\PYGZsq{}\PYGZlt{}?xml version=\PYGZdq{}1.0\PYGZdq{} encoding=\PYGZdq{}utf\PYGZhy{}8\PYGZdq{} standalone=\PYGZdq{}no\PYGZdq{}?\PYGZgt{}\PYGZbs{}n\PYGZlt{}!DOCTYPE svg ‚Ä¶
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxstepscope


\chapter{Create many scenarios, simulate them  and access results}
\label{\detokenize{content/howto/experiments/create_save_scenarios:create-many-scenarios-simulate-them-and-access-results}}\label{\detokenize{content/howto/experiments/create_save_scenarios::doc}}
\sphinxAtStartPar
In this chapter/notebook you will learn how to:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Loading a pre\sphinxhyphen{}existing model in Modelflow

\item {} 
\sphinxAtStartPar
Creating several experiments based on that model

\item {} 
\sphinxAtStartPar
Running your model

\item {} 
\sphinxAtStartPar
Visualizing the results

\end{enumerate}

\sphinxAtStartPar
This Notebook uses the model for Pakistan described here: \hyperlink{cite.content/litterature:id14}{Burns \sphinxstyleemphasis{et al.}}


\section{Imports}
\label{\detokenize{content/howto/experiments/create_save_scenarios:imports}}
\sphinxAtStartPar
Modelflow‚Äôs modelclass includes most of the methods needed to manage a model in Modelflow.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{modelclass} \PYG{k+kn}{import} \PYG{n}{model} 
\PYG{n}{model}\PYG{o}{.}\PYG{n}{widescreen}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}IPython.core.display.HTML object\PYGZgt{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Load a pre\sphinxhyphen{}existing model, data and descriptions}
\label{\detokenize{content/howto/experiments/create_save_scenarios:load-a-pre-existing-model-data-and-descriptions}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{p}{,}\PYG{n}{baseline} \PYG{o}{=} \PYG{n}{model}\PYG{o}{.}\PYG{n}{modelload}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{../../models/pak.pcim}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{run}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{silent}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{alfa}\PYG{o}{=}\PYG{l+m+mf}{0.7}\PYG{p}{,}\PYG{n}{keep}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Baseline}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Create a dictionary with experiments}
\label{\detokenize{content/howto/experiments/create_save_scenarios:create-a-dictionary-with-experiments}}
\sphinxAtStartPar
Now a dictionary of dataframes is created for different values of Carbon emission tax. The \sphinxstyleemphasis{key} is the value of the tax. The \sphinxstyleemphasis{value} is a dataframe where the tax variables are updated.

\sphinxAtStartPar
Python allows this to be expressed in a quite concise way:

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{scenarios} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{n}{value}\PYG{p}{:} 
    \PYG{n}{baseline}\PYG{o}{.}\PYG{n}{upd}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZlt{}2020:2100\PYGZgt{} PAKGGREVCO2CER PAKGGREVCO2GER PAKGGREVCO2OER = }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{value}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)} 
    \PYG{k}{for} \PYG{n}{value} \PYG{o+ow}{in} \PYG{p}{[}\PYG{l+m+mi}{5}\PYG{p}{,} \PYG{l+m+mi}{10}\PYG{p}{,} \PYG{l+m+mi}{15}\PYG{p}{,} \PYG{l+m+mi}{20}\PYG{p}{,}\PYG{l+m+mi}{25}\PYG{p}{]}\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{\PYGZsh{} scenario\PYGZus{}30 =     baseline.upd(\PYGZdq{}\PYGZlt{}2020:2100\PYGZgt{} PAKGGREVCO2CER PAKGGREVCO2GER PAKGGREVCO2OER = 30\PYGZdq{}) }
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\sphinxAtStartPar
\sphinxstylestrong{Python constructs}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Python construct
&\sphinxstyletheadfamily 
\sphinxAtStartPar
explanation
&\sphinxstyletheadfamily 
\sphinxAtStartPar
info
\\
\hline
\sphinxAtStartPar
f‚Äù‚Ä¶ = \{value\}‚Äù
&
\sphinxAtStartPar
‚Äò f\sphinxhyphen{}string, \{value\} is substituted with the value of the variable \sphinxstylestrong{value}
&
\sphinxAtStartPar
\sphinxhref{https://www.google.com/search?q=python+dictionary+comprehension\&newwindow=1}{Search}
\\
\hline
\sphinxAtStartPar
baseline.upd(‚Ä¶)
&
\sphinxAtStartPar
a new dataframe is created where the three tax variables are updated
&
\sphinxAtStartPar
{\hyperref[\detokenize{content/howto/update/model update::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{Introduction to dataframe.upd}}}}
\\
\hline
\sphinxAtStartPar
\{value: model.update(‚Ä¶ \{value\}) for value  in {[}5,10 ‚Ä¶{]}\}
&
\sphinxAtStartPar
Creates a dictionary of dataframes
&
\sphinxAtStartPar
\sphinxhref{https://www.google.com/search?q=python+dictionary+comprehension\&newwindow=1}{Search dictionary comprehension }
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\section{Run the model with all the scenarios}
\label{\detokenize{content/howto/experiments/create_save_scenarios:run-the-model-with-all-the-scenarios}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{for}  \PYG{n}{value}\PYG{p}{,}\PYG{n}{dataframe} \PYG{o+ow}{in} \PYG{n}{scenarios}\PYG{o}{.}\PYG{n}{items}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{value}\PYG{p}{,}\PYG{n}{dataframe}\PYG{o}{.}\PYG{n}{ALBNEIMPGNFSKD}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
5 1980    655.959991
1981    657.440879
1982    773.473829
1983    662.950925
1984    597.058556
Name: ALBNEIMPGNFSKD, dtype: float64
10 1980    655.959991
1981    657.440879
1982    773.473829
1983    662.950925
1984    597.058556
Name: ALBNEIMPGNFSKD, dtype: float64
15 1980    655.959991
1981    657.440879
1982    773.473829
1983    662.950925
1984    597.058556
Name: ALBNEIMPGNFSKD, dtype: float64
20 1980    655.959991
1981    657.440879
1982    773.473829
1983    662.950925
1984    597.058556
Name: ALBNEIMPGNFSKD, dtype: float64
25 1980    655.959991
1981    657.440879
1982    773.473829
1983    662.950925
1984    597.058556
Name: ALBNEIMPGNFSKD, dtype: float64
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{for} \PYG{n}{value}\PYG{p}{,}\PYG{n}{dataframe} \PYG{o+ow}{in} \PYG{n}{scenarios}\PYG{o}{.}\PYG{n}{items}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:} \PYG{c+c1}{\PYGZsh{} Returns the value and the dataframe of each experiment}
        \PYG{n}{\PYGZus{}}\PYG{o}{=} \PYG{n}{mpak}\PYG{p}{(}\PYG{n}{dataframe}\PYG{p}{,}\PYG{l+m+mi}{2020}\PYG{p}{,}\PYG{l+m+mi}{2100}\PYG{p}{,}\PYG{n}{keep}\PYG{o}{=}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Coal, Oil and Gastax : }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{value}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{ nominal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{} simulates the model }
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Access results}
\label{\detokenize{content/howto/experiments/create_save_scenarios:access-results}}
\sphinxAtStartPar
Let‚Äôs take a look at the how to extract information stored in our model instance, mpak.
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{mpak.basedf}: Dataframe with the values for the first scenario

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{mpak.lastdf}: Dataframe with the values for the last scenario

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{mpak.keep\_solutions}: Dictionary with dataframes from \sphinxstyleemphasis{ALL} scenarios

\end{itemize}


\subsection{mpak.keep\_solutions a dictionary with dataframes}
\label{\detokenize{content/howto/experiments/create_save_scenarios:mpak-keep-solutions-a-dictionary-with-dataframes}}
\sphinxAtStartPar
As we have multiple scenarios the \sphinxstyleemphasis{keept} solutions will be used in this notebook. 
\sphinxstylestrong{Modelflow provides a number of ways to visualize the keept results.}

\sphinxAtStartPar
The dataframe which is keept in the dictionary is the complete solution of the model. So it includes all exogenous and endogenous variables in all years. If the model is large this can become a very large object. Therefor the user can decide only
to keep some variables \sphinxhyphen{} this will not be covered here.

\sphinxAtStartPar
Below the keys and content of mpak.keep\_solutions is shown:

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{for} \PYG{n}{key}\PYG{p}{,}\PYG{n}{value} \PYG{o+ow}{in} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keep\PYGZus{}solutions}\PYG{o}{.}\PYG{n}{items}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:} 
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{key = }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{key}\PYG{l+s+si}{:}\PYG{l+s+s1}{34}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{|value = Dataframe with }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{value}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{ years and }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{value}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{ variables}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
key = Baseline                          |value = Dataframe with 121 years and 1291 variables
key = Coal, Oil and Gastax : 5 nominal  |value = Dataframe with 121 years and 1291 variables
key = Coal, Oil and Gastax : 10 nominal |value = Dataframe with 121 years and 1291 variables
key = Coal, Oil and Gastax : 15 nominal |value = Dataframe with 121 years and 1291 variables
key = Coal, Oil and Gastax : 20 nominal |value = Dataframe with 121 years and 1291 variables
key = Coal, Oil and Gastax : 25 nominal |value = Dataframe with 121 years and 1291 variables
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{.keep\_plot()  Function to visualize the keept solutions}
\label{\detokenize{content/howto/experiments/create_save_scenarios:keep-plot-function-to-visualize-the-keept-solutions}}
\sphinxAtStartPar
When creating charts from keep‚Äôt solutions the goto function is .keep\_plot(). As will be shown below it can display the results in a number of ways.


\subsection{.keep\_plot(..showtype=‚Äôlevel‚Äô|‚Äôgrowth‚Äô|‚Äôchange‚Äô..)}
\label{\detokenize{content/howto/experiments/create_save_scenarios:keep-plot-showtype-level-growth-change}}
\sphinxAtStartPar
keep\_plot can display data with three different transformations:

\sphinxAtStartPar
\sphinxstylestrong{Transformation of data displayed:}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
showtype=
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Use this operator
\\
\hline
\sphinxAtStartPar
‚Äòlevel‚Äô (default)
&
\sphinxAtStartPar
No transformation
\\
\hline
\sphinxAtStartPar
‚Äògrowth‚Äô
&
\sphinxAtStartPar
The growth rate  in percent
\\
\hline
\sphinxAtStartPar
‚Äòchange‚Äô
&
\sphinxAtStartPar
The yearly change (\(\Delta\))
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
\sphinxstylestrong{legend placement}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
legend=
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Use this operator
\\
\hline
\sphinxAtStartPar
False (default)
&
\sphinxAtStartPar
The legends will be placed at the end of the corresponding line
\\
\hline
\sphinxAtStartPar
True
&
\sphinxAtStartPar
The legends are places in a legend box
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
The \sphinxstylestrong{variables} we want to be displayed is listed as first argument. Variable names can include
wildcards (using * for any string and ? for any character)

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{for} \PYG{n}{trans} \PYG{o+ow}{in} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{level}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{growth}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{change}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{:}
    \PYG{n}{plot\PYGZus{}level}  \PYG{o}{=} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keep\PYGZus{}plot}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKCCEMISCO2TKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+m+mi}{2010}\PYG{p}{,}\PYG{l+m+mi}{2100}\PYG{p}{,}\PYG{n}{showtype}\PYG{o}{=}\PYG{n}{trans}\PYG{p}{,}\PYG{n}{legend}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{create_save_scenarios_17_0}.png}

\noindent\sphinxincludegraphics{{create_save_scenarios_17_1}.png}

\noindent\sphinxincludegraphics{{create_save_scenarios_17_2}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{.keep\_plot(,, diff=1|0) show difference to first scenario}
\label{\detokenize{content/howto/experiments/create_save_scenarios:keep-plot-diff-1-0-show-difference-to-first-scenario}}
\sphinxAtStartPar
Often it is useful to compare the scenario results with the baseline result. This is done with the diff argument.


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
diff=
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Use this operator
\\
\hline
\sphinxAtStartPar
False (default)
&
\sphinxAtStartPar
All entries in the keep\_solution dictionary is displayed
\\
\hline
\sphinxAtStartPar
True
&
\sphinxAtStartPar
The difference to the first entry is shown.
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{plot\PYGZus{}impact} \PYG{o}{=} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keep\PYGZus{}plot}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKCCEMISCO2TKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+m+mi}{2010}\PYG{p}{,}\PYG{l+m+mi}{2100}\PYG{p}{,}\PYG{n}{legend}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{diff}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{create_save_scenarios_19_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{.keep\_plot(,, diffpct=1|0) show difference in percent to first scenario}
\label{\detokenize{content/howto/experiments/create_save_scenarios:keep-plot-diffpct-1-0-show-difference-in-percent-to-first-scenario}}
\sphinxAtStartPar
Often it is useful to compare the scenario results with the baseline result \sphinxstylestrong{measured in percent}. This is done with the diffpct argument.


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
diffpct=
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Use this operator
\\
\hline
\sphinxAtStartPar
False (default)
&
\sphinxAtStartPar
All entries in the keep\_solution dictionary is displayed
\\
\hline
\sphinxAtStartPar
True
&
\sphinxAtStartPar
The difference in percent to the first entry is shown
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\begin{sphinxadmonition}{danger}{Danger:}
\sphinxAtStartPar
diff=1 and diffpct=1 can‚Äôt be used at the same time
\end{sphinxadmonition}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{plot\PYGZus{}impact} \PYG{o}{=} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keep\PYGZus{}plot}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKCCEMISCO2TKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+m+mi}{2010}\PYG{p}{,}\PYG{l+m+mi}{2100}\PYG{p}{,}\PYG{n}{legend}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{diffpct}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{create_save_scenarios_22_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Saving plots in files}
\label{\detokenize{content/howto/experiments/create_save_scenarios:saving-plots-in-files}}
\sphinxAtStartPar
keep\_plot returns a dictionary of the matplotlib figure objects it has produced. These can be used to create charts in different formats.

\sphinxAtStartPar
In this case the the there is only one
item in the dictionary. The key is the variable name in the plot:

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{plot\PYGZus{}impact}\PYG{o}{.}\PYG{n}{keys}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
dict\PYGZus{}keys([\PYGZsq{}PAKCCEMISCO2TKN\PYGZsq{}])
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxAtStartPar
We can loop over the items and save the plots in different formats.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} create a folder}
\PYG{o}{!}md graph
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
A subdirectory or file graph already exists.
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{for} \PYG{n}{variable}\PYG{p}{,}\PYG{n}{figure} \PYG{o+ow}{in} \PYG{n}{plot\PYGZus{}level}\PYG{o}{.}\PYG{n}{items}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{display}\PYG{p}{(}\PYG{n}{figure}\PYG{p}{)}
    \PYG{n}{figure}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{graph/}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{variable}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZus{}test.png}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{} save in png format }
    \PYG{n}{figure}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{graph/}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{variable}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZus{}test.pdf}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{} save in pdf format }
    \PYG{n}{figure}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{graph/}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{variable}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZus{}test.svg}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{} save in svg format}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{create_save_scenarios_27_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{.keepswitch, Select scenarios for plotting}
\label{\detokenize{content/howto/experiments/create_save_scenarios:keepswitch-select-scenarios-for-plotting}}
\sphinxAtStartPar
When creating many scenarios with the \sphinxcode{\sphinxupquote{keep}} keyword it can sometime be useful to:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Plot selected scenarios and to change the sequence of the scenarios.

\item {} 
\sphinxAtStartPar
To use the .basedf and .lastdf as scenarios.

\end{itemize}

\sphinxAtStartPar
To facilitate this the .keepswitch function has been created.


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Parameter
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Explanation
\\
\hline
\sphinxAtStartPar
switch = True|False(default)
&
\sphinxAtStartPar
If True use the .basedf and .lastdf
\\
\hline
\sphinxAtStartPar
scenario=‚Äô<string>‚Äô
&
\sphinxAtStartPar
Listing of scenarios separated by | if no wildcards else space
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
.keepswitch is a \sphinxhref{https://www.pythontutorial.net/advanced-python/python-context-managers}{context manager} like .set\_smpl.
So it works in the scope of a \sphinxcode{\sphinxupquote{with}}. After the with statement the keept solutions are restored.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Before with mpak.keepswitch:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{o}{*}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keep\PYGZus{}solutions}\PYG{o}{.}\PYG{n}{keys}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}\PYG{n}{sep}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{k}{with} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keepswitch}\PYG{p}{(}\PYG{n}{scenarios} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{*25* *15*}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{:}
   \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{During with mpak.keepswitch:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{o}{*}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keep\PYGZus{}solutions}\PYG{o}{.}\PYG{n}{keys}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}\PYG{n}{sep}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{After with mpak.keepswitch:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{o}{*}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keep\PYGZus{}solutions}\PYG{o}{.}\PYG{n}{keys}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}\PYG{n}{sep}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Before with mpak.keepswitch:
Baseline
Coal, Oil and Gastax : 5 nominal
Coal, Oil and Gastax : 10 nominal
Coal, Oil and Gastax : 15 nominal
Coal, Oil and Gastax : 20 nominal
Coal, Oil and Gastax : 25 nominal

During with mpak.keepswitch:
Coal, Oil and Gastax : 25 nominal
Coal, Oil and Gastax : 15 nominal

After with mpak.keepswitch:
Baseline
Coal, Oil and Gastax : 5 nominal
Coal, Oil and Gastax : 10 nominal
Coal, Oil and Gastax : 15 nominal
Coal, Oil and Gastax : 20 nominal
Coal, Oil and Gastax : 25 nominal
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{with} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keepswitch}\PYG{p}{(}\PYG{n}{scenarios} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{*25* *15*}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{:}
   \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keep\PYGZus{}plot}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKCCEMISCO2TKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+m+mi}{2010}\PYG{p}{,}\PYG{l+m+mi}{2100}\PYG{p}{,}\PYG{n}{legend}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
   \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keep\PYGZus{}plot}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKCCEMISCO2TKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+m+mi}{2010}\PYG{p}{,}\PYG{l+m+mi}{2100}\PYG{p}{,}\PYG{n}{diff}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{legend}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{create_save_scenarios_30_0}.png}

\noindent\sphinxincludegraphics{{create_save_scenarios_30_1}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{.modeldump() Saving results}
\label{\detokenize{content/howto/experiments/create_save_scenarios:modeldump-saving-results}}
\sphinxAtStartPar
The ‚Äòkeep‚Äô option ensures, that the solutions are saved together with the model, data and descriptions.

\sphinxAtStartPar
Note: When working with large data and many scenarios, this file takes up a lot of space!

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{modeldump}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{../../models/pak scenarios.pcim}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{keep}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{!}dir ..\PYG{l+s+se}{\PYGZbs{}.}.\PYG{l+s+se}{\PYGZbs{}m}odels
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 Volume in drive C has no label.
 Volume Serial Number is C2DB\PYGZhy{}095E

 Directory of c:\PYGZbs{}wb new\PYGZbs{}Modelflow\PYGZbs{}working\PYGZus{}paper\PYGZbs{}thebook\PYGZbs{}content\PYGZbs{}models

27\PYGZhy{}06\PYGZhy{}2022  02:14    \PYGZlt{}DIR\PYGZgt{}          .
14\PYGZhy{}09\PYGZhy{}2022  17:22    \PYGZlt{}DIR\PYGZgt{}          ..
11\PYGZhy{}10\PYGZhy{}2022  19:23        22.999.561 pak scenarios.pcim
02\PYGZhy{}03\PYGZhy{}2022  11:12         3.388.012 pak.pcim
11\PYGZhy{}10\PYGZhy{}2022  18:14         3.391.454 pak\PYGZus{}exogenized.pcim
               3 File(s)     29.779.027 bytes
               2 Dir(s)  751.411.384.320 bytes free
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{[}\PYG{n}{k} \PYG{k}{for} \PYG{n}{k} \PYG{o+ow}{in} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keep\PYGZus{}solutions}\PYG{o}{.}\PYG{n}{keys}\PYG{p}{(}\PYG{p}{)}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZsq{}Baseline\PYGZsq{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{andrew} \PYG{o}{=} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keep\PYGZus{}solutions}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Coal, Oil and Gastax : 5 nominal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{andrew}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
      ADAP  ALBNEIMPGNFSKD  ALBNEIMPGNFSKD01  AUTNEIMPGNFSKD  \PYGZbs{}
1980   0.0      655.959991        655.959991    57235.583413   
1981   0.0      657.440879        657.440879    56888.545640   
1982   0.0      773.473829        773.473829    54824.093028   
1983   0.0      662.950925        662.950925    57114.045613   
1984   0.0      597.058556        597.058556    60908.310421   

      AUTNEIMPGNFSKD01  BELNEIMPGNFSKD  BELNEIMPGNFSKD01  BIHNEIMPGNFSKD  \PYGZbs{}
1980      57235.583413   110340.519687     110340.519687             0.0   
1981      56888.545640   108205.205228     108205.205228             0.0   
1982      54824.093028   109671.110584     109671.110584             0.0   
1983      57114.045613   108319.709418     108319.709418             0.0   
1984      60908.310421   115244.067557     115244.067557             0.0   

      BIHNEIMPGNFSKD01  CHNEXR05  ...  PAKGGREVOTHRCN\PYGZus{}X  PAKNVAGRFSNGXN\PYGZus{}D  \PYGZbs{}
1980               0.0  0.354531  ...               0.0               0.0   
1981               0.0  0.372258  ...               0.0               0.0   
1982               0.0  0.387030  ...               0.0               0.0   
1983               0.0  0.385553  ...               0.0               0.0   
1984               0.0  0.413620  ...               0.0               0.0   

      PAKGGREVGRNTCN\PYGZus{}X  PAKBMFSTOTHRCD\PYGZus{}X  PAKGGREVGRNTCN\PYGZus{}D  PAKNVSRVTRNSKN\PYGZus{}D  \PYGZbs{}
1980               0.0               0.0               0.0               0.0   
1981               0.0               0.0               0.0               0.0   
1982               0.0               0.0               0.0               0.0   
1983               0.0               0.0               0.0               0.0   
1984               0.0               0.0               0.0               0.0   

      PAKNVGASPRODXN\PYGZus{}D  PAKNVENGTOTLKN\PYGZus{}D  PAKBXGSRMRCHCD\PYGZus{}D  PAKNEIMPGNFSKN\PYGZus{}D  
1980               0.0               0.0               0.0               0.0  
1981               0.0               0.0               0.0               0.0  
1982               0.0               0.0               0.0               0.0  
1983               0.0               0.0               0.0               0.0  
1984               0.0               0.0               0.0               0.0  

[5 rows x 1291 columns]
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxstepscope


\chapter{A experiment using Taxes on Goods and Services}
\label{\detokenize{content/howto/experiments/Standard experiment simple:a-experiment-using-taxes-on-goods-and-services}}\label{\detokenize{content/howto/experiments/Standard experiment simple::doc}}
\sphinxAtStartPar
This notebook makes one of the ‚Äústandard experiment‚Äù used to check MfMod models on the PAK model \hyperlink{cite.content/litterature:id14}{Burns \sphinxstyleemphasis{et al.}} .

\sphinxAtStartPar
The variable PAKGGREVGNFSCN (Taxes on Goods and Services) is increased by 1 percent of gdp (PAKNYGDPMKTPCN) in 2023 and the impulse response is visualized.
Process:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Loading a pre\sphinxhyphen{}existing model in Modelflow

\item {} 
\sphinxAtStartPar
Creating the experimet by updating PAKGGREVGNFSCN

\item {} 
\sphinxAtStartPar
Simulating the model

\item {} 
\sphinxAtStartPar
Visualizing the results

\end{enumerate}

\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
PAKGGREVGNFSCN is the only variable of the standard shock variables: \sphinxcode{\sphinxupquote{GGEXPCRNTCN GGEXPWAGECN GGREVGNFSCN GGREVDPITCN GGREVDCITCN}} which is relevant for this particular model
\end{sphinxadmonition}


\section{Imports}
\label{\detokenize{content/howto/experiments/Standard experiment simple:imports}}
\sphinxAtStartPar
Modelflow‚Äôs modelclass includes most of the methods needed to manage a model in Modelflow.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{modelclass} \PYG{k+kn}{import} \PYG{n}{model} 
\PYG{n}{model}\PYG{o}{.}\PYG{n}{widescreen}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{model}\PYG{o}{.}\PYG{n}{scroll\PYGZus{}off}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}IPython.core.display.HTML object\PYGZgt{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Load a pre\sphinxhyphen{}existing model, data and descriptions}
\label{\detokenize{content/howto/experiments/Standard experiment simple:load-a-pre-existing-model-data-and-descriptions}}
\sphinxAtStartPar
The file \sphinxcode{\sphinxupquote{pak.pcim}} contains a dump of model equations, dataframe, simulation options and variable descriptions. The file has been created when onboarding the model.
Examples can be found {\hyperref[\detokenize{content/howto/onboard/eviews/onboard one model from  wf1::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{here}}}}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{p}{,}\PYG{n}{baseline} \PYG{o}{=} \PYG{n}{model}\PYG{o}{.}\PYG{n}{modelload}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{../onboard/eviews/modelflowdumps/pak.pcim}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{alfa}\PYG{o}{=}\PYG{l+m+mf}{0.7}\PYG{p}{,}\PYG{n}{run}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{keep}\PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Baseline}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Fix the equation for PAKGGREVGNFSCN}
\label{\detokenize{content/howto/experiments/Standard experiment simple:fix-the-equation-for-pakggrevgnfscn}}
\sphinxAtStartPar
The equation looks like this:

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{PAKGGREVGNFSCN}\PYG{o}{.}\PYG{n}{frml}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Endogeneous: PAKGGREVGNFSCN: Taxes on Goods and Services
Formular: FRML \PYGZlt{}Z,EXO\PYGZgt{} PAKGGREVGNFSCN = ((PAKGGREVGNFSXN/100*(PAKNECONPRVTCN+PAKNECONGOVTCN))+5.34672642860449E\PYGZhy{}12 + PAKGGREVGNFSCN\PYGZus{}A)* (1\PYGZhy{}PAKGGREVGNFSCN\PYGZus{}D)+ PAKGGREVGNFSCN\PYGZus{}X*PAKGGREVGNFSCN\PYGZus{}D  \PYGZdl{}

PAKGGREVGNFSCN  : Taxes on Goods and Services
PAKGGREVGNFSCN\PYGZus{}A: Add factor:Taxes on Goods and Services
PAKGGREVGNFSCN\PYGZus{}D: Fix dummy:Taxes on Goods and Services
PAKGGREVGNFSCN\PYGZus{}X: Fix value:Taxes on Goods and Services
PAKGGREVGNFSXN  : Goods and services Tax Rate
PAKNECONGOVTCN  : Govt. Cons., LCU mn
PAKNECONPRVTCN  : Pvt. Cons., LCU mn
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxAtStartPar
The result of the equation can be fixes by calling mpak.fix(<dataframe>,PAKGGREVGNFSCN,2023,2023)

\sphinxAtStartPar
This will create a new dataframe where the value of PAKGGREVGNFSCN\_X is set to the current value of PAKGGREVGNFSCN, and the value of PAKGGREVGNFSCN\_D is set to 1 in the year 2023.
When this dataframe is simulated the value of PAKGGREVGNFSCN will not depend on the ordinary right hand side variables, only on the value of PAKGGREVGNFSCN\_X.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{alternative\PYGZus{}base} \PYG{o}{=} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{fix}\PYG{p}{(}\PYG{n}{baseline}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKGGREVGNFSCN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+m+mi}{2023}\PYG{p}{,}\PYG{l+m+mi}{2023}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxadmonition}{warning}{Warning:}
\sphinxAtStartPar
In this experiment PAKGGREVGNFSCN is fixed in 2023. The value in all other years will be calculated using the original equation. 
To fix the value for all periods replace \sphinxcode{\sphinxupquote{2023,2023}} with \sphinxcode{\sphinxupquote{2023,2100}}
\end{sphinxadmonition}


\section{Create a scenario by shocking PAKGGREVGNFSCN}
\label{\detokenize{content/howto/experiments/Standard experiment simple:create-a-scenario-by-shocking-pakggrevgnfscn}}
\sphinxAtStartPar
A new dataframe where PAKGGREVGNFSCN\_X is increased by one percent of GDP is created

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{alternative} \PYG{o}{=} \PYG{n}{alternative\PYGZus{}base}\PYG{o}{.}\PYG{n}{upd}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZlt{}2023 2023\PYGZgt{} PAKGGREVGNFSCN\PYGZus{}X + }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{baseline}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{l+m+mi}{2023}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{PAKNYGDPMKTPCN}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{o}{*}\PYG{l+m+mf}{0.01} \PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\sphinxAtStartPar
The variable before and after the shock can be
displayed

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Value of GDP in 2023: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{baseline}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{l+m+mi}{2023}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{PAKNYGDPMKTPCN}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{l+s+si}{:}\PYG{l+s+s1}{,.0f}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Base value in 2023: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{alternative\PYGZus{}base}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{l+m+mi}{2023}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{PAKGGREVGNFSCN\PYGZus{}X}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{l+s+si}{:}\PYG{l+s+s1}{,.0f}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{. Alternative value: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{alternative}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{l+m+mi}{2023}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{PAKGGREVGNFSCN\PYGZus{}X}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{l+s+si}{:}\PYG{l+s+s1}{,.0f}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}
    \PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Difference: }\PYG{l+s+si}{\PYGZob{}}\PYG{o}{\PYGZhy{}}\PYG{p}{(}\PYG{n}{alternative\PYGZus{}base}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{l+m+mi}{2023}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{PAKGGREVGNFSCN\PYGZus{}X}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{alternative}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{l+m+mi}{2023}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{PAKGGREVGNFSCN\PYGZus{}X}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{)}\PYG{l+s+si}{:}\PYG{l+s+s1}{,.0f}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Value of GDP in 2023: 67,604,654
Base value in 2023: 2,804,747. Alternative value: 3,480,793.Difference: 676,047.
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Simulate the model}
\label{\detokenize{content/howto/experiments/Standard experiment simple:simulate-the-model}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZpc{}}\PYG{k}{matplotlib} notebook 
\PYG{n}{result} \PYG{o}{=} \PYG{n}{mpak}\PYG{p}{(}\PYG{n}{alternative}\PYG{p}{,}\PYG{l+m+mi}{2020}\PYG{p}{,}\PYG{l+m+mi}{2035}\PYG{p}{,}\PYG{n}{keep}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Taxes on Goods and Services up by 1 pct of GDP in 2023}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{} simulates the model }
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Access results}
\label{\detokenize{content/howto/experiments/Standard experiment simple:access-results}}
\sphinxAtStartPar
Now we have two dataframes with results \sphinxcode{\sphinxupquote{baseline}} and \sphinxcode{\sphinxupquote{result}}. These dataframes can be manipulated and visualized
with the tools provided by the \sphinxstylestrong{pandas} library and other like \sphinxstylestrong{Matplotlib} and \sphinxstylestrong{Plotly}. However to make things easy the first and
latest simulation result is also in the mpak object:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{mpak.basedf}: Dataframe with the values for baseline

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{mpak.lastdf}: Dataframe with the values for alternative

\end{itemize}

\sphinxAtStartPar
The result can easily be visualized in Jupyter notebooks by using the \sphinxcode{\sphinxupquote{{[}.{]}}} operator this will display the values of the variables in square brackets and useful
transformations of the values including the impact. In addition the exotenous variables which has changed are displayed.

\sphinxAtStartPar
\sphinxstylestrong{Click on the tabs to display the different output}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPCN PAKNYGDPMKTPKN PAKGGEXPTOTLCN PAKGGREVTOTLCN PAKNECONGOVTKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Tab(children=(Tab(children=(HTML(value=\PYGZsq{}\PYGZlt{}?xml version=\PYGZdq{}1.0\PYGZdq{} encoding=\PYGZdq{}utf\PYGZhy{}8\PYGZdq{} standalone=\PYGZdq{}no\PYGZdq{}?\PYGZgt{}\PYGZbs{}n\PYGZlt{}!DOCTYPE svg ‚Ä¶
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Or use keep\_plot to make more bespoken charts which can be saved  in many formats}
\label{\detokenize{content/howto/experiments/Standard experiment simple:or-use-keep-plot-to-make-more-bespoken-charts-which-can-be-saved-in-many-formats}}
\sphinxAtStartPar
This method can display a number of different transformations of the series for more \sphinxhref{./create\_save\_scenarios.ipynb\#.keep\_plot()--Function-to-visualize-the-keept-solutions}{here}
Here only a few:


\subsection{Differences of growth rates}
\label{\detokenize{content/howto/experiments/Standard experiment simple:differences-of-growth-rates}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keep\PYGZus{}plot}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPCN PAKGGEXPTOTLCN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{diff}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{showtype}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{growth}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{savefig}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{testgraph/tax\PYGZus{}impact\PYGZus{}growth\PYGZus{}.svg}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{legend}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Standard experiment simple_21_0}.png}

\noindent\sphinxincludegraphics{{Standard experiment simple_21_1}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Differences in percent of baseline values}
\label{\detokenize{content/howto/experiments/Standard experiment simple:differences-in-percent-of-baseline-values}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keep\PYGZus{}plot}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPCN PAKGGEXPTOTLCN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{diffpct}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{showtype}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{level}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{savefig}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{testgraph/tax\PYGZus{}impact\PYGZus{}difpct\PYGZus{}.svg}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{legend}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Standard experiment simple_23_0}.png}

\noindent\sphinxincludegraphics{{Standard experiment simple_23_1}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Some variations on keep\_plot(}
\label{\detokenize{content/howto/experiments/Standard experiment simple:some-variations-on-keep-plot}}
\sphinxAtStartPar
The \sphinxstylestrong{variables} we want to be displayed is listed as first argument. Variable names can include
wildcards (using * for any string and ? for any character)

\sphinxAtStartPar
\sphinxstylestrong{Transformation of data displayed:}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
showtype=
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Use this operator
\\
\hline
\sphinxAtStartPar
‚Äòlevel‚Äô (default)
&
\sphinxAtStartPar
No transformation
\\
\hline
\sphinxAtStartPar
‚Äògrowth‚Äô
&
\sphinxAtStartPar
The growth rate  in percent
\\
\hline
\sphinxAtStartPar
‚Äòchange‚Äô
&
\sphinxAtStartPar
The yearly change (\(\Delta\))
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
\sphinxstylestrong{legend placement}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
legend=
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Use this operator
\\
\hline
\sphinxAtStartPar
False (default)
&
\sphinxAtStartPar
The legends will be placed at the end of the corresponding line
\\
\hline
\sphinxAtStartPar
True
&
\sphinxAtStartPar
The legends are places in a legend box
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
Often it is useful to compare the scenario results with the baseline result. This is done with the diff argument.


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
diff=
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Use this operator
\\
\hline
\sphinxAtStartPar
False (default)
&
\sphinxAtStartPar
All entries in the keep\_solution dictionary is displayed
\\
\hline
\sphinxAtStartPar
True
&
\sphinxAtStartPar
The difference to the first entry is shown.
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
It can also be useful to compare the scenario results with the baseline result \sphinxstylestrong{measured in percent}. This is done with the diffpct argument.


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
diffpct=
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Use this operator
\\
\hline
\sphinxAtStartPar
False (default)
&
\sphinxAtStartPar
All entries in the keep\_solution dictionary is displayed
\\
\hline
\sphinxAtStartPar
True
&
\sphinxAtStartPar
The difference in percent to the first entry is shown
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{savefig='{[}path/{]}<prefix>.<extension>'}}
Will create a number of files with the charts.
The files will be saved location with name \sphinxcode{\sphinxupquote{<path>/<prefix><variable name>.<extension>}} The extension determines the
format of the saved file. pdf, svg and png are the most common extensions.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
!dir testgraph\PYGZbs{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 Volume in drive C has no label.
 Volume Serial Number is C2DB\PYGZhy{}095E

 Directory of c:\PYGZbs{}wb new\PYGZbs{}Modelflow\PYGZbs{}working\PYGZus{}paper\PYGZbs{}thebook\PYGZbs{}content\PYGZbs{}howto\PYGZbs{}experiments\PYGZbs{}testgraph

27\PYGZhy{}06\PYGZhy{}2022  02:14    \PYGZlt{}DIR\PYGZgt{}          .
09\PYGZhy{}10\PYGZhy{}2022  15:27    \PYGZlt{}DIR\PYGZgt{}          ..
11\PYGZhy{}10\PYGZhy{}2022  19:22            35.849 tax\PYGZus{}impact\PYGZus{}difpct\PYGZus{}\PYGZus{}PAKGGEXPTOTLCN.svg
11\PYGZhy{}10\PYGZhy{}2022  19:22            37.126 tax\PYGZus{}impact\PYGZus{}difpct\PYGZus{}\PYGZus{}PAKNYGDPMKTPCN.svg
11\PYGZhy{}10\PYGZhy{}2022  19:22            35.274 tax\PYGZus{}impact\PYGZus{}growth\PYGZus{}\PYGZus{}PAKGGEXPTOTLCN.svg
11\PYGZhy{}10\PYGZhy{}2022  19:22            36.558 tax\PYGZus{}impact\PYGZus{}growth\PYGZus{}\PYGZus{}PAKNYGDPMKTPCN.svg
               4 File(s)        144.807 bytes
               2 Dir(s)  751.399.378.944 bytes free
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} fixed\PYGZus{}alternative = mpak.fix(alternative,\PYGZsq{}PAKGGEXPCAPTCN PAKGGEXPGNFSCN PAKGGEXPOTHRCN PAKGGEXPTRNSCN\PYGZsq{},2023,2035)}
\PYG{n}{fixed\PYGZus{}alternative} \PYG{o}{=} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{fix}\PYG{p}{(}\PYG{n}{alternative}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKGGEXPCAPTCN }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+m+mi}{2023}\PYG{p}{,}\PYG{l+m+mi}{2035}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{result\PYGZus{}fixed\PYGZus{}expenditure} \PYG{o}{=} \PYG{n}{mpak}\PYG{p}{(}\PYG{n}{fixed\PYGZus{}alternative}\PYG{p}{,}\PYG{l+m+mi}{2020}\PYG{p}{,}\PYG{l+m+mi}{2035}\PYG{p}{,}\PYG{n}{keep}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Taxes on Goods and Services up, expenditure fixed}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{silent}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{first\PYGZus{}test}\PYG{o}{=}\PYG{l+m+mi}{60}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{} simulates the model }
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Will start solving: PAK
Create compiled solving function for PAK
ljit=False stringjit=True  transpile\PYGZus{}reset=False  hasattr(self, f\PYGZdq{}pro\PYGZus{}\PYGZob{}jitname\PYGZcb{}\PYGZdq{})=False
2020 Solved in 61 iterations
2021 Solved in 61 iterations
2022 Solved in 61 iterations
2023 Solved in 70 iterations
2024 Solved in 62 iterations
2025 Solved in 62 iterations
2026 Solved in 62 iterations
2027 Solved in 62 iterations
2028 Solved in 62 iterations
2029 Solved in 62 iterations
2030 Solved in 62 iterations
2031 Solved in 62 iterations
2032 Solved in 62 iterations
2033 Solved in 62 iterations
2034 Solved in 62 iterations
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
2035 Solved in 62 iterations
PAK solved  
Running calc\PYGZus{}adjust\PYGZus{}model 
Dummies set [\PYGZsq{}PAKGGEXPCAPTCN\PYGZus{}D\PYGZsq{}, \PYGZsq{}PAKGGREVGNFSCN\PYGZus{}D\PYGZsq{}]
Will start calculating: Calculate add factors
2020  solved
2021  solved
2022  solved
2023  solved
2024  solved
2025  solved
2026  solved
2027  solved
2028  solved
2029  solved
2030  solved
2031  solved
2032  solved
2033  solved
2034  solved
2035  solved
Calculate add factors calculated 
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{fix\PYGZus{}dummy\PYGZus{}fixed}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
[\PYGZsq{}PAKGGEXPCAPTCN\PYGZus{}D\PYGZsq{}, \PYGZsq{}PAKGGREVGNFSCN\PYGZus{}D\PYGZsq{}]
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPCN PAKNYGDPMKTPKN PAKGGEXPTOTLCN PAKGGREVTOTLCN PAKNECONGOVTKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Tab(children=(Tab(children=(HTML(value=\PYGZsq{}\PYGZlt{}?xml version=\PYGZdq{}1.0\PYGZdq{} encoding=\PYGZdq{}utf\PYGZhy{}8\PYGZdq{} standalone=\PYGZdq{}no\PYGZdq{}?\PYGZgt{}\PYGZbs{}n\PYGZlt{}!DOCTYPE svg ‚Ä¶
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keep\PYGZus{}solutions}\PYG{o}{.}\PYG{n}{keys}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
dict\PYGZus{}keys([\PYGZsq{}Baseline\PYGZsq{}, \PYGZsq{}Taxes on Goods and Services up by 1 pct of GDP in 2023\PYGZsq{}, \PYGZsq{}Taxes on Goods and Services up, expenditure fixed\PYGZsq{}])
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{with} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keepswitch}\PYG{p}{(}\PYG{n}{scenarios}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Taxes on Goods and Services up by 1 pct of GDP in 2023|Taxes on Goods and Services up, expenditure fixed}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keep\PYGZus{}plot}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPCN PAKNYGDPMKTPKN PAKGGEXPTOTLCN PAKGGREVTOTLCN PAKNECONGOVTKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{diff}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{showtype}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{level}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{legend}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Standard experiment simple_31_0}.png}

\noindent\sphinxincludegraphics{{Standard experiment simple_31_1}.png}

\noindent\sphinxincludegraphics{{Standard experiment simple_31_2}.png}

\noindent\sphinxincludegraphics{{Standard experiment simple_31_3}.png}

\noindent\sphinxincludegraphics{{Standard experiment simple_31_4}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxstepscope


\part{Keept experiments}

\sphinxstepscope


\chapter{Load a model and data inclusive the keept scenarios}
\label{\detokenize{content/howto/keep/Create and modify charts with keep_plot:load-a-model-and-data-inclusive-the-keept-scenarios}}\label{\detokenize{content/howto/keep/Create and modify charts with keep_plot::doc}}
\sphinxAtStartPar
By loading the previous created scenarios there is no need to create them through simulation. We can concentrate on the
manipulating the results.

\sphinxAtStartPar
Here look at how to create plots and enhancing the plots afterwards.

\sphinxAtStartPar
The \sphinxstylestrong{matplotlib} packagde is used. It has a lot of possibilities. Af which only a few will be shown here.

\sphinxAtStartPar
Matplotlib documentation: https://matplotlib.org/stable/index.html


\section{Import the model class}
\label{\detokenize{content/howto/keep/Create and modify charts with keep_plot:import-the-model-class}}
\sphinxAtStartPar
This class incorporates most of the methods used to manage a model.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{modelclass} \PYG{k+kn}{import} \PYG{n}{model} 
\PYG{n}{model}\PYG{o}{.}\PYG{n}{widescreen}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{model}\PYG{o}{.}\PYG{n}{scroll\PYGZus{}off}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}IPython.core.display.HTML object\PYGZgt{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{IPython}\PYG{n+nn}{.}\PYG{n+nn}{display} \PYG{k+kn}{import} \PYG{n}{display}\PYG{p}{,} \PYG{n}{Markdown}\PYG{p}{,} \PYG{n}{HTML}
\PYG{k+kn}{from} \PYG{n+nn}{pathlib} \PYG{k+kn}{import} \PYG{n}{Path} 
\PYG{k+kn}{import} \PYG{n+nn}{glob}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Used when developing  }
\PYG{o}{\PYGZpc{}}\PYG{k}{load\PYGZus{}ext} autoreload
\PYG{o}{\PYGZpc{}}\PYG{k}{autoreload} 2
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Load an existing model, data and descriptions}
\label{\detokenize{content/howto/keep/Create and modify charts with keep_plot:load-an-existing-model-data-and-descriptions}}
\sphinxAtStartPar
The file \sphinxcode{\sphinxupquote{pak\_exogenized.pcim}} contains a dump of model equations, dataframe, simulation options and variable descriptions.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{p}{,}\PYG{n}{exostart} \PYG{o}{=} \PYG{n}{model}\PYG{o}{.}\PYG{n}{modelload}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{../models/pak scenarios.pcim}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{run}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{silent}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\subsection{This mpak also contains the saved scenarios}
\label{\detokenize{content/howto/keep/Create and modify charts with keep_plot:this-mpak-also-contains-the-saved-scenarios}}
\sphinxAtStartPar
So there is no need to run the scenarios again

\sphinxAtStartPar
The scenarios are:

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{for} \PYG{n}{k} \PYG{o+ow}{in} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keep\PYGZus{}solutions}\PYG{o}{.}\PYG{n}{keys}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{k}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Baseline
Coal, Oil and Gastax : 5 nominal
Coal, Oil and Gastax : 10 nominal
Coal, Oil and Gastax : 15 nominal
Coal, Oil and Gastax : 20 nominal
Coal, Oil and Gastax : 25 nominal
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{The scenarios are avaiable out of the box}
\label{\detokenize{content/howto/keep/Create and modify charts with keep_plot:the-scenarios-are-avaiable-out-of-the-box}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{plot\PYGZus{}level}  \PYG{o}{=} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keep\PYGZus{}plot}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN PAKCCEMISCO2TKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+m+mi}{2010}\PYG{p}{,}\PYG{l+m+mi}{2100}\PYG{p}{,}\PYG{n}{diffpct}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{legend}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Create and modify charts with keep_plot_10_0}.png}

\noindent\sphinxincludegraphics{{Create and modify charts with keep_plot_10_1}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{mpak.keep\_plot has a lot of options}
\label{\detokenize{content/howto/keep/Create and modify charts with keep_plot:mpak-keep-plot-has-a-lot-of-options}}
\sphinxAtStartPar
The options are listed below. Try different options. Feel free to suggest other options.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{help}\PYG{p}{(}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keep\PYGZus{}plot}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Help on method keep\PYGZus{}plot in module modelclass:

keep\PYGZus{}plot(pat=\PYGZsq{}*\PYGZsq{}, start=\PYGZsq{}\PYGZsq{}, slut=\PYGZsq{}\PYGZsq{}, start\PYGZus{}ofset=0, slut\PYGZus{}ofset=0, showtype=\PYGZsq{}level\PYGZsq{}, diff=False, diffpct=False, mul=1.0, title=\PYGZsq{}Show variables\PYGZsq{}, legend=False, scale=\PYGZsq{}linear\PYGZsq{}, yunit=\PYGZsq{}\PYGZsq{}, ylabel=\PYGZsq{}\PYGZsq{}, dec=\PYGZsq{}\PYGZsq{}, trans=\PYGZob{}\PYGZcb{}, showfig=False, vline=[], savefig=\PYGZsq{}\PYGZsq{}, keep\PYGZus{}dim=True, dataonly=False) method of modelclass.model instance
    Args:
        pat (string, optional): Variable selection. Defaults to \PYGZsq{}*\PYGZsq{}.
        start (TYPE, optional): start periode. Defaults to \PYGZsq{}\PYGZsq{}.
        slut (TYPE, optional): end periode. Defaults to \PYGZsq{}\PYGZsq{}.
        start\PYGZus{}ofset (int, optional): start periode relativ ofset to current. Defaults to 0.
        slut\PYGZus{}ofset (int, optional): end period, relativ ofset to current. Defaults to 0.
        showtype (str, optional): \PYGZsq{}level\PYGZsq{},\PYGZsq{}growth\PYGZsq{} or change\PYGZsq{} transformation of data. Defaults to \PYGZsq{}level\PYGZsq{}.
        diff (Logical, optional): if True shows the difference to the first experiment. Defaults to False.
        diffpct (logical,optional) : if True shows the difference in percent to tirst experiment. defalut to false
        mul (float, optional): multiplier of data. Defaults to 1.0.
        title (TYPE, optional): DESCRIPTION. Defaults to \PYGZsq{}Show variables\PYGZsq{}.
        legend (TYPE, optional): if False, expanations on the right of curve. Defaults to True.
        scale (TYPE, optional): \PYGZsq{}log\PYGZsq{} og \PYGZsq{}linear\PYGZsq{}. Defaults to \PYGZsq{}linear\PYGZsq{}.
        yunit (TYPE, optional): DESCRIPTION. Defaults to \PYGZsq{}\PYGZsq{}.
        ylabel (TYPE, optional): DESCRIPTION. Defaults to \PYGZsq{}\PYGZsq{}.
        dec (TYPE, optional): decimals if \PYGZsq{}\PYGZsq{} automated. Defaults to \PYGZsq{}\PYGZsq{}.
        trans (TYPE, optional): . Translation dict for variable names. Defaults to \PYGZob{}\PYGZcb{}.
        showfig (TYPE, optional): Time will come . Defaults to False.
        vline (list of tupels, optional): list of (time,text) for vertical lines. Will be keept, to erase del model.vline
        savefig (string,optional): folder to save figures in. Can include folder name, if needed the folder will be created 
        keep\PYGZus{}dim (bool,True): if True each line is a scenario else each line is a variable 
        dataonly = False: If True only the resulting dataframes are returned 
    Returns:
        figs (dict): dict of the generated Matplotlib figures.
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{The plots can be displayed again}
\label{\detokenize{content/howto/keep/Create and modify charts with keep_plot:the-plots-can-be-displayed-again}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{for} \PYG{n}{v}\PYG{p}{,}\PYG{n}{p} \PYG{o+ow}{in} \PYG{n}{plot\PYGZus{}level}\PYG{o}{.}\PYG{n}{items}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{display}\PYG{p}{(}\PYG{n}{p}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Create and modify charts with keep_plot_14_0}.png}

\noindent\sphinxincludegraphics{{Create and modify charts with keep_plot_14_1}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Charts can be saved in several formats}
\label{\detokenize{content/howto/keep/Create and modify charts with keep_plot:charts-can-be-saved-in-several-formats}}
\sphinxAtStartPar
This is done by using the savefig option.
The location, prefix name and format is taken from the string.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{plot\PYGZus{}level}  \PYG{o}{=} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keep\PYGZus{}plot}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN PAKCCEMISCO2TKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+m+mi}{2010}\PYG{p}{,}\PYG{l+m+mi}{2100}\PYG{p}{,}\PYG{n}{savefig}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{testgraph/Level.svg}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{legend} \PYG{o}{=} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Create and modify charts with keep_plot_16_0}.png}

\noindent\sphinxincludegraphics{{Create and modify charts with keep_plot_16_1}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{The files in svg format can be listed.}
\label{\detokenize{content/howto/keep/Create and modify charts with keep_plot:the-files-in-svg-format-can-be-listed}}
\sphinxAtStartPar
With the mpak.display\_toc\_this  method
The list is clickable

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{display\PYGZus{}toc\PYGZus{}this}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{*}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{text}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Files in the testgraph folder}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{path}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{testgraph}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{ext}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{*}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{showext} \PYG{o}{=} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\sphinxAtStartPar
Files in the testgraph folder

\begin{sphinxVerbatim}[commandchars=\\\{\}]
testgraph :
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}IPython.core.display.HTML object\PYGZgt{}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}IPython.core.display.HTML object\PYGZgt{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{We can select which scenarios to plot:}
\label{\detokenize{content/howto/keep/Create and modify charts with keep_plot:we-can-select-which-scenarios-to-plot}}
\sphinxAtStartPar
And the sequence of scenario. 
In this example only 2 scenarios are selected, and the ranking is reorders. Which matters because diff is always relative to the first scenario.
The scenarios are located in the

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{with} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keepswitch}\PYG{p}{(}\PYG{n}{scenarios} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{*25* *15*}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{:}
   \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keep\PYGZus{}plot}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKCCEMISCO2TKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+m+mi}{2010}\PYG{p}{,}\PYG{l+m+mi}{2100}\PYG{p}{,}\PYG{n}{diff}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Create and modify charts with keep_plot_20_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{The all scenarios again}
\label{\detokenize{content/howto/keep/Create and modify charts with keep_plot:the-all-scenarios-again}}
\sphinxAtStartPar
Ith was only a local selection and reorder of the scenarios. 

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{figs} \PYG{o}{=} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keep\PYGZus{}plot}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN PAKCCEMISCO2TKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+m+mi}{2010}\PYG{p}{,}\PYG{l+m+mi}{2100}\PYG{p}{,}\PYG{n}{legend}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Create and modify charts with keep_plot_22_0}.png}

\noindent\sphinxincludegraphics{{Create and modify charts with keep_plot_22_1}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Charts can be modified}
\label{\detokenize{content/howto/keep/Create and modify charts with keep_plot:charts-can-be-modified}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{fig} \PYG{o}{=} \PYG{n}{figs}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKCCEMISCO2TKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{axes}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{New Title }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{axes}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Year}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{axes}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1000 PKR}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{axes}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{yaxis}\PYG{o}{.}\PYG{n}{set\PYGZus{}label\PYGZus{}coords}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.1}\PYG{p}{,}\PYG{l+m+mf}{1.02}\PYG{p}{)}
\PYG{n}{fig}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Create and modify charts with keep_plot_25_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Or chart variables instead of scenarios}
\label{\detokenize{content/howto/keep/Create and modify charts with keep_plot:or-chart-variables-instead-of-scenarios}}
\sphinxAtStartPar
This is driven by keep\_dim = 0

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{with} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keepswitch}\PYG{p}{(}\PYG{k+kc}{True}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{last*}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{var\PYGZus{}figs} \PYG{o}{=} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keep\PYGZus{}plot}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN PAKNECONPRVTKN PAKNEGDIFTOTKN PAKNEIMPGNFSKN PAKNEEXPGNFSKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+m+mi}{2010}\PYG{p}{,}\PYG{l+m+mi}{2100}\PYG{p}{,}\PYG{n}{keep\PYGZus{}dim}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{legend}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Create and modify charts with keep_plot_27_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{or use the keep\_plot\_multi where all charts are collected in one fig}
\label{\detokenize{content/howto/keep/Create and modify charts with keep_plot:or-use-the-keep-plot-multi-where-all-charts-are-collected-in-one-fig}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{with} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keepswitch}\PYG{p}{(}\PYG{k+kc}{True}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{var\PYGZus{}figs} \PYG{o}{=} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keep\PYGZus{}plot\PYGZus{}multi}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN PAKNECONPRVTKN PAKNEGDIFTOTKN PAKNEIMPGNFSKN PAKNEEXPGNFSKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+m+mi}{2010}\PYG{p}{,}\PYG{l+m+mi}{2100}\PYG{p}{,}\PYG{n}{keep\PYGZus{}dim}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{legend}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}
                                \PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{10}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{)} \PYG{p}{,}\PYG{n}{title}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsq{}}  \PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Create and modify charts with keep_plot_29_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Change titles for each axes}
\label{\detokenize{content/howto/keep/Create and modify charts with keep_plot:change-titles-for-each-axes}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{with} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keepswitch}\PYG{p}{(}\PYG{k+kc}{True}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{var\PYGZus{}figs} \PYG{o}{=} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keep\PYGZus{}plot\PYGZus{}multi}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN PAKNECONPRVTKN PAKNEGDIFTOTKN PAKNEIMPGNFSKN PAKNEEXPGNFSKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+m+mi}{2010}\PYG{p}{,}\PYG{l+m+mi}{2100}\PYG{p}{,}\PYG{n}{keep\PYGZus{}dim}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{legend}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}
                                \PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{10}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{)} \PYG{p}{,}\PYG{n}{title}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsq{}}  \PYG{p}{)}\PYG{p}{;}
\PYG{n}{var\PYGZus{}figs}\PYG{o}{.}\PYG{n}{axes}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Business as usual }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}    \PYG{c+c1}{\PYGZsh{} many properties can be set afterward }
\PYG{n}{var\PYGZus{}figs}\PYG{o}{.}\PYG{n}{axes}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A new and beter world }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Create and modify charts with keep_plot_31_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Add text to the axes}
\label{\detokenize{content/howto/keep/Create and modify charts with keep_plot:add-text-to-the-axes}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{with} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keepswitch}\PYG{p}{(}\PYG{k+kc}{True}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{var\PYGZus{}figs} \PYG{o}{=} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keep\PYGZus{}plot\PYGZus{}multi}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN PAKNECONPRVTKN PAKNEGDIFTOTKN PAKNEIMPGNFSKN PAKNEEXPGNFSKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+m+mi}{2010}\PYG{p}{,}\PYG{l+m+mi}{2100}\PYG{p}{,}\PYG{n}{keep\PYGZus{}dim}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{legend}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}

\PYG{n}{var\PYGZus{}figs}\PYG{o}{.}\PYG{n}{axes}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{l+m+mf}{2040.}\PYG{p}{,}\PYG{l+m+mf}{150\PYGZus{}000\PYGZus{}000.}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Some text}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{style}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{italic}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}

\PYG{n}{var\PYGZus{}figs}\PYG{o}{.}\PYG{n}{axes}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{l+m+mi}{2040}\PYG{p}{,}\PYG{l+m+mi}{150\PYGZus{}000\PYGZus{}000}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZdl{}This = a\PYGZca{}2\PYGZdl{} in latex}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{style}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{italic}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{12}\PYG{p}{,}
        \PYG{n}{bbox}\PYG{o}{=}\PYG{n+nb}{dict}\PYG{p}{(}\PYG{n}{facecolor}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{red}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.5}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Create and modify charts with keep_plot_33_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Charts can be resized afterward}
\label{\detokenize{content/howto/keep/Create and modify charts with keep_plot:charts-can-be-resized-afterward}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var\PYGZus{}figs}\PYG{o}{.}\PYG{n}{set\PYGZus{}size\PYGZus{}inches}\PYG{p}{(}\PYG{l+m+mi}{15}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{)}
\PYG{n}{var\PYGZus{}figs}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Create and modify charts with keep_plot_35_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{charts can be removed}
\label{\detokenize{content/howto/keep/Create and modify charts with keep_plot:charts-can-be-removed}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var\PYGZus{}figs}\PYG{o}{.}\PYG{n}{axes}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{remove}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var\PYGZus{}figs}\PYG{o}{.}\PYG{n}{set\PYGZus{}size\PYGZus{}inches}\PYG{p}{(}\PYG{l+m+mi}{15}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{)}
\PYG{n}{var\PYGZus{}figs}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Create and modify charts with keep_plot_38_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxstepscope


\part{Onboarding MFMod models from .wf1}

\sphinxstepscope


\chapter{Onboard a model defined in a .wf1 file}
\label{\detokenize{content/howto/onboard/eviews/onboard one model from  wf1:onboard-a-model-defined-in-a-wf1-file}}\label{\detokenize{content/howto/onboard/eviews/onboard one model from  wf1:onboardone}}\label{\detokenize{content/howto/onboard/eviews/onboard one model from  wf1::doc}}
\sphinxAtStartPar
This notebook takes a .wf1 workfile and transform  it to a modelflow model.

\sphinxAtStartPar
The overall process is performed in a Dataclass named:\sphinxstylestrong{GrapWfModel}
Close study of this class can be rewarding, but is outside the need of most users.
The overall structure is:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Eviews is started and the wf1 file is loaded
\begin{itemize}
\item {} 
\sphinxAtStartPar
Some transformations are performed on data.

\item {} 
\sphinxAtStartPar
The model is unlinked

\item {} 
\sphinxAtStartPar
The workspace is saved as a wf2 file. Same name with \sphinxcode{\sphinxupquote{\_modelflow appended}}

\end{itemize}

\item {} 
\sphinxAtStartPar
Eviews is closed

\item {} 
\sphinxAtStartPar
The wf2 file is read as a json file.

\item {} 
\sphinxAtStartPar
Relevant objects are extracted.

\item {} 
\sphinxAtStartPar
The MFMSA variable is  extracted, to be saved in the dumpfile.

\item {} 
\sphinxAtStartPar
The equations are transformed and normalized to modelflow format and classified into identities and stochastic

\item {} 
\sphinxAtStartPar
Stochastic equations are enriched by add\_factor and fixing terms (dummy + fixing value)

\item {} 
\sphinxAtStartPar
For Stochastic equations new fitted variables are generated \sphinxhyphen{} without add add\_factors and dummies.

\item {} 
\sphinxAtStartPar
A model to generate fitted variables is created

\item {} 
\sphinxAtStartPar
A model to generate add\_factors is created.

\item {} 
\sphinxAtStartPar
A model encompassing the original equations, the model for fitted variables and for add\_factors is created.

\item {} 
\sphinxAtStartPar
The data series and scalars are shoveled into a Pandas dataframe
\begin{itemize}
\item {} 
\sphinxAtStartPar
Some special series are generated as the expression can not be incorporated into modelflow model specifications

\item {} 
\sphinxAtStartPar
The model for fitted values is simulated in the specified timespan

\item {} 
\sphinxAtStartPar
The model for add\_factors is simulated in the timespan set in MFMSA

\end{itemize}

\item {} 
\sphinxAtStartPar
The data descriptions are extracted into a dictionary.
\sphinxhyphen{} Data descriptions for dummies, fixed values, fitted values and add\_factors are derived.

\item {} 
\sphinxAtStartPar
Now we have a model and a dataframe with all variables which are needed.
b
The GrapWfModel instance in general keeps most of the steps so the developer can inspect the the different steps.

\end{enumerate}


\section{Prerequisites}
\label{\detokenize{content/howto/onboard/eviews/onboard one model from  wf1:prerequisites}}\begin{itemize}
\item {} 
\sphinxAtStartPar
Eviews version 12

\item {} 
\sphinxAtStartPar
The python library: \sphinxcode{\sphinxupquote{pyevies}}

\end{itemize}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZpc{}}\PYG{k}{matplotlib} Notebook
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{pathlib} \PYG{k+kn}{import} \PYG{n}{Path}

\PYG{k+kn}{from} \PYG{n+nn}{modelclass} \PYG{k+kn}{import} \PYG{n}{model} 
\PYG{k+kn}{from} \PYG{n+nn}{modelgrabwf2} \PYG{k+kn}{import} \PYG{n}{GrabWfModel}
\PYG{n}{model}\PYG{o}{.}\PYG{n}{widescreen}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{model}\PYG{o}{.}\PYG{n}{scroll\PYGZus{}off}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}IPython.core.display.HTML object\PYGZgt{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 \PYG{o}{\PYGZpc{}}\PYG{k}{load\PYGZus{}ext} autoreload
 \PYG{o}{\PYGZpc{}}\PYG{k}{autoreload} 2
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Model specific transformations}
\label{\detokenize{content/howto/onboard/eviews/onboard one model from  wf1:model-specific-transformations}}
\sphinxAtStartPar
Not all Eviews equations have a direct counterpart in modelflow.
To handle that two types of transformations can be provided for a specific model.
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{eviews\_run\_lines} which specifies a list of Eviews command lines to be run. Typical to make some transformation of data which is not possible in modelflow.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{country\_trans} which specifies a list of replacements to be done to the Eviews formulas before they are processed further. Typical to use the transformation mentioned above.

\end{itemize}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mda\PYGZus{}eviews\PYGZus{}run\PYGZus{}lines} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Scalar \PYGZus{}MDASBBREV\PYGZus{}at\PYGZus{}COEF\PYGZus{}2 = \PYGZus{}MDASBBREV.@COEF(+2)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{mda\PYGZus{}trans} \PYG{o}{=} \PYG{k}{lambda} \PYG{n+nb}{input}\PYG{p}{:} \PYG{n+nb}{input}\PYG{o}{.}\PYG{n}{replace}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZus{}MDAsbbrev.@coef(2)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZus{}MDASBBREV\PYGZus{}at\PYGZus{}COEF\PYGZus{}2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}   


\PYG{c+c1}{\PYGZsh{} Another example }
\PYG{n}{ago\PYGZus{}eviews\PYGZus{}run\PYGZus{}lines} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{smpl @ALL}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{series MEAN\PYGZus{}AGOBNCABFUNDCD\PYGZus{}DIV\PYGZus{}AGONYGDPMKTPCD = @MEAN(AGOBNCABFUNDCD/AGONYGDPMKTPCD,}\PYG{l+s+s1}{\PYGZdq{}}\PYG{l+s+s1}{2000 2020}\PYG{l+s+s1}{\PYGZdq{}}\PYG{l+s+s1}{)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{ago\PYGZus{}trans} \PYG{o}{=} \PYG{k}{lambda}  \PYG{n+nb}{input} \PYG{p}{:} \PYG{n+nb}{input}\PYG{o}{.}\PYG{n}{replace}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{@MEAN(AGOBNCABFUNDCD/AGONYGDPMKTPCD,}\PYG{l+s+s1}{\PYGZdq{}}\PYG{l+s+s1}{2000 2020}\PYG{l+s+s1}{\PYGZdq{}}\PYG{l+s+s1}{)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{MEAN\PYGZus{}AGOBNCABFUNDCD\PYGZus{}DIV\PYGZus{}AGONYGDPMKTPCD}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} 
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Process the model}
\label{\detokenize{content/howto/onboard/eviews/onboard one model from  wf1:process-the-model}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{all\PYGZus{}about\PYGZus{}mda} \PYG{o}{=} \PYG{n}{GrabWfModel}\PYG{p}{(}\PYG{l+s+sa}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{wfs}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{mdasoln.wf1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} 
                  \PYG{n}{eviews\PYGZus{}run\PYGZus{}lines}\PYG{o}{=} \PYG{n}{mda\PYGZus{}eviews\PYGZus{}run\PYGZus{}lines}\PYG{p}{,}
                  \PYG{n}{country\PYGZus{}trans}    \PYG{o}{=}  \PYG{n}{mda\PYGZus{}trans}\PYG{p}{,}
                    \PYG{n}{make\PYGZus{}fitted} \PYG{o}{=} \PYG{k+kc}{True}\PYG{p}{,}        \PYG{c+c1}{\PYGZsh{} make equatios for fitted values of stocastic equations }
                    \PYG{n}{do\PYGZus{}add\PYGZus{}factor\PYGZus{}calc}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,}   \PYG{c+c1}{\PYGZsh{} Calculate the add factors which makes the stocastic equations match    }
                    \PYG{n}{fit\PYGZus{}start} \PYG{o}{=} \PYG{l+m+mi}{2000}\PYG{p}{,}          \PYG{c+c1}{\PYGZsh{} Start of calculation of fittet model in baseline (to have some historic values) }
                    \PYG{n}{fit\PYGZus{}end}   \PYG{o}{=} \PYG{k+kc}{None}\PYG{p}{,}           \PYG{c+c1}{\PYGZsh{} end of calc for fittted model, if None taken from mdmfsa options  }
                    \PYG{n}{disable\PYGZus{}progress} \PYG{o}{=}\PYG{k+kc}{True}     \PYG{c+c1}{\PYGZsh{} Better for jupyter book }
                           \PYG{p}{)} 
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Reading c:\PYGZbs{}wb new\PYGZbs{}Modelflow\PYGZbs{}working\PYGZus{}paper\PYGZbs{}thebook\PYGZbs{}content\PYGZbs{}howto\PYGZbs{}onboard\PYGZbs{}eviews\PYGZbs{}wfs\PYGZbs{}mdasoln.wf1
Assummed model name: MDA
Eviewsline to run :Scalar \PYGZus{}MDASBBREV\PYGZus{}at\PYGZus{}COEF\PYGZus{}2 = \PYGZus{}MDASBBREV.@COEF(+2)
The model: MDA is unlinked 
Writing C:\PYGZbs{}wb new\PYGZbs{}Modelflow\PYGZbs{}working\PYGZus{}paper\PYGZbs{}thebook\PYGZbs{}content\PYGZbs{}howto\PYGZbs{}onboard\PYGZbs{}eviews\PYGZbs{}wfs\PYGZbs{}mdasoln\PYGZus{}modelflow.wf2
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Model name: MDA
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Processing the model:MDA
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
testmodel calculated  
Calculation of add factors for MDA calculated  
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Check if each equation on its own result in the values provided.}
\label{\detokenize{content/howto/onboard/eviews/onboard one model from  wf1:check-if-each-equation-on-its-own-result-in-the-values-provided}}
\sphinxAtStartPar
aka: residual check 
If they are not pretty close, something is very wrong.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{all\PYGZus{}about\PYGZus{}mda}\PYG{o}{.}\PYG{n}{test\PYGZus{}model}\PYG{p}{(}\PYG{n}{all\PYGZus{}about\PYGZus{}mda}\PYG{o}{.}\PYG{n}{start}\PYG{p}{,}\PYG{n}{all\PYGZus{}about\PYGZus{}mda}\PYG{o}{.}\PYG{n}{end}\PYG{p}{,}\PYG{n}{maxerr}\PYG{o}{=}\PYG{l+m+mi}{100}\PYG{p}{,}\PYG{n}{tol}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{showall}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}   \PYG{c+c1}{\PYGZsh{} tol determins the max acceptable absolute difference }
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
MDA calculated  

Chekking residuals for MDA 2014 to 2025
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Extract the model and the baseline}
\label{\detokenize{content/howto/onboard/eviews/onboard one model from  wf1:extract-the-model-and-the-baseline}}
\sphinxAtStartPar
\sphinxstylestrong{all\_about\_mda} has a lot of content including.
\begin{itemize}
\item {} 
\sphinxAtStartPar
.mmodel is the model instance

\item {} 
\sphinxAtStartPar
.base\_input is the baseline where the add factors and the fitted values are calculated

\end{itemize}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mmda}    \PYG{o}{=} \PYG{n}{all\PYGZus{}about\PYGZus{}mda}\PYG{o}{.}\PYG{n}{mmodel}       \PYG{c+c1}{\PYGZsh{} the model instance  }
\PYG{n}{baseline} \PYG{o}{=} \PYG{n}{all\PYGZus{}about\PYGZus{}mda}\PYG{o}{.}\PYG{n}{base\PYGZus{}input}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Run the model}
\label{\detokenize{content/howto/onboard/eviews/onboard one model from  wf1:run-the-model}}
\sphinxAtStartPar
In order to achieve numerical stability Gauss\sphinxhyphen{}Seidle has to be dampened: alfa=0.7 makes sure that the solution does not explode.
The convergence criteria is tightend a lot.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{res} \PYG{o}{=} \PYG{n}{mmda}\PYG{p}{(}\PYG{n}{all\PYGZus{}about\PYGZus{}mda}\PYG{o}{.}\PYG{n}{base\PYGZus{}input}\PYG{p}{,}\PYG{l+m+mi}{2016}\PYG{p}{,}\PYG{l+m+mi}{2040}\PYG{p}{,}\PYG{n}{silent}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{alfa}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{ldumpvar}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{n}{mmda}\PYG{o}{.}\PYG{n}{basedf} \PYG{o}{=} \PYG{n}{all\PYGZus{}about\PYGZus{}mda}\PYG{o}{.}\PYG{n}{base\PYGZus{}input}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{And the simulation result is also fine.}
\label{\detokenize{content/howto/onboard/eviews/onboard one model from  wf1:and-the-simulation-result-is-also-fine}}
\sphinxAtStartPar
Here the percent difference is displayed

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mmda}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mdaGGEXPCAPTCN mdaNYGDPMKTPCN mdaGGDBTTOTLCN mdaBNCABFUNDCD}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Tab(children=(Tab(children=(HTML(value=\PYGZsq{}\PYGZlt{}?xml version=\PYGZdq{}1.0\PYGZdq{} encoding=\PYGZdq{}utf\PYGZhy{}8\PYGZdq{} standalone=\PYGZdq{}no\PYGZdq{}?\PYGZgt{}\PYGZbs{}n\PYGZlt{}!DOCTYPE svg ‚Ä¶
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Look at a stochastic variable}
\label{\detokenize{content/howto/onboard/eviews/onboard one model from  wf1:look-at-a-stochastic-variable}}
\sphinxAtStartPar
Here the equations undergo more phases

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{all\PYGZus{}about\PYGZus{}mda}\PYG{o}{.}\PYG{n}{all\PYGZus{}frml\PYGZus{}dict}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{MDABFCAFCAPTCD}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{fprint}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Endo\PYGZus{}var        : MDABFCAFCAPTCD
Original        : MDABFCAFCAPTCD/(MDANYGDPMKTPCN/MDAPANUSATLS)=0.00282736002227067
Preprocessed    : MDABFCAFCAPTCD/(MDANYGDPMKTPCN/MDAPANUSATLS)=0.00282736002227067
Normalized      : MDABFCAFCAPTCD = (MDABFCAFCAPTCD\PYGZus{}A*MDANYGDPMKTPCN/MDAPANUSATLS+MDANYGDPMKTPCN* (0.00282736002227067) /MDAPANUSATLS) * (1\PYGZhy{}MDABFCAFCAPTCD\PYGZus{}D)+ MDABFCAFCAPTCD\PYGZus{}X*MDABFCAFCAPTCD\PYGZus{}D 
Calc\PYGZus{}add\PYGZus{}factor : MDABFCAFCAPTCD\PYGZus{}A = MDABFCAFCAPTCD*MDAPANUSATLS/MDANYGDPMKTPCN\PYGZhy{} ((0.00282736002227067)) 
Fitted          : MDABFCAFCAPTCD\PYGZus{}FITTED = MDANYGDPMKTPCN* (0.00282736002227067) /MDAPANUSATLS
Eviews          : MDABFCAFCAPTCD/(MDANYGDPMKTPCN/MDAPANUSATLS) = 0.00282736002227067
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Look a all the modelflow frmls}
\label{\detokenize{content/howto/onboard/eviews/onboard one model from  wf1:look-a-all-the-modelflow-frmls}}
\sphinxAtStartPar
Notice after the ‚Äúoriginal‚Äù model the equations for the ‚Äúfitted‚Äù values have been added. 
Also in the end of the listing the specification of the model which calculates the add factors if a variable is fixed. When processing the equations the \sphinxcode{\sphinxupquote{model}} class will process this this model separately and create a model instance
which is used to calculate add factors in case

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{mmda}\PYG{o}{.}\PYG{n}{equations}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
FRML  \PYGZlt{}\PYGZgt{} MDAPSTAR = (1/MDANYGDPTFP)**(1/MDANYYWBTOTL\PYGZus{})*(MDANYWRTTOTLXN/MDANYYWBTOTL\PYGZus{})*(MDANYGDPPOTLKN/MDANEGDIKSTKKN)**((1\PYGZhy{}MDANYYWBTOTL\PYGZus{})/MDANYYWBTOTL\PYGZus{}) \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDAGR = ((log(MDANYGDPTFP))\PYGZhy{}(log(MDANYGDPTFP(\PYGZhy{}1))))/MDANYYWBTOTL\PYGZus{}+((log(MDASPPOPWORK))\PYGZhy{}(log(MDASPPOPWORK(\PYGZhy{}1)))) \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDANYGDPFCSTXN = (MDANYGDPFCSTXN(\PYGZhy{}1)*EXP(MDANYGDPFCSTXN\PYGZus{}A+ (0.197543704108975*((LOG(MDANYGDPFCSTXN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}2))))+(1\PYGZhy{}0.197543704108975)*(0.3*MDAINFLEXPT/100+(1\PYGZhy{}0.3)*((LOG(MDAPSTAR))\PYGZhy{}(LOG(MDAPSTAR(\PYGZhy{}1)))))+0.3*MDANYGDPGAP\PYGZus{}/100+0.0103490916251564*DURING\PYGZus{}2011\PYGZhy{}0.119727211086869*DURING\PYGZus{}2009) )) * (1\PYGZhy{}MDANYGDPFCSTXN\PYGZus{}D)+ MDANYGDPFCSTXN\PYGZus{}X*MDANYGDPFCSTXN\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDAFMLBLPOLYXN = (100*MDAFMLBLPOLYXN\PYGZus{}A+100* (0.7*MDAFMLBLPOLYXN(\PYGZhy{}1)/100+(1\PYGZhy{}0.7)*(0.108512280547198+1.5*(((LOG(MDANECONPRVTXN))\PYGZhy{}(LOG(MDANECONPRVTXN(\PYGZhy{}1))))\PYGZhy{}MDAINFLEXPT/100)+0.6*MDANYGDPGAP\PYGZus{}/100)) ) * (1\PYGZhy{}MDAFMLBLPOLYXN\PYGZus{}D)+ MDAFMLBLPOLYXN\PYGZus{}X*MDAFMLBLPOLYXN\PYGZus{}D  \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDAINTRDXN = MDAFMLBLPOLYXN+MDAINTRDDIFF \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDAINTREXN = MDAUSAFMLBLPOLYFR+MDAINTREDIFF \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDAFMLBLLENDXN = MDAFMLBLPOLYXN+MDAINTRLENDDIFF \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDANECONPRVTKN = (MDANECONPRVTKN(\PYGZhy{}1)*EXP(MDANECONPRVTKN\PYGZus{}A+ (\PYGZhy{}0.534235170141198*(LOG(MDANECONPRVTKN(\PYGZhy{}1))\PYGZhy{}LOG(((1\PYGZhy{}MDAGGREVTPITXN/100)*(1\PYGZhy{}MDAGGREVSSOCXN/100)*MDANYYWBTOTLCN(\PYGZhy{}1)+MDAGGEXPTRNSCN(\PYGZhy{}1)+MDABNFSTSTRNCD(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1)+MDABNFSTPCOECD(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1))/MDANECONPRVTXN(\PYGZhy{}1)))+0.571611921075017*((LOG(((1\PYGZhy{}MDAGGREVTPITXN/100)*(1\PYGZhy{}MDAGGREVSSOCXN/100)*MDANYYWBTOTLCN+MDAGGEXPTRNSCN+MDABNFSTSTRNCD*MDAPANUSATLS+MDABNFSTPCOECD*MDAPANUSATLS)/MDANECONPRVTXN))\PYGZhy{}(LOG(((1\PYGZhy{}MDAGGREVTPITXN(\PYGZhy{}1)/100)*(1\PYGZhy{}MDAGGREVSSOCXN(\PYGZhy{}1)/100)*MDANYYWBTOTLCN(\PYGZhy{}1)+MDAGGEXPTRNSCN(\PYGZhy{}1)+MDABNFSTSTRNCD(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1)+MDABNFSTPCOECD(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1))/MDANECONPRVTXN(\PYGZhy{}1))))+(1\PYGZhy{}0.571611921075017)*MDAGR+0.0302887358479325) )) * (1\PYGZhy{}MDANECONPRVTKN\PYGZus{}D)+ MDANECONPRVTKN\PYGZus{}X*MDANECONPRVTKN\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDANECONPRVTXN = (MDANECONPRVTXN(\PYGZhy{}1)*EXP(MDANECONPRVTXN\PYGZus{}A+ (\PYGZhy{}0.35*(LOG(MDANECONPRVTXN(\PYGZhy{}1))\PYGZhy{}0.829507589240535*LOG(MDANYGDPFCSTXN(\PYGZhy{}1))\PYGZhy{}(1\PYGZhy{}0.829507589240535)*LOG(MDANEIMPGNFSXN(\PYGZhy{}1))\PYGZhy{}LOG(1+MDAGGREVVATDXN(\PYGZhy{}1)/100))+0.774735420555399*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))+(1\PYGZhy{}0.774735420555399)*((LOG(MDANEIMPGNFSXN))\PYGZhy{}(LOG(MDANEIMPGNFSXN(\PYGZhy{}1))))\PYGZhy{}0.0128830876051222+((MDAGGREVVATDXN/100)\PYGZhy{}(MDAGGREVVATDXN(\PYGZhy{}1)/100))) )) * (1\PYGZhy{}MDANECONPRVTXN\PYGZus{}D)+ MDANECONPRVTXN\PYGZus{}X*MDANECONPRVTXN\PYGZus{}D  \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANECONPRVTCN = MDANECONPRVTKN*MDANECONPRVTXN \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDANECONGOVTCN = (MDANECONGOVTCN\PYGZus{}A+ (((MDAGGEXPGNFSCN+MDAGGEXPWAGECN)\PYGZhy{}(MDAGGEXPGNFSCN(\PYGZhy{}1)+MDAGGEXPWAGECN(\PYGZhy{}1)))*MDANECONGOVTCOV\PYGZus{}/100+78.9812762019829*DUMH) +MDANECONGOVTCN(\PYGZhy{}1)) * (1\PYGZhy{}MDANECONGOVTCN\PYGZus{}D)+ MDANECONGOVTCN\PYGZus{}X*MDANECONGOVTCN\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDANECONGOVTXN = (MDANECONGOVTXN(\PYGZhy{}1)*EXP(MDANECONGOVTXN\PYGZus{}A+ (\PYGZhy{}0.35*(LOG(MDANECONGOVTXN(\PYGZhy{}1))\PYGZhy{}LOG(MDANECONPRVTXN(\PYGZhy{}1))\PYGZhy{}LOG(1+MDAGGREVVATDXN(\PYGZhy{}1)/100))\PYGZhy{}0.435409373323052+((LOG(MDANECONPRVTXN))\PYGZhy{}(LOG(MDANECONPRVTXN(\PYGZhy{}1))))+0.0136318410176717*T\PYGZus{}LR+((MDAGGREVVATDXN/100)\PYGZhy{}(MDAGGREVVATDXN(\PYGZhy{}1)/100))) )) * (1\PYGZhy{}MDANECONGOVTXN\PYGZus{}D)+ MDANECONGOVTXN\PYGZus{}X*MDANECONGOVTXN\PYGZus{}D  \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANECONGOVTKN = MDANECONGOVTCN/MDANECONGOVTXN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANECONTOTLCN = MDANECONPRVTCN+MDANECONGOVTCN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANECONTOTLKN = MDANECONPRVTKN+MDANECONGOVTKN \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDANEGDIFTOTXN = (MDANEGDIFTOTXN(\PYGZhy{}1)*EXP(MDANEGDIFTOTXN\PYGZus{}A+ (\PYGZhy{}0.618632444397103*(LOG(MDANEGDIFTOTXN(\PYGZhy{}1))\PYGZhy{}0.574681347908539*LOG(MDANYGDPFCSTXN(\PYGZhy{}1))\PYGZhy{}(1\PYGZhy{}0.574681347908539)*LOG(MDANEIMPGNFSXN(\PYGZhy{}1)))+0.00252520630407499+0.435002280297711*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))+(1\PYGZhy{}0.435002280297711)*((LOG(MDANEIMPGNFSXN))\PYGZhy{}(LOG(MDANEIMPGNFSXN(\PYGZhy{}1))))) )) * (1\PYGZhy{}MDANEGDIFTOTXN\PYGZus{}D)+ MDANEGDIFTOTXN\PYGZus{}X*MDANEGDIFTOTXN\PYGZus{}D  \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANEGDIFGOVCN = MDAGGEXPCAPTCN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANEGDIFPRVCN = MDANEGDIFPRVKN*MDANEGDIFTOTXN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANEGDIFGOVKN = MDANEGDIFGOVCN/MDANEGDIFTOTXN \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDANEGDIFPRVKN = (MDANEGDIFPRVKN(\PYGZhy{}1)*EXP(MDANEGDIFPRVKN\PYGZus{}A+ (\PYGZhy{}0.312870852277258*(LOG(MDANEGDIFTOTKN(\PYGZhy{}1))\PYGZhy{}LOG(MDANYGDPPOTLKN(\PYGZhy{}1)))\PYGZhy{}0.537020065044523+0.220071067703888*((LOG(MDANEGDIFPRVKN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDANEGDIFPRVKN(\PYGZhy{}2))))+(1\PYGZhy{}0.220071067703888)*(((LOG(MDANEGDETTOTKN\PYGZhy{}MDANEGDIFTOTKN))\PYGZhy{}(LOG(MDANEGDETTOTKN(\PYGZhy{}1)\PYGZhy{}MDANEGDIFTOTKN(\PYGZhy{}1))))\PYGZhy{}0.15*((LOG(MDANEKRTTOTLXN))\PYGZhy{}(LOG(MDANEKRTTOTLXN(\PYGZhy{}1)))))\PYGZhy{}0.266889444067425*DURING\PYGZus{}2008+0.00424042413096946*T\PYGZus{}LR) )) * (1\PYGZhy{}MDANEGDIFPRVKN\PYGZus{}D)+ MDANEGDIFPRVKN\PYGZus{}X*MDANEGDIFPRVKN\PYGZus{}D  \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANEKRTTOTLXN = (1\PYGZhy{}MDADEPR/(1\PYGZhy{}MDAGGREVTCITXN/100))*((1\PYGZhy{}MDAGGREVTCITXN/100)*MDAFMLBLLENDXN/100+MDADEPR\PYGZhy{}(1\PYGZhy{}MDADEPR)*MDAINFLEXPT/100)*MDANYGDPFCSTXN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANEGDIFTOTCN = MDANEGDIFGOVCN+MDANEGDIFPRVCN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANEGDIFTOTKN = MDANEGDIFPRVKN+MDANEGDIFGOVKN \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDANEEXPGNFSKN = (MDANEEXPGNFSKN(\PYGZhy{}1)*EXP(MDANEEXPGNFSKN\PYGZus{}A+ (\PYGZhy{}0.336730629453757*(LOG(MDANEEXPGNFSKN(\PYGZhy{}1))\PYGZhy{}LOG(MDAXMKT(\PYGZhy{}1))+0.2*LOG(MDANEEXPGNFSXN(\PYGZhy{}1)/(MDANYGDPFCSTXN(\PYGZhy{}1))))+((LOG(MDAXMKT))\PYGZhy{}(LOG(MDAXMKT(\PYGZhy{}1))))\PYGZhy{}0.345691440406372*((LOG(MDANEEXPGNFSXN/MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANEEXPGNFSXN(\PYGZhy{}1)/MDANYGDPFCSTXN(\PYGZhy{}1))))+2.84032004924203+0.015458379408832*T\PYGZus{}LR) )) * (1\PYGZhy{}MDANEEXPGNFSKN\PYGZus{}D)+ MDANEEXPGNFSKN\PYGZus{}X*MDANEEXPGNFSKN\PYGZus{}D  \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANEEXPOTHRKN = MDANEEXPGNFSKN\PYGZhy{}MDANEEXPAGRTKN \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDANEEXPGNFSXN = (MDANEEXPGNFSXN(\PYGZhy{}1)*EXP(MDANEEXPGNFSXN\PYGZus{}A+ (\PYGZhy{}0.689680638262842*(LOG(MDANEEXPGNFSXN(\PYGZhy{}1))\PYGZhy{}0.603631334048721*LOG(MDANYGDPFCSTXN(\PYGZhy{}1))\PYGZhy{}(1\PYGZhy{}0.603631334048721)*LOG(MDAPXKEY(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1)))+1.06714218353871*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))+(1\PYGZhy{}1.06714218353871)*((LOG(MDAPXKEY*MDAPANUSATLS))\PYGZhy{}(LOG(MDAPXKEY(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1))))+0.0593246295410032\PYGZhy{}0.0247522128533159*T\PYGZus{}LR) )) * (1\PYGZhy{}MDANEEXPGNFSXN\PYGZus{}D)+ MDANEEXPGNFSXN\PYGZus{}X*MDANEEXPGNFSXN\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDANEEXPAGRTXN = (MDANEEXPAGRTXN(\PYGZhy{}1)*EXP(MDANEEXPAGRTXN\PYGZus{}A+ (\PYGZhy{}0.3*(LOG(MDANEEXPAGRTXN(\PYGZhy{}1))\PYGZhy{}(1\PYGZhy{}1.3186882875842)*LOG(MDANYGDPFCSTXN(\PYGZhy{}1))\PYGZhy{}1.3186882875842*LOG(MDAWLDFAGRTOTLXD(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1)))\PYGZhy{}2.85770216483863+1.3186882875842*((LOG(MDAWLDFAGRTOTLXD*MDAPANUSATLS))\PYGZhy{}(LOG(MDAWLDFAGRTOTLXD(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1))))+(1\PYGZhy{}1.3186882875842)*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))) )) * (1\PYGZhy{}MDANEEXPAGRTXN\PYGZus{}D)+ MDANEEXPAGRTXN\PYGZus{}X*MDANEEXPAGRTXN\PYGZus{}D  \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANEEXPOTHRXN = MDANEEXPOTHRCN/MDANEEXPOTHRKN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANEEXPGNFSCN = MDANEEXPGNFSXN*MDANEEXPGNFSKN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANEEXPAGRTCN = MDANEEXPAGRTXN*MDANEEXPAGRTKN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANEEXPOTHRCN = MDANEEXPGNFSCN\PYGZhy{}MDANEEXPAGRTCN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDAXMKT\PYGZus{}GR = 0.431710914* (100 * ( (MDAROUNYGDPMKTPKN) / (MDAROUNYGDPMKTPKN(\PYGZhy{}1)) \PYGZhy{}1)) +0.357817109* (100 * ( (MDADEUNYGDPMKTPKN) / (MDADEUNYGDPMKTPKN(\PYGZhy{}1)) \PYGZhy{}1)) +0.119174041* (100 * ( (MDARUSNYGDPMKTPKN) / (MDARUSNYGDPMKTPKN(\PYGZhy{}1)) \PYGZhy{}1)) +0.04380531* (100 * ( (MDAUKRNYGDPMKTPKN) / (MDAUKRNYGDPMKTPKN(\PYGZhy{}1)) \PYGZhy{}1)) +0.047492625* (100 * ( (MDABLRNYGDPMKTPKN) / (MDABLRNYGDPMKTPKN(\PYGZhy{}1)) \PYGZhy{}1)) \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDAXMKT = MDAXMKT(\PYGZhy{}1)*(1+MDAXMKT\PYGZus{}GR/100) \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANEIMPFUELXN = MDANEIMPFUELXN(\PYGZhy{}1)*(MDAWLDFCRUDE\PYGZus{}PETRO*MDAPANUSATLS)/(MDAWLDFCRUDE\PYGZus{}PETRO(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1)) \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANEIMPFUELCN = MDANEIMPFUELKN*MDANEIMPFUELXN \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDANEIMPGNFSKN = (MDANEIMPGNFSKN(\PYGZhy{}1)*EXP(MDANEIMPGNFSKN\PYGZus{}A+ (\PYGZhy{}0.218751344210448*(LOG(MDANEIMPGNFSKN(\PYGZhy{}1))\PYGZhy{}LOG(MDANEGDETTOTKN(\PYGZhy{}1))+0.248762098352762*LOG(MDANEIMPGNFSXN(\PYGZhy{}1)/(MDANYGDPFCSTXN(\PYGZhy{}1))))+(((LOG(MDANEGDETTOTKN))\PYGZhy{}(LOG(MDANEGDETTOTKN(\PYGZhy{}1))))\PYGZhy{}((LOG(MDANYGDPPOTLKN))\PYGZhy{}(LOG(MDANYGDPPOTLKN(\PYGZhy{}1)))))+MDAGR\PYGZhy{}0.248762098352762*((LOG(MDANEIMPGNFSXN/MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANEIMPGNFSXN(\PYGZhy{}1)/MDANYGDPFCSTXN(\PYGZhy{}1))))\PYGZhy{}0.336531838649722+0.00576104613986022*T\PYGZus{}LR) )) * (1\PYGZhy{}MDANEIMPGNFSKN\PYGZus{}D)+ MDANEIMPGNFSKN\PYGZus{}X*MDANEIMPGNFSKN\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDANEIMPGNFSXN = (MDANEIMPGNFSXN(\PYGZhy{}1)*EXP(MDANEIMPGNFSXN\PYGZus{}A+ (\PYGZhy{}0.564370575830738*(LOG(MDANEIMPGNFSXN(\PYGZhy{}1))\PYGZhy{}0.25*LOG(MDANYGDPFCSTXN(\PYGZhy{}1))\PYGZhy{}(1\PYGZhy{}0.25)*LOG(MDAPMKEY(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1))\PYGZhy{}LOG(1+MDAGGREVVATMXN(\PYGZhy{}1)/100))+0.25*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))+(1\PYGZhy{}0.25)*((LOG(MDAPMKEY*MDAPANUSATLS))\PYGZhy{}(LOG(MDAPMKEY(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1))))\PYGZhy{}1.18325081713964+((MDAGGREVVATMXN/100)\PYGZhy{}(MDAGGREVVATMXN(\PYGZhy{}1)/100))) )) * (1\PYGZhy{}MDANEIMPGNFSXN\PYGZus{}D)+ MDANEIMPGNFSXN\PYGZus{}X*MDANEIMPGNFSXN\PYGZus{}D  \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANEIMPGNFSCN = MDANEIMPGNFSKN*MDANEIMPGNFSXN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANEIMPOTHRCN = MDANEIMPGNFSCN\PYGZhy{}MDANEIMPFUELCN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANEIMPOTHRKN = MDANEIMPGNFSKN\PYGZhy{}MDANEIMPFUELKN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANEIMPOTHRXN = MDANEIMPOTHRCN/MDANEIMPOTHRKN \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDALMEMPTOTL = (MDALMEMPTOTL(\PYGZhy{}1)*EXP(MDALMEMPTOTL\PYGZus{}A+ (\PYGZhy{}0.183075987473735*(LOG(MDALMEMPTOTL(\PYGZhy{}1))\PYGZhy{}LOG(MDALMEMPSTRL(\PYGZhy{}1)))+((LOG(MDALMEMPSTRL))\PYGZhy{}(LOG(MDALMEMPSTRL(\PYGZhy{}1))))+0.581694127104354*(((LOG(MDANYGDPMKTPKN))\PYGZhy{}(LOG(MDANYGDPMKTPKN(\PYGZhy{}1))))\PYGZhy{}MDAGR)\PYGZhy{}0.688544000289914*(((LOG(MDANYWRTTOTLXN/MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYWRTTOTLXN(\PYGZhy{}1)/MDANYGDPFCSTXN(\PYGZhy{}1))))\PYGZhy{}((LOG(MDANYGDPTFP))\PYGZhy{}(LOG(MDANYGDPTFP(\PYGZhy{}1))))/MDANYYWBTOTL\PYGZus{})) )) * (1\PYGZhy{}MDALMEMPTOTL\PYGZus{}D)+ MDALMEMPTOTL\PYGZus{}X*MDALMEMPTOTL\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDANYWRTTOTLXN = (MDANYWRTTOTLXN(\PYGZhy{}1)*EXP(MDANYWRTTOTLXN\PYGZus{}A+ (((LOG(MDANECONPRVTXN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDANECONPRVTXN(\PYGZhy{}2))))+((LOG(MDANYGDPPOTLKN/MDALMEMPSTRL))\PYGZhy{}(LOG(MDANYGDPPOTLKN(\PYGZhy{}1)/MDALMEMPSTRL(\PYGZhy{}1))))\PYGZhy{}0.5*(MDALMUNRTOTL\PYGZus{}\PYGZhy{}MDALMUNRSTRL\PYGZus{})/100\PYGZhy{}0.26929290393266*DURING\PYGZus{}2009) )) * (1\PYGZhy{}MDANYWRTTOTLXN\PYGZus{}D)+ MDANYWRTTOTLXN\PYGZus{}X*MDANYWRTTOTLXN\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDALMPRTTOTL\PYGZus{} = (MDALMPRTTOTL\PYGZus{}\PYGZus{}A+ (0.415124722480563*(MDALMPRTTOTL\PYGZus{}(\PYGZhy{}1))+(1\PYGZhy{}0.415124722480563)*(MDALMPRTSTRL\PYGZus{})) ) * (1\PYGZhy{}MDALMPRTTOTL\PYGZus{}\PYGZus{}D)+ MDALMPRTTOTL\PYGZus{}\PYGZus{}X*MDALMPRTTOTL\PYGZus{}\PYGZus{}D  \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDALMLBFTOTL = MDALMPRTTOTL\PYGZus{}/100*MDASPPOPWORK \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDALMEMPSTRL = (1\PYGZhy{}MDALMUNRSTRL\PYGZus{}/100)*(MDALMPRTSTRL\PYGZus{}/100*MDASPPOPWORK) \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDALMUNRTOTL\PYGZus{} = (1\PYGZhy{}MDALMEMPTOTL/(MDALMPRTTOTL\PYGZus{}/100*MDASPPOPWORK))*100 \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANYYWBTOTLCN = MDANYWRTTOTLXN*MDALMEMPTOTL \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDAGGREVTOTLCN = MDAGGREVTPITCN+MDAGGREVTCITCN+MDAGGREVVATDCN+MDAGGREVVATMCN+MDAGGREVVATXCN+MDAGGREVGRNTCN+MDAGGREVSSOCCN+MDAGGREVTRDECN+MDAGGREVOTHRCN \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDAGGREVTCITCN = (MDAGGREVTCITCN\PYGZus{}A*MDAGGREVTCITCN(\PYGZhy{}1)/100+ (1* (100 * ( (MDAGGREVTCITXN/100*MDANYGDPMKTPCN) / (MDAGGREVTCITXN(\PYGZhy{}1)/100*MDANYGDPMKTPCN(\PYGZhy{}1)) \PYGZhy{}1))) *MDAGGREVTCITCN(\PYGZhy{}1)/100+MDAGGREVTCITCN(\PYGZhy{}1)) * (1\PYGZhy{}MDAGGREVTCITCN\PYGZus{}D)+ MDAGGREVTCITCN\PYGZus{}X*MDAGGREVTCITCN\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDAGGREVTPITCN = (MDAGGREVTPITCN\PYGZus{}A*MDAGGREVTPITCN(\PYGZhy{}1)/100+ (1* (100 * ( (MDAGGREVTPITXN/100*MDANYYWBTOTLCN) / (MDAGGREVTPITXN(\PYGZhy{}1)/100*MDANYYWBTOTLCN(\PYGZhy{}1)) \PYGZhy{}1))) *MDAGGREVTPITCN(\PYGZhy{}1)/100+MDAGGREVTPITCN(\PYGZhy{}1)) * (1\PYGZhy{}MDAGGREVTPITCN\PYGZus{}D)+ MDAGGREVTPITCN\PYGZus{}X*MDAGGREVTPITCN\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDAGGREVSSOCCN = (MDAGGREVSSOCCN\PYGZus{}A*MDAGGREVSSOCCN(\PYGZhy{}1)/100+ (1* (100 * ( (MDAGGREVSSOCXN/100*MDANYYWBTOTLCN) / (MDAGGREVSSOCXN(\PYGZhy{}1)/100*MDANYYWBTOTLCN(\PYGZhy{}1)) \PYGZhy{}1))) *MDAGGREVSSOCCN(\PYGZhy{}1)/100+MDAGGREVSSOCCN(\PYGZhy{}1)) * (1\PYGZhy{}MDAGGREVSSOCCN\PYGZus{}D)+ MDAGGREVSSOCCN\PYGZus{}X*MDAGGREVSSOCCN\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDAGGREVVATDCN = (MDAGGREVVATDCN\PYGZus{}A*MDAGGREVVATDCN(\PYGZhy{}1)/100+ (1* (100 * ( (MDAGGREVVATDXN/100*(MDANECONPRVTCN+MDANECONGOVTCN)) / (MDAGGREVVATDXN(\PYGZhy{}1)/100*(MDANECONPRVTCN(\PYGZhy{}1)+MDANECONGOVTCN(\PYGZhy{}1))) \PYGZhy{}1))) *MDAGGREVVATDCN(\PYGZhy{}1)/100+MDAGGREVVATDCN(\PYGZhy{}1)) * (1\PYGZhy{}MDAGGREVVATDCN\PYGZus{}D)+ MDAGGREVVATDCN\PYGZus{}X*MDAGGREVVATDCN\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDAGGREVVATMCN = (MDAGGREVVATMCN\PYGZus{}A*MDAGGREVVATMCN(\PYGZhy{}1)/100+ (1* (100 * ( (MDAGGREVVATMXN/100*(MDANEIMPGNFSCN)) / (MDAGGREVVATMXN(\PYGZhy{}1)/100*(MDANEIMPGNFSCN(\PYGZhy{}1))) \PYGZhy{}1))) *MDAGGREVVATMCN(\PYGZhy{}1)/100+MDAGGREVVATMCN(\PYGZhy{}1)) * (1\PYGZhy{}MDAGGREVVATMCN\PYGZus{}D)+ MDAGGREVVATMCN\PYGZus{}X*MDAGGREVVATMCN\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDAGGREVVATXCN = (MDAGGREVVATXCN\PYGZus{}A*MDANECONGOVTCN/100+MDAGGREVVATXCN\PYGZus{}A*MDANECONPRVTCN/100+MDANECONGOVTCN* (2.57630681423735) /100+MDANECONPRVTCN* (2.57630681423735) /100) * (1\PYGZhy{}MDAGGREVVATXCN\PYGZus{}D)+ MDAGGREVVATXCN\PYGZus{}X*MDAGGREVVATXCN\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDAGGREVTRDECN = (MDAGGREVTRDECN\PYGZus{}A*MDANEEXPGNFSCN/100+MDAGGREVTRDECN\PYGZus{}A*MDANEIMPGNFSCN/100+MDANEEXPGNFSCN* (1.25164890853099) /100+MDANEIMPGNFSCN* (1.25164890853099) /100) * (1\PYGZhy{}MDAGGREVTRDECN\PYGZus{}D)+ MDAGGREVTRDECN\PYGZus{}X*MDAGGREVTRDECN\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDAGGREVGRNTCN = (MDAGGREVGRNTCN\PYGZus{}A*MDANYGDPMKTPCN/100+MDANYGDPMKTPCN* (0.862196453658808) /100) * (1\PYGZhy{}MDAGGREVGRNTCN\PYGZus{}D)+ MDAGGREVGRNTCN\PYGZus{}X*MDAGGREVGRNTCN\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDAGGREVOTHRCN = (MDAGGREVOTHRCN\PYGZus{}A*MDANYGDPMKTPCN/100+MDANYGDPMKTPCN* (3.11360965029002) /100) * (1\PYGZhy{}MDAGGREVOTHRCN\PYGZus{}D)+ MDAGGREVOTHRCN\PYGZus{}X*MDAGGREVOTHRCN\PYGZus{}D  \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDAGGEXPTOTLCN = MDAGGEXPCRNTCN+MDAGGEXPCAPTCN+MDAGGEXPOTHRCN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDAGGEXPCRNTCN = MDAGGEXPWAGECN+MDAGGEXPGNFSCN+MDAGGEXPINTPCN+MDAGGEXPTRNSCN+MDAGGEXPCRNOCN \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDAGGEXPWAGECN = (MDANYGDPMKTPXN*MDAGGEXPWAGECN(\PYGZhy{}1)*EXP(MDAGGEXPWAGECN\PYGZus{}A+ (\PYGZhy{}0.3*(LOG(MDAGGEXPWAGECN(\PYGZhy{}1)/MDANYGDPMKTPXN(\PYGZhy{}1))\PYGZhy{}LOG(MDANYGDPPOTLKN(\PYGZhy{}1)))\PYGZhy{}0.0832410088126464*((LOG(MDAGGEXPWAGECN(\PYGZhy{}1)/MDANYGDPMKTPXN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDAGGEXPWAGECN(\PYGZhy{}2)/MDANYGDPMKTPXN(\PYGZhy{}2))))+(1+0.0832410088126464)*MDAGR\PYGZhy{}0.773634130131987) )/MDANYGDPMKTPXN(\PYGZhy{}1)) * (1\PYGZhy{}MDAGGEXPWAGECN\PYGZus{}D)+ MDAGGEXPWAGECN\PYGZus{}X*MDAGGEXPWAGECN\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDAGGEXPGNFSCN = (MDANYGDPMKTPXN*MDAGGEXPGNFSCN(\PYGZhy{}1)*EXP(MDAGGEXPGNFSCN\PYGZus{}A+ (\PYGZhy{}0.3*(LOG(MDAGGEXPGNFSCN(\PYGZhy{}1)/MDANYGDPMKTPXN(\PYGZhy{}1))\PYGZhy{}LOG(MDANYGDPPOTLKN(\PYGZhy{}1)))\PYGZhy{}0.244712417380816*((LOG(MDAGGEXPGNFSCN(\PYGZhy{}1)/MDANYGDPMKTPXN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDAGGEXPGNFSCN(\PYGZhy{}2)/MDANYGDPMKTPXN(\PYGZhy{}2))))+(1+0.244712417380816)*MDAGR\PYGZhy{}0.806178876325669) )/MDANYGDPMKTPXN(\PYGZhy{}1)) * (1\PYGZhy{}MDAGGEXPGNFSCN\PYGZus{}D)+ MDAGGEXPGNFSCN\PYGZus{}X*MDAGGEXPGNFSCN\PYGZus{}D  \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDAGGEXPINTPCN = MDAGGEXPINTECN+MDAGGEXPINTDCN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDAGGEXPINTECN = MDAGGDBTEXTLCN(\PYGZhy{}1)*MDAINTREXN/100 \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDAGGEXPINTDCN = MDAGGDBTDOMTCN(\PYGZhy{}1)*MDAINTRDXN/100 \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDAGGEXPTRNSCN = (MDANYGDPMKTPXN*MDAGGEXPTRNSCN(\PYGZhy{}1)*EXP(MDAGGEXPTRNSCN\PYGZus{}A+ (\PYGZhy{}0.3*(LOG(MDAGGEXPTRNSCN(\PYGZhy{}1)/MDANYGDPMKTPXN(\PYGZhy{}1))\PYGZhy{}LOG(MDANYGDPPOTLKN(\PYGZhy{}1)))\PYGZhy{}0.475511831460235*((LOG(MDAGGEXPTRNSCN(\PYGZhy{}1)/MDANYGDPMKTPXN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDAGGEXPTRNSCN(\PYGZhy{}2)/MDANYGDPMKTPXN(\PYGZhy{}2))))+(1+0.475511831460235)*MDAGR\PYGZhy{}0.640727459385319) )/MDANYGDPMKTPXN(\PYGZhy{}1)) * (1\PYGZhy{}MDAGGEXPTRNSCN\PYGZus{}D)+ MDAGGEXPTRNSCN\PYGZus{}X*MDAGGEXPTRNSCN\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDAGGEXPCAPTCN = (MDANYGDPMKTPXN*MDAGGEXPCAPTCN(\PYGZhy{}1)*EXP(MDAGGEXPCAPTCN\PYGZus{}A+ (\PYGZhy{}0.3*(LOG(MDAGGEXPCAPTCN(\PYGZhy{}1)/MDANYGDPMKTPXN(\PYGZhy{}1))\PYGZhy{}LOG(MDANYGDPPOTLKN(\PYGZhy{}1)))+0.27663427827676*((LOG(MDAGGEXPCAPTCN(\PYGZhy{}1)/MDANYGDPMKTPXN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDAGGEXPCAPTCN(\PYGZhy{}2)/MDANYGDPMKTPXN(\PYGZhy{}2))))+(1\PYGZhy{}0.27663427827676)*MDAGR\PYGZhy{}1.03766125029565) )/MDANYGDPMKTPXN(\PYGZhy{}1)) * (1\PYGZhy{}MDAGGEXPCAPTCN\PYGZus{}D)+ MDAGGEXPCAPTCN\PYGZus{}X*MDAGGEXPCAPTCN\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDAGGEXPOTHRCN = (MDAGGEXPOTHRCN\PYGZus{}A*MDANYGDPMKTPCN/100+MDANYGDPMKTPCN* (1.49239295839917) /100) * (1\PYGZhy{}MDAGGEXPOTHRCN\PYGZus{}D)+ MDAGGEXPOTHRCN\PYGZus{}X*MDAGGEXPOTHRCN\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDAGGEXPCRNOCN = (MDAGGEXPCRNOCN\PYGZus{}A*MDANYGDPMKTPCN/100+MDANYGDPMKTPCN* (0.754699479458526) /100) * (1\PYGZhy{}MDAGGEXPCRNOCN\PYGZus{}D)+ MDAGGEXPCRNOCN\PYGZus{}X*MDAGGEXPCRNOCN\PYGZus{}D  \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDAGGBALOVRLCN = MDAGGREVTOTLCN\PYGZhy{}MDAGGEXPTOTLCN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDAGGBALOVRLCN\PYGZus{} = MDAGGBALOVRLCN/MDANYGDPMKTPCN*100 \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDAGGBALPRIMCN = MDAGGBALOVRLCN+MDAGGEXPINTPCN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDAGGDBTTOTLCN = MDAGGDBTEXTLCN+MDAGGDBTDOMTCN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDAGGDBTEXTLCN = MDAGGDBTEXTLCN(\PYGZhy{}1)+MDAGGDBTVALECN+MDAGGFINEXTLCN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDAGGDBTDOMTCN = MDAGGDBTDOMTCN(\PYGZhy{}1)+MDAGGDBTVALDCN+MDAGGFINDOMTCN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDAGGFINTOTLCN = MDAGGFINEXTLCN+MDAGGFINDOMTCN+MDAGGFINPRVTCN+MDAGGFINCBALCN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDAGGFINEXTLCN = MDAGGFINEDSBCN+MDAGGFINEAMTCN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDAGGFINFGAPCN = MDAGGFINTOTLCN+MDAGGBALOVRLCN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDAGGREVSTRLCN = MDAGGREVTOTLCN*(1\PYGZhy{}MDANYGDPGAP\PYGZus{}/100)**(\PYGZus{}MDASBBREV\PYGZus{}AT\PYGZus{}COEF\PYGZus{}2) \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDAGGREVCYCLCN = MDAGGREVTOTLCN\PYGZhy{}MDAGGREVSTRLCN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDAGGBALSTRLCN = MDAGGBALOVRLCN\PYGZhy{}MDAGGREVCYCLCN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDAGGBALCYCLCN = MDAGGBALOVRLCN\PYGZhy{}MDAGGBALSTRLCN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDABNGSRGNFSCD = MDABXGSRGNFSCD\PYGZhy{}MDABMGSRGNFSCD \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDABXGSRGNFSCD = (MDABXGSRGNFSCD\PYGZus{}A*MDABXGSRGNFSCD(\PYGZhy{}1)/100+ ((100 * ( (MDANEEXPGNFSCN/MDAPANUSATLS) / (MDANEEXPGNFSCN(\PYGZhy{}1)/MDAPANUSATLS(\PYGZhy{}1)) \PYGZhy{}1)) \PYGZhy{}0.0279008217603989*DUMH) *MDABXGSRGNFSCD(\PYGZhy{}1)/100+MDABXGSRGNFSCD(\PYGZhy{}1)) * (1\PYGZhy{}MDABXGSRGNFSCD\PYGZus{}D)+ MDABXGSRGNFSCD\PYGZus{}X*MDABXGSRGNFSCD\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDABXGSRAGRTCD = (MDABXGSRAGRTCD\PYGZus{}A*MDABXGSRAGRTCD(\PYGZhy{}1)/100+ ((100 * ( (MDANEEXPAGRTCN/MDAPANUSATLS) / (MDANEEXPAGRTCN(\PYGZhy{}1)/MDAPANUSATLS(\PYGZhy{}1)) \PYGZhy{}1)) +2.52429656125299E\PYGZhy{}15*DUMH) *MDABXGSRAGRTCD(\PYGZhy{}1)/100+MDABXGSRAGRTCD(\PYGZhy{}1)) * (1\PYGZhy{}MDABXGSRAGRTCD\PYGZus{}D)+ MDABXGSRAGRTCD\PYGZus{}X*MDABXGSRAGRTCD\PYGZus{}D  \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDABXGSROTHRCD = MDABXGSRGNFSCD\PYGZhy{}MDABXGSRAGRTCD \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDABMGSRGNFSCD = (MDABMGSRGNFSCD\PYGZus{}A*MDABMGSRGNFSCD(\PYGZhy{}1)/100+ ((100 * ( (MDANEIMPGNFSCN/MDAPANUSATLS) / (MDANEIMPGNFSCN(\PYGZhy{}1)/MDAPANUSATLS(\PYGZhy{}1)) \PYGZhy{}1)) \PYGZhy{}0.150835412701402*DUMH) *MDABMGSRGNFSCD(\PYGZhy{}1)/100+MDABMGSRGNFSCD(\PYGZhy{}1)) * (1\PYGZhy{}MDABMGSRGNFSCD\PYGZus{}D)+ MDABMGSRGNFSCD\PYGZus{}X*MDABMGSRGNFSCD\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDABMGSRFUELCD = (MDABMGSRFUELCD\PYGZus{}A*MDABMGSRFUELCD(\PYGZhy{}1)/100+ ((100 * ( (MDANEIMPFUELCN/MDAPANUSATLS) / (MDANEIMPFUELCN(\PYGZhy{}1)/MDAPANUSATLS(\PYGZhy{}1)) \PYGZhy{}1)) +0*DUMH) *MDABMGSRFUELCD(\PYGZhy{}1)/100+MDABMGSRFUELCD(\PYGZhy{}1)) * (1\PYGZhy{}MDABMGSRFUELCD\PYGZus{}D)+ MDABMGSRFUELCD\PYGZus{}X*MDABMGSRFUELCD\PYGZus{}D  \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDABMGSROTHRCD = MDABMGSRGNFSCD\PYGZhy{}MDABMGSRFUELCD \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDABNFSTCABTCD = MDABNFSTOTHRCD+MDABNFSTSTRNCD+MDABNFSTPCOECD \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDABNFSTSTRNCD = (MDANYGDPMKTPXN*MDABNFSTSTRNCD(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1)*EXP(MDABNFSTSTRNCD\PYGZus{}A+ (1.21239586043243*MDAGR+(1\PYGZhy{}1.21239586043243)*((LOG((MDABNFSTSTRNCD(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1))/MDANYGDPMKTPXN(\PYGZhy{}1)))\PYGZhy{}(LOG((MDABNFSTSTRNCD(\PYGZhy{}2)*MDAPANUSATLS(\PYGZhy{}2))/MDANYGDPMKTPXN(\PYGZhy{}2))))) )/(MDAPANUSATLS*MDANYGDPMKTPXN(\PYGZhy{}1))) * (1\PYGZhy{}MDABNFSTSTRNCD\PYGZus{}D)+ MDABNFSTSTRNCD\PYGZus{}X*MDABNFSTSTRNCD\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDABNFSTPCOECD = (MDANYGDPMKTPXN*MDABNFSTPCOECD(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1)*EXP(MDABNFSTPCOECD\PYGZus{}A+ (0.669088437645741*MDAGR+(1\PYGZhy{}0.669088437645741)*((LOG((MDABNFSTPCOECD(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1))/MDANYGDPMKTPXN(\PYGZhy{}1)))\PYGZhy{}(LOG((MDABNFSTPCOECD(\PYGZhy{}2)*MDAPANUSATLS(\PYGZhy{}2))/MDANYGDPMKTPXN(\PYGZhy{}2))))) )/(MDAPANUSATLS*MDANYGDPMKTPXN(\PYGZhy{}1))) * (1\PYGZhy{}MDABNFSTPCOECD\PYGZus{}D)+ MDABNFSTPCOECD\PYGZus{}X*MDABNFSTPCOECD\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDABNFSTOTHRCD = (MDABNFSTOTHRCD\PYGZus{}A*MDANYGDPMKTPCD+MDANYGDPMKTPCD* (0.113187073392889\PYGZhy{}0.00250912199388566*T\PYGZus{}LR) ) * (1\PYGZhy{}MDABNFSTOTHRCD\PYGZus{}D)+ MDABNFSTOTHRCD\PYGZus{}X*MDABNFSTOTHRCD\PYGZus{}D  \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDABNCABFUNDCD = MDABXGSRGNFSCD\PYGZhy{}MDABMGSRGNFSCD+MDABNFSTCABTCD \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDABFCAFCAPTCD = (MDABFCAFCAPTCD\PYGZus{}A*MDANYGDPMKTPCN/MDAPANUSATLS+MDANYGDPMKTPCN* (0.00282736002227067) /MDAPANUSATLS) * (1\PYGZhy{}MDABFCAFCAPTCD\PYGZus{}D)+ MDABFCAFCAPTCD\PYGZus{}X*MDABFCAFCAPTCD\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDABFCAFFFDICD = (MDABFCAFFFDICD\PYGZus{}A*MDANYGDPMKTPCN/MDAPANUSATLS+MDANYGDPMKTPCN* (\PYGZhy{}0.028376216546585) /MDAPANUSATLS) * (1\PYGZhy{}MDABFCAFFFDICD\PYGZus{}D)+ MDABFCAFFFDICD\PYGZus{}X*MDABFCAFFFDICD\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDABFCAFFPFTCD = (MDABFCAFFPFTCD\PYGZus{}A*MDANYGDPMKTPCN/MDAPANUSATLS+MDANYGDPMKTPCN* (\PYGZhy{}0.000240950762685102) /MDAPANUSATLS) * (1\PYGZhy{}MDABFCAFFPFTCD\PYGZus{}D)+ MDABFCAFFPFTCD\PYGZus{}X*MDABFCAFFPFTCD\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDABFCAFOTHRCD = (MDABFCAFOTHRCD\PYGZus{}A*MDANYGDPMKTPCN/MDAPANUSATLS+MDANYGDPMKTPCN* (\PYGZhy{}0.0515665290620459) /MDAPANUSATLS) * (1\PYGZhy{}MDABFCAFOTHRCD\PYGZus{}D)+ MDABFCAFOTHRCD\PYGZus{}X*MDABFCAFOTHRCD\PYGZus{}D  \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDABFBOPTOTLCD = MDABFCAFCAPTCD+MDABFCAFFINXCD+MDABNCABFUNDCD+MDABFCAFNEOMCD \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDABFCAFFINXCD = MDABFCAFFFDICD+MDABFCAFFPFTCD+MDABFCAFOTHRCD \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDABFCAFRACGCD = (\PYGZhy{}MDABNCABFUNDCD\PYGZhy{}MDABFCAFFINXCD\PYGZhy{}MDABFCAFCAPTCD\PYGZhy{}MDABFCAFNEOMCD\PYGZhy{}1176.08181818182*DUMH + MDABFCAFRACGCD\PYGZus{}A)* (1\PYGZhy{}MDABFCAFRACGCD\PYGZus{}D)+ MDABFCAFRACGCD\PYGZus{}X*MDABFCAFRACGCD\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDAPANUSATLS = (MDAPANUSATLS(\PYGZhy{}1)*EXP(MDAPANUSATLS\PYGZus{}A+ (0.41922820233295*((LOG(MDAPANUSATLS(\PYGZhy{}1)))\PYGZhy{}(LOG(MDAPANUSATLS(\PYGZhy{}2))))+(1\PYGZhy{}0.41922820233295)*((LOG((1+MDAUSAFMLBLPOLYFR/100)/(1+MDAFMLBLPOLYXN/100)))\PYGZhy{}(LOG((1+MDAUSAFMLBLPOLYFR(\PYGZhy{}1)/100)/(1+MDAFMLBLPOLYXN(\PYGZhy{}1)/100))))) )) * (1\PYGZhy{}MDAPANUSATLS\PYGZus{}D)+ MDAPANUSATLS\PYGZus{}X*MDAPANUSATLS\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDAFPCPITOTLXN = (MDAFPCPITOTLXN(\PYGZhy{}1)*EXP(MDAFPCPITOTLXN\PYGZus{}A+ (\PYGZhy{}1.37696081847616*(LOG(MDAFPCPITOTLXN(\PYGZhy{}1))\PYGZhy{}LOG(MDANECONPRVTXN(\PYGZhy{}1)))+9.99703744406243+0.00326070346873517*T\PYGZus{}LR+((LOG(MDANECONPRVTXN))\PYGZhy{}(LOG(MDANECONPRVTXN(\PYGZhy{}1))))) )) * (1\PYGZhy{}MDAFPCPITOTLXN\PYGZus{}D)+ MDAFPCPITOTLXN\PYGZus{}X*MDAFPCPITOTLXN\PYGZus{}D  \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANEGDIKSTKKN = MDANEGDIKSTKKN(\PYGZhy{}1)*(1\PYGZhy{}MDADEPR)+MDANEGDIFTOTKN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANYGDPPOTLKN = MDANYGDPTFP*(MDALMEMPSTRL**MDANYYWBTOTL\PYGZus{})*(MDANEGDIKSTKKN(\PYGZhy{}1)**(1\PYGZhy{}MDANYYWBTOTL\PYGZus{})) \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANYGDPGAP\PYGZus{} = ((MDANYGDPMKTPKN/MDANYGDPPOTLKN\PYGZhy{}1)*100) \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANYGDPMKTPXN = MDANYGDPMKTPCN/MDANYGDPMKTPKN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANYGDPMKTPCD = MDANYGDPMKTPCN/MDAPANUSATLS \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANYTAXNINDCN = MDANYGDPMKTPCN\PYGZhy{}MDANYGDPFCSTCN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANYGDPFCSTCN = MDANYGDPFCSTXN*MDANYGDPFCSTKN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANEGDETTOTKN = MDANECONPRVTKN+MDANECONGOVTKN+MDANEGDIFTOTKN+MDANEGDISTKBKN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANEGDETTOTCN = MDANECONPRVTCN+MDANECONGOVTCN+MDANEGDIFTOTCN+MDANEGDISTKBCN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANEGDETTOTXN = MDANEGDETTOTCN/MDANEGDETTOTKN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANYGDPMKTPKN = MDANECONPRVTKN+MDANECONGOVTKN+MDANEGDIFTOTKN+MDANEGDISTKBKN+MDANEEXPGNFSKN\PYGZhy{}MDANEIMPGNFSKN+MDANYGDPDISCKN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANYGDPMKTPCN = MDANECONPRVTCN+MDANECONGOVTCN+MDANEGDIFTOTCN+MDANEGDISTKBCN+MDANEEXPGNFSCN\PYGZhy{}MDANEIMPGNFSCN+MDANYGDPDISCCN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDAPXKEY = (0.000000000000*WLDFALUMINUM/(WLDFALUMINUM\PYGZus{}VALUE\PYGZus{}2015)+0.000000000000*WLDFBANANA\PYGZus{}US/(WLDFBANANA\PYGZus{}US\PYGZus{}VALUE\PYGZus{}2015)+0.806106716856*WLDFBEEF/(WLDFBEEF\PYGZus{}VALUE\PYGZus{}2015)+0.000257789164*WLDFCOAL\PYGZus{}AUS/(WLDFCOAL\PYGZus{}AUS\PYGZus{}VALUE\PYGZus{}2015)+0.000000000000*WLDFCOCOA/(WLDFCOCOA\PYGZus{}VALUE\PYGZus{}2015)+0.001976383593*WLDFCOFFEE\PYGZus{}COMPO/(WLDFCOFFEE\PYGZus{}COMPO\PYGZus{}VALUE\PYGZus{}2015)+0.000000000000*WLDFCOPPER/(WLDFCOPPER\PYGZus{}VALUE\PYGZus{}2015)+0.000165363864*WLDFCOTTON\PYGZus{}A\PYGZus{}INDX/(WLDFCOTTON\PYGZus{}A\PYGZus{}INDX\PYGZus{}VALUE\PYGZus{}2015)+0.000000000000*MDAWLDFCRUDE\PYGZus{}PETRO/(MDAWLDFCRUDE\PYGZus{}PETRO\PYGZus{}VALUE\PYGZus{}2015)+0.000000000000*WLDFGRNUT\PYGZus{}OIL/(WLDFGRNUT\PYGZus{}OIL\PYGZus{}VALUE\PYGZus{}2015)+0.000000000000*WLDFGRNUT\PYGZus{}OIL/(WLDFGRNUT\PYGZus{}OIL\PYGZus{}VALUE\PYGZus{}2015)+0.023372884232*WLDFGOLD/(WLDFGOLD\PYGZus{}VALUE\PYGZus{}2015)+0.000000000000*WLDFGRNUT/(WLDFGRNUT\PYGZus{}VALUE\PYGZus{}2015)+0.000000000000*WLDFIRON\PYGZus{}ORE/(WLDFIRON\PYGZus{}ORE\PYGZus{}VALUE\PYGZus{}2015)+0.000000000000*WLDFLEAD/(WLDFLEAD\PYGZus{}VALUE\PYGZus{}2015)+1.304413171503*WLDFMAIZE/(WLDFMAIZE\PYGZus{}VALUE\PYGZus{}2015)+77.117456649498*MDAWLDFMUV/(MDAWLDFMUV\PYGZus{}VALUE\PYGZus{}2015)+0.000000000000*WLDFNICKEL/(WLDFNICKEL\PYGZus{}VALUE\PYGZus{}2015)+0.000330727727*WLDFORANGE/(WLDFORANGE\PYGZus{}VALUE\PYGZus{}2015)+0.068915636597*WLDFNGAS\PYGZus{}EUR/(WLDFNGAS\PYGZus{}EUR\PYGZus{}VALUE\PYGZus{}2015)+0.000000000000*WLDFPALM\PYGZus{}OIL/(WLDFPALM\PYGZus{}OIL\PYGZus{}VALUE\PYGZus{}2015)+0.000000000000*WLDFPALM\PYGZus{}OIL/(WLDFPALM\PYGZus{}OIL\PYGZus{}VALUE\PYGZus{}2015)+0.000429648607*WLDFRICE\PYGZus{}05/(WLDFRICE\PYGZus{}05\PYGZus{}VALUE\PYGZus{}2015)+0.000000000000*WLDFRUBBER1\PYGZus{}MYSG/(WLDFRUBBER1\PYGZus{}MYSG\PYGZus{}VALUE\PYGZus{}2015)+0.000773367493*WLDFSILVER/(WLDFSILVER\PYGZus{}VALUE\PYGZus{}2015)+0.517296923086*WLDFSOYBEAN\PYGZus{}MEAL/(WLDFSOYBEAN\PYGZus{}MEAL\PYGZus{}VALUE\PYGZus{}2015)+0.650659850766*WLDFSOYBEAN\PYGZus{}OIL/(WLDFSOYBEAN\PYGZus{}OIL\PYGZus{}VALUE\PYGZus{}2015)+0.643699543329*WLDFSOYBEANS/(WLDFSOYBEANS\PYGZus{}VALUE\PYGZus{}2015)+0.077516795300*WLDFSORGHUM/(WLDFSORGHUM\PYGZus{}VALUE\PYGZus{}2015)+12.515148349831*WLDFISTL\PYGZus{}JP\PYGZus{}INDX/(WLDFISTL\PYGZus{}JP\PYGZus{}INDX\PYGZus{}VALUE\PYGZus{}2015)+2.181240049107*WLDFSUGAR\PYGZus{}WLD/(WLDFSUGAR\PYGZus{}WLD\PYGZus{}VALUE\PYGZus{}2015)+0.000928344854*WLDFTEA\PYGZus{}AVG/(WLDFTEA\PYGZus{}AVG\PYGZus{}VALUE\PYGZus{}2015)+0.000000000000*WLDFTIN/(WLDFTIN\PYGZus{}VALUE\PYGZus{}2015)+1.499645498622*WLDFTOBAC\PYGZus{}US/(WLDFTOBAC\PYGZus{}US\PYGZus{}VALUE\PYGZus{}2015)+0.002837971651*WLDFLOGS\PYGZus{}MYS/(WLDFLOGS\PYGZus{}MYS\PYGZus{}VALUE\PYGZus{}2015)+0.090655856122*WLDFPLYWOOD/(WLDFPLYWOOD\PYGZus{}VALUE\PYGZus{}2015)+0.000515578329*WLDFWOODPULP/(WLDFWOODPULP\PYGZus{}VALUE\PYGZus{}2015)+0.017529663174*WLDFSAWNWD\PYGZus{}MYS/(WLDFSAWNWD\PYGZus{}MYS\PYGZus{}VALUE\PYGZus{}2015)+2.478127236692*WLDFWHEAT\PYGZus{}US\PYGZus{}HRW/(WLDFWHEAT\PYGZus{}US\PYGZus{}HRW\PYGZus{}VALUE\PYGZus{}2015)+0.000000000000*WLDFZINC/(WLDFZINC\PYGZus{}VALUE\PYGZus{}2015))/100 \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDAPMKEY = (0.026359971729*WLDFALUMINUM/(WLDFALUMINUM\PYGZus{}VALUE\PYGZus{}2015)+0.034910160859*WLDFBANANA\PYGZus{}US/(WLDFBANANA\PYGZus{}US\PYGZus{}VALUE\PYGZus{}2015)+1.852478749765*WLDFBEEF/(WLDFBEEF\PYGZus{}VALUE\PYGZus{}2015)+0.686890084842*WLDFCOAL\PYGZus{}AUS/(WLDFCOAL\PYGZus{}AUS\PYGZus{}VALUE\PYGZus{}2015)+0.000000000000*WLDFCOCOA/(WLDFCOCOA\PYGZus{}VALUE\PYGZus{}2015)+0.225926613218*WLDFCOFFEE\PYGZus{}COMPO/(WLDFCOFFEE\PYGZus{}COMPO\PYGZus{}VALUE\PYGZus{}2015)+0.000000000000*WLDFCOPPER/(WLDFCOPPER\PYGZus{}VALUE\PYGZus{}2015)+0.219878007807*WLDFCOTTON\PYGZus{}A\PYGZus{}INDX/(WLDFCOTTON\PYGZus{}A\PYGZus{}INDX\PYGZus{}VALUE\PYGZus{}2015)+0.010503952387*MDAWLDFCRUDE\PYGZus{}PETRO/(MDAWLDFCRUDE\PYGZus{}PETRO\PYGZus{}VALUE\PYGZus{}2015)+0.000000000000*WLDFGRNUT\PYGZus{}OIL/(WLDFGRNUT\PYGZus{}OIL\PYGZus{}VALUE\PYGZus{}2015)+0.000037337070*WLDFGRNUT\PYGZus{}OIL/(WLDFGRNUT\PYGZus{}OIL\PYGZus{}VALUE\PYGZus{}2015)+0.000709404338*WLDFGOLD/(WLDFGOLD\PYGZus{}VALUE\PYGZus{}2015)+0.001008100902*WLDFGRNUT/(WLDFGRNUT\PYGZus{}VALUE\PYGZus{}2015)+0.003957729466*WLDFIRON\PYGZus{}ORE/(WLDFIRON\PYGZus{}ORE\PYGZus{}VALUE\PYGZus{}2015)+0.000000000000*WLDFLEAD/(WLDFLEAD\PYGZus{}VALUE\PYGZus{}2015)+0.031437813309*WLDFMAIZE/(WLDFMAIZE\PYGZus{}VALUE\PYGZus{}2015)+88.504949214622*MDAWLDFMUV/(MDAWLDFMUV\PYGZus{}VALUE\PYGZus{}2015)+0.000000000000*WLDFNICKEL/(WLDFNICKEL\PYGZus{}VALUE\PYGZus{}2015)+0.248702226185*WLDFORANGE/(WLDFORANGE\PYGZus{}VALUE\PYGZus{}2015)+1.386549447773*WLDFNGAS\PYGZus{}EUR/(WLDFNGAS\PYGZus{}EUR\PYGZus{}VALUE\PYGZus{}2015)+0.000000000000*WLDFPALM\PYGZus{}OIL/(WLDFPALM\PYGZus{}OIL\PYGZus{}VALUE\PYGZus{}2015)+0.001008100902*WLDFPALM\PYGZus{}OIL/(WLDFPALM\PYGZus{}OIL\PYGZus{}VALUE\PYGZus{}2015)+0.169846333421*WLDFRICE\PYGZus{}05/(WLDFRICE\PYGZus{}05\PYGZus{}VALUE\PYGZus{}2015)+0.001082775043*WLDFRUBBER1\PYGZus{}MYSG/(WLDFRUBBER1\PYGZus{}MYSG\PYGZus{}VALUE\PYGZus{}2015)+0.000560056057*WLDFSILVER/(WLDFSILVER\PYGZus{}VALUE\PYGZus{}2015)+0.000000000000*WLDFSOYBEAN\PYGZus{}MEAL/(WLDFSOYBEAN\PYGZus{}MEAL\PYGZus{}VALUE\PYGZus{}2015)+0.028786881307*WLDFSOYBEAN\PYGZus{}OIL/(WLDFSOYBEAN\PYGZus{}OIL\PYGZus{}VALUE\PYGZus{}2015)+0.264197110417*WLDFSOYBEANS/(WLDFSOYBEANS\PYGZus{}VALUE\PYGZus{}2015)+0.000149348282*WLDFSORGHUM/(WLDFSORGHUM\PYGZus{}VALUE\PYGZus{}2015)+4.037630797129*WLDFISTL\PYGZus{}JP\PYGZus{}INDX/(WLDFISTL\PYGZus{}JP\PYGZus{}INDX\PYGZus{}VALUE\PYGZus{}2015)+0.353320697552*WLDFSUGAR\PYGZus{}WLD/(WLDFSUGAR\PYGZus{}WLD\PYGZus{}VALUE\PYGZus{}2015)+0.317551784072*WLDFTEA\PYGZus{}AVG/(WLDFTEA\PYGZus{}AVG\PYGZus{}VALUE\PYGZus{}2015)+0.000000000000*WLDFTIN/(WLDFTIN\PYGZus{}VALUE\PYGZus{}2015)+0.645259251304*WLDFTOBAC\PYGZus{}US/(WLDFTOBAC\PYGZus{}US\PYGZus{}VALUE\PYGZus{}2015)+0.000037337070*WLDFLOGS\PYGZus{}MYS/(WLDFLOGS\PYGZus{}MYS\PYGZus{}VALUE\PYGZus{}2015)+0.782472985162*WLDFPLYWOOD/(WLDFPLYWOOD\PYGZus{}VALUE\PYGZus{}2015)+0.005376538143*WLDFWOODPULP/(WLDFWOODPULP\PYGZus{}VALUE\PYGZus{}2015)+0.152484595667*WLDFSAWNWD\PYGZus{}MYS/(WLDFSAWNWD\PYGZus{}MYS\PYGZus{}VALUE\PYGZus{}2015)+0.005936594200*WLDFWHEAT\PYGZus{}US\PYGZus{}HRW/(WLDFWHEAT\PYGZus{}US\PYGZus{}HRW\PYGZus{}VALUE\PYGZus{}2015)+0.000000000000*WLDFZINC/(WLDFZINC\PYGZus{}VALUE\PYGZus{}2015)+0)/100 \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDANYGDPDISCCN = (MDANYGDPDISCCN\PYGZus{}A*MDANYGDPMKTPCN+MDANYGDPMKTPCN* (\PYGZhy{}0.0104830273967771) ) * (1\PYGZhy{}MDANYGDPDISCCN\PYGZus{}D)+ MDANYGDPDISCCN\PYGZus{}X*MDANYGDPDISCCN\PYGZus{}D  \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDASMAGRTOTLKN = ((0.0148291818908477*MDANECONGOVTKN+0.117329993386964*MDANECONPRVTKN+1*MDANEEXPAGRTKN+0*MDANEEXPOTHRKN+0.0326625963691576*MDANEGDIFTOTKN+0.0474487689906466*MDANEGDISTKBKN)*(1+0.600427138860681)\PYGZhy{}0.0401461890256766*MDANYTAXNINDKN\PYGZhy{}0.0285727001640423*MDANEIMPGNFSKN\PYGZhy{}2.78/100*MDANYGDPFCSTKN)/(1+0.965581152309926) \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDASMINDTOTLKN = ((0.010690747330332*MDANECONGOVTKN+0.569984424289192*MDANECONPRVTKN+0*MDANEEXPAGRTKN+0.711153597962845*MDANEEXPOTHRKN+0.381999028539556*MDANEGDIFTOTKN+0.952549892992068*MDANEGDISTKBKN)*(1+0.839198038045702)\PYGZhy{}0.769262827467038*MDANYTAXNINDKN\PYGZhy{}0.89795376226341*MDANEIMPGNFSKN\PYGZhy{}30.43/100*MDANYGDPFCSTKN)/(1+2.86713090201824) \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDASMSRVCONTKN = ((0*MDANECONGOVTKN+0.0148694094060245*MDANECONPRVTKN+0*MDANEEXPAGRTKN+0.0107293612573989*MDANEEXPOTHRKN+0.538147507656802*MDANEGDIFTOTKN+0*MDANEGDISTKBKN)*(1+0.17563826316238)\PYGZhy{}0.0181945035406025*MDANYTAXNINDKN\PYGZhy{}0.00502467253166018*MDANEIMPGNFSKN\PYGZhy{}0/1000\PYGZhy{}0/1000+0/1000+0/1000)/(1+3.93113850449642) \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDASMSRVWHLEKN = ((0*MDANECONGOVTKN+0.00110846513014049*MDANECONPRVTKN+0*MDANEEXPAGRTKN+0.00118200950098922*MDANEEXPOTHRKN+0*MDANEGDIFTOTKN+0*MDANEGDISTKBKN)*(1+5.71349020945925)\PYGZhy{}0.1100084816686*MDANYTAXNINDKN\PYGZhy{}0.000421483072262446*MDANEIMPGNFSKN+30.55/100*MDANYGDPFCSTKN)/(1+0.930835857681878) \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDASMSRVTRNSKN = ((0*MDANECONGOVTKN+0.0470474115150646*MDANECONPRVTKN+0*MDANEEXPAGRTKN+0.158858892053594*MDANEEXPOTHRKN+0*MDANEGDIFTOTKN+0*MDANEGDISTKBKN)*(1+0.690213449518783)\PYGZhy{}0.0226879281340598*MDANYTAXNINDKN\PYGZhy{}0.0285524601638301*MDANEIMPGNFSKN+2.66/100*MDANYGDPFCSTKN)/(1+2.45793100439559) \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDASMSRVACCMKN = ((0*MDANECONGOVTKN+0.017042866672113*MDANECONPRVTKN+0*MDANEEXPAGRTKN+0.0209319251831472*MDANEEXPOTHRKN+0*MDANEGDIFTOTKN+0*MDANEGDISTKBKN)*(1+0.434230546640305)\PYGZhy{}0.00814302178464406*MDANYTAXNINDKN\PYGZhy{}0.00709480244507614*MDANEIMPGNFSKN\PYGZhy{}0/1000\PYGZhy{}0/1000+0/1000+0/1000)/(1+1.44305871053201) \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDASMSRVINFOKN = ((0*MDANECONGOVTKN+0.0400283030556697*MDANECONPRVTKN+0*MDANEEXPAGRTKN+0.0565461853127648*MDANEEXPOTHRKN+0*MDANEGDIFTOTKN+0*MDANEGDISTKBKN)*(1+0.492501655217848)\PYGZhy{}0.019668848606441*MDANYTAXNINDKN\PYGZhy{}0.0108773594141113*MDANEIMPGNFSKN\PYGZhy{}0/1000\PYGZhy{}0/1000+0/1000+0/1000)/(1+0.617686720621447) \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDASMSRVFINAKN = ((0*MDANECONGOVTKN+0.0184409978087097*MDANECONPRVTKN+0*MDANEEXPAGRTKN+0.00435708168583997*MDANEEXPOTHRKN+0*MDANEGDIFTOTKN+0*MDANEGDISTKBKN)*(1+2.55822900375627)\PYGZhy{}0.00344958761056441*MDANYTAXNINDKN\PYGZhy{}0.00638335801445772*MDANEIMPGNFSKN\PYGZhy{}0/1000\PYGZhy{}0/1000+0/1000+0/1000)/(1+0.39651158209491) \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDASMSRVOTHRKN = ((0.97448007077882*MDANECONGOVTKN+0.174148128736122*MDANECONPRVTKN+0*MDANEEXPAGRTKN+0.0362409470434213*MDANEEXPOTHRKN+0.0471908674344848*MDANEGDIFTOTKN+1.33801728585681E\PYGZhy{}06*MDANEGDISTKBKN)*(1+0.247441144107494)\PYGZhy{}0.00843861216237385*MDANYTAXNINDKN\PYGZhy{}0.0151194019311494*MDANEIMPGNFSKN\PYGZhy{}0/1000\PYGZhy{}0/1000+0/1000+0/1000)/(1+0.711506529247456) \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDANVAGRTOTLKN = (MDANVAGRTOTLKN(\PYGZhy{}1)*EXP(MDANVAGRTOTLKN\PYGZus{}A+ (1.42808459809626*((LOG(MDANYGDPPOTLKN))\PYGZhy{}(LOG(MDANYGDPPOTLKN(\PYGZhy{}1))))+(1\PYGZhy{}1.42808459809626)*((LOG(MDANVAGRTOTLKN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDANVAGRTOTLKN(\PYGZhy{}2))))) )) * (1\PYGZhy{}MDANVAGRTOTLKN\PYGZus{}D)+ MDANVAGRTOTLKN\PYGZus{}X*MDANVAGRTOTLKN\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDANVINDTOTLKN = (MDANVINDTOTLKN(\PYGZhy{}1)*EXP(MDANVINDTOTLKN\PYGZus{}A+ (1.43892189150108*((LOG(MDANYGDPPOTLKN))\PYGZhy{}(LOG(MDANYGDPPOTLKN(\PYGZhy{}1))))+(1\PYGZhy{}1.43892189150108)*((LOG(MDANVINDTOTLKN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDANVINDTOTLKN(\PYGZhy{}2))))) )) * (1\PYGZhy{}MDANVINDTOTLKN\PYGZus{}D)+ MDANVINDTOTLKN\PYGZus{}X*MDANVINDTOTLKN\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDANVSRVCONTKN = (MDANVSRVCONTKN(\PYGZhy{}1)*EXP(MDANVSRVCONTKN\PYGZus{}A+ (0.371368937381176*((LOG(MDANYGDPPOTLKN))\PYGZhy{}(LOG(MDANYGDPPOTLKN(\PYGZhy{}1))))+(1\PYGZhy{}0.371368937381176)*((LOG(MDANVSRVCONTKN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDANVSRVCONTKN(\PYGZhy{}2))))) )) * (1\PYGZhy{}MDANVSRVCONTKN\PYGZus{}D)+ MDANVSRVCONTKN\PYGZus{}X*MDANVSRVCONTKN\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDANVSRVTRNSKN = (MDANVSRVTRNSKN(\PYGZhy{}1)*EXP(MDANVSRVTRNSKN\PYGZus{}A+ (1.67475245888343*((LOG(MDANYGDPPOTLKN))\PYGZhy{}(LOG(MDANYGDPPOTLKN(\PYGZhy{}1))))+(1\PYGZhy{}1.67475245888343)*((LOG(MDANVSRVTRNSKN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDANVSRVTRNSKN(\PYGZhy{}2))))) )) * (1\PYGZhy{}MDANVSRVTRNSKN\PYGZus{}D)+ MDANVSRVTRNSKN\PYGZus{}X*MDANVSRVTRNSKN\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDANVSRVACCMKN = (MDANVSRVACCMKN(\PYGZhy{}1)*EXP(MDANVSRVACCMKN\PYGZus{}A+ (1.97626862992525*((LOG(MDANYGDPPOTLKN))\PYGZhy{}(LOG(MDANYGDPPOTLKN(\PYGZhy{}1))))+(1\PYGZhy{}1.97626862992525)*((LOG(MDANVSRVACCMKN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDANVSRVACCMKN(\PYGZhy{}2))))) )) * (1\PYGZhy{}MDANVSRVACCMKN\PYGZus{}D)+ MDANVSRVACCMKN\PYGZus{}X*MDANVSRVACCMKN\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDANVSRVINFOKN = (MDANVSRVINFOKN(\PYGZhy{}1)*EXP(MDANVSRVINFOKN\PYGZus{}A+ (0.876628309230883*((LOG(MDANYGDPPOTLKN))\PYGZhy{}(LOG(MDANYGDPPOTLKN(\PYGZhy{}1))))+(1\PYGZhy{}0.876628309230883)*((LOG(MDANVSRVINFOKN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDANVSRVINFOKN(\PYGZhy{}2))))) )) * (1\PYGZhy{}MDANVSRVINFOKN\PYGZus{}D)+ MDANVSRVINFOKN\PYGZus{}X*MDANVSRVINFOKN\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDANVSRVFINAKN = (MDANVSRVFINAKN(\PYGZhy{}1)*EXP(MDANVSRVFINAKN\PYGZus{}A+ (1.24316636274024*((LOG(MDANYGDPPOTLKN))\PYGZhy{}(LOG(MDANYGDPPOTLKN(\PYGZhy{}1))))+(1\PYGZhy{}1.24316636274024)*((LOG(MDANVSRVFINAKN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDANVSRVFINAKN(\PYGZhy{}2))))) )) * (1\PYGZhy{}MDANVSRVFINAKN\PYGZus{}D)+ MDANVSRVFINAKN\PYGZus{}X*MDANVSRVFINAKN\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDANVSRVOTHRKN = (MDANVSRVOTHRKN(\PYGZhy{}1)*EXP(MDANVSRVOTHRKN\PYGZus{}A+ (0.431580607334864*((LOG(MDANYGDPPOTLKN))\PYGZhy{}(LOG(MDANYGDPPOTLKN(\PYGZhy{}1))))+(1\PYGZhy{}0.431580607334864)*((LOG(MDANVSRVOTHRKN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDANVSRVOTHRKN(\PYGZhy{}2))))) )) * (1\PYGZhy{}MDANVSRVOTHRKN\PYGZus{}D)+ MDANVSRVOTHRKN\PYGZus{}X*MDANVSRVOTHRKN\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDANVAGRTOTLXN = (MDANVAGRTOTLXN(\PYGZhy{}1)*EXP(MDANVAGRTOTLXN\PYGZus{}A+ (\PYGZhy{}0.3*(LOG(MDANVAGRTOTLXN(\PYGZhy{}1))\PYGZhy{}(1\PYGZhy{}0.15)*LOG(MDANYGDPFCSTXN(\PYGZhy{}1))\PYGZhy{}0.85*LOG(MDAWLDFAGRTOTLXD(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1)))\PYGZhy{}1.82179756558893+0.15*((LOG(MDAWLDFAGRTOTLXD*MDAPANUSATLS))\PYGZhy{}(LOG(MDAWLDFAGRTOTLXD(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1))))+(1\PYGZhy{}0.85)*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))) )) * (1\PYGZhy{}MDANVAGRTOTLXN\PYGZus{}D)+ MDANVAGRTOTLXN\PYGZus{}X*MDANVAGRTOTLXN\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDANVINDTOTLXN = (MDANVINDTOTLXN(\PYGZhy{}1)*EXP(MDANVINDTOTLXN\PYGZus{}A+ (\PYGZhy{}0.642555574166414*(LOG(MDANVINDTOTLXN(\PYGZhy{}1))\PYGZhy{}0.799550564777672*LOG(MDANYGDPFCSTXN(\PYGZhy{}1))\PYGZhy{}(1\PYGZhy{}0.799550564777672)*LOG(MDANEIMPGNFSXN(\PYGZhy{}1)))+0.0457961224580996+0.291567048935525*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))+(1\PYGZhy{}0.291567048935525)*((LOG(MDANEIMPGNFSXN))\PYGZhy{}(LOG(MDANEIMPGNFSXN(\PYGZhy{}1))))) )) * (1\PYGZhy{}MDANVINDTOTLXN\PYGZus{}D)+ MDANVINDTOTLXN\PYGZus{}X*MDANVINDTOTLXN\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDANVSRVCONTXN = (MDANVSRVCONTXN(\PYGZhy{}1)*EXP(MDANVSRVCONTXN\PYGZus{}A+ (1.21058375527728*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))+(1\PYGZhy{}1.21058375527728)*((LOG(MDANEIMPGNFSXN))\PYGZhy{}(LOG(MDANEIMPGNFSXN(\PYGZhy{}1))))) )) * (1\PYGZhy{}MDANVSRVCONTXN\PYGZus{}D)+ MDANVSRVCONTXN\PYGZus{}X*MDANVSRVCONTXN\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDANVSRVWHLEXN = (MDANVSRVWHLEXN(\PYGZhy{}1)*EXP(MDANVSRVWHLEXN\PYGZus{}A+ (0.939249117801536*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))+(1\PYGZhy{}0.939249117801536)*((LOG(MDANEIMPGNFSXN))\PYGZhy{}(LOG(MDANEIMPGNFSXN(\PYGZhy{}1))))) )) * (1\PYGZhy{}MDANVSRVWHLEXN\PYGZus{}D)+ MDANVSRVWHLEXN\PYGZus{}X*MDANVSRVWHLEXN\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDANVSRVTRNSXN = (MDANVSRVTRNSXN(\PYGZhy{}1)*EXP(MDANVSRVTRNSXN\PYGZus{}A+ (0.972053736234501*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))+(1\PYGZhy{}0.972053736234501)*((LOG(MDANEIMPGNFSXN))\PYGZhy{}(LOG(MDANEIMPGNFSXN(\PYGZhy{}1))))) )) * (1\PYGZhy{}MDANVSRVTRNSXN\PYGZus{}D)+ MDANVSRVTRNSXN\PYGZus{}X*MDANVSRVTRNSXN\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDANVSRVACCMXN = (MDANVSRVACCMXN(\PYGZhy{}1)*EXP(MDANVSRVACCMXN\PYGZus{}A+ (1.09148732426661*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))+(1\PYGZhy{}1.09148732426661)*((LOG(MDANEIMPGNFSXN))\PYGZhy{}(LOG(MDANEIMPGNFSXN(\PYGZhy{}1))))) )) * (1\PYGZhy{}MDANVSRVACCMXN\PYGZus{}D)+ MDANVSRVACCMXN\PYGZus{}X*MDANVSRVACCMXN\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDANVSRVINFOXN = (MDANVSRVINFOXN(\PYGZhy{}1)*EXP(MDANVSRVINFOXN\PYGZus{}A+ (0.421485464414997*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))+(1\PYGZhy{}0.421485464414997)*((LOG(MDANEIMPGNFSXN))\PYGZhy{}(LOG(MDANEIMPGNFSXN(\PYGZhy{}1))))) )) * (1\PYGZhy{}MDANVSRVINFOXN\PYGZus{}D)+ MDANVSRVINFOXN\PYGZus{}X*MDANVSRVINFOXN\PYGZus{}D  \PYGZdl{}
FRML \PYGZlt{}Z,EXO\PYGZgt{} MDANVSRVFINAXN = (MDANVSRVFINAXN(\PYGZhy{}1)*EXP(MDANVSRVFINAXN\PYGZus{}A+ (\PYGZhy{}0.0691541484208101*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))+(1+0.0691541484208101)*((LOG(MDANEIMPGNFSXN))\PYGZhy{}(LOG(MDANEIMPGNFSXN(\PYGZhy{}1))))) )) * (1\PYGZhy{}MDANVSRVFINAXN\PYGZus{}D)+ MDANVSRVFINAXN\PYGZus{}X*MDANVSRVFINAXN\PYGZus{}D  \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANVSRVOTHRXN = MDANVSRVOTHRCN/MDANVSRVOTHRKN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANVSRVOTHRCN = MDANYGDPFCSTCN\PYGZhy{}MDANVAGRTOTLCN\PYGZhy{}MDANVINDTOTLCN\PYGZhy{}MDANVSRVCONTCN\PYGZhy{}MDANVSRVWHLECN\PYGZhy{}MDANVSRVTRNSCN\PYGZhy{}MDANVSRVACCMCN\PYGZhy{}MDANVSRVINFOCN\PYGZhy{}MDANVSRVFINACN\PYGZhy{}MDANVGDPDISCCN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANVAGRTOTLCN = MDANVAGRTOTLKN*MDANVAGRTOTLXN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANVINDTOTLCN = MDANVINDTOTLKN*MDANVINDTOTLXN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANVSRVCONTCN = MDANVSRVCONTKN*MDANVSRVCONTXN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANVSRVWHLECN = MDANVSRVWHLEKN*MDANVSRVWHLEXN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANVSRVTRNSCN = MDANVSRVTRNSKN*MDANVSRVTRNSXN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANVSRVACCMCN = MDANVSRVACCMKN*MDANVSRVACCMXN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANVSRVINFOCN = MDANVSRVINFOKN*MDANVSRVINFOXN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANVSRVFINACN = MDANVSRVFINAKN*MDANVSRVFINAXN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDAIOCONPRVTKN = 0.117329993386964*MDANVAGRTOTLKN+0.569984424289192*MDANVINDTOTLKN+0.0148694094060245*MDANVSRVCONTKN+0.00110846513014049*MDANVSRVWHLEKN+0.0470474115150646*MDANVSRVTRNSKN+0.017042866672113*MDANVSRVACCMKN+0.0400283030556697*MDANVSRVINFOKN+0.0184409978087097*MDANVSRVFINAKN+0.174148128736122*MDANVSRVOTHRKN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDAIOCONGOVTKN = 0.0148291818908477*MDANVAGRTOTLKN+0.010690747330332*MDANVINDTOTLKN+0*MDANVSRVCONTKN+0*MDANVSRVWHLEKN+0*MDANVSRVTRNSKN+0*MDANVSRVACCMKN+0*MDANVSRVINFOKN+0*MDANVSRVFINAKN+0.97448007077882*MDANVSRVOTHRKN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDAIOEXPGNFSKN = 0.159326200138187*MDANVAGRTOTLKN+0.597848197484825*MDANVINDTOTLKN+0.00901989289834764*MDANVSRVCONTKN+0.000993684418669372*MDANVSRVWHLEKN+0.133548508424532*MDANVSRVTRNSKN+0.0175969210821395*MDANVSRVACCMKN+0.0475368964745722*MDANVSRVINFOKN+0.0036628844171434*MDANVSRVFINAKN+0.0304668146615837*MDANVSRVOTHRKN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDAIOEXPAGRTKN = 1*MDANVAGRTOTLKN+0*MDANVINDTOTLKN+0*MDANVSRVCONTKN+0*MDANVSRVWHLEKN+0*MDANVSRVTRNSKN+0*MDANVSRVACCMKN+0*MDANVSRVINFOKN+0*MDANVSRVFINAKN+0*MDANVSRVOTHRKN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDAIOEXPOTHRKN = 0*MDANVAGRTOTLKN+0.711153597962845*MDANVINDTOTLKN+0.0107293612573989*MDANVSRVCONTKN+0.00118200950098922*MDANVSRVWHLEKN+0.158858892053594*MDANVSRVTRNSKN+0.0209319251831472*MDANVSRVACCMKN+0.0565461853127648*MDANVSRVINFOKN+0.00435708168583997*MDANVSRVFINAKN+0.0362409470434213*MDANVSRVOTHRKN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDAIOGDIFTOTKN = 0.0326625963691576*MDANVAGRTOTLKN+0.381999028539556*MDANVINDTOTLKN+0.538147507656802*MDANVSRVCONTKN+0*MDANVSRVWHLEKN+0*MDANVSRVTRNSKN+0*MDANVSRVACCMKN+0*MDANVSRVINFOKN+0*MDANVSRVFINAKN+0.0471908674344848*MDANVSRVOTHRKN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDAIOGDISTKBKN = 0.0474487689906466*MDANVAGRTOTLKN+0.952549892992068*MDANVINDTOTLKN+0*MDANVSRVCONTKN+0*MDANVSRVWHLEKN+0*MDANVSRVTRNSKN+0*MDANVSRVACCMKN+0*MDANVSRVINFOKN+0*MDANVSRVFINAKN+1.33801728585681E\PYGZhy{}06*MDANVSRVOTHRKN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDAIOIMPGNFSKN = 0.0285727001640423*MDANVAGRTOTLKN+0.89795376226341*MDANVINDTOTLKN+0.00502467253166018*MDANVSRVCONTKN+0.000421483072262446*MDANVSRVWHLEKN+0.0285524601638301*MDANVSRVTRNSKN+0.00709480244507614*MDANVSRVACCMKN+0.0108773594141113*MDANVSRVINFOKN+0.00638335801445772*MDANVSRVFINAKN+0.0151194019311494*MDANVSRVOTHRKN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANYGDPFCSTKN = MDANYGDPMKTPKN\PYGZhy{}MDANYTAXNINDKN \PYGZdl{}
FRML  \PYGZlt{}\PYGZgt{} MDANVSRVWHLEKN = MDANYGDPFCSTKN\PYGZhy{}(MDANVAGRTOTLKN+MDANVINDTOTLKN+MDANVSRVCONTKN+MDANVSRVTRNSKN+MDANVSRVACCMKN+MDANVSRVINFOKN+MDANVSRVFINAKN+MDANVSRVOTHRKN+MDANVGDPDISCKN) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDANYGDPFCSTXN\PYGZus{}FITTED = MDANYGDPFCSTXN(\PYGZhy{}1)*EXP( (0.197543704108975*((LOG(MDANYGDPFCSTXN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}2))))+(1\PYGZhy{}0.197543704108975)*(0.3*MDAINFLEXPT/100+(1\PYGZhy{}0.3)*((LOG(MDAPSTAR))\PYGZhy{}(LOG(MDAPSTAR(\PYGZhy{}1)))))+0.3*MDANYGDPGAP\PYGZus{}/100+0.0103490916251564*DURING\PYGZus{}2011\PYGZhy{}0.119727211086869*DURING\PYGZus{}2009) ) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDAFMLBLPOLYXN\PYGZus{}FITTED = 100* (0.7*MDAFMLBLPOLYXN(\PYGZhy{}1)/100+(1\PYGZhy{}0.7)*(0.108512280547198+1.5*(((LOG(MDANECONPRVTXN))\PYGZhy{}(LOG(MDANECONPRVTXN(\PYGZhy{}1))))\PYGZhy{}MDAINFLEXPT/100)+0.6*MDANYGDPGAP\PYGZus{}/100))  \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDANECONPRVTKN\PYGZus{}FITTED = MDANECONPRVTKN(\PYGZhy{}1)*EXP( (\PYGZhy{}0.534235170141198*(LOG(MDANECONPRVTKN(\PYGZhy{}1))\PYGZhy{}LOG(((1\PYGZhy{}MDAGGREVTPITXN/100)*(1\PYGZhy{}MDAGGREVSSOCXN/100)*MDANYYWBTOTLCN(\PYGZhy{}1)+MDAGGEXPTRNSCN(\PYGZhy{}1)+MDABNFSTSTRNCD(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1)+MDABNFSTPCOECD(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1))/MDANECONPRVTXN(\PYGZhy{}1)))+0.571611921075017*((LOG(((1\PYGZhy{}MDAGGREVTPITXN/100)*(1\PYGZhy{}MDAGGREVSSOCXN/100)*MDANYYWBTOTLCN+MDAGGEXPTRNSCN+MDABNFSTSTRNCD*MDAPANUSATLS+MDABNFSTPCOECD*MDAPANUSATLS)/MDANECONPRVTXN))\PYGZhy{}(LOG(((1\PYGZhy{}MDAGGREVTPITXN(\PYGZhy{}1)/100)*(1\PYGZhy{}MDAGGREVSSOCXN(\PYGZhy{}1)/100)*MDANYYWBTOTLCN(\PYGZhy{}1)+MDAGGEXPTRNSCN(\PYGZhy{}1)+MDABNFSTSTRNCD(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1)+MDABNFSTPCOECD(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1))/MDANECONPRVTXN(\PYGZhy{}1))))+(1\PYGZhy{}0.571611921075017)*MDAGR+0.0302887358479325) ) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDANECONPRVTXN\PYGZus{}FITTED = MDANECONPRVTXN(\PYGZhy{}1)*EXP( (\PYGZhy{}0.35*(LOG(MDANECONPRVTXN(\PYGZhy{}1))\PYGZhy{}0.829507589240535*LOG(MDANYGDPFCSTXN(\PYGZhy{}1))\PYGZhy{}(1\PYGZhy{}0.829507589240535)*LOG(MDANEIMPGNFSXN(\PYGZhy{}1))\PYGZhy{}LOG(1+MDAGGREVVATDXN(\PYGZhy{}1)/100))+0.774735420555399*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))+(1\PYGZhy{}0.774735420555399)*((LOG(MDANEIMPGNFSXN))\PYGZhy{}(LOG(MDANEIMPGNFSXN(\PYGZhy{}1))))\PYGZhy{}0.0128830876051222+((MDAGGREVVATDXN/100)\PYGZhy{}(MDAGGREVVATDXN(\PYGZhy{}1)/100))) ) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDANECONGOVTCN\PYGZus{}FITTED =  (((MDAGGEXPGNFSCN+MDAGGEXPWAGECN)\PYGZhy{}(MDAGGEXPGNFSCN(\PYGZhy{}1)+MDAGGEXPWAGECN(\PYGZhy{}1)))*MDANECONGOVTCOV\PYGZus{}/100+78.9812762019829*DUMH) +MDANECONGOVTCN(\PYGZhy{}1) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDANECONGOVTXN\PYGZus{}FITTED = MDANECONGOVTXN(\PYGZhy{}1)*EXP( (\PYGZhy{}0.35*(LOG(MDANECONGOVTXN(\PYGZhy{}1))\PYGZhy{}LOG(MDANECONPRVTXN(\PYGZhy{}1))\PYGZhy{}LOG(1+MDAGGREVVATDXN(\PYGZhy{}1)/100))\PYGZhy{}0.435409373323052+((LOG(MDANECONPRVTXN))\PYGZhy{}(LOG(MDANECONPRVTXN(\PYGZhy{}1))))+0.0136318410176717*T\PYGZus{}LR+((MDAGGREVVATDXN/100)\PYGZhy{}(MDAGGREVVATDXN(\PYGZhy{}1)/100))) ) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDANEGDIFTOTXN\PYGZus{}FITTED = MDANEGDIFTOTXN(\PYGZhy{}1)*EXP( (\PYGZhy{}0.618632444397103*(LOG(MDANEGDIFTOTXN(\PYGZhy{}1))\PYGZhy{}0.574681347908539*LOG(MDANYGDPFCSTXN(\PYGZhy{}1))\PYGZhy{}(1\PYGZhy{}0.574681347908539)*LOG(MDANEIMPGNFSXN(\PYGZhy{}1)))+0.00252520630407499+0.435002280297711*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))+(1\PYGZhy{}0.435002280297711)*((LOG(MDANEIMPGNFSXN))\PYGZhy{}(LOG(MDANEIMPGNFSXN(\PYGZhy{}1))))) ) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDANEGDIFPRVKN\PYGZus{}FITTED = MDANEGDIFPRVKN(\PYGZhy{}1)*EXP( (\PYGZhy{}0.312870852277258*(LOG(MDANEGDIFTOTKN(\PYGZhy{}1))\PYGZhy{}LOG(MDANYGDPPOTLKN(\PYGZhy{}1)))\PYGZhy{}0.537020065044523+0.220071067703888*((LOG(MDANEGDIFPRVKN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDANEGDIFPRVKN(\PYGZhy{}2))))+(1\PYGZhy{}0.220071067703888)*(((LOG(MDANEGDETTOTKN\PYGZhy{}MDANEGDIFTOTKN))\PYGZhy{}(LOG(MDANEGDETTOTKN(\PYGZhy{}1)\PYGZhy{}MDANEGDIFTOTKN(\PYGZhy{}1))))\PYGZhy{}0.15*((LOG(MDANEKRTTOTLXN))\PYGZhy{}(LOG(MDANEKRTTOTLXN(\PYGZhy{}1)))))\PYGZhy{}0.266889444067425*DURING\PYGZus{}2008+0.00424042413096946*T\PYGZus{}LR) ) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDANEEXPGNFSKN\PYGZus{}FITTED = MDANEEXPGNFSKN(\PYGZhy{}1)*EXP( (\PYGZhy{}0.336730629453757*(LOG(MDANEEXPGNFSKN(\PYGZhy{}1))\PYGZhy{}LOG(MDAXMKT(\PYGZhy{}1))+0.2*LOG(MDANEEXPGNFSXN(\PYGZhy{}1)/(MDANYGDPFCSTXN(\PYGZhy{}1))))+((LOG(MDAXMKT))\PYGZhy{}(LOG(MDAXMKT(\PYGZhy{}1))))\PYGZhy{}0.345691440406372*((LOG(MDANEEXPGNFSXN/MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANEEXPGNFSXN(\PYGZhy{}1)/MDANYGDPFCSTXN(\PYGZhy{}1))))+2.84032004924203+0.015458379408832*T\PYGZus{}LR) ) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDANEEXPGNFSXN\PYGZus{}FITTED = MDANEEXPGNFSXN(\PYGZhy{}1)*EXP( (\PYGZhy{}0.689680638262842*(LOG(MDANEEXPGNFSXN(\PYGZhy{}1))\PYGZhy{}0.603631334048721*LOG(MDANYGDPFCSTXN(\PYGZhy{}1))\PYGZhy{}(1\PYGZhy{}0.603631334048721)*LOG(MDAPXKEY(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1)))+1.06714218353871*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))+(1\PYGZhy{}1.06714218353871)*((LOG(MDAPXKEY*MDAPANUSATLS))\PYGZhy{}(LOG(MDAPXKEY(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1))))+0.0593246295410032\PYGZhy{}0.0247522128533159*T\PYGZus{}LR) ) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDANEEXPAGRTXN\PYGZus{}FITTED = MDANEEXPAGRTXN(\PYGZhy{}1)*EXP( (\PYGZhy{}0.3*(LOG(MDANEEXPAGRTXN(\PYGZhy{}1))\PYGZhy{}(1\PYGZhy{}1.3186882875842)*LOG(MDANYGDPFCSTXN(\PYGZhy{}1))\PYGZhy{}1.3186882875842*LOG(MDAWLDFAGRTOTLXD(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1)))\PYGZhy{}2.85770216483863+1.3186882875842*((LOG(MDAWLDFAGRTOTLXD*MDAPANUSATLS))\PYGZhy{}(LOG(MDAWLDFAGRTOTLXD(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1))))+(1\PYGZhy{}1.3186882875842)*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))) ) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDANEIMPGNFSKN\PYGZus{}FITTED = MDANEIMPGNFSKN(\PYGZhy{}1)*EXP( (\PYGZhy{}0.218751344210448*(LOG(MDANEIMPGNFSKN(\PYGZhy{}1))\PYGZhy{}LOG(MDANEGDETTOTKN(\PYGZhy{}1))+0.248762098352762*LOG(MDANEIMPGNFSXN(\PYGZhy{}1)/(MDANYGDPFCSTXN(\PYGZhy{}1))))+(((LOG(MDANEGDETTOTKN))\PYGZhy{}(LOG(MDANEGDETTOTKN(\PYGZhy{}1))))\PYGZhy{}((LOG(MDANYGDPPOTLKN))\PYGZhy{}(LOG(MDANYGDPPOTLKN(\PYGZhy{}1)))))+MDAGR\PYGZhy{}0.248762098352762*((LOG(MDANEIMPGNFSXN/MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANEIMPGNFSXN(\PYGZhy{}1)/MDANYGDPFCSTXN(\PYGZhy{}1))))\PYGZhy{}0.336531838649722+0.00576104613986022*T\PYGZus{}LR) ) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDANEIMPGNFSXN\PYGZus{}FITTED = MDANEIMPGNFSXN(\PYGZhy{}1)*EXP( (\PYGZhy{}0.564370575830738*(LOG(MDANEIMPGNFSXN(\PYGZhy{}1))\PYGZhy{}0.25*LOG(MDANYGDPFCSTXN(\PYGZhy{}1))\PYGZhy{}(1\PYGZhy{}0.25)*LOG(MDAPMKEY(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1))\PYGZhy{}LOG(1+MDAGGREVVATMXN(\PYGZhy{}1)/100))+0.25*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))+(1\PYGZhy{}0.25)*((LOG(MDAPMKEY*MDAPANUSATLS))\PYGZhy{}(LOG(MDAPMKEY(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1))))\PYGZhy{}1.18325081713964+((MDAGGREVVATMXN/100)\PYGZhy{}(MDAGGREVVATMXN(\PYGZhy{}1)/100))) ) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDALMEMPTOTL\PYGZus{}FITTED = MDALMEMPTOTL(\PYGZhy{}1)*EXP( (\PYGZhy{}0.183075987473735*(LOG(MDALMEMPTOTL(\PYGZhy{}1))\PYGZhy{}LOG(MDALMEMPSTRL(\PYGZhy{}1)))+((LOG(MDALMEMPSTRL))\PYGZhy{}(LOG(MDALMEMPSTRL(\PYGZhy{}1))))+0.581694127104354*(((LOG(MDANYGDPMKTPKN))\PYGZhy{}(LOG(MDANYGDPMKTPKN(\PYGZhy{}1))))\PYGZhy{}MDAGR)\PYGZhy{}0.688544000289914*(((LOG(MDANYWRTTOTLXN/MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYWRTTOTLXN(\PYGZhy{}1)/MDANYGDPFCSTXN(\PYGZhy{}1))))\PYGZhy{}((LOG(MDANYGDPTFP))\PYGZhy{}(LOG(MDANYGDPTFP(\PYGZhy{}1))))/MDANYYWBTOTL\PYGZus{})) ) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDANYWRTTOTLXN\PYGZus{}FITTED = MDANYWRTTOTLXN(\PYGZhy{}1)*EXP( (((LOG(MDANECONPRVTXN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDANECONPRVTXN(\PYGZhy{}2))))+((LOG(MDANYGDPPOTLKN/MDALMEMPSTRL))\PYGZhy{}(LOG(MDANYGDPPOTLKN(\PYGZhy{}1)/MDALMEMPSTRL(\PYGZhy{}1))))\PYGZhy{}0.5*(MDALMUNRTOTL\PYGZus{}\PYGZhy{}MDALMUNRSTRL\PYGZus{})/100\PYGZhy{}0.26929290393266*DURING\PYGZus{}2009) ) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDALMPRTTOTL\PYGZus{}\PYGZus{}FITTED =  (0.415124722480563*(MDALMPRTTOTL\PYGZus{}(\PYGZhy{}1))+(1\PYGZhy{}0.415124722480563)*(MDALMPRTSTRL\PYGZus{}))  \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDAGGREVTCITCN\PYGZus{}FITTED =  (1* (100 * ( (MDAGGREVTCITXN/100*MDANYGDPMKTPCN) / (MDAGGREVTCITXN(\PYGZhy{}1)/100*MDANYGDPMKTPCN(\PYGZhy{}1)) \PYGZhy{}1))) *MDAGGREVTCITCN(\PYGZhy{}1)/100+MDAGGREVTCITCN(\PYGZhy{}1) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDAGGREVTPITCN\PYGZus{}FITTED =  (1* (100 * ( (MDAGGREVTPITXN/100*MDANYYWBTOTLCN) / (MDAGGREVTPITXN(\PYGZhy{}1)/100*MDANYYWBTOTLCN(\PYGZhy{}1)) \PYGZhy{}1))) *MDAGGREVTPITCN(\PYGZhy{}1)/100+MDAGGREVTPITCN(\PYGZhy{}1) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDAGGREVSSOCCN\PYGZus{}FITTED =  (1* (100 * ( (MDAGGREVSSOCXN/100*MDANYYWBTOTLCN) / (MDAGGREVSSOCXN(\PYGZhy{}1)/100*MDANYYWBTOTLCN(\PYGZhy{}1)) \PYGZhy{}1))) *MDAGGREVSSOCCN(\PYGZhy{}1)/100+MDAGGREVSSOCCN(\PYGZhy{}1) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDAGGREVVATDCN\PYGZus{}FITTED =  (1* (100 * ( (MDAGGREVVATDXN/100*(MDANECONPRVTCN+MDANECONGOVTCN)) / (MDAGGREVVATDXN(\PYGZhy{}1)/100*(MDANECONPRVTCN(\PYGZhy{}1)+MDANECONGOVTCN(\PYGZhy{}1))) \PYGZhy{}1))) *MDAGGREVVATDCN(\PYGZhy{}1)/100+MDAGGREVVATDCN(\PYGZhy{}1) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDAGGREVVATMCN\PYGZus{}FITTED =  (1* (100 * ( (MDAGGREVVATMXN/100*(MDANEIMPGNFSCN)) / (MDAGGREVVATMXN(\PYGZhy{}1)/100*(MDANEIMPGNFSCN(\PYGZhy{}1))) \PYGZhy{}1))) *MDAGGREVVATMCN(\PYGZhy{}1)/100+MDAGGREVVATMCN(\PYGZhy{}1) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDAGGREVVATXCN\PYGZus{}FITTED = MDANECONGOVTCN* (2.57630681423735) /100+MDANECONPRVTCN* (2.57630681423735) /100 \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDAGGREVTRDECN\PYGZus{}FITTED = MDANEEXPGNFSCN* (1.25164890853099) /100+MDANEIMPGNFSCN* (1.25164890853099) /100 \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDAGGREVGRNTCN\PYGZus{}FITTED = MDANYGDPMKTPCN* (0.862196453658808) /100 \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDAGGREVOTHRCN\PYGZus{}FITTED = MDANYGDPMKTPCN* (3.11360965029002) /100 \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDAGGEXPWAGECN\PYGZus{}FITTED = MDANYGDPMKTPXN*MDAGGEXPWAGECN(\PYGZhy{}1)*EXP( (\PYGZhy{}0.3*(LOG(MDAGGEXPWAGECN(\PYGZhy{}1)/MDANYGDPMKTPXN(\PYGZhy{}1))\PYGZhy{}LOG(MDANYGDPPOTLKN(\PYGZhy{}1)))\PYGZhy{}0.0832410088126464*((LOG(MDAGGEXPWAGECN(\PYGZhy{}1)/MDANYGDPMKTPXN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDAGGEXPWAGECN(\PYGZhy{}2)/MDANYGDPMKTPXN(\PYGZhy{}2))))+(1+0.0832410088126464)*MDAGR\PYGZhy{}0.773634130131987) )/MDANYGDPMKTPXN(\PYGZhy{}1) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDAGGEXPGNFSCN\PYGZus{}FITTED = MDANYGDPMKTPXN*MDAGGEXPGNFSCN(\PYGZhy{}1)*EXP( (\PYGZhy{}0.3*(LOG(MDAGGEXPGNFSCN(\PYGZhy{}1)/MDANYGDPMKTPXN(\PYGZhy{}1))\PYGZhy{}LOG(MDANYGDPPOTLKN(\PYGZhy{}1)))\PYGZhy{}0.244712417380816*((LOG(MDAGGEXPGNFSCN(\PYGZhy{}1)/MDANYGDPMKTPXN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDAGGEXPGNFSCN(\PYGZhy{}2)/MDANYGDPMKTPXN(\PYGZhy{}2))))+(1+0.244712417380816)*MDAGR\PYGZhy{}0.806178876325669) )/MDANYGDPMKTPXN(\PYGZhy{}1) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDAGGEXPTRNSCN\PYGZus{}FITTED = MDANYGDPMKTPXN*MDAGGEXPTRNSCN(\PYGZhy{}1)*EXP( (\PYGZhy{}0.3*(LOG(MDAGGEXPTRNSCN(\PYGZhy{}1)/MDANYGDPMKTPXN(\PYGZhy{}1))\PYGZhy{}LOG(MDANYGDPPOTLKN(\PYGZhy{}1)))\PYGZhy{}0.475511831460235*((LOG(MDAGGEXPTRNSCN(\PYGZhy{}1)/MDANYGDPMKTPXN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDAGGEXPTRNSCN(\PYGZhy{}2)/MDANYGDPMKTPXN(\PYGZhy{}2))))+(1+0.475511831460235)*MDAGR\PYGZhy{}0.640727459385319) )/MDANYGDPMKTPXN(\PYGZhy{}1) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDAGGEXPCAPTCN\PYGZus{}FITTED = MDANYGDPMKTPXN*MDAGGEXPCAPTCN(\PYGZhy{}1)*EXP( (\PYGZhy{}0.3*(LOG(MDAGGEXPCAPTCN(\PYGZhy{}1)/MDANYGDPMKTPXN(\PYGZhy{}1))\PYGZhy{}LOG(MDANYGDPPOTLKN(\PYGZhy{}1)))+0.27663427827676*((LOG(MDAGGEXPCAPTCN(\PYGZhy{}1)/MDANYGDPMKTPXN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDAGGEXPCAPTCN(\PYGZhy{}2)/MDANYGDPMKTPXN(\PYGZhy{}2))))+(1\PYGZhy{}0.27663427827676)*MDAGR\PYGZhy{}1.03766125029565) )/MDANYGDPMKTPXN(\PYGZhy{}1) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDAGGEXPOTHRCN\PYGZus{}FITTED = MDANYGDPMKTPCN* (1.49239295839917) /100 \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDAGGEXPCRNOCN\PYGZus{}FITTED = MDANYGDPMKTPCN* (0.754699479458526) /100 \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDABXGSRGNFSCD\PYGZus{}FITTED =  ((100 * ( (MDANEEXPGNFSCN/MDAPANUSATLS) / (MDANEEXPGNFSCN(\PYGZhy{}1)/MDAPANUSATLS(\PYGZhy{}1)) \PYGZhy{}1)) \PYGZhy{}0.0279008217603989*DUMH) *MDABXGSRGNFSCD(\PYGZhy{}1)/100+MDABXGSRGNFSCD(\PYGZhy{}1) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDABXGSRAGRTCD\PYGZus{}FITTED =  ((100 * ( (MDANEEXPAGRTCN/MDAPANUSATLS) / (MDANEEXPAGRTCN(\PYGZhy{}1)/MDAPANUSATLS(\PYGZhy{}1)) \PYGZhy{}1)) +2.52429656125299E\PYGZhy{}15*DUMH) *MDABXGSRAGRTCD(\PYGZhy{}1)/100+MDABXGSRAGRTCD(\PYGZhy{}1) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDABMGSRGNFSCD\PYGZus{}FITTED =  ((100 * ( (MDANEIMPGNFSCN/MDAPANUSATLS) / (MDANEIMPGNFSCN(\PYGZhy{}1)/MDAPANUSATLS(\PYGZhy{}1)) \PYGZhy{}1)) \PYGZhy{}0.150835412701402*DUMH) *MDABMGSRGNFSCD(\PYGZhy{}1)/100+MDABMGSRGNFSCD(\PYGZhy{}1) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDABMGSRFUELCD\PYGZus{}FITTED =  ((100 * ( (MDANEIMPFUELCN/MDAPANUSATLS) / (MDANEIMPFUELCN(\PYGZhy{}1)/MDAPANUSATLS(\PYGZhy{}1)) \PYGZhy{}1)) +0*DUMH) *MDABMGSRFUELCD(\PYGZhy{}1)/100+MDABMGSRFUELCD(\PYGZhy{}1) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDABNFSTSTRNCD\PYGZus{}FITTED = MDANYGDPMKTPXN*MDABNFSTSTRNCD(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1)*EXP( (1.21239586043243*MDAGR+(1\PYGZhy{}1.21239586043243)*((LOG((MDABNFSTSTRNCD(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1))/MDANYGDPMKTPXN(\PYGZhy{}1)))\PYGZhy{}(LOG((MDABNFSTSTRNCD(\PYGZhy{}2)*MDAPANUSATLS(\PYGZhy{}2))/MDANYGDPMKTPXN(\PYGZhy{}2))))) )/(MDAPANUSATLS*MDANYGDPMKTPXN(\PYGZhy{}1)) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDABNFSTPCOECD\PYGZus{}FITTED = MDANYGDPMKTPXN*MDABNFSTPCOECD(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1)*EXP( (0.669088437645741*MDAGR+(1\PYGZhy{}0.669088437645741)*((LOG((MDABNFSTPCOECD(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1))/MDANYGDPMKTPXN(\PYGZhy{}1)))\PYGZhy{}(LOG((MDABNFSTPCOECD(\PYGZhy{}2)*MDAPANUSATLS(\PYGZhy{}2))/MDANYGDPMKTPXN(\PYGZhy{}2))))) )/(MDAPANUSATLS*MDANYGDPMKTPXN(\PYGZhy{}1)) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDABNFSTOTHRCD\PYGZus{}FITTED = MDANYGDPMKTPCD* (0.113187073392889\PYGZhy{}0.00250912199388566*T\PYGZus{}LR)  \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDABFCAFCAPTCD\PYGZus{}FITTED = MDANYGDPMKTPCN* (0.00282736002227067) /MDAPANUSATLS \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDABFCAFFFDICD\PYGZus{}FITTED = MDANYGDPMKTPCN* (\PYGZhy{}0.028376216546585) /MDAPANUSATLS \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDABFCAFFPFTCD\PYGZus{}FITTED = MDANYGDPMKTPCN* (\PYGZhy{}0.000240950762685102) /MDAPANUSATLS \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDABFCAFOTHRCD\PYGZus{}FITTED = MDANYGDPMKTPCN* (\PYGZhy{}0.0515665290620459) /MDAPANUSATLS \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDABFCAFRACGCD\PYGZus{}FITTED = \PYGZhy{}MDABNCABFUNDCD\PYGZhy{}MDABFCAFFINXCD\PYGZhy{}MDABFCAFCAPTCD\PYGZhy{}MDABFCAFNEOMCD\PYGZhy{}1176.08181818182*DUMH \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDAPANUSATLS\PYGZus{}FITTED = MDAPANUSATLS(\PYGZhy{}1)*EXP( (0.41922820233295*((LOG(MDAPANUSATLS(\PYGZhy{}1)))\PYGZhy{}(LOG(MDAPANUSATLS(\PYGZhy{}2))))+(1\PYGZhy{}0.41922820233295)*((LOG((1+MDAUSAFMLBLPOLYFR/100)/(1+MDAFMLBLPOLYXN/100)))\PYGZhy{}(LOG((1+MDAUSAFMLBLPOLYFR(\PYGZhy{}1)/100)/(1+MDAFMLBLPOLYXN(\PYGZhy{}1)/100))))) ) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDAFPCPITOTLXN\PYGZus{}FITTED = MDAFPCPITOTLXN(\PYGZhy{}1)*EXP( (\PYGZhy{}1.37696081847616*(LOG(MDAFPCPITOTLXN(\PYGZhy{}1))\PYGZhy{}LOG(MDANECONPRVTXN(\PYGZhy{}1)))+9.99703744406243+0.00326070346873517*T\PYGZus{}LR+((LOG(MDANECONPRVTXN))\PYGZhy{}(LOG(MDANECONPRVTXN(\PYGZhy{}1))))) ) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDANYGDPDISCCN\PYGZus{}FITTED = MDANYGDPMKTPCN* (\PYGZhy{}0.0104830273967771)  \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDANVAGRTOTLKN\PYGZus{}FITTED = MDANVAGRTOTLKN(\PYGZhy{}1)*EXP( (1.42808459809626*((LOG(MDANYGDPPOTLKN))\PYGZhy{}(LOG(MDANYGDPPOTLKN(\PYGZhy{}1))))+(1\PYGZhy{}1.42808459809626)*((LOG(MDANVAGRTOTLKN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDANVAGRTOTLKN(\PYGZhy{}2))))) ) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDANVINDTOTLKN\PYGZus{}FITTED = MDANVINDTOTLKN(\PYGZhy{}1)*EXP( (1.43892189150108*((LOG(MDANYGDPPOTLKN))\PYGZhy{}(LOG(MDANYGDPPOTLKN(\PYGZhy{}1))))+(1\PYGZhy{}1.43892189150108)*((LOG(MDANVINDTOTLKN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDANVINDTOTLKN(\PYGZhy{}2))))) ) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDANVSRVCONTKN\PYGZus{}FITTED = MDANVSRVCONTKN(\PYGZhy{}1)*EXP( (0.371368937381176*((LOG(MDANYGDPPOTLKN))\PYGZhy{}(LOG(MDANYGDPPOTLKN(\PYGZhy{}1))))+(1\PYGZhy{}0.371368937381176)*((LOG(MDANVSRVCONTKN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDANVSRVCONTKN(\PYGZhy{}2))))) ) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDANVSRVTRNSKN\PYGZus{}FITTED = MDANVSRVTRNSKN(\PYGZhy{}1)*EXP( (1.67475245888343*((LOG(MDANYGDPPOTLKN))\PYGZhy{}(LOG(MDANYGDPPOTLKN(\PYGZhy{}1))))+(1\PYGZhy{}1.67475245888343)*((LOG(MDANVSRVTRNSKN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDANVSRVTRNSKN(\PYGZhy{}2))))) ) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDANVSRVACCMKN\PYGZus{}FITTED = MDANVSRVACCMKN(\PYGZhy{}1)*EXP( (1.97626862992525*((LOG(MDANYGDPPOTLKN))\PYGZhy{}(LOG(MDANYGDPPOTLKN(\PYGZhy{}1))))+(1\PYGZhy{}1.97626862992525)*((LOG(MDANVSRVACCMKN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDANVSRVACCMKN(\PYGZhy{}2))))) ) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDANVSRVINFOKN\PYGZus{}FITTED = MDANVSRVINFOKN(\PYGZhy{}1)*EXP( (0.876628309230883*((LOG(MDANYGDPPOTLKN))\PYGZhy{}(LOG(MDANYGDPPOTLKN(\PYGZhy{}1))))+(1\PYGZhy{}0.876628309230883)*((LOG(MDANVSRVINFOKN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDANVSRVINFOKN(\PYGZhy{}2))))) ) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDANVSRVFINAKN\PYGZus{}FITTED = MDANVSRVFINAKN(\PYGZhy{}1)*EXP( (1.24316636274024*((LOG(MDANYGDPPOTLKN))\PYGZhy{}(LOG(MDANYGDPPOTLKN(\PYGZhy{}1))))+(1\PYGZhy{}1.24316636274024)*((LOG(MDANVSRVFINAKN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDANVSRVFINAKN(\PYGZhy{}2))))) ) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDANVSRVOTHRKN\PYGZus{}FITTED = MDANVSRVOTHRKN(\PYGZhy{}1)*EXP( (0.431580607334864*((LOG(MDANYGDPPOTLKN))\PYGZhy{}(LOG(MDANYGDPPOTLKN(\PYGZhy{}1))))+(1\PYGZhy{}0.431580607334864)*((LOG(MDANVSRVOTHRKN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDANVSRVOTHRKN(\PYGZhy{}2))))) ) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDANVAGRTOTLXN\PYGZus{}FITTED = MDANVAGRTOTLXN(\PYGZhy{}1)*EXP( (\PYGZhy{}0.3*(LOG(MDANVAGRTOTLXN(\PYGZhy{}1))\PYGZhy{}(1\PYGZhy{}0.15)*LOG(MDANYGDPFCSTXN(\PYGZhy{}1))\PYGZhy{}0.85*LOG(MDAWLDFAGRTOTLXD(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1)))\PYGZhy{}1.82179756558893+0.15*((LOG(MDAWLDFAGRTOTLXD*MDAPANUSATLS))\PYGZhy{}(LOG(MDAWLDFAGRTOTLXD(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1))))+(1\PYGZhy{}0.85)*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))) ) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDANVINDTOTLXN\PYGZus{}FITTED = MDANVINDTOTLXN(\PYGZhy{}1)*EXP( (\PYGZhy{}0.642555574166414*(LOG(MDANVINDTOTLXN(\PYGZhy{}1))\PYGZhy{}0.799550564777672*LOG(MDANYGDPFCSTXN(\PYGZhy{}1))\PYGZhy{}(1\PYGZhy{}0.799550564777672)*LOG(MDANEIMPGNFSXN(\PYGZhy{}1)))+0.0457961224580996+0.291567048935525*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))+(1\PYGZhy{}0.291567048935525)*((LOG(MDANEIMPGNFSXN))\PYGZhy{}(LOG(MDANEIMPGNFSXN(\PYGZhy{}1))))) ) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDANVSRVCONTXN\PYGZus{}FITTED = MDANVSRVCONTXN(\PYGZhy{}1)*EXP( (1.21058375527728*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))+(1\PYGZhy{}1.21058375527728)*((LOG(MDANEIMPGNFSXN))\PYGZhy{}(LOG(MDANEIMPGNFSXN(\PYGZhy{}1))))) ) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDANVSRVWHLEXN\PYGZus{}FITTED = MDANVSRVWHLEXN(\PYGZhy{}1)*EXP( (0.939249117801536*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))+(1\PYGZhy{}0.939249117801536)*((LOG(MDANEIMPGNFSXN))\PYGZhy{}(LOG(MDANEIMPGNFSXN(\PYGZhy{}1))))) ) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDANVSRVTRNSXN\PYGZus{}FITTED = MDANVSRVTRNSXN(\PYGZhy{}1)*EXP( (0.972053736234501*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))+(1\PYGZhy{}0.972053736234501)*((LOG(MDANEIMPGNFSXN))\PYGZhy{}(LOG(MDANEIMPGNFSXN(\PYGZhy{}1))))) ) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDANVSRVACCMXN\PYGZus{}FITTED = MDANVSRVACCMXN(\PYGZhy{}1)*EXP( (1.09148732426661*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))+(1\PYGZhy{}1.09148732426661)*((LOG(MDANEIMPGNFSXN))\PYGZhy{}(LOG(MDANEIMPGNFSXN(\PYGZhy{}1))))) ) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDANVSRVINFOXN\PYGZus{}FITTED = MDANVSRVINFOXN(\PYGZhy{}1)*EXP( (0.421485464414997*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))+(1\PYGZhy{}0.421485464414997)*((LOG(MDANEIMPGNFSXN))\PYGZhy{}(LOG(MDANEIMPGNFSXN(\PYGZhy{}1))))) ) \PYGZdl{}
FRML \PYGZlt{}FIT\PYGZgt{} MDANVSRVFINAXN\PYGZus{}FITTED = MDANVSRVFINAXN(\PYGZhy{}1)*EXP( (\PYGZhy{}0.0691541484208101*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))+(1+0.0691541484208101)*((LOG(MDANEIMPGNFSXN))\PYGZhy{}(LOG(MDANEIMPGNFSXN(\PYGZhy{}1))))) ) \PYGZdl{}FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDANYGDPFCSTXN\PYGZus{}A = \PYGZhy{} ((0.197543704108975*((LOG(MDANYGDPFCSTXN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}2))))+(1\PYGZhy{}0.197543704108975)*(0.3*MDAINFLEXPT/100+(1\PYGZhy{}0.3)*((LOG(MDAPSTAR))\PYGZhy{}(LOG(MDAPSTAR(\PYGZhy{}1)))))+0.3*MDANYGDPGAP\PYGZus{}/100+0.0103490916251564*DURING\PYGZus{}2011\PYGZhy{}0.119727211086869*DURING\PYGZus{}2009)) +LOG(MDANYGDPFCSTXN)\PYGZhy{}LOG(MDANYGDPFCSTXN(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDAFMLBLPOLYXN\PYGZus{}A = MDAFMLBLPOLYXN/100\PYGZhy{} ((0.7*MDAFMLBLPOLYXN(\PYGZhy{}1)/100+(1\PYGZhy{}0.7)*(0.108512280547198+1.5*(((LOG(MDANECONPRVTXN))\PYGZhy{}(LOG(MDANECONPRVTXN(\PYGZhy{}1))))\PYGZhy{}MDAINFLEXPT/100)+0.6*MDANYGDPGAP\PYGZus{}/100))) \PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDANECONPRVTKN\PYGZus{}A = \PYGZhy{} ((\PYGZhy{}0.534235170141198*(LOG(MDANECONPRVTKN(\PYGZhy{}1))\PYGZhy{}LOG(((1\PYGZhy{}MDAGGREVTPITXN/100)*(1\PYGZhy{}MDAGGREVSSOCXN/100)*MDANYYWBTOTLCN(\PYGZhy{}1)+MDAGGEXPTRNSCN(\PYGZhy{}1)+MDABNFSTSTRNCD(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1)+MDABNFSTPCOECD(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1))/MDANECONPRVTXN(\PYGZhy{}1)))+0.571611921075017*((LOG(((1\PYGZhy{}MDAGGREVTPITXN/100)*(1\PYGZhy{}MDAGGREVSSOCXN/100)*MDANYYWBTOTLCN+MDAGGEXPTRNSCN+MDABNFSTSTRNCD*MDAPANUSATLS+MDABNFSTPCOECD*MDAPANUSATLS)/MDANECONPRVTXN))\PYGZhy{}(LOG(((1\PYGZhy{}MDAGGREVTPITXN(\PYGZhy{}1)/100)*(1\PYGZhy{}MDAGGREVSSOCXN(\PYGZhy{}1)/100)*MDANYYWBTOTLCN(\PYGZhy{}1)+MDAGGEXPTRNSCN(\PYGZhy{}1)+MDABNFSTSTRNCD(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1)+MDABNFSTPCOECD(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1))/MDANECONPRVTXN(\PYGZhy{}1))))+(1\PYGZhy{}0.571611921075017)*MDAGR+0.0302887358479325)) +LOG(MDANECONPRVTKN)\PYGZhy{}LOG(MDANECONPRVTKN(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDANECONPRVTXN\PYGZus{}A = \PYGZhy{} ((\PYGZhy{}0.35*(LOG(MDANECONPRVTXN(\PYGZhy{}1))\PYGZhy{}0.829507589240535*LOG(MDANYGDPFCSTXN(\PYGZhy{}1))\PYGZhy{}(1\PYGZhy{}0.829507589240535)*LOG(MDANEIMPGNFSXN(\PYGZhy{}1))\PYGZhy{}LOG(1+MDAGGREVVATDXN(\PYGZhy{}1)/100))+0.774735420555399*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))+(1\PYGZhy{}0.774735420555399)*((LOG(MDANEIMPGNFSXN))\PYGZhy{}(LOG(MDANEIMPGNFSXN(\PYGZhy{}1))))\PYGZhy{}0.0128830876051222+((MDAGGREVVATDXN/100)\PYGZhy{}(MDAGGREVVATDXN(\PYGZhy{}1)/100)))) +LOG(MDANECONPRVTXN)\PYGZhy{}LOG(MDANECONPRVTXN(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDANECONGOVTCN\PYGZus{}A = MDANECONGOVTCN\PYGZhy{} ((((MDAGGEXPGNFSCN+MDAGGEXPWAGECN)\PYGZhy{}(MDAGGEXPGNFSCN(\PYGZhy{}1)+MDAGGEXPWAGECN(\PYGZhy{}1)))*MDANECONGOVTCOV\PYGZus{}/100+78.9812762019829*DUMH)) \PYGZhy{}MDANECONGOVTCN(\PYGZhy{}1)\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDANECONGOVTXN\PYGZus{}A = \PYGZhy{} ((\PYGZhy{}0.35*(LOG(MDANECONGOVTXN(\PYGZhy{}1))\PYGZhy{}LOG(MDANECONPRVTXN(\PYGZhy{}1))\PYGZhy{}LOG(1+MDAGGREVVATDXN(\PYGZhy{}1)/100))\PYGZhy{}0.435409373323052+((LOG(MDANECONPRVTXN))\PYGZhy{}(LOG(MDANECONPRVTXN(\PYGZhy{}1))))+0.0136318410176717*T\PYGZus{}LR+((MDAGGREVVATDXN/100)\PYGZhy{}(MDAGGREVVATDXN(\PYGZhy{}1)/100)))) +LOG(MDANECONGOVTXN)\PYGZhy{}LOG(MDANECONGOVTXN(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDANEGDIFTOTXN\PYGZus{}A = \PYGZhy{} ((\PYGZhy{}0.618632444397103*(LOG(MDANEGDIFTOTXN(\PYGZhy{}1))\PYGZhy{}0.574681347908539*LOG(MDANYGDPFCSTXN(\PYGZhy{}1))\PYGZhy{}(1\PYGZhy{}0.574681347908539)*LOG(MDANEIMPGNFSXN(\PYGZhy{}1)))+0.00252520630407499+0.435002280297711*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))+(1\PYGZhy{}0.435002280297711)*((LOG(MDANEIMPGNFSXN))\PYGZhy{}(LOG(MDANEIMPGNFSXN(\PYGZhy{}1)))))) +LOG(MDANEGDIFTOTXN)\PYGZhy{}LOG(MDANEGDIFTOTXN(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDANEGDIFPRVKN\PYGZus{}A = \PYGZhy{} ((\PYGZhy{}0.312870852277258*(LOG(MDANEGDIFTOTKN(\PYGZhy{}1))\PYGZhy{}LOG(MDANYGDPPOTLKN(\PYGZhy{}1)))\PYGZhy{}0.537020065044523+0.220071067703888*((LOG(MDANEGDIFPRVKN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDANEGDIFPRVKN(\PYGZhy{}2))))+(1\PYGZhy{}0.220071067703888)*(((LOG(MDANEGDETTOTKN\PYGZhy{}MDANEGDIFTOTKN))\PYGZhy{}(LOG(MDANEGDETTOTKN(\PYGZhy{}1)\PYGZhy{}MDANEGDIFTOTKN(\PYGZhy{}1))))\PYGZhy{}0.15*((LOG(MDANEKRTTOTLXN))\PYGZhy{}(LOG(MDANEKRTTOTLXN(\PYGZhy{}1)))))\PYGZhy{}0.266889444067425*DURING\PYGZus{}2008+0.00424042413096946*T\PYGZus{}LR)) +LOG(MDANEGDIFPRVKN)\PYGZhy{}LOG(MDANEGDIFPRVKN(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDANEEXPGNFSKN\PYGZus{}A = \PYGZhy{} ((\PYGZhy{}0.336730629453757*(LOG(MDANEEXPGNFSKN(\PYGZhy{}1))\PYGZhy{}LOG(MDAXMKT(\PYGZhy{}1))+0.2*LOG(MDANEEXPGNFSXN(\PYGZhy{}1)/(MDANYGDPFCSTXN(\PYGZhy{}1))))+((LOG(MDAXMKT))\PYGZhy{}(LOG(MDAXMKT(\PYGZhy{}1))))\PYGZhy{}0.345691440406372*((LOG(MDANEEXPGNFSXN/MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANEEXPGNFSXN(\PYGZhy{}1)/MDANYGDPFCSTXN(\PYGZhy{}1))))+2.84032004924203+0.015458379408832*T\PYGZus{}LR)) +LOG(MDANEEXPGNFSKN)\PYGZhy{}LOG(MDANEEXPGNFSKN(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDANEEXPGNFSXN\PYGZus{}A = \PYGZhy{} ((\PYGZhy{}0.689680638262842*(LOG(MDANEEXPGNFSXN(\PYGZhy{}1))\PYGZhy{}0.603631334048721*LOG(MDANYGDPFCSTXN(\PYGZhy{}1))\PYGZhy{}(1\PYGZhy{}0.603631334048721)*LOG(MDAPXKEY(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1)))+1.06714218353871*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))+(1\PYGZhy{}1.06714218353871)*((LOG(MDAPXKEY*MDAPANUSATLS))\PYGZhy{}(LOG(MDAPXKEY(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1))))+0.0593246295410032\PYGZhy{}0.0247522128533159*T\PYGZus{}LR)) +LOG(MDANEEXPGNFSXN)\PYGZhy{}LOG(MDANEEXPGNFSXN(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDANEEXPAGRTXN\PYGZus{}A = \PYGZhy{} ((\PYGZhy{}0.3*(LOG(MDANEEXPAGRTXN(\PYGZhy{}1))\PYGZhy{}(1\PYGZhy{}1.3186882875842)*LOG(MDANYGDPFCSTXN(\PYGZhy{}1))\PYGZhy{}1.3186882875842*LOG(MDAWLDFAGRTOTLXD(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1)))\PYGZhy{}2.85770216483863+1.3186882875842*((LOG(MDAWLDFAGRTOTLXD*MDAPANUSATLS))\PYGZhy{}(LOG(MDAWLDFAGRTOTLXD(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1))))+(1\PYGZhy{}1.3186882875842)*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1)))))) +LOG(MDANEEXPAGRTXN)\PYGZhy{}LOG(MDANEEXPAGRTXN(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDANEIMPGNFSKN\PYGZus{}A = \PYGZhy{} ((\PYGZhy{}0.218751344210448*(LOG(MDANEIMPGNFSKN(\PYGZhy{}1))\PYGZhy{}LOG(MDANEGDETTOTKN(\PYGZhy{}1))+0.248762098352762*LOG(MDANEIMPGNFSXN(\PYGZhy{}1)/(MDANYGDPFCSTXN(\PYGZhy{}1))))+(((LOG(MDANEGDETTOTKN))\PYGZhy{}(LOG(MDANEGDETTOTKN(\PYGZhy{}1))))\PYGZhy{}((LOG(MDANYGDPPOTLKN))\PYGZhy{}(LOG(MDANYGDPPOTLKN(\PYGZhy{}1)))))+MDAGR\PYGZhy{}0.248762098352762*((LOG(MDANEIMPGNFSXN/MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANEIMPGNFSXN(\PYGZhy{}1)/MDANYGDPFCSTXN(\PYGZhy{}1))))\PYGZhy{}0.336531838649722+0.00576104613986022*T\PYGZus{}LR)) +LOG(MDANEIMPGNFSKN)\PYGZhy{}LOG(MDANEIMPGNFSKN(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDANEIMPGNFSXN\PYGZus{}A = \PYGZhy{} ((\PYGZhy{}0.564370575830738*(LOG(MDANEIMPGNFSXN(\PYGZhy{}1))\PYGZhy{}0.25*LOG(MDANYGDPFCSTXN(\PYGZhy{}1))\PYGZhy{}(1\PYGZhy{}0.25)*LOG(MDAPMKEY(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1))\PYGZhy{}LOG(1+MDAGGREVVATMXN(\PYGZhy{}1)/100))+0.25*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))+(1\PYGZhy{}0.25)*((LOG(MDAPMKEY*MDAPANUSATLS))\PYGZhy{}(LOG(MDAPMKEY(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1))))\PYGZhy{}1.18325081713964+((MDAGGREVVATMXN/100)\PYGZhy{}(MDAGGREVVATMXN(\PYGZhy{}1)/100)))) +LOG(MDANEIMPGNFSXN)\PYGZhy{}LOG(MDANEIMPGNFSXN(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDALMEMPTOTL\PYGZus{}A = \PYGZhy{} ((\PYGZhy{}0.183075987473735*(LOG(MDALMEMPTOTL(\PYGZhy{}1))\PYGZhy{}LOG(MDALMEMPSTRL(\PYGZhy{}1)))+((LOG(MDALMEMPSTRL))\PYGZhy{}(LOG(MDALMEMPSTRL(\PYGZhy{}1))))+0.581694127104354*(((LOG(MDANYGDPMKTPKN))\PYGZhy{}(LOG(MDANYGDPMKTPKN(\PYGZhy{}1))))\PYGZhy{}MDAGR)\PYGZhy{}0.688544000289914*(((LOG(MDANYWRTTOTLXN/MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYWRTTOTLXN(\PYGZhy{}1)/MDANYGDPFCSTXN(\PYGZhy{}1))))\PYGZhy{}((LOG(MDANYGDPTFP))\PYGZhy{}(LOG(MDANYGDPTFP(\PYGZhy{}1))))/MDANYYWBTOTL\PYGZus{}))) +LOG(MDALMEMPTOTL)\PYGZhy{}LOG(MDALMEMPTOTL(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDANYWRTTOTLXN\PYGZus{}A = \PYGZhy{} ((((LOG(MDANECONPRVTXN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDANECONPRVTXN(\PYGZhy{}2))))+((LOG(MDANYGDPPOTLKN/MDALMEMPSTRL))\PYGZhy{}(LOG(MDANYGDPPOTLKN(\PYGZhy{}1)/MDALMEMPSTRL(\PYGZhy{}1))))\PYGZhy{}0.5*(MDALMUNRTOTL\PYGZus{}\PYGZhy{}MDALMUNRSTRL\PYGZus{})/100\PYGZhy{}0.26929290393266*DURING\PYGZus{}2009)) +LOG(MDANYWRTTOTLXN)\PYGZhy{}LOG(MDANYWRTTOTLXN(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDALMPRTTOTL\PYGZus{}\PYGZus{}A = MDALMPRTTOTL\PYGZus{}\PYGZhy{} ((0.415124722480563*(MDALMPRTTOTL\PYGZus{}(\PYGZhy{}1))+(1\PYGZhy{}0.415124722480563)*(MDALMPRTSTRL\PYGZus{}))) \PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDAGGREVTCITCN\PYGZus{}A = 100*MDAGGREVTCITCN/MDAGGREVTCITCN(\PYGZhy{}1)\PYGZhy{} ((1* (100 * ( (MDAGGREVTCITXN/100*MDANYGDPMKTPCN) / (MDAGGREVTCITXN(\PYGZhy{}1)/100*MDANYGDPMKTPCN(\PYGZhy{}1)) \PYGZhy{}1)))) \PYGZhy{}100\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDAGGREVTPITCN\PYGZus{}A = 100*MDAGGREVTPITCN/MDAGGREVTPITCN(\PYGZhy{}1)\PYGZhy{} ((1* (100 * ( (MDAGGREVTPITXN/100*MDANYYWBTOTLCN) / (MDAGGREVTPITXN(\PYGZhy{}1)/100*MDANYYWBTOTLCN(\PYGZhy{}1)) \PYGZhy{}1)))) \PYGZhy{}100\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDAGGREVSSOCCN\PYGZus{}A = 100*MDAGGREVSSOCCN/MDAGGREVSSOCCN(\PYGZhy{}1)\PYGZhy{} ((1* (100 * ( (MDAGGREVSSOCXN/100*MDANYYWBTOTLCN) / (MDAGGREVSSOCXN(\PYGZhy{}1)/100*MDANYYWBTOTLCN(\PYGZhy{}1)) \PYGZhy{}1)))) \PYGZhy{}100\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDAGGREVVATDCN\PYGZus{}A = 100*MDAGGREVVATDCN/MDAGGREVVATDCN(\PYGZhy{}1)\PYGZhy{} ((1* (100 * ( (MDAGGREVVATDXN/100*(MDANECONPRVTCN+MDANECONGOVTCN)) / (MDAGGREVVATDXN(\PYGZhy{}1)/100*(MDANECONPRVTCN(\PYGZhy{}1)+MDANECONGOVTCN(\PYGZhy{}1))) \PYGZhy{}1)))) \PYGZhy{}100\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDAGGREVVATMCN\PYGZus{}A = 100*MDAGGREVVATMCN/MDAGGREVVATMCN(\PYGZhy{}1)\PYGZhy{} ((1* (100 * ( (MDAGGREVVATMXN/100*(MDANEIMPGNFSCN)) / (MDAGGREVVATMXN(\PYGZhy{}1)/100*(MDANEIMPGNFSCN(\PYGZhy{}1))) \PYGZhy{}1)))) \PYGZhy{}100\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDAGGREVVATXCN\PYGZus{}A = \PYGZhy{}100*MDAGGREVVATXCN/(\PYGZhy{}MDANECONGOVTCN\PYGZhy{}MDANECONPRVTCN)+MDANECONGOVTCN* ((2.57630681423735)) /(\PYGZhy{}MDANECONGOVTCN\PYGZhy{}MDANECONPRVTCN)+MDANECONPRVTCN* ((2.57630681423735)) /(\PYGZhy{}MDANECONGOVTCN\PYGZhy{}MDANECONPRVTCN)\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDAGGREVTRDECN\PYGZus{}A = \PYGZhy{}100*MDAGGREVTRDECN/(\PYGZhy{}MDANEEXPGNFSCN\PYGZhy{}MDANEIMPGNFSCN)+MDANEEXPGNFSCN* ((1.25164890853099)) /(\PYGZhy{}MDANEEXPGNFSCN\PYGZhy{}MDANEIMPGNFSCN)+MDANEIMPGNFSCN* ((1.25164890853099)) /(\PYGZhy{}MDANEEXPGNFSCN\PYGZhy{}MDANEIMPGNFSCN)\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDAGGREVGRNTCN\PYGZus{}A = 100*MDAGGREVGRNTCN/MDANYGDPMKTPCN\PYGZhy{} ((0.862196453658808)) \PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDAGGREVOTHRCN\PYGZus{}A = 100*MDAGGREVOTHRCN/MDANYGDPMKTPCN\PYGZhy{} ((3.11360965029002)) \PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDAGGEXPWAGECN\PYGZus{}A = \PYGZhy{} ((\PYGZhy{}0.3*(LOG(MDAGGEXPWAGECN(\PYGZhy{}1)/MDANYGDPMKTPXN(\PYGZhy{}1))\PYGZhy{}LOG(MDANYGDPPOTLKN(\PYGZhy{}1)))\PYGZhy{}0.0832410088126464*((LOG(MDAGGEXPWAGECN(\PYGZhy{}1)/MDANYGDPMKTPXN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDAGGEXPWAGECN(\PYGZhy{}2)/MDANYGDPMKTPXN(\PYGZhy{}2))))+(1+0.0832410088126464)*MDAGR\PYGZhy{}0.773634130131987)) +LOG(MDAGGEXPWAGECN/MDANYGDPMKTPXN)\PYGZhy{}LOG(MDAGGEXPWAGECN(\PYGZhy{}1)/MDANYGDPMKTPXN(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDAGGEXPGNFSCN\PYGZus{}A = \PYGZhy{} ((\PYGZhy{}0.3*(LOG(MDAGGEXPGNFSCN(\PYGZhy{}1)/MDANYGDPMKTPXN(\PYGZhy{}1))\PYGZhy{}LOG(MDANYGDPPOTLKN(\PYGZhy{}1)))\PYGZhy{}0.244712417380816*((LOG(MDAGGEXPGNFSCN(\PYGZhy{}1)/MDANYGDPMKTPXN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDAGGEXPGNFSCN(\PYGZhy{}2)/MDANYGDPMKTPXN(\PYGZhy{}2))))+(1+0.244712417380816)*MDAGR\PYGZhy{}0.806178876325669)) +LOG(MDAGGEXPGNFSCN/MDANYGDPMKTPXN)\PYGZhy{}LOG(MDAGGEXPGNFSCN(\PYGZhy{}1)/MDANYGDPMKTPXN(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDAGGEXPTRNSCN\PYGZus{}A = \PYGZhy{} ((\PYGZhy{}0.3*(LOG(MDAGGEXPTRNSCN(\PYGZhy{}1)/MDANYGDPMKTPXN(\PYGZhy{}1))\PYGZhy{}LOG(MDANYGDPPOTLKN(\PYGZhy{}1)))\PYGZhy{}0.475511831460235*((LOG(MDAGGEXPTRNSCN(\PYGZhy{}1)/MDANYGDPMKTPXN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDAGGEXPTRNSCN(\PYGZhy{}2)/MDANYGDPMKTPXN(\PYGZhy{}2))))+(1+0.475511831460235)*MDAGR\PYGZhy{}0.640727459385319)) +LOG(MDAGGEXPTRNSCN/MDANYGDPMKTPXN)\PYGZhy{}LOG(MDAGGEXPTRNSCN(\PYGZhy{}1)/MDANYGDPMKTPXN(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDAGGEXPCAPTCN\PYGZus{}A = \PYGZhy{} ((\PYGZhy{}0.3*(LOG(MDAGGEXPCAPTCN(\PYGZhy{}1)/MDANYGDPMKTPXN(\PYGZhy{}1))\PYGZhy{}LOG(MDANYGDPPOTLKN(\PYGZhy{}1)))+0.27663427827676*((LOG(MDAGGEXPCAPTCN(\PYGZhy{}1)/MDANYGDPMKTPXN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDAGGEXPCAPTCN(\PYGZhy{}2)/MDANYGDPMKTPXN(\PYGZhy{}2))))+(1\PYGZhy{}0.27663427827676)*MDAGR\PYGZhy{}1.03766125029565)) +LOG(MDAGGEXPCAPTCN/MDANYGDPMKTPXN)\PYGZhy{}LOG(MDAGGEXPCAPTCN(\PYGZhy{}1)/MDANYGDPMKTPXN(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDAGGEXPOTHRCN\PYGZus{}A = 100*MDAGGEXPOTHRCN/MDANYGDPMKTPCN\PYGZhy{} ((1.49239295839917)) \PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDAGGEXPCRNOCN\PYGZus{}A = 100*MDAGGEXPCRNOCN/MDANYGDPMKTPCN\PYGZhy{} ((0.754699479458526)) \PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDABXGSRGNFSCD\PYGZus{}A = 100*MDABXGSRGNFSCD/MDABXGSRGNFSCD(\PYGZhy{}1)\PYGZhy{} (((100 * ( (MDANEEXPGNFSCN/MDAPANUSATLS) / (MDANEEXPGNFSCN(\PYGZhy{}1)/MDAPANUSATLS(\PYGZhy{}1)) \PYGZhy{}1)) \PYGZhy{}0.0279008217603989*DUMH)) \PYGZhy{}100\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDABXGSRAGRTCD\PYGZus{}A = 100*MDABXGSRAGRTCD/MDABXGSRAGRTCD(\PYGZhy{}1)\PYGZhy{} (((100 * ( (MDANEEXPAGRTCN/MDAPANUSATLS) / (MDANEEXPAGRTCN(\PYGZhy{}1)/MDAPANUSATLS(\PYGZhy{}1)) \PYGZhy{}1)) +2.52429656125299E\PYGZhy{}15*DUMH)) \PYGZhy{}100\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDABMGSRGNFSCD\PYGZus{}A = 100*MDABMGSRGNFSCD/MDABMGSRGNFSCD(\PYGZhy{}1)\PYGZhy{} (((100 * ( (MDANEIMPGNFSCN/MDAPANUSATLS) / (MDANEIMPGNFSCN(\PYGZhy{}1)/MDAPANUSATLS(\PYGZhy{}1)) \PYGZhy{}1)) \PYGZhy{}0.150835412701402*DUMH)) \PYGZhy{}100\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDABMGSRFUELCD\PYGZus{}A = 100*MDABMGSRFUELCD/MDABMGSRFUELCD(\PYGZhy{}1)\PYGZhy{} (((100 * ( (MDANEIMPFUELCN/MDAPANUSATLS) / (MDANEIMPFUELCN(\PYGZhy{}1)/MDAPANUSATLS(\PYGZhy{}1)) \PYGZhy{}1)) +0*DUMH)) \PYGZhy{}100\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDABNFSTSTRNCD\PYGZus{}A = \PYGZhy{} ((1.21239586043243*MDAGR+(1\PYGZhy{}1.21239586043243)*((LOG((MDABNFSTSTRNCD(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1))/MDANYGDPMKTPXN(\PYGZhy{}1)))\PYGZhy{}(LOG((MDABNFSTSTRNCD(\PYGZhy{}2)*MDAPANUSATLS(\PYGZhy{}2))/MDANYGDPMKTPXN(\PYGZhy{}2)))))) +LOG(MDABNFSTSTRNCD*MDAPANUSATLS/MDANYGDPMKTPXN)\PYGZhy{}LOG(MDABNFSTSTRNCD(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1)/MDANYGDPMKTPXN(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDABNFSTPCOECD\PYGZus{}A = \PYGZhy{} ((0.669088437645741*MDAGR+(1\PYGZhy{}0.669088437645741)*((LOG((MDABNFSTPCOECD(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1))/MDANYGDPMKTPXN(\PYGZhy{}1)))\PYGZhy{}(LOG((MDABNFSTPCOECD(\PYGZhy{}2)*MDAPANUSATLS(\PYGZhy{}2))/MDANYGDPMKTPXN(\PYGZhy{}2)))))) +LOG(MDABNFSTPCOECD*MDAPANUSATLS/MDANYGDPMKTPXN)\PYGZhy{}LOG(MDABNFSTPCOECD(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1)/MDANYGDPMKTPXN(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDABNFSTOTHRCD\PYGZus{}A = MDABNFSTOTHRCD/MDANYGDPMKTPCD\PYGZhy{} ((0.113187073392889\PYGZhy{}0.00250912199388566*T\PYGZus{}LR)) \PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDABFCAFCAPTCD\PYGZus{}A = MDABFCAFCAPTCD*MDAPANUSATLS/MDANYGDPMKTPCN\PYGZhy{} ((0.00282736002227067)) \PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDABFCAFFFDICD\PYGZus{}A = MDABFCAFFFDICD*MDAPANUSATLS/MDANYGDPMKTPCN\PYGZhy{} ((\PYGZhy{}0.028376216546585)) \PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDABFCAFFPFTCD\PYGZus{}A = MDABFCAFFPFTCD*MDAPANUSATLS/MDANYGDPMKTPCN\PYGZhy{} ((\PYGZhy{}0.000240950762685102)) \PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDABFCAFOTHRCD\PYGZus{}A = MDABFCAFOTHRCD*MDAPANUSATLS/MDANYGDPMKTPCN\PYGZhy{} ((\PYGZhy{}0.0515665290620459)) \PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDABFCAFRACGCD\PYGZus{}A = (MDABFCAFRACGCD) \PYGZhy{} (\PYGZhy{}MDABNCABFUNDCD\PYGZhy{}MDABFCAFFINXCD\PYGZhy{}MDABFCAFCAPTCD\PYGZhy{}MDABFCAFNEOMCD\PYGZhy{}1176.08181818182*DUMH)\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDAPANUSATLS\PYGZus{}A = \PYGZhy{} ((0.41922820233295*((LOG(MDAPANUSATLS(\PYGZhy{}1)))\PYGZhy{}(LOG(MDAPANUSATLS(\PYGZhy{}2))))+(1\PYGZhy{}0.41922820233295)*((LOG((1+MDAUSAFMLBLPOLYFR/100)/(1+MDAFMLBLPOLYXN/100)))\PYGZhy{}(LOG((1+MDAUSAFMLBLPOLYFR(\PYGZhy{}1)/100)/(1+MDAFMLBLPOLYXN(\PYGZhy{}1)/100)))))) +LOG(MDAPANUSATLS)\PYGZhy{}LOG(MDAPANUSATLS(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDAFPCPITOTLXN\PYGZus{}A = \PYGZhy{} ((\PYGZhy{}1.37696081847616*(LOG(MDAFPCPITOTLXN(\PYGZhy{}1))\PYGZhy{}LOG(MDANECONPRVTXN(\PYGZhy{}1)))+9.99703744406243+0.00326070346873517*T\PYGZus{}LR+((LOG(MDANECONPRVTXN))\PYGZhy{}(LOG(MDANECONPRVTXN(\PYGZhy{}1)))))) +LOG(MDAFPCPITOTLXN)\PYGZhy{}LOG(MDAFPCPITOTLXN(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDANYGDPDISCCN\PYGZus{}A = MDANYGDPDISCCN/MDANYGDPMKTPCN\PYGZhy{} ((\PYGZhy{}0.0104830273967771)) \PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDANVAGRTOTLKN\PYGZus{}A = \PYGZhy{} ((1.42808459809626*((LOG(MDANYGDPPOTLKN))\PYGZhy{}(LOG(MDANYGDPPOTLKN(\PYGZhy{}1))))+(1\PYGZhy{}1.42808459809626)*((LOG(MDANVAGRTOTLKN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDANVAGRTOTLKN(\PYGZhy{}2)))))) +LOG(MDANVAGRTOTLKN)\PYGZhy{}LOG(MDANVAGRTOTLKN(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDANVINDTOTLKN\PYGZus{}A = \PYGZhy{} ((1.43892189150108*((LOG(MDANYGDPPOTLKN))\PYGZhy{}(LOG(MDANYGDPPOTLKN(\PYGZhy{}1))))+(1\PYGZhy{}1.43892189150108)*((LOG(MDANVINDTOTLKN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDANVINDTOTLKN(\PYGZhy{}2)))))) +LOG(MDANVINDTOTLKN)\PYGZhy{}LOG(MDANVINDTOTLKN(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDANVSRVCONTKN\PYGZus{}A = \PYGZhy{} ((0.371368937381176*((LOG(MDANYGDPPOTLKN))\PYGZhy{}(LOG(MDANYGDPPOTLKN(\PYGZhy{}1))))+(1\PYGZhy{}0.371368937381176)*((LOG(MDANVSRVCONTKN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDANVSRVCONTKN(\PYGZhy{}2)))))) +LOG(MDANVSRVCONTKN)\PYGZhy{}LOG(MDANVSRVCONTKN(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDANVSRVTRNSKN\PYGZus{}A = \PYGZhy{} ((1.67475245888343*((LOG(MDANYGDPPOTLKN))\PYGZhy{}(LOG(MDANYGDPPOTLKN(\PYGZhy{}1))))+(1\PYGZhy{}1.67475245888343)*((LOG(MDANVSRVTRNSKN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDANVSRVTRNSKN(\PYGZhy{}2)))))) +LOG(MDANVSRVTRNSKN)\PYGZhy{}LOG(MDANVSRVTRNSKN(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDANVSRVACCMKN\PYGZus{}A = \PYGZhy{} ((1.97626862992525*((LOG(MDANYGDPPOTLKN))\PYGZhy{}(LOG(MDANYGDPPOTLKN(\PYGZhy{}1))))+(1\PYGZhy{}1.97626862992525)*((LOG(MDANVSRVACCMKN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDANVSRVACCMKN(\PYGZhy{}2)))))) +LOG(MDANVSRVACCMKN)\PYGZhy{}LOG(MDANVSRVACCMKN(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDANVSRVINFOKN\PYGZus{}A = \PYGZhy{} ((0.876628309230883*((LOG(MDANYGDPPOTLKN))\PYGZhy{}(LOG(MDANYGDPPOTLKN(\PYGZhy{}1))))+(1\PYGZhy{}0.876628309230883)*((LOG(MDANVSRVINFOKN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDANVSRVINFOKN(\PYGZhy{}2)))))) +LOG(MDANVSRVINFOKN)\PYGZhy{}LOG(MDANVSRVINFOKN(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDANVSRVFINAKN\PYGZus{}A = \PYGZhy{} ((1.24316636274024*((LOG(MDANYGDPPOTLKN))\PYGZhy{}(LOG(MDANYGDPPOTLKN(\PYGZhy{}1))))+(1\PYGZhy{}1.24316636274024)*((LOG(MDANVSRVFINAKN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDANVSRVFINAKN(\PYGZhy{}2)))))) +LOG(MDANVSRVFINAKN)\PYGZhy{}LOG(MDANVSRVFINAKN(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDANVSRVOTHRKN\PYGZus{}A = \PYGZhy{} ((0.431580607334864*((LOG(MDANYGDPPOTLKN))\PYGZhy{}(LOG(MDANYGDPPOTLKN(\PYGZhy{}1))))+(1\PYGZhy{}0.431580607334864)*((LOG(MDANVSRVOTHRKN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDANVSRVOTHRKN(\PYGZhy{}2)))))) +LOG(MDANVSRVOTHRKN)\PYGZhy{}LOG(MDANVSRVOTHRKN(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDANVAGRTOTLXN\PYGZus{}A = \PYGZhy{} ((\PYGZhy{}0.3*(LOG(MDANVAGRTOTLXN(\PYGZhy{}1))\PYGZhy{}(1\PYGZhy{}0.15)*LOG(MDANYGDPFCSTXN(\PYGZhy{}1))\PYGZhy{}0.85*LOG(MDAWLDFAGRTOTLXD(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1)))\PYGZhy{}1.82179756558893+0.15*((LOG(MDAWLDFAGRTOTLXD*MDAPANUSATLS))\PYGZhy{}(LOG(MDAWLDFAGRTOTLXD(\PYGZhy{}1)*MDAPANUSATLS(\PYGZhy{}1))))+(1\PYGZhy{}0.85)*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1)))))) +LOG(MDANVAGRTOTLXN)\PYGZhy{}LOG(MDANVAGRTOTLXN(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDANVINDTOTLXN\PYGZus{}A = \PYGZhy{} ((\PYGZhy{}0.642555574166414*(LOG(MDANVINDTOTLXN(\PYGZhy{}1))\PYGZhy{}0.799550564777672*LOG(MDANYGDPFCSTXN(\PYGZhy{}1))\PYGZhy{}(1\PYGZhy{}0.799550564777672)*LOG(MDANEIMPGNFSXN(\PYGZhy{}1)))+0.0457961224580996+0.291567048935525*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))+(1\PYGZhy{}0.291567048935525)*((LOG(MDANEIMPGNFSXN))\PYGZhy{}(LOG(MDANEIMPGNFSXN(\PYGZhy{}1)))))) +LOG(MDANVINDTOTLXN)\PYGZhy{}LOG(MDANVINDTOTLXN(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDANVSRVCONTXN\PYGZus{}A = \PYGZhy{} ((1.21058375527728*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))+(1\PYGZhy{}1.21058375527728)*((LOG(MDANEIMPGNFSXN))\PYGZhy{}(LOG(MDANEIMPGNFSXN(\PYGZhy{}1)))))) +LOG(MDANVSRVCONTXN)\PYGZhy{}LOG(MDANVSRVCONTXN(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDANVSRVWHLEXN\PYGZus{}A = \PYGZhy{} ((0.939249117801536*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))+(1\PYGZhy{}0.939249117801536)*((LOG(MDANEIMPGNFSXN))\PYGZhy{}(LOG(MDANEIMPGNFSXN(\PYGZhy{}1)))))) +LOG(MDANVSRVWHLEXN)\PYGZhy{}LOG(MDANVSRVWHLEXN(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDANVSRVTRNSXN\PYGZus{}A = \PYGZhy{} ((0.972053736234501*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))+(1\PYGZhy{}0.972053736234501)*((LOG(MDANEIMPGNFSXN))\PYGZhy{}(LOG(MDANEIMPGNFSXN(\PYGZhy{}1)))))) +LOG(MDANVSRVTRNSXN)\PYGZhy{}LOG(MDANVSRVTRNSXN(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDANVSRVACCMXN\PYGZus{}A = \PYGZhy{} ((1.09148732426661*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))+(1\PYGZhy{}1.09148732426661)*((LOG(MDANEIMPGNFSXN))\PYGZhy{}(LOG(MDANEIMPGNFSXN(\PYGZhy{}1)))))) +LOG(MDANVSRVACCMXN)\PYGZhy{}LOG(MDANVSRVACCMXN(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDANVSRVINFOXN\PYGZus{}A = \PYGZhy{} ((0.421485464414997*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))+(1\PYGZhy{}0.421485464414997)*((LOG(MDANEIMPGNFSXN))\PYGZhy{}(LOG(MDANEIMPGNFSXN(\PYGZhy{}1)))))) +LOG(MDANVSRVINFOXN)\PYGZhy{}LOG(MDANVSRVINFOXN(\PYGZhy{}1))\PYGZdl{}
FRML \PYGZlt{}CALC\PYGZus{}ADD\PYGZus{}FACTOR\PYGZgt{} MDANVSRVFINAXN\PYGZus{}A = \PYGZhy{} ((\PYGZhy{}0.0691541484208101*((LOG(MDANYGDPFCSTXN))\PYGZhy{}(LOG(MDANYGDPFCSTXN(\PYGZhy{}1))))+(1+0.0691541484208101)*((LOG(MDANEIMPGNFSXN))\PYGZhy{}(LOG(MDANEIMPGNFSXN(\PYGZhy{}1)))))) +LOG(MDANVSRVFINAXN)\PYGZhy{}LOG(MDANVSRVFINAXN(\PYGZhy{}1))\PYGZdl{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{with} \PYG{n}{mmda}\PYG{o}{.}\PYG{n}{set\PYGZus{}smpl}\PYG{p}{(}\PYG{l+m+mi}{2020}\PYG{p}{,}\PYG{l+m+mi}{2023}\PYG{p}{)}\PYG{p}{:}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{mmda}\PYG{o}{.}\PYG{n}{mdaGGEXPCAPTCN}\PYG{o}{.}\PYG{n}{show}\PYG{p}{)}                        
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Endogeneous: MDAGGEXPCAPTCN: Expenditure: Investment LCU millions
Formular: FRML \PYGZlt{}Z,EXO\PYGZgt{} MDAGGEXPCAPTCN = (MDANYGDPMKTPXN*MDAGGEXPCAPTCN(\PYGZhy{}1)*EXP(MDAGGEXPCAPTCN\PYGZus{}A+ (\PYGZhy{}0.3*(LOG(MDAGGEXPCAPTCN(\PYGZhy{}1)/MDANYGDPMKTPXN(\PYGZhy{}1))\PYGZhy{}LOG(MDANYGDPPOTLKN(\PYGZhy{}1)))+0.27663427827676*((LOG(MDAGGEXPCAPTCN(\PYGZhy{}1)/MDANYGDPMKTPXN(\PYGZhy{}1)))\PYGZhy{}(LOG(MDAGGEXPCAPTCN(\PYGZhy{}2)/MDANYGDPMKTPXN(\PYGZhy{}2))))+(1\PYGZhy{}0.27663427827676)*MDAGR\PYGZhy{}1.03766125029565) )/MDANYGDPMKTPXN(\PYGZhy{}1)) * (1\PYGZhy{}MDAGGEXPCAPTCN\PYGZus{}D)+ MDAGGEXPCAPTCN\PYGZus{}X*MDAGGEXPCAPTCN\PYGZus{}D  \PYGZdl{}

MDAGGEXPCAPTCN  : Expenditure: Investment LCU millions
MDAGGEXPCAPTCN\PYGZus{}A: Add factor:Expenditure: Investment LCU millions
MDAGGEXPCAPTCN\PYGZus{}D: Fix dummy:Expenditure: Investment LCU millions
MDAGGEXPCAPTCN\PYGZus{}X: Fix value:Expenditure: Investment LCU millions
MDAGR           : 
MDANYGDPMKTPXN  : 
MDANYGDPPOTLKN  : 

Values :
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}pandas.io.formats.style.Styler at 0x2cdb2b54c40\PYGZgt{}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Input last run:
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}pandas.io.formats.style.Styler at 0x2cdb4143850\PYGZgt{}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Input base run:
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}pandas.io.formats.style.Styler at 0x2cdb3723a30\PYGZgt{}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Difference for input variables
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}pandas.io.formats.style.Styler at 0x2cdb34c44c0\PYGZgt{}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
None
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mmda}\PYG{o}{.}\PYG{n}{modeldump}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{test.pcim}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{!}dir *.pcim
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 Volume in drive C has no label.
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
 Volume Serial Number is C2DB\PYGZhy{}095E

 Directory of c:\PYGZbs{}wb new\PYGZbs{}Modelflow\PYGZbs{}working\PYGZus{}paper\PYGZbs{}thebook\PYGZbs{}content\PYGZbs{}howto\PYGZbs{}onboard\PYGZbs{}eviews

11\PYGZhy{}10\PYGZhy{}2022  19:25         1.029.276 test.pcim
               1 File(s)      1.029.276 bytes
               0 Dir(s)  751.339.479.040 bytes free
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxstepscope


\chapter{Onboard all models  defined in .wf1 files}
\label{\detokenize{content/howto/onboard/eviews/onboard many models from wf1:onboard-all-models-defined-in-wf1-files}}\label{\detokenize{content/howto/onboard/eviews/onboard many models from wf1::doc}}
\sphinxAtStartPar
This notebook takes all .wf1 workfile from the folder wfs\textbackslash{} and transform the models  it to a modelflow model.

\sphinxAtStartPar
The overall process is performed in a Dataclass named:\sphinxstylestrong{GrapWfModel}
Close study of this class can be rewarding, but is outside the need of most users.
The overall structure is: Onboard all model defined in a .wf1 file

\sphinxAtStartPar
The overall structure is:

\sphinxAtStartPar
Eviews is started and the wf1 file is loaded
Some transformations are performed on data.
The model is unlinked
The workspace is saved as a wf2 file. Same name with \_modelflow appended
Eviews is closed
The wf2 file is read as a json file.
Relevant objects are extracted.
The MFMSA variable is extracted, to be saved in the dumpfile.
The equations are transformed and normalized to modelflow format and classified into identities and stochastic
Stochastic equations are enriched by add\_factor and fixing terms (dummy + fixing value)
For Stochastic equations new fitted variables are generated \sphinxhyphen{} without add add\_factors and dummies.
A model to generate fitted variables is created
A model to generate add\_factors is created.
A model encompassing the original equations, the model for fitted variables and for add\_factors is created.
The data series and scalars are shoveled into a Pandas dataframe
Some special series are generated as the expression can not be incorporated into modelflow model specifications
The model for fitted values is simulated in the specified timespan
The model for add\_factors is simulated in the timespan set in MFMSA
The data descriptions are extracted into a dictionary.
Data descriptions for dummies, fixed values, fitted values and add\_factors are derived.
Now we have a model and a dataframe with all variables which are needed. b The GrapWfModel instance in general keeps most of the steps so the developer can inspect the the different steps.

\sphinxAtStartPar
The GrapWfModel instance in general keeps most of the steps so the developer can inspect the the different steps.
\begin{itemize}
\item {} 
\sphinxAtStartPar
Eviews has to be installed

\item {} 
\sphinxAtStartPar
pyevies has to be installed

\end{itemize}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{pathlib} \PYG{k+kn}{import} \PYG{n}{Path}

\PYG{k+kn}{from} \PYG{n+nn}{modelclass} \PYG{k+kn}{import} \PYG{n}{model} 
\PYG{k+kn}{from} \PYG{n+nn}{modelgrabwf2} \PYG{k+kn}{import} \PYG{n}{GrabWfModel}
\PYG{n}{model}\PYG{o}{.}\PYG{n}{widescreen}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{model}\PYG{o}{.}\PYG{n}{scroll\PYGZus{}off}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{latex}\PYG{o}{=}\PYG{l+m+mi}{1}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}IPython.core.display.HTML object\PYGZgt{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 \PYG{o}{\PYGZpc{}}\PYG{k}{load\PYGZus{}ext} autoreload
 \PYG{o}{\PYGZpc{}}\PYG{k}{autoreload} 2
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{List potential files}
\label{\detokenize{content/howto/onboard/eviews/onboard many models from wf1:list-potential-files}}
\sphinxAtStartPar
The workfiles are located in the \sphinxcode{\sphinxupquote{wfs}} folder. 
The \sphinxhref{https://docs.python.org/3/library/pathlib.html}{pathlib.Path} class is used to find all wf1 files

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{filedict} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{n}{f}\PYG{o}{.}\PYG{n}{stem}\PYG{p}{[}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{]}\PYG{o}{.}\PYG{n}{lower}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}\PYG{n}{f} \PYG{k}{for} \PYG{n}{f} \PYG{o+ow}{in} \PYG{n}{Path}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{wfs}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{glob}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{*.wf1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{\PYGZcb{}}
\PYG{k}{for} \PYG{n}{modelname}\PYG{p}{,}\PYG{n}{filename} \PYG{o+ow}{in} \PYG{n}{filedict}\PYG{o}{.}\PYG{n}{items}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The model and date for }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{modelname}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{ is located in this workfile:}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{filename}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
The model and date for ago is located in this workfile:wfs\PYGZbs{}agosoln.wf1
The model and date for mda is located in this workfile:wfs\PYGZbs{}MDAsoln.wf1
The model and date for pak is located in this workfile:wfs\PYGZbs{}PAKSoln.wf1
The model and date for per is located in this workfile:wfs\PYGZbs{}PERMOD\PYGZus{}damage\PYGZus{}asFactor20220322.wf1
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Model specific transformations}
\label{\detokenize{content/howto/onboard/eviews/onboard many models from wf1:model-specific-transformations}}
\sphinxAtStartPar
Not all Eviews equations has a direct counterpart in modelflow.
To handle that two types of transformations can be provided for a specific model.
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{eviews\_run\_lines} which specifies a list of Eviews command lines to be run. Typical to make some transformation of data.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{country\_trans} which specifies a list of replacements to be done to the Eviews formulas before they are processed.

\end{itemize}

\sphinxAtStartPar
As a convention the variables like this <modelname>\_eviews\_run\_lines and \_trans

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pak\PYGZus{}trans} \PYG{o}{=} \PYG{k}{lambda} \PYG{n+nb}{input} \PYG{p}{:} \PYG{n+nb}{input}\PYG{o}{.}\PYG{n}{replace}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{} 01*D(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}1*D(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}   

\PYG{n}{ago\PYGZus{}trans} \PYG{o}{=} \PYG{k}{lambda}  \PYG{n+nb}{input} \PYG{p}{:} \PYG{n+nb}{input}\PYG{o}{.}\PYG{n}{replace}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{@MEAN(AGOBNCABFUNDCD/AGONYGDPMKTPCD,}\PYG{l+s+s1}{\PYGZdq{}}\PYG{l+s+s1}{2000 2020}\PYG{l+s+s1}{\PYGZdq{}}\PYG{l+s+s1}{)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{MEAN\PYGZus{}AGOBNCABFUNDCD\PYGZus{}DIV\PYGZus{}AGONYGDPMKTPCD}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} 
\PYG{n}{ago\PYGZus{}eviews\PYGZus{}run\PYGZus{}lines} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{smpl @ALL}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{series MEAN\PYGZus{}AGOBNCABFUNDCD\PYGZus{}DIV\PYGZus{}AGONYGDPMKTPCD = @MEAN(AGOBNCABFUNDCD/AGONYGDPMKTPCD,}\PYG{l+s+s1}{\PYGZdq{}}\PYG{l+s+s1}{2000 2020}\PYG{l+s+s1}{\PYGZdq{}}\PYG{l+s+s1}{)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{mda\PYGZus{}trans} \PYG{o}{=} \PYG{k}{lambda} \PYG{n+nb}{input}\PYG{p}{:} \PYG{n+nb}{input}\PYG{o}{.}\PYG{n}{replace}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZus{}MDAsbbrev.@coef(2)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZus{}MDASBBREV\PYGZus{}at\PYGZus{}COEF\PYGZus{}2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}         
\PYG{n}{mda\PYGZus{}eviews\PYGZus{}run\PYGZus{}lines} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Scalar \PYGZus{}MDASBBREV\PYGZus{}at\PYGZus{}COEF\PYGZus{}2 = \PYGZus{}MDASBBREV.@COEF(+2)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Transform all wf1 files in the folder}
\label{\detokenize{content/howto/onboard/eviews/onboard many models from wf1:transform-all-wf1-files-in-the-folder}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{allmodels} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{n}{modelname}\PYG{p}{:} 
     \PYG{n}{GrabWfModel}\PYG{p}{(}\PYG{n}{filename}\PYG{p}{,} 
                        \PYG{n}{eviews\PYGZus{}run\PYGZus{}lines}\PYG{o}{=} \PYG{n+nb}{globals}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{get}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{modelname}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZus{}eviews\PYGZus{}run\PYGZus{}lines}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{p}{[}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,}
                        \PYG{n}{country\PYGZus{}trans}    \PYG{o}{=}   \PYG{n+nb}{globals}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{get}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{modelname}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZus{}trans}\PYG{l+s+s1}{\PYGZsq{}}   \PYG{p}{,}\PYG{k}{lambda} \PYG{n}{x} \PYG{p}{:} \PYG{n}{x}\PYG{p}{[}\PYG{p}{:}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,}
                        \PYG{n}{make\PYGZus{}fitted} \PYG{o}{=} \PYG{k+kc}{True}\PYG{p}{,}        \PYG{c+c1}{\PYGZsh{} make equatios for fitted values of stocastic equations }
                        \PYG{n}{do\PYGZus{}add\PYGZus{}factor\PYGZus{}calc}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,}   \PYG{c+c1}{\PYGZsh{} Calculate the add factors which makes the stocastic equations match    }
                        \PYG{n}{fit\PYGZus{}start} \PYG{o}{=} \PYG{l+m+mi}{2000}\PYG{p}{,}          \PYG{c+c1}{\PYGZsh{} Start of calculation of fittet model in baseline (to have some historic values) }
                        \PYG{n}{fit\PYGZus{}end}   \PYG{o}{=} \PYG{k+kc}{None}\PYG{p}{,}           \PYG{c+c1}{\PYGZsh{} end of calc for fittted model, if None taken from mdmfsa options  }
                        \PYG{n}{disable\PYGZus{}progress} \PYG{o}{=}\PYG{k+kc}{True}
                        \PYG{p}{)} 
                  \PYG{k}{for} \PYG{n}{modelname}\PYG{p}{,}\PYG{n}{filename} \PYG{o+ow}{in} \PYG{n}{filedict}\PYG{o}{.}\PYG{n}{items}\PYG{p}{(}\PYG{p}{)}\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Reading c:\PYGZbs{}wb new\PYGZbs{}Modelflow\PYGZbs{}working\PYGZus{}paper\PYGZbs{}thebook\PYGZbs{}content\PYGZbs{}howto\PYGZbs{}onboard\PYGZbs{}eviews\PYGZbs{}wfs\PYGZbs{}agosoln.wf1
Assummed model name: AGO
Eviewsline to run :smpl @ALL
Eviewsline to run :series MEAN\PYGZus{}AGOBNCABFUNDCD\PYGZus{}DIV\PYGZus{}AGONYGDPMKTPCD = @MEAN(AGOBNCABFUNDCD/AGONYGDPMKTPCD,\PYGZdq{}2000 2020\PYGZdq{})
The model: AGO is unlinked 
Writing C:\PYGZbs{}wb new\PYGZbs{}Modelflow\PYGZbs{}working\PYGZus{}paper\PYGZbs{}thebook\PYGZbs{}content\PYGZbs{}howto\PYGZbs{}onboard\PYGZbs{}eviews\PYGZbs{}wfs\PYGZbs{}agosoln\PYGZus{}modelflow.wf2
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Model name: AGO

Processing the model:AGO
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
testmodel calculated  
Calculation of add factors for AGO calculated  
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Reading c:\PYGZbs{}wb new\PYGZbs{}Modelflow\PYGZbs{}working\PYGZus{}paper\PYGZbs{}thebook\PYGZbs{}content\PYGZbs{}howto\PYGZbs{}onboard\PYGZbs{}eviews\PYGZbs{}wfs\PYGZbs{}MDAsoln.wf1
Assummed model name: MDA
Eviewsline to run :Scalar \PYGZus{}MDASBBREV\PYGZus{}at\PYGZus{}COEF\PYGZus{}2 = \PYGZus{}MDASBBREV.@COEF(+2)
The model: MDA is unlinked 
Writing C:\PYGZbs{}wb new\PYGZbs{}Modelflow\PYGZbs{}working\PYGZus{}paper\PYGZbs{}thebook\PYGZbs{}content\PYGZbs{}howto\PYGZbs{}onboard\PYGZbs{}eviews\PYGZbs{}wfs\PYGZbs{}MDAsoln\PYGZus{}modelflow.wf2
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Model name: MDA
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Processing the model:MDA
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
testmodel calculated  
Calculation of add factors for MDA calculated  
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Reading c:\PYGZbs{}wb new\PYGZbs{}Modelflow\PYGZbs{}working\PYGZus{}paper\PYGZbs{}thebook\PYGZbs{}content\PYGZbs{}howto\PYGZbs{}onboard\PYGZbs{}eviews\PYGZbs{}wfs\PYGZbs{}PAKSoln.wf1
Assummed model name: PAK
The model: PAK is unlinked 
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Writing C:\PYGZbs{}wb new\PYGZbs{}Modelflow\PYGZbs{}working\PYGZus{}paper\PYGZbs{}thebook\PYGZbs{}content\PYGZbs{}howto\PYGZbs{}onboard\PYGZbs{}eviews\PYGZbs{}wfs\PYGZbs{}PAKSoln\PYGZus{}modelflow.wf2
Model name: PAK
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Processing the model:PAK
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
testmodel calculated  
Calculation of add factors for PAK calculated  
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Reading c:\PYGZbs{}wb new\PYGZbs{}Modelflow\PYGZbs{}working\PYGZus{}paper\PYGZbs{}thebook\PYGZbs{}content\PYGZbs{}howto\PYGZbs{}onboard\PYGZbs{}eviews\PYGZbs{}wfs\PYGZbs{}PERMOD\PYGZus{}damage\PYGZus{}asFactor20220322.wf1
Assummed model name: PER
The model: PER is unlinked 
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Writing C:\PYGZbs{}wb new\PYGZbs{}Modelflow\PYGZbs{}working\PYGZus{}paper\PYGZbs{}thebook\PYGZbs{}content\PYGZbs{}howto\PYGZbs{}onboard\PYGZbs{}eviews\PYGZbs{}wfs\PYGZbs{}PERMOD\PYGZus{}damage\PYGZus{}asFactor20220322\PYGZus{}modelflow.wf2
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Model name: PER
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Processing the model:PER
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
testmodel calculated  
Calculation of add factors for PER calculated  
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Check all the models}
\label{\detokenize{content/howto/onboard/eviews/onboard many models from wf1:check-all-the-models}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{for} \PYG{n}{modelname}\PYG{p}{,}\PYG{n}{cmodel} \PYG{o+ow}{in} \PYG{n}{allmodels}\PYG{o}{.}\PYG{n}{items}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{cmodel}\PYG{o}{.}\PYG{n}{test\PYGZus{}model}\PYG{p}{(}\PYG{n}{cmodel}\PYG{o}{.}\PYG{n}{start}\PYG{p}{,}\PYG{n}{cmodel}\PYG{o}{.}\PYG{n}{end}\PYG{p}{,}\PYG{n}{maxerr}\PYG{o}{=}\PYG{l+m+mi}{100}\PYG{p}{,}\PYG{n}{tol}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{showall}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}   \PYG{c+c1}{\PYGZsh{} tol determins the max acceptable absolute difference }
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
AGO calculated  

Chekking residuals for AGO 2016 to 2060

Variable with residuals above threshold
AGONECONPRVTCN                        , Max difference:  2861.03139496 Max Pct    0.0000106457\PYGZpc{} It is number    44 in the solveorder and error number 1
AGONEGDIFGOVCN                        , Max difference:    21.01837921 Max Pct    0.0000013130\PYGZpc{} It is number    55 in the solveorder and error number 2
AGONEGDIFTOTCN                        , Max difference:   177.46922302 Max Pct    0.0000007316\PYGZpc{} It is number    58 in the solveorder and error number 3
AGONEEXPNOILCN                        , Max difference:    34.74809837 Max Pct    0.0000022911\PYGZpc{} It is number    63 in the solveorder and error number 4
AGONEEXPGOILCN                        , Max difference:   544.94689941 Max Pct    0.0000026926\PYGZpc{} It is number    66 in the solveorder and error number 5
AGONEEXPGNFSCN                        , Max difference:   504.25928497 Max Pct    0.0000023486\PYGZpc{} It is number    67 in the solveorder and error number 6
AGONEIMPGNFSCN                        , Max difference:  1101.58077240 Max Pct    0.0000111348\PYGZpc{} It is number    71 in the solveorder and error number 7
AGONYYWBTOTLCN                        , Max difference:   286.10862160 Max Pct    0.0000091250\PYGZpc{} It is number    80 in the solveorder and error number 8
AGOGGREVTOTLCN                        , Max difference:   136.30834198 Max Pct    0.0000014056\PYGZpc{} It is number    81 in the solveorder and error number 9
AGOGGEXPINTPCN                        , Max difference:    99.77352953 Max Pct    0.0000082146\PYGZpc{} It is number    86 in the solveorder and error number 10
AGONVGDPFCSTCN                        , Max difference:   455.67959595 Max Pct    0.0000009309\PYGZpc{} It is number    93 in the solveorder and error number 11
AGONYTAXNINDKN                        , Max difference:     1.37211440 Max Pct    0.0014202837\PYGZpc{} It is number    95 in the solveorder and error number 12
AGONVAGRTOTLCN                        , Max difference:     5.06173030 Max Pct    0.0000057479\PYGZpc{} It is number    96 in the solveorder and error number 13
AGONVINDMINGCN                        , Max difference:    89.14881706 Max Pct    0.0000037522\PYGZpc{} It is number    97 in the solveorder and error number 14
AGONVSRVPUBLCN                        , Max difference:   597.87203789 Max Pct    0.0000183998\PYGZpc{} It is number    98 in the solveorder and error number 15
AGONVGDPOTHRCN                        , Max difference:   355.96192932 Max Pct    0.0000005341\PYGZpc{} It is number    99 in the solveorder and error number 16
AGONYGDPMKTPCN                        , Max difference:   296.17025757 Max Pct    0.0000012217\PYGZpc{} It is number   147 in the solveorder and error number 17
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
MDA calculated  

Chekking residuals for MDA 2014 to 2025
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
PAK calculated  

Chekking residuals for PAK 2015 to 2100
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Variable with residuals above threshold
PAKNYYWBTOTLCN              , Max difference:    76.62465858 Max Pct    0.0000042560\PYGZpc{} It is number    69 in the solveorder and error number 1
PAKNECONPRVTCN              , Max difference:    35.41133165 Max Pct    0.0000017794\PYGZpc{} It is number    78 in the solveorder and error number 2
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
PER calculated  

Chekking residuals for PER 2016 to 2300
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Run the models}
\label{\detokenize{content/howto/onboard/eviews/onboard many models from wf1:run-the-models}}
\sphinxAtStartPar
Some models need a different alfa (dampening factor in Gauss iterations) in order to solve.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{alfadict}\PYG{o}{=}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ago}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}\PYG{l+m+mf}{0.7}\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{for} \PYG{n}{modelname}\PYG{p}{,}\PYG{n}{cmodel} \PYG{o+ow}{in} \PYG{n}{allmodels}\PYG{o}{.}\PYG{n}{items}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{\PYGZus{}} \PYG{o}{=} \PYG{n}{cmodel}\PYG{o}{.}\PYG{n}{mmodel}\PYG{p}{(}\PYG{n}{cmodel}\PYG{o}{.}\PYG{n}{base\PYGZus{}input}\PYG{p}{,}\PYG{n}{alfa}\PYG{o}{=}\PYG{n}{alfadict}\PYG{o}{.}\PYG{n}{get}\PYG{p}{(}\PYG{n}{modelname}\PYG{p}{,}\PYG{l+m+mf}{1.0}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{cmodel}\PYG{o}{.}\PYG{n}{mmodel}\PYG{o}{.}\PYG{n}{modeldump}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{modelflowdumps/}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{modelname}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{.pcim}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}  
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{modelname}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{ run and saved}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
ago run and saved
mda run and saved
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
pak run and saved
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
per run and saved
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
!dir modelflowdumps\PYGZbs{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 Volume in drive C has no label.
 Volume Serial Number is C2DB\PYGZhy{}095E

 Directory of c:\PYGZbs{}wb new\PYGZbs{}Modelflow\PYGZbs{}working\PYGZus{}paper\PYGZbs{}thebook\PYGZbs{}content\PYGZbs{}howto\PYGZbs{}onboard\PYGZbs{}eviews\PYGZbs{}modelflowdumps

27\PYGZhy{}06\PYGZhy{}2022  02:14    \PYGZlt{}DIR\PYGZgt{}          .
11\PYGZhy{}10\PYGZhy{}2022  16:00    \PYGZlt{}DIR\PYGZgt{}          ..
27\PYGZhy{}06\PYGZhy{}2022  02:14         1.434.250 ago
11\PYGZhy{}10\PYGZhy{}2022  19:24         1.434.181 ago.pcim
27\PYGZhy{}06\PYGZhy{}2022  02:14         1.029.618 mda
11\PYGZhy{}10\PYGZhy{}2022  19:24         1.029.604 mda.pcim
27\PYGZhy{}06\PYGZhy{}2022  02:14         3.386.584 pak
11\PYGZhy{}10\PYGZhy{}2022  19:24         3.386.691 pak.pcim
27\PYGZhy{}06\PYGZhy{}2022  02:14        11.979.848 per
11\PYGZhy{}10\PYGZhy{}2022  19:24        11.980.021 per.pcim
               8 File(s)     35.660.797 bytes
               2 Dir(s)  751.341.367.296 bytes free
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Make some names in the namespace}
\label{\detokenize{content/howto/onboard/eviews/onboard many models from wf1:make-some-names-in-the-namespace}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{for} \PYG{n}{modelname}\PYG{p}{,}\PYG{n}{cmodel} \PYG{o+ow}{in} \PYG{n}{allmodels}\PYG{o}{.}\PYG{n}{items}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{thismodel} \PYG{o}{=} \PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{m}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{modelname}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}
    \PYG{n}{thisbaseline} \PYG{o}{=} \PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{modelname}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZus{}baseline}\PYG{l+s+s1}{\PYGZsq{}}
    \PYG{n}{thiscmodel} \PYG{o}{=} \PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{modelname}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZus{}cmodel}\PYG{l+s+s1}{\PYGZsq{}}
    \PYG{n+nb}{globals}\PYG{p}{(}\PYG{p}{)}\PYG{p}{[}\PYG{n}{thismodel}\PYG{p}{]} \PYG{o}{=} \PYG{n}{cmodel}\PYG{o}{.}\PYG{n}{mmodel}
    \PYG{n+nb}{globals}\PYG{p}{(}\PYG{p}{)}\PYG{p}{[}\PYG{n}{thisbaseline}\PYG{p}{]}\PYG{o}{=} \PYG{n}{cmodel}\PYG{o}{.}\PYG{n}{base\PYGZus{}input} 
    \PYG{n+nb}{globals}\PYG{p}{(}\PYG{p}{)}\PYG{p}{[}\PYG{n}{thiscmodel}\PYG{p}{]}\PYG{o}{=} \PYG{n}{cmodel}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{thismodel}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{, }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{thisbaseline}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{ and }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{thiscmodel}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{ has been created}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}    
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
mago, ago\PYGZus{}baseline and ago\PYGZus{}cmodel has been created
mmda, mda\PYGZus{}baseline and mda\PYGZus{}cmodel has been created
mpak, pak\PYGZus{}baseline and pak\PYGZus{}cmodel has been created
mper, per\PYGZus{}baseline and per\PYGZus{}cmodel has been created
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{thissilent} \PYG{o}{=} \PYG{l+m+mi}{1}
\PYG{n}{\PYGZus{}} \PYG{o}{=} \PYG{n}{mago}\PYG{p}{(}\PYG{n}{ago\PYGZus{}baseline}\PYG{p}{,}\PYG{n}{silent}\PYG{o}{=}\PYG{n}{thissilent}\PYG{p}{,}\PYG{n}{alfa}\PYG{o}{=}\PYG{l+m+mf}{0.7}\PYG{p}{)}
\PYG{n}{\PYGZus{}} \PYG{o}{=} \PYG{n}{mmda}\PYG{p}{(}\PYG{n}{mda\PYGZus{}baseline}\PYG{p}{,}\PYG{n}{silent}\PYG{o}{=}\PYG{n}{thissilent}\PYG{p}{)}
\PYG{n}{\PYGZus{}} \PYG{o}{=} \PYG{n}{mpak}\PYG{p}{(}\PYG{n}{pak\PYGZus{}baseline}\PYG{p}{,}\PYG{n}{silent}\PYG{o}{=}\PYG{n}{thissilent}\PYG{p}{)}
\PYG{n}{\PYGZus{}} \PYG{o}{=} \PYG{n}{mper}\PYG{p}{(}\PYG{n}{per\PYGZus{}baseline}\PYG{p}{,}\PYG{n}{silent}\PYG{o}{=}\PYG{n}{thissilent}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{From here testing \sphinxhyphen{} will be deleted}
\label{\detokenize{content/howto/onboard/eviews/onboard many models from wf1:from-here-testing-will-be-deleted}}

\section{Lets create a list of all variable names}
\label{\detokenize{content/howto/onboard/eviews/onboard many models from wf1:lets-create-a-list-of-all-variable-names}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{allvar} \PYG{o}{=} \PYG{p}{[}\PYG{n}{varname} \PYG{k}{for} \PYG{n}{cmodel}  \PYG{o+ow}{in} \PYG{n}{allmodels}\PYG{o}{.}\PYG{n}{values}\PYG{p}{(}\PYG{p}{)} \PYG{k}{for} \PYG{n}{varname} \PYG{o+ow}{in} \PYG{n}{cmodel}\PYG{o}{.}\PYG{n}{mmodel}\PYG{o}{.}\PYG{n}{allvar}\PYG{o}{.}\PYG{n}{keys}\PYG{p}{(}\PYG{p}{)}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{allvar} \PYG{o}{=} \PYG{p}{[}\PYG{n}{varname} \PYG{k}{for} \PYG{n}{thismodel} \PYG{o+ow}{in} \PYG{p}{[}\PYG{n}{mago}\PYG{p}{,}\PYG{n}{mmda}\PYG{p}{,}\PYG{n}{mpak}\PYG{p}{,}\PYG{n}{mper}\PYG{p}{]} \PYG{k}{for} \PYG{n}{varname} \PYG{o+ow}{in} \PYG{n}{thismodel}\PYG{o}{.}\PYG{n}{allvar}\PYG{o}{.}\PYG{n}{keys}\PYG{p}{(}\PYG{p}{)}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{allvar\PYGZus{}dict}  \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{n}{varname}\PYG{p}{:}\PYG{n}{cmodel}\PYG{o}{.}\PYG{n}{mmodel}\PYG{o}{.}\PYG{n}{var\PYGZus{}description}\PYG{p}{[}\PYG{n}{varname}\PYG{p}{]} \PYG{k}{for} \PYG{n}{cmodel}  \PYG{o+ow}{in} \PYG{n}{allmodels}\PYG{o}{.}\PYG{n}{values}\PYG{p}{(}\PYG{p}{)} \PYG{k}{for} \PYG{n}{varname} \PYG{o+ow}{in} \PYG{n}{cmodel}\PYG{o}{.}\PYG{n}{mmodel}\PYG{o}{.}\PYG{n}{allvar}\PYG{o}{.}\PYG{n}{keys}\PYG{p}{(}\PYG{p}{)}\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{allvar}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
2872
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{fnmatch}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{fnmatch}\PYG{o}{.}\PYG{n}{filter}\PYG{p}{(}\PYG{n}{allvar}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{*NECONGOVTCN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
[\PYGZsq{}AGONECONGOVTCN\PYGZsq{}, \PYGZsq{}MDANECONGOVTCN\PYGZsq{}, \PYGZsq{}PAKNECONGOVTCN\PYGZsq{}, \PYGZsq{}PERNECONGOVTCN\PYGZsq{}]
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb}{set}\PYG{p}{(}\PYG{n}{allvar}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
2763
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{getnames}\PYG{p}{(}\PYG{n}{pat}\PYG{p}{,}\PYG{n}{allvar}\PYG{o}{=}\PYG{n}{allvar}\PYG{p}{,}\PYG{n}{allvar\PYGZus{}dict}\PYG{o}{=}\PYG{n}{allvar\PYGZus{}dict}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{selected} \PYG{o}{=} \PYG{p}{[}\PYG{p}{(}\PYG{n}{varname}\PYG{p}{,}\PYG{n}{allvar\PYGZus{}dict}\PYG{p}{[}\PYG{n}{varname}\PYG{p}{]}\PYG{p}{)} \PYG{k}{for} \PYG{n}{varname} \PYG{o+ow}{in} \PYG{n}{fnmatch}\PYG{o}{.}\PYG{n}{filter}\PYG{p}{(}\PYG{n}{allvar\PYGZus{}dict}\PYG{o}{.}\PYG{n}{keys}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,} \PYG{n}{pat}\PYG{p}{)}\PYG{p}{]}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{o}{*}\PYG{n}{selected}\PYG{p}{,}\PYG{n}{sep}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\subsection{Government consumption}
\label{\detokenize{content/howto/onboard/eviews/onboard many models from wf1:government-consumption}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{getnames}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{*NECONGOVTCN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
(\PYGZsq{}AGONECONGOVTCN\PYGZsq{}, \PYGZsq{}Nominal Govt Cons\PYGZsq{})
(\PYGZsq{}MDANECONGOVTCN\PYGZsq{}, \PYGZsq{}GDP: Final Consumption: Public Administration LCU thousands\PYGZsq{})
(\PYGZsq{}PAKNECONGOVTCN\PYGZsq{}, \PYGZsq{}Govt. Cons., LCU mn\PYGZsq{})
(\PYGZsq{}PERNECONGOVTCN\PYGZsq{}, \PYGZsq{}PERNECONGOVTCN\PYGZsq{})
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Government investment}
\label{\detokenize{content/howto/onboard/eviews/onboard many models from wf1:government-investment}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{getnames}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{*NEGDIFGOVCN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
(\PYGZsq{}AGONEGDIFGOVCN\PYGZsq{}, \PYGZsq{}AGONEGDIFGOVCN\PYGZsq{})
(\PYGZsq{}MDANEGDIFGOVCN\PYGZsq{}, \PYGZsq{}MDANEGDIFGOVCN\PYGZsq{})
(\PYGZsq{}PAKNEGDIFGOVCN\PYGZsq{}, \PYGZsq{}Public Fixed Domestic Inv., LCU mn\PYGZsq{})
(\PYGZsq{}PERNEGDIFGOVCN\PYGZsq{}, \PYGZsq{}PERNEGDIFGOVCN\PYGZsq{})
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{getnames}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{*LMEMPTOTLCN*}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
(\PYGZsq{}PAKLMEMPTOTLCN\PYGZus{}FITTED\PYGZsq{}, \PYGZsq{}Fitted  value:Employment\PYGZsq{})
(\PYGZsq{}PAKLMEMPTOTLCN\PYGZsq{}, \PYGZsq{}Employment\PYGZsq{})
(\PYGZsq{}PAKLMEMPTOTLCN\PYGZus{}D\PYGZsq{}, \PYGZsq{}Fix dummy:Employment\PYGZsq{})
(\PYGZsq{}PAKLMEMPTOTLCN\PYGZus{}A\PYGZsq{}, \PYGZsq{}Add factor:Employment\PYGZsq{})
(\PYGZsq{}PAKLMEMPTOTLCN\PYGZus{}X\PYGZsq{}, \PYGZsq{}Fix value:Employment\PYGZsq{})
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{getnames}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{*GGEXPWAGECN*}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
(\PYGZsq{}AGOGGEXPWAGECN\PYGZus{}VALUE\PYGZus{}2019\PYGZsq{}, \PYGZsq{}AGOGGEXPWAGECN\PYGZus{}VALUE\PYGZus{}2019\PYGZsq{})
(\PYGZsq{}AGOGGEXPWAGECN\PYGZsq{}, \PYGZsq{}Wages and Salaries\PYGZsq{})
(\PYGZsq{}AGOGGEXPWAGECN\PYGZus{}A\PYGZsq{}, \PYGZsq{}Add factor:Wages and Salaries\PYGZsq{})
(\PYGZsq{}AGOGGEXPWAGECN\PYGZus{}FITTED\PYGZsq{}, \PYGZsq{}Fitted  value:Wages and Salaries\PYGZsq{})
(\PYGZsq{}AGOGGEXPWAGECN\PYGZus{}X\PYGZsq{}, \PYGZsq{}Fix value:Wages and Salaries\PYGZsq{})
(\PYGZsq{}AGOGGEXPWAGECN\PYGZus{}D\PYGZsq{}, \PYGZsq{}Fix dummy:Wages and Salaries\PYGZsq{})
(\PYGZsq{}MDAGGEXPWAGECN\PYGZus{}FITTED\PYGZsq{}, \PYGZsq{}Fitted  value:Expenditure: Wages and Salaries LCU millions\PYGZsq{})
(\PYGZsq{}MDAGGEXPWAGECN\PYGZus{}A\PYGZsq{}, \PYGZsq{}Add factor:Expenditure: Wages and Salaries LCU millions\PYGZsq{})
(\PYGZsq{}MDAGGEXPWAGECN\PYGZus{}D\PYGZsq{}, \PYGZsq{}Fix dummy:Expenditure: Wages and Salaries LCU millions\PYGZsq{})
(\PYGZsq{}MDAGGEXPWAGECN\PYGZsq{}, \PYGZsq{}Expenditure: Wages and Salaries LCU millions\PYGZsq{})
(\PYGZsq{}MDAGGEXPWAGECN\PYGZus{}X\PYGZsq{}, \PYGZsq{}Fix value:Expenditure: Wages and Salaries LCU millions\PYGZsq{})
(\PYGZsq{}PERGGEXPWAGECN\PYGZus{}D\PYGZsq{}, \PYGZsq{}Fix dummy:PERGGEXPWAGECN\PYGZsq{})
(\PYGZsq{}PERGGEXPWAGECN\PYGZus{}FITTED\PYGZsq{}, \PYGZsq{}Fitted  value:PERGGEXPWAGECN\PYGZsq{})
(\PYGZsq{}PERGGEXPWAGECN\PYGZus{}A\PYGZsq{}, \PYGZsq{}Add factor:PERGGEXPWAGECN\PYGZsq{})
(\PYGZsq{}PERGGEXPWAGECN\PYGZus{}X\PYGZsq{}, \PYGZsq{}Fix value:PERGGEXPWAGECN\PYGZsq{})
(\PYGZsq{}PERGGEXPWAGECN\PYGZsq{}, \PYGZsq{}PERGGEXPWAGECN\PYGZsq{})
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{PAKBXFSTREMTCD}\PYG{o}{.}\PYG{n}{frml}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Endogeneous: PAKBXFSTREMTCD: Exp., Remittances (BOP), US\PYGZdl{} mn
Formular: FRML \PYGZlt{}Z,EXO\PYGZgt{} PAKBXFSTREMTCD = (PAKBXFSTREMTCD\PYGZus{}A*PAKNYGDPMKTPCD+PAKNYGDPMKTPCD* (0.053028373687723) ) * (1\PYGZhy{}PAKBXFSTREMTCD\PYGZus{}D)+ PAKBXFSTREMTCD\PYGZus{}X*PAKBXFSTREMTCD\PYGZus{}D  \PYGZdl{}

PAKBXFSTREMTCD  : Exp., Remittances (BOP), US\PYGZdl{} mn
PAKBXFSTREMTCD\PYGZus{}A: Add factor:Exp., Remittances (BOP), US\PYGZdl{} mn
PAKBXFSTREMTCD\PYGZus{}D: Fix dummy:Exp., Remittances (BOP), US\PYGZdl{} mn
PAKBXFSTREMTCD\PYGZus{}X: Fix value:Exp., Remittances (BOP), US\PYGZdl{} mn
PAKNYGDPMKTPCD  : 
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{PAKGGEXPGNFSCN}\PYG{o}{.}\PYG{n}{frml}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Endogeneous: PAKGGEXPGNFSCN: General government expenditure on goods and services (millions lcu)
Formular: FRML \PYGZlt{}Z,EXO\PYGZgt{} PAKGGEXPGNFSCN = (0.3*PAKGGEXPGNFSCN(\PYGZhy{}1)+(1\PYGZhy{}0.3)*(0.80*(PAKGGREVTOTLCN\PYGZhy{}PAKGGEXPINTPCN(\PYGZhy{}0)))+505277.259999999*DURING\PYGZus{}2012 + PAKGGEXPGNFSCN\PYGZus{}A)* (1\PYGZhy{}PAKGGEXPGNFSCN\PYGZus{}D)+ PAKGGEXPGNFSCN\PYGZus{}X*PAKGGEXPGNFSCN\PYGZus{}D  \PYGZdl{}

PAKGGEXPGNFSCN  : General government expenditure on goods and services (millions lcu)
DURING\PYGZus{}2012     : 
PAKGGEXPGNFSCN\PYGZus{}A: Add factor:General government expenditure on goods and services (millions lcu)
PAKGGEXPGNFSCN\PYGZus{}D: Fix dummy:General government expenditure on goods and services (millions lcu)
PAKGGEXPGNFSCN\PYGZus{}X: Fix value:General government expenditure on goods and services (millions lcu)
PAKGGEXPINTPCN  : General government interest payments on public debt (millions lcu)
PAKGGREVTOTLCN  : General government revenues, total (millions lcu)
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}\PYGZsh{}\PYGZsh{}  mpak.modeldash(\PYGZsq{}PAKNECONGOVTCN\PYGZsq{},jupyter=1)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{allmodels}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{pak}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{all\PYGZus{}frml\PYGZus{}dict}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKGGEXPGNFSCN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Endo\PYGZus{}var        : PAKGGEXPGNFSCN
Original        : PAKGGEXPGNFSCN=0.3*PAKGGEXPGNFSCN(\PYGZhy{}1)+(1\PYGZhy{}0.3)*(0.80*(PAKGGREVTOTLCN\PYGZhy{}PAKGGEXPINTPCN(\PYGZhy{}0)))+505277.259999999*DURING\PYGZus{}2012
Preprocessed    : PAKGGEXPGNFSCN=0.3*PAKGGEXPGNFSCN(\PYGZhy{}1)+(1\PYGZhy{}0.3)*(0.80*(PAKGGREVTOTLCN\PYGZhy{}PAKGGEXPINTPCN(\PYGZhy{}0)))+505277.259999999*DURING\PYGZus{}2012
Normalized      : PAKGGEXPGNFSCN = (0.3*PAKGGEXPGNFSCN(\PYGZhy{}1)+(1\PYGZhy{}0.3)*(0.80*(PAKGGREVTOTLCN\PYGZhy{}PAKGGEXPINTPCN(\PYGZhy{}0)))+505277.259999999*DURING\PYGZus{}2012 + PAKGGEXPGNFSCN\PYGZus{}A)* (1\PYGZhy{}PAKGGEXPGNFSCN\PYGZus{}D)+ PAKGGEXPGNFSCN\PYGZus{}X*PAKGGEXPGNFSCN\PYGZus{}D 
Calc\PYGZus{}add\PYGZus{}factor : PAKGGEXPGNFSCN\PYGZus{}A = (PAKGGEXPGNFSCN) \PYGZhy{} (0.3*PAKGGEXPGNFSCN(\PYGZhy{}1)+(1\PYGZhy{}0.3)*(0.80*(PAKGGREVTOTLCN\PYGZhy{}PAKGGEXPINTPCN(\PYGZhy{}0)))+505277.259999999*DURING\PYGZus{}2012)
Fitted          : PAKGGEXPGNFSCN\PYGZus{}FITTED = 0.3*PAKGGEXPGNFSCN(\PYGZhy{}1)+(1\PYGZhy{}0.3)*(0.80*(PAKGGREVTOTLCN\PYGZhy{}PAKGGEXPINTPCN(\PYGZhy{}0)))+505277.259999999*DURING\PYGZus{}2012
Eviews          : PAKGGEXPGNFSCN = 0.3*PAKGGEXPGNFSCN( \PYGZhy{} 1) + (1 \PYGZhy{} 0.3)*(0.80*(PAKGGREVTOTLCN \PYGZhy{} PAKGGEXPINTPCN( \PYGZhy{} 0))) + 505277.259999999*@DURING(\PYGZdq{}2012\PYGZdq{})
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{allmodels}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ago}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{all\PYGZus{}frml\PYGZus{}dict}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{AGONECONGOVTCN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Endo\PYGZus{}var        : AGONECONGOVTCN
Original        : DIFF(AGONECONGOVTCN)=DIFF(AGOGGEXPGNFSCN+AGOGGEXPWAGECN)*AGONECONGOVTCOV\PYGZus{}/100+14591.8357729705*DUMH
Preprocessed    : ((AGONECONGOVTCN)\PYGZhy{}(AGONECONGOVTCN(\PYGZhy{}1)))=((AGOGGEXPGNFSCN+AGOGGEXPWAGECN)\PYGZhy{}(AGOGGEXPGNFSCN(\PYGZhy{}1)+AGOGGEXPWAGECN(\PYGZhy{}1)))*AGONECONGOVTCOV\PYGZus{}/100+14591.8357729705*DUMH
Normalized      : AGONECONGOVTCN = (AGONECONGOVTCN\PYGZus{}A+ (((AGOGGEXPGNFSCN+AGOGGEXPWAGECN)\PYGZhy{}(AGOGGEXPGNFSCN(\PYGZhy{}1)+AGOGGEXPWAGECN(\PYGZhy{}1)))*AGONECONGOVTCOV\PYGZus{}/100+14591.8357729705*DUMH) +AGONECONGOVTCN(\PYGZhy{}1)) * (1\PYGZhy{}AGONECONGOVTCN\PYGZus{}D)+ AGONECONGOVTCN\PYGZus{}X*AGONECONGOVTCN\PYGZus{}D 
Calc\PYGZus{}add\PYGZus{}factor : AGONECONGOVTCN\PYGZus{}A = AGONECONGOVTCN\PYGZhy{} ((((AGOGGEXPGNFSCN+AGOGGEXPWAGECN)\PYGZhy{}(AGOGGEXPGNFSCN(\PYGZhy{}1)+AGOGGEXPWAGECN(\PYGZhy{}1)))*AGONECONGOVTCOV\PYGZus{}/100+14591.8357729705*DUMH)) \PYGZhy{}AGONECONGOVTCN(\PYGZhy{}1)
Fitted          : AGONECONGOVTCN\PYGZus{}FITTED =  (((AGOGGEXPGNFSCN+AGOGGEXPWAGECN)\PYGZhy{}(AGOGGEXPGNFSCN(\PYGZhy{}1)+AGOGGEXPWAGECN(\PYGZhy{}1)))*AGONECONGOVTCOV\PYGZus{}/100+14591.8357729705*DUMH) +AGONECONGOVTCN(\PYGZhy{}1)
Eviews          : D(AGONECONGOVTCN) = D(AGOGGEXPGNFSCN + AGOGGEXPWAGECN)*AGONECONGOVTCOV\PYGZus{}/100 + 14591.8357729705*DUMH
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{allmodels}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{pak}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{mmodel}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}
Model name                              :                  PAK 
Model structure                         :         Simultaneous 
Number of variables                     :                  841 
Number of exogeneous  variables         :                  463 
Number of endogeneous variables         :                  378 
\PYGZgt{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxstepscope


\chapter{Normalizing when onboarding  eviews models}
\label{\detokenize{content/howto/onboard/eviews/Normalizing when onboarding eviews:normalizing-when-onboarding-eviews-models}}\label{\detokenize{content/howto/onboard/eviews/Normalizing when onboarding eviews::doc}}
\sphinxAtStartPar
When onboarding a model from Eviews the model flows through several phases.
In this notebook the normalization of equations is explored.

\sphinxAtStartPar
In the normal function the equation is normalized. That is only one variable on the left hand side of the =. In addition the
the equation can be enriched by an add factor and a fixing construct.

\sphinxAtStartPar
Also equations can be generated to calculate the add factor and a \_fitted variable \sphinxhyphen{} meaning the value without fixing or add factor)

\sphinxAtStartPar
First an equation is \sphinxstylestrong{preprocessed}. That is: diff ,dlog, pct\_growth, movavg and the like is expanded.
Then the equation is normalized. That is a variable (the endogenous variable) is isolated on the left hand side of the =.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{modelnormalize} \PYG{k+kn}{import} \PYG{n}{normal}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZpc{}}\PYG{k}{load\PYGZus{}ext} autoreload
\PYG{o}{\PYGZpc{}}\PYG{k}{autoreload} 2
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{normal}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{dlog(a) = 3 }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{make\PYGZus{}fitted}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{add\PYGZus{}add\PYGZus{}factor}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Endo\PYGZus{}var        : A
Original        : dlog(a) = 3 
Preprocessed    : ((LOG(A))\PYGZhy{}(LOG(A(\PYGZhy{}1))))=3
Normalized      : A = A(\PYGZhy{}1)*EXP(A\PYGZus{}A+ (3) )
Calc\PYGZus{}add\PYGZus{}factor : A\PYGZus{}A = \PYGZhy{} ((3)) +LOG(A)\PYGZhy{}LOG(A(\PYGZhy{}1))
Fitted          : A\PYGZus{}FITTED = A(\PYGZhy{}1)*EXP( (3) )
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{normal}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{a \PYGZhy{} b = 3 }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{make\PYGZus{}fitted}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{add\PYGZus{}add\PYGZus{}factor}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Endo\PYGZus{}var        : A
Original        : a \PYGZhy{} b = 3 
Preprocessed    : A\PYGZhy{}B=3
Normalized      : A = A\PYGZus{}A+B+ (3) 
Calc\PYGZus{}add\PYGZus{}factor : A\PYGZus{}A = A\PYGZhy{}B\PYGZhy{} ((3)) 
Fitted          : A\PYGZus{}FITTED = B+ (3) 
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{normal}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{dlog(y)  = 3 * dlog(x+b) }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{make\PYGZus{}fitted}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Endo\PYGZus{}var        : Y
Original        : dlog(y)  = 3 * dlog(x+b) 
Preprocessed    : ((LOG(Y))\PYGZhy{}(LOG(Y(\PYGZhy{}1))))=3*((LOG(X+B))\PYGZhy{}(LOG(X(\PYGZhy{}1)+B(\PYGZhy{}1))))
Normalized      : Y = Y(\PYGZhy{}1)*EXP(Y\PYGZus{}A+ (3*((LOG(X+B))\PYGZhy{}(LOG(X(\PYGZhy{}1)+B(\PYGZhy{}1))))) )
Calc\PYGZus{}add\PYGZus{}factor : Y\PYGZus{}A = \PYGZhy{} ((3*((LOG(X+B))\PYGZhy{}(LOG(X(\PYGZhy{}1)+B(\PYGZhy{}1)))))) +LOG(Y)\PYGZhy{}LOG(Y(\PYGZhy{}1))
Fitted          : Y\PYGZus{}FITTED = Y(\PYGZhy{}1)*EXP( (3*((LOG(X+B))\PYGZhy{}(LOG(X(\PYGZhy{}1)+B(\PYGZhy{}1))))) )
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{normal}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x  = 3 }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{add\PYGZus{}add\PYGZus{}factor}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Endo\PYGZus{}var        : X
Original        : x  = 3 
Preprocessed    : X=3
Normalized      : X = (3 + X\PYGZus{}A)                               
Calc\PYGZus{}add\PYGZus{}factor : X\PYGZus{}A = (X) \PYGZhy{} (3)
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{normal}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{pct\PYGZus{}growth(x)  = pct\PYGZus{}growth(y) }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{make\PYGZus{}fixable}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{add\PYGZus{}add\PYGZus{}factor}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Endo\PYGZus{}var        : X
Original        : pct\PYGZus{}growth(x)  = pct\PYGZus{}growth(y) 
Preprocessed    :  (100 * ( (X) / (X(\PYGZhy{}1)) \PYGZhy{}1)) = (100 * ( (Y) / (Y(\PYGZhy{}1)) \PYGZhy{}1)) 
Normalized      : X = X\PYGZus{}A*X(\PYGZhy{}1)/100+ ((100 * ( (Y) / (Y(\PYGZhy{}1)) \PYGZhy{}1))) *X(\PYGZhy{}1)/100+X(\PYGZhy{}1)
Calc\PYGZus{}add\PYGZus{}factor : X\PYGZus{}A = 100*X/X(\PYGZhy{}1)\PYGZhy{} (((100 * ( (Y) / (Y(\PYGZhy{}1)) \PYGZhy{}1)))) \PYGZhy{}100
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxstepscope


\part{modifying models}

\sphinxstepscope


\chapter{Fixing the value of variables}
\label{\detokenize{content/howto/fixing/Fixing variables:fixing-the-value-of-variables}}\label{\detokenize{content/howto/fixing/Fixing variables::doc}}
\sphinxAtStartPar
Provided a model has been specified to allow this it is possible to fix the values of some endogenous variable. This can be
useful in many situations. Also when a variable is fixed a matching add factor is calculated. This keeps the result unchanged
when the fixing is lifted and the marginal properties of the model is preserved.


\section{Import the model class}
\label{\detokenize{content/howto/fixing/Fixing variables:import-the-model-class}}
\sphinxAtStartPar
This class incorporates most of the methods used to manage a model.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 \PYG{o}{\PYGZpc{}}\PYG{k}{load\PYGZus{}ext} autoreload
 \PYG{o}{\PYGZpc{}}\PYG{k}{autoreload} 2
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{pandas} \PYG{k}{as} \PYG{n+nn}{pd}
\PYG{k+kn}{from} \PYG{n+nn}{modelclass} \PYG{k+kn}{import} \PYG{n}{model} 
\PYG{k+kn}{import} \PYG{n+nn}{modelwidget} \PYG{k}{as} \PYG{n+nn}{mw}
\PYG{n}{model}\PYG{o}{.}\PYG{n}{widescreen}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{model}\PYG{o}{.}\PYG{n}{scroll\PYGZus{}off}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}IPython.core.display.HTML object\PYGZgt{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Load a pre\sphinxhyphen{}existing model, data and descriptions}
\label{\detokenize{content/howto/fixing/Fixing variables:load-a-pre-existing-model-data-and-descriptions}}
\sphinxAtStartPar
The file \sphinxcode{\sphinxupquote{pak.pcim}} contains a dump of model equations, dataframe, simulation options and variable descriptions. The file was created separately.

\sphinxAtStartPar
The modelload method returns an instance \sphinxcode{\sphinxupquote{mpak}} of the \sphinxcode{\sphinxupquote{model}} class, and a dataframe \sphinxcode{\sphinxupquote{result}} that holds the baseline run.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{p}{,}\PYG{n}{result} \PYG{o}{=} \PYG{n}{model}\PYG{o}{.}\PYG{n}{modelload}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{../../models/pak.pcim}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{run}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{silent}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{How to fix the values for variables}
\label{\detokenize{content/howto/fixing/Fixing variables:how-to-fix-the-values-for-variables}}
\sphinxAtStartPar
The equation for a fixable variable should like this:
\begin{quote}

\sphinxAtStartPar
frml <z,exo> VAR  = (expression)*(1\sphinxhyphen{}VAR\_D) + VAR\_X * VAR\_D
\end{quote}

\sphinxAtStartPar
Each endogenous variable which has an \_D variable and \_X variable can be fixed

\sphinxAtStartPar
\_D=1 means that the variable is to be fixed and

\sphinxAtStartPar
\_X holds the value to which it should be fixed

\sphinxAtStartPar
In the pak model all stocastic equations are fixable.


\subsection{.fix(dataframe,variable pattern, start,end) Returns a dataframe where variables matching pattern are fixed}
\label{\detokenize{content/howto/fixing/Fixing variables:fix-dataframe-variable-pattern-start-end-returns-a-dataframe-where-variables-matching-pattern-are-fixed}}
\sphinxAtStartPar
The code fixes the values for some variables by setting the \_X variable to the current value, and \_D variable to 1 in the timespan {[}start,end{]}.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{var\PYGZus{}to\PYGZus{}be\PYGZus{}fixed} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKGGEXPCAPTCN PAKGGEXPGNFSCN PAKGGEXPOTHRCN PAKGGEXPTRNSCN}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{fix\PYGZus{}df} \PYG{o}{=} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{fix}\PYG{p}{(}\PYG{n}{result}\PYG{p}{,}\PYG{n}{var\PYGZus{}to\PYGZus{}be\PYGZus{}fixed}\PYG{p}{,}\PYG{l+m+mi}{2021}\PYG{p}{,}\PYG{l+m+mi}{2100}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Now run the model with the new dataframe}
\label{\detokenize{content/howto/fixing/Fixing variables:now-run-the-model-with-the-new-dataframe}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{\PYGZus{}} \PYG{o}{=} \PYG{n}{mpak}\PYG{p}{(}\PYG{n}{fix\PYGZus{}df}\PYG{p}{,}\PYG{n}{silent}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{keep}\PYG{o}{=}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Baseline}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{} \PYGZus{} is just a  name, the dataframe is not going to be used }
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{alternative}  \PYG{o}{=}  \PYG{n}{fix\PYGZus{}df}\PYG{o}{.}\PYG{n}{upd}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZlt{}2023 2100\PYGZgt{} PAKGGREVCO2CER PAKGGREVCO2GER PAKGGREVCO2OER = 29}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{\PYGZus{}} \PYG{o}{=} \PYG{n}{mpak}\PYG{p}{(}\PYG{n}{alternative}\PYG{p}{,}\PYG{n}{silent}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{keep}\PYG{o}{=}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Tax = 29}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{alfa} \PYG{o}{=} \PYG{l+m+mf}{0.5}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{with} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{set\PYGZus{}smpl}\PYG{p}{(}\PYG{l+m+mi}{2020}\PYG{p}{,}\PYG{l+m+mi}{2030}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{display}\PYG{p}{(}\PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Tab(children=(Tab(children=(HTML(value=\PYGZsq{}\PYGZlt{}?xml version=\PYGZdq{}1.0\PYGZdq{} encoding=\PYGZdq{}utf\PYGZhy{}8\PYGZdq{} standalone=\PYGZdq{}no\PYGZdq{}?\PYGZgt{}\PYGZbs{}n\PYGZlt{}!DOCTYPE svg ‚Ä¶
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{.fix\_inf() Show relevant variables for each fixed variables}
\label{\detokenize{content/howto/fixing/Fixing variables:fix-inf-show-relevant-variables-for-each-fixed-variables}}
\sphinxAtStartPar
To make it short we only show the first 4 years

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{with} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{set\PYGZus{}smpl}\PYG{p}{(}\PYG{l+m+mi}{2021}\PYG{p}{,}\PYG{l+m+mi}{2024}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{fix\PYGZus{}inf}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Acquisition of non\PYGZhy{}financial assets

FRML \PYGZlt{}Z,EXO\PYGZgt{} PAKGGEXPCAPTCN = (0.3*PAKGGEXPCAPTCN(\PYGZhy{}1)+(1\PYGZhy{}0.3)*(0.37*(PAKGGREVTOTLCN\PYGZhy{}PAKGGEXPINTPCN(\PYGZhy{}0)))+393385.011*DURING\PYGZus{}2013 + PAKGGEXPCAPTCN\PYGZus{}A)* (1\PYGZhy{}PAKGGEXPCAPTCN\PYGZus{}D)+ PAKGGEXPCAPTCN\PYGZus{}X*PAKGGEXPCAPTCN\PYGZus{}D  \PYGZdl{}

FRML \PYGZlt{}CALC\PYGZgt{} PAKGGEXPCAPTCN\PYGZus{}A = (PAKGGEXPCAPTCN) \PYGZhy{} (0.3*PAKGGEXPCAPTCN(\PYGZhy{}1)+(1\PYGZhy{}0.3)*(0.37*(PAKGGREVTOTLCN\PYGZhy{}PAKGGEXPINTPCN(\PYGZhy{}0)))+393385.011*DURING\PYGZus{}2013)\PYGZdl{}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}pandas.io.formats.style.Styler at 0x2b152e82520\PYGZgt{}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Expenditure on Goods and Services

FRML \PYGZlt{}Z,EXO\PYGZgt{} PAKGGEXPGNFSCN = (0.3*PAKGGEXPGNFSCN(\PYGZhy{}1)+(1\PYGZhy{}0.3)*(0.80*(PAKGGREVTOTLCN\PYGZhy{}PAKGGEXPINTPCN(\PYGZhy{}0)))+505277.259999999*DURING\PYGZus{}2012 + PAKGGEXPGNFSCN\PYGZus{}A)* (1\PYGZhy{}PAKGGEXPGNFSCN\PYGZus{}D)+ PAKGGEXPGNFSCN\PYGZus{}X*PAKGGEXPGNFSCN\PYGZus{}D  \PYGZdl{}

FRML \PYGZlt{}CALC\PYGZgt{} PAKGGEXPGNFSCN\PYGZus{}A = (PAKGGEXPGNFSCN) \PYGZhy{} (0.3*PAKGGEXPGNFSCN(\PYGZhy{}1)+(1\PYGZhy{}0.3)*(0.80*(PAKGGREVTOTLCN\PYGZhy{}PAKGGEXPINTPCN(\PYGZhy{}0)))+505277.259999999*DURING\PYGZus{}2012)\PYGZdl{}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}pandas.io.formats.style.Styler at 0x2b152d7e1f0\PYGZgt{}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Other Expenditure

FRML \PYGZlt{}Z,EXO\PYGZgt{} PAKGGEXPOTHRCN = (\PYGZhy{}PAKGGEXPOTHRCN\PYGZus{}A*PAKNYGDPMKTPXN*PAKNYGDPPOTLKN+PAKNYGDPMKTPXN*PAKNYGDPPOTLKN* (\PYGZhy{}0.00363915924526289) ) * (1\PYGZhy{}PAKGGEXPOTHRCN\PYGZus{}D)+ PAKGGEXPOTHRCN\PYGZus{}X*PAKGGEXPOTHRCN\PYGZus{}D  \PYGZdl{}

FRML \PYGZlt{}CALC\PYGZgt{} PAKGGEXPOTHRCN\PYGZus{}A = \PYGZhy{}PAKGGEXPOTHRCN/(PAKNYGDPMKTPXN*PAKNYGDPPOTLKN)+ ((\PYGZhy{}0.00363915924526289)) \PYGZdl{}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}pandas.io.formats.style.Styler at 0x2b152d7e7f0\PYGZgt{}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Transfers

FRML \PYGZlt{}Z,EXO\PYGZgt{} PAKGGEXPTRNSCN = (0.91020884318931*PAKGGEXPTRNSCN(\PYGZhy{}1)+(1\PYGZhy{}0.91020884318931)*(0.06*(PAKGGREVTOTLCN\PYGZhy{}PAKGGEXPINTPCN(\PYGZhy{}0))) + PAKGGEXPTRNSCN\PYGZus{}A)* (1\PYGZhy{}PAKGGEXPTRNSCN\PYGZus{}D)+ PAKGGEXPTRNSCN\PYGZus{}X*PAKGGEXPTRNSCN\PYGZus{}D  \PYGZdl{}

FRML \PYGZlt{}CALC\PYGZgt{} PAKGGEXPTRNSCN\PYGZus{}A = (PAKGGEXPTRNSCN) \PYGZhy{} (0.91020884318931*PAKGGEXPTRNSCN(\PYGZhy{}1)+(1\PYGZhy{}0.91020884318931)*(0.06*(PAKGGREVTOTLCN\PYGZhy{}PAKGGEXPINTPCN(\PYGZhy{}0))))\PYGZdl{}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}pandas.io.formats.style.Styler at 0x2b150222a60\PYGZgt{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{The result match the result before exogenizing, as it should}
\label{\detokenize{content/howto/fixing/Fixing variables:the-result-match-the-result-before-exogenizing-as-it-should}}
\sphinxAtStartPar
Numbers below show the difference in pct betwen the solution whitout and with fixing

\sphinxAtStartPar
The difference is small and OK

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{with} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keepswitch}\PYG{p}{(}\PYG{k+kc}{True}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keep\PYGZus{}plot}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{diffpct}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{dec}\PYG{o}{=}\PYG{l+m+mi}{7}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Fixing variables_17_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Dump the model and solution for later use}
\label{\detokenize{content/howto/fixing/Fixing variables:dump-the-model-and-solution-for-later-use}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{modeldump}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{../../models/pak\PYGZus{}exogenized.pcim}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{More advanced information}
\label{\detokenize{content/howto/fixing/Fixing variables:more-advanced-information}}
\sphinxAtStartPar
The model instance (here mpak) maintain properties related to the fixing of values.


\subsection{List of potential and actual fixed variables}
\label{\detokenize{content/howto/fixing/Fixing variables:list-of-potential-and-actual-fixed-variables}}
\sphinxAtStartPar
The model instance (here mpak) maintain properties related to the fixing of values.


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Variable type
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Variable name suffix
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Lists for all fixable variables
&\sphinxstyletheadfamily 
\sphinxAtStartPar
List of fixed variables
\\
\hline
\sphinxAtStartPar
Endogenous
&
\sphinxAtStartPar

&
\sphinxAtStartPar
.fix\_endo
&
\sphinxAtStartPar
.fix\_endo\_fixed
\\
\hline
\sphinxAtStartPar
Dummy
&
\sphinxAtStartPar
\_D
&
\sphinxAtStartPar
.fix\_dummy
&
\sphinxAtStartPar
.fix\_dummy\_fixed
\\
\hline
\sphinxAtStartPar
Fixed value
&
\sphinxAtStartPar
\_X
&
\sphinxAtStartPar
.fix\_value
&
\sphinxAtStartPar
.fix\_value\_fixed
\\
\hline
\sphinxAtStartPar
Add factor
&
\sphinxAtStartPar
\_A
&
\sphinxAtStartPar
.fix\_add\_factor
&
\sphinxAtStartPar
.fix\_add\_factor\_fixed
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\subsubsection{LIst of all fixable variables for this model}
\label{\detokenize{content/howto/fixing/Fixing variables:list-of-all-fixable-variables-for-this-model}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{all\PYGZus{}fix\PYGZus{}var} \PYG{o}{=}\PYG{p}{[}\PYG{n+nb}{vars} \PYG{k}{for} \PYG{n+nb}{vars} \PYG{o+ow}{in} \PYG{n+nb}{zip}\PYG{p}{(}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{fix\PYGZus{}dummy}\PYG{p}{,}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{fix\PYGZus{}value}\PYG{p}{,}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{fix\PYGZus{}add\PYGZus{}factor}\PYG{p}{)}\PYG{p}{]}
\PYG{n}{fix\PYGZus{}names} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{all\PYGZus{}fix\PYGZus{}var}\PYG{p}{,}\PYG{n}{columns}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Dummy}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Fixed value}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Add factor}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}\PYG{n}{index}\PYG{o}{=}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{fix\PYGZus{}endo}\PYG{p}{)}
\PYG{n}{mw}\PYG{o}{.}\PYG{n}{htmlwidget\PYGZus{}df}\PYG{p}{(}\PYG{n}{mpak}\PYG{p}{,}\PYG{n}{fix\PYGZus{}names}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
HTML(value=\PYGZsq{}\PYGZlt{}style type=\PYGZdq{}text/css\PYGZdq{}\PYGZgt{}\PYGZbs{}n\PYGZsh{}T\PYGZus{}f5bc1 thead tr:nth\PYGZhy{}child(1) th \PYGZob{}\PYGZbs{}n  position: sticky;\PYGZbs{}n  background\PYGZhy{}co‚Ä¶
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
\sphinxstylestrong{Dataframes with strings and zip}

\sphinxAtStartPar
Pandas dataframes are very versatile. Here the dataframe is filled not with scalars but with strings.

\sphinxAtStartPar
Also the zip function is used to combine lists. \sphinxhref{https://docs.python.org/3/library/functions.html\#zip}{More here}
\end{sphinxadmonition}


\subsubsection{List of fixed variables}
\label{\detokenize{content/howto/fixing/Fixing variables:list-of-fixed-variables}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{fixed\PYGZus{}fix\PYGZus{}var} \PYG{o}{=}\PYG{p}{[}\PYG{n+nb}{vars} \PYG{k}{for} \PYG{n+nb}{vars} \PYG{o+ow}{in} 
                 \PYG{n+nb}{zip}\PYG{p}{(}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{fix\PYGZus{}dummy\PYGZus{}fixed}\PYG{p}{,}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{fix\PYGZus{}value\PYGZus{}fixed}\PYG{p}{,}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{fix\PYGZus{}add\PYGZus{}factor\PYGZus{}fixed}\PYG{p}{)}\PYG{p}{]}
\PYG{n}{fixed\PYGZus{}names} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{fixed\PYGZus{}fix\PYGZus{}var}\PYG{p}{,}\PYG{n}{columns}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Dummy}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Fixed value}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Add factor}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}\PYG{n}{index}\PYG{o}{=}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{fix\PYGZus{}endo\PYGZus{}fixed}\PYG{p}{)}
\PYG{n}{mw}\PYG{o}{.}\PYG{n}{htmlwidget\PYGZus{}df}\PYG{p}{(}\PYG{n}{mpak}\PYG{p}{,}\PYG{n}{fixed\PYGZus{}names}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
HTML(value=\PYGZsq{}\PYGZlt{}style type=\PYGZdq{}text/css\PYGZdq{}\PYGZgt{}\PYGZbs{}n\PYGZsh{}T\PYGZus{}42c76 thead tr:nth\PYGZhy{}child(1) th \PYGZob{}\PYGZbs{}n  position: sticky;\PYGZbs{}n  background\PYGZhy{}co‚Ä¶
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsubsection{Is there a model (.calc\_add\_factor\_model) available  to calculate the add factors corresponding to the fixed values}
\label{\detokenize{content/howto/fixing/Fixing variables:is-there-a-model-calc-add-factor-model-available-to-calculate-the-add-factors-corresponding-to-the-fixed-values}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{split\PYGZus{}calc\PYGZus{}add\PYGZus{}factor}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
True
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsubsection{Show the equations for the .calc\_add\_factor\_model}
\label{\detokenize{content/howto/fixing/Fixing variables:show-the-equations-for-the-calc-add-factor-model}}
\sphinxAtStartPar
Here only 3 are displayed. Delete the {[}:3{]} and all equations will be displayed.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{calc\PYGZus{}add\PYGZus{}factor\PYGZus{}model}\PYG{o}{.}\PYG{n}{equations}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZdl{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{[}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
[\PYGZsq{}FRML \PYGZlt{}CALC\PYGZgt{} PAKBMFSTOTHRCD\PYGZus{}A = \PYGZhy{}PAKBMFSTOTHRCD/PAKNYGDPMKTPCD+ ((\PYGZhy{}0.0106244247103773)) \PYGZsq{},
 \PYGZsq{} FRML \PYGZlt{}CALC\PYGZgt{} PAKBMFSTREMTCD\PYGZus{}A = \PYGZhy{}PAKBMFSTREMTCD/PAKNYGDPMKTPCD+ ((5.83179728399106E\PYGZhy{}05)) \PYGZsq{},
 \PYGZsq{} FRML \PYGZlt{}CALC\PYGZgt{} PAKBMGSRGNFSCD\PYGZus{}A = \PYGZhy{}100*PAKBMGSRGNFSCD/PAKBMGSRGNFSCD(\PYGZhy{}1)+ (((100 * ( (PAKNEIMPGNFSCD) / (PAKNEIMPGNFSCD(\PYGZhy{}1)) \PYGZhy{}1)) +0.16331992292838*DUMH)) +100\PYGZsq{}]
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxstepscope


\chapter{Modified equation to to keep real tax rates}
\label{\detokenize{content/howto/modifymodel/create_real_model:modified-equation-to-to-keep-real-tax-rates}}\label{\detokenize{content/howto/modifymodel/create_real_model::doc}}

\section{Import the model class}
\label{\detokenize{content/howto/modifymodel/create_real_model:import-the-model-class}}
\sphinxAtStartPar
This class incorporates most of the methods used to manage a model.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZpc{}}\PYG{k}{matplotlib} inline
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
 \PYG{o}{\PYGZpc{}}\PYG{k}{load\PYGZus{}ext} autoreload
 \PYG{o}{\PYGZpc{}}\PYG{k}{autoreload} 2
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{modelclass} \PYG{k+kn}{import} \PYG{n}{model} 
\PYG{n}{model}\PYG{o}{.}\PYG{n}{widescreen}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{model}\PYG{o}{.}\PYG{n}{scroll\PYGZus{}off}\PYG{p}{(}\PYG{p}{)}
\PYG{k+kn}{import} \PYG{n+nn}{modelmf}  \PYG{c+c1}{\PYGZsh{} Triggers a a dataframe method:  mfcalc }
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}IPython.core.display.HTML object\PYGZgt{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Load a pre\sphinxhyphen{}existing model, data and descriptions}
\label{\detokenize{content/howto/modifymodel/create_real_model:load-a-pre-existing-model-data-and-descriptions}}
\sphinxAtStartPar
The file \sphinxcode{\sphinxupquote{pak.pcim}} contains a dump of model equations, dataframe, simulation options and variable descriptions.


\subsection{For testing only, not used here}
\label{\detokenize{content/howto/modifymodel/create_real_model:for-testing-only-not-used-here}}
\sphinxAtStartPar
mpak,baseline = model.modelload(‚Äò../../models/pak.pcim‚Äô,run=1,silent=1,keep=‚ÄôNo tax change‚Äô)
mpakdisplay,\_ = model.modelload(‚Äò../../models/pak.pcim‚Äô,run=1,silent=1,keep=‚ÄôNo tax change‚Äô)

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{p}{,}\PYG{n}{baseline} \PYG{o}{=} \PYG{n}{model}\PYG{o}{.}\PYG{n}{modelload}\PYG{p}{(}\PYG{l+s+sa}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C:}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{wb new}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{Modelflow}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{jupyter}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{pak.pcim}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{run}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{silent}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{keep}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{No tax change}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{mpakdisplay}\PYG{p}{,}\PYG{n}{\PYGZus{}} \PYG{o}{=} \PYG{n}{model}\PYG{o}{.}\PYG{n}{modelload}\PYG{p}{(}\PYG{l+s+sa}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C:}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{wb new}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{Modelflow}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{jupyter}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{pak.pcim}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{run}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{silent}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{keep}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{No tax change}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Create a experiment  where nominal tax is set to 29}
\label{\detokenize{content/howto/modifymodel/create_real_model:create-a-experiment-where-nominal-tax-is-set-to-29}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{alternative\PYGZus{}nominal} \PYG{o}{=} \PYG{n}{baseline}\PYG{o}{.}\PYG{n}{upd}\PYG{p}{(}
     \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZlt{}2023 2100\PYGZgt{} PAKGGREVCO2CER PAKGGREVCO2GER PAKGGREVCO2OER = 29}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{\PYGZus{}} \PYG{o}{=} \PYG{n}{mpak}\PYG{p}{(}\PYG{n}{alternative\PYGZus{}nominal}\PYG{p}{,}\PYG{l+m+mi}{2021}\PYG{p}{,}\PYG{l+m+mi}{2100}\PYG{p}{,}\PYG{n}{keep}\PYG{o}{=}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Nominal model nominal tax = 29}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{alfa}\PYG{o}{=}\PYG{l+m+mf}{0.5}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Run same expriement but with real price set at 29}
\label{\detokenize{content/howto/modifymodel/create_real_model:run-same-expriement-but-with-real-price-set-at-29}}
\sphinxAtStartPar
First we use update to set the value to 29 in 2024

\sphinxAtStartPar
Then use a new functionality \sphinxstylestrong{mfcalc} to do a recusrive calculation taht is not easy to do straight up python. This behavior is
triggers by the
\begin{quote}

\sphinxAtStartPar
import modelmf
\end{quote}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Set the rate equal to 29 nominal in 2023}
\PYG{n}{alternative\PYGZus{}real\PYGZus{}exante} \PYG{o}{=} \PYG{n}{baseline}\PYG{o}{.}\PYG{n}{upd}\PYG{p}{(}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZlt{}2023 \PYGZgt{} PAKGGREVCO2GER PAKGGREVCO2OER PAKGGREVCO2CER = 29}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}   

\PYG{n}{alternative\PYGZus{}real\PYGZus{}exante}\PYG{o}{=}\PYG{n}{alternative\PYGZus{}real\PYGZus{}exante}\PYG{o}{.}\PYG{n}{mfcalc}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{l+s+s2}{PAKGGREVCO2GER =PAKGGREVCO2GER(\PYGZhy{}1)*PAKNECONPRVTXN/PAKNECONPRVTXN(\PYGZhy{}1)}
\PYG{l+s+s2}{PAKGGREVCO2OER =PAKGGREVCO2OER(\PYGZhy{}1)*PAKNECONPRVTXN/PAKNECONPRVTXN(\PYGZhy{}1)}
\PYG{l+s+s2}{PAKGGREVCO2CER =PAKGGREVCO2CER(\PYGZhy{}1)*PAKNECONPRVTXN/PAKNECONPRVTXN(\PYGZhy{}1)}\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}\PYG{p}{,}\PYG{l+m+mi}{2024}\PYG{p}{,} \PYG{l+m+mi}{2100}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{}runs the calculation over the period speciied}

\PYG{n}{\PYGZus{}} \PYG{o}{=} \PYG{n}{mpak}\PYG{p}{(}\PYG{n}{alternative\PYGZus{}real\PYGZus{}exante}\PYG{p}{,}\PYG{l+m+mi}{2021}\PYG{p}{,}\PYG{l+m+mi}{2100}\PYG{p}{,}\PYG{n}{keep}\PYG{o}{=}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Nominal model ex ante real tax = 29}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{alfa}\PYG{o}{=}\PYG{l+m+mf}{0.5}\PYG{p}{)}

\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keep\PYGZus{}plot}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKCCEMISCO2TKN PAKGGREVCO2CER}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+m+mi}{2010}\PYG{p}{,}\PYG{l+m+mi}{2100}\PYG{p}{,}\PYG{n}{legend}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{create_real_model_11_0}.png}

\noindent\sphinxincludegraphics{{create_real_model_11_1}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Now modify  the mpak model so the carbon tax can be kept constant in real terms}
\label{\detokenize{content/howto/modifymodel/create_real_model:now-modify-the-mpak-model-so-the-carbon-tax-can-be-kept-constant-in-real-terms}}
\sphinxAtStartPar
In the mpak model the carbon tax variables \sphinxcode{\sphinxupquote{PAKGGREVCO2CER PAKGGREVCO2GER PAKGGREVCO2OER}} where exogenous variables. Now equations for these variables are introduced to and a \sphinxstylestrong{new modified model} is created.

\sphinxAtStartPar
Each tax variable are now determined by an equation which makes its growth rate follow the growth rate of inflation PAKNECONPRVTXN.

\sphinxAtStartPar
The new equations are made fixable, so the previous behavior can be preserved. The behavior in each year is determined by the \sphinxstylestrong{<name>\_D} variable.
\begin{quote}

\sphinxAtStartPar
name = (expression)*(1\sphinxhyphen{}<name>\_D) + <name>\_X *<name>\_D
\end{quote}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Value of:   <name>\_D
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Value of: name
\\
\hline
\sphinxAtStartPar
1
&
\sphinxAtStartPar
\sphinxstylestrong{<name>\_X}
\\
\hline
\sphinxAtStartPar
0
&
\sphinxAtStartPar
\sphinxstylestrong{expression}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpakreal}\PYG{p}{,}\PYG{n}{\PYGZus{}} \PYG{o}{=} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{equpdate}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}\PYG{l+s+se}{\PYGZbs{}}
\PYG{l+s+s1}{\PYGZlt{}fixable\PYGZgt{} pct\PYGZus{}growth(PAKGGREVCO2CER) = pct\PYGZus{}growth(PAKNECONPRVTXN)}
\PYG{l+s+s1}{\PYGZlt{}fixable\PYGZgt{} pct\PYGZus{}growth(PAKGGREVCO2OER) = pct\PYGZus{}growth(PAKNECONPRVTXN)}
\PYG{l+s+s1}{\PYGZlt{}fixable\PYGZgt{} pct\PYGZus{}growth(PAKGGREVCO2GER) = pct\PYGZus{}growth(PAKNECONPRVTXN)}
\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}\PYG{p}{,}\PYG{n}{add\PYGZus{}add\PYGZus{}factor}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{,} \PYG{n}{calc\PYGZus{}add}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{,}\PYG{n}{newname}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Pak model, real adjusted tax}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
The model:\PYGZdq{}Pak model\PYGZdq{} got new equations, new model name is:\PYGZdq{}Pak model, real adjusted tax\PYGZdq{}
New equation for For PAKGGREVCO2CER
Old frml   :new endogeneous variable 
New frml   :FRML \PYGZlt{}fixable\PYGZgt{} PAKGGREVCO2CER = ( ((100 * ( (PAKNECONPRVTXN) / (PAKNECONPRVTXN(\PYGZhy{}1)) \PYGZhy{}1))) *PAKGGREVCO2CER(\PYGZhy{}1)/100+PAKGGREVCO2CER(\PYGZhy{}1)) * (1\PYGZhy{}PAKGGREVCO2CER\PYGZus{}D)+ PAKGGREVCO2CER\PYGZus{}X*PAKGGREVCO2CER\PYGZus{}D \PYGZdl{}
Adjust calc:No frml for adjustment calc  

New equation for For PAKGGREVCO2OER
Old frml   :new endogeneous variable 
New frml   :FRML \PYGZlt{}fixable\PYGZgt{} PAKGGREVCO2OER = ( ((100 * ( (PAKNECONPRVTXN) / (PAKNECONPRVTXN(\PYGZhy{}1)) \PYGZhy{}1))) *PAKGGREVCO2OER(\PYGZhy{}1)/100+PAKGGREVCO2OER(\PYGZhy{}1)) * (1\PYGZhy{}PAKGGREVCO2OER\PYGZus{}D)+ PAKGGREVCO2OER\PYGZus{}X*PAKGGREVCO2OER\PYGZus{}D \PYGZdl{}
Adjust calc:No frml for adjustment calc  

New equation for For PAKGGREVCO2GER
Old frml   :new endogeneous variable 
New frml   :FRML \PYGZlt{}fixable\PYGZgt{} PAKGGREVCO2GER = ( ((100 * ( (PAKNECONPRVTXN) / (PAKNECONPRVTXN(\PYGZhy{}1)) \PYGZhy{}1))) *PAKGGREVCO2GER(\PYGZhy{}1)/100+PAKGGREVCO2GER(\PYGZhy{}1)) * (1\PYGZhy{}PAKGGREVCO2GER\PYGZus{}D)+ PAKGGREVCO2GER\PYGZus{}X*PAKGGREVCO2GER\PYGZus{}D \PYGZdl{}
Adjust calc:No frml for adjustment calc  
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{No tax change in the real model.}
\label{\detokenize{content/howto/modifymodel/create_real_model:no-tax-change-in-the-real-model}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{baseline\PYGZus{}real} \PYG{o}{=} \PYG{n}{baseline}\PYG{o}{.}\PYG{n}{mfcalc}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\PYG{l+s+s1}{PAKGGREVCO2CER\PYGZus{}X = PAKGGREVCO2CER}
\PYG{l+s+s1}{PAKGGREVCO2GER\PYGZus{}X = PAKGGREVCO2GER}
\PYG{l+s+s1}{PAKGGREVCO2OER\PYGZus{}X = PAKGGREVCO2OER}
\PYG{l+s+s1}{PAKGGREVCO2CER\PYGZus{}D = 1}
\PYG{l+s+s1}{PAKGGREVCO2GER\PYGZus{}D = 1}
\PYG{l+s+s1}{PAKGGREVCO2OER\PYGZus{}D = 1}
\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}\PYG{p}{)}

\PYG{n}{\PYGZus{}} \PYG{o}{=} \PYG{n}{mpakreal}\PYG{p}{(}\PYG{n}{baseline\PYGZus{}real}\PYG{p}{,}\PYG{l+m+mi}{2021}\PYG{p}{,}\PYG{l+m+mi}{2100}\PYG{p}{,}\PYG{n}{alfa}\PYG{o}{=}\PYG{l+m+mf}{0.5}\PYG{p}{,}\PYG{n}{keep}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Real model no tax change}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Nominal tax of 29 in the real model.}
\label{\detokenize{content/howto/modifymodel/create_real_model:nominal-tax-of-29-in-the-real-model}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{alternative\PYGZus{}real\PYGZus{}model\PYGZus{}nominal\PYGZus{}tax} \PYG{o}{=} \PYG{n}{baseline\PYGZus{}real}\PYG{o}{.}\PYG{n}{upd}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\PYG{l+s+s1}{\PYGZlt{}2023 2100\PYGZgt{} PAKGGREVCO2CER\PYGZus{}X PAKGGREVCO2GER\PYGZus{}X PAKGGREVCO2OER\PYGZus{}X = 29}
\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}\PYG{p}{)}
\PYG{n}{\PYGZus{}} \PYG{o}{=} \PYG{n}{mpakreal}\PYG{p}{(}\PYG{n}{alternative\PYGZus{}real\PYGZus{}model\PYGZus{}nominal\PYGZus{}tax}\PYG{p}{,}\PYG{l+m+mi}{2021}\PYG{p}{,}\PYG{l+m+mi}{2100}\PYG{p}{,}\PYG{n}{alfa}\PYG{o}{=}\PYG{l+m+mf}{0.5}\PYG{p}{,}\PYG{n}{keep}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Real model nominal tax = 29}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Real tax in the real model}
\label{\detokenize{content/howto/modifymodel/create_real_model:real-tax-in-the-real-model}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{alternative\PYGZus{}real\PYGZus{}model\PYGZus{}real\PYGZus{}tax} \PYG{o}{=} \PYG{n}{baseline\PYGZus{}real}\PYG{o}{.}\PYG{n}{upd}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\PYG{l+s+s1}{\PYGZlt{}2023 2023\PYGZgt{} }
\PYG{l+s+s1}{PAKGGREVCO2CER\PYGZus{}X PAKGGREVCO2GER\PYGZus{}X PAKGGREVCO2OER\PYGZus{}X = 29}
\PYG{l+s+s1}{\PYGZlt{}2024 2100\PYGZgt{} }
\PYG{l+s+s1}{PAKGGREVCO2CER\PYGZus{}D PAKGGREVCO2GER\PYGZus{}D PAKGGREVCO2OER\PYGZus{}D = 0 }
\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}\PYG{p}{)}
\PYG{n}{res} \PYG{o}{=} \PYG{n}{mpakreal}\PYG{p}{(}\PYG{n}{alternative\PYGZus{}real\PYGZus{}model\PYGZus{}real\PYGZus{}tax}\PYG{p}{,}\PYG{l+m+mi}{2021}\PYG{p}{,}\PYG{l+m+mi}{2100}\PYG{p}{,}\PYG{n}{alfa}\PYG{o}{=}\PYG{l+m+mf}{0.5}\PYG{p}{,}\PYG{n}{keep}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Real model Real tax = 29}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{silent}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\chapter{Now look at the results for nominal and real tax.}
\label{\detokenize{content/howto/modifymodel/create_real_model:now-look-at-the-results-for-nominal-and-real-tax}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpakreal}\PYG{o}{.}\PYG{n}{keep\PYGZus{}plot}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKCCEMISCO2TKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+m+mi}{2016}\PYG{p}{,}\PYG{l+m+mi}{2100}\PYG{p}{,}\PYG{n}{diff}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{legend}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{create_real_model_21_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpakdisplay}\PYG{o}{.}\PYG{n}{keep\PYGZus{}solutions} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{o}{*}\PYG{o}{*}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keep\PYGZus{}solutions}\PYG{p}{,}\PYG{o}{*}\PYG{o}{*}\PYG{n}{mpakreal}\PYG{o}{.}\PYG{n}{keep\PYGZus{}solutions}\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Check ex ante vs real model}
\label{\detokenize{content/howto/modifymodel/create_real_model:check-ex-ante-vs-real-model}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{with} \PYG{n}{mpakdisplay}\PYG{o}{.}\PYG{n}{keepswitch}\PYG{p}{(}\PYG{n}{scenarios}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Nominal model ex ante real tax = 29|Real model Real tax = 29}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{mpakdisplay}\PYG{o}{.}\PYG{n}{keep\PYGZus{}plot}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKCCEMISCO2TKN PAKGGREVCO2CER PAKNECONPRVTXN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+m+mi}{2020}\PYG{p}{,}\PYG{l+m+mi}{2100}\PYG{p}{,}\PYG{n}{diff}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{create_real_model_24_0}.png}

\noindent\sphinxincludegraphics{{create_real_model_24_1}.png}

\noindent\sphinxincludegraphics{{create_real_model_24_2}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Check nominal tax gives the same result in the two models}
\label{\detokenize{content/howto/modifymodel/create_real_model:check-nominal-tax-gives-the-same-result-in-the-two-models}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{with} \PYG{n}{mpakdisplay}\PYG{o}{.}\PYG{n}{keepswitch}\PYG{p}{(}\PYG{n}{scenarios}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Nominal model nominal tax = 29|Real model nominal tax = 29}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{mpakdisplay}\PYG{o}{.}\PYG{n}{keep\PYGZus{}plot}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKCCEMISCO2TKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+m+mi}{2020}\PYG{p}{,}\PYG{l+m+mi}{2100}\PYG{p}{,}\PYG{n}{diff}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{legend}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{create_real_model_26_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxstepscope


\part{Features}

\sphinxstepscope


\chapter{Useful model instance properties and methods}
\label{\detokenize{content/Python/modelflow_features:useful-model-instance-properties-and-methods}}\label{\detokenize{content/Python/modelflow_features::doc}}
\sphinxAtStartPar
The focus of this chapter is to introduce some properties and methods of the model instance.

\sphinxAtStartPar
First a model and data is loaded, then a scenario is run. Then we have some content to use.

\sphinxAtStartPar
A model instance gives the user access to a number of properties and methods which helps in managing the model and its results.

\sphinxAtStartPar
If \sphinxcode{\sphinxupquote{mmodel}} is a model instance \sphinxcode{\sphinxupquote{mmodel.<property>}} will return a property. Some properties can also be assigned by the user just by:
\begin{quote}

\sphinxAtStartPar
mmodel.property = something
\end{quote}

\sphinxAtStartPar
The model class itself also have a few properties. These are simple accessed by  \sphinxcode{\sphinxupquote{model.<property>}}.


\section{Import the model class}
\label{\detokenize{content/Python/modelflow_features:import-the-model-class}}
\sphinxAtStartPar
This class incorporates most of the methods used to manage a model.

\sphinxAtStartPar
Assuming the ModelFlow library has been installed on your machine, the following imports set up your notebook so that you can run the cells in this notebook.

\sphinxAtStartPar
In order to manipulate plots later on matplotlib.pyplot is also imported.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}\PYGZpc{}matplotlib notebook}
\PYG{o}{\PYGZpc{}}\PYG{k}{matplotlib} inline
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{modelclass} \PYG{k+kn}{import} \PYG{n}{model} 
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt} \PYG{c+c1}{\PYGZsh{} To manipulate plots }
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Class methods to help in Jupyter Notebook}
\label{\detokenize{content/Python/modelflow_features:class-methods-to-help-in-jupyter-notebook}}

\subsection{.widescreen() use Jupyter Notebook in widescreen}
\label{\detokenize{content/Python/modelflow_features:widescreen-use-jupyter-notebook-in-widescreen}}
\sphinxAtStartPar
Enables the whole viewing area of the browser.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{model}\PYG{o}{.}\PYG{n}{widescreen}\PYG{p}{(}\PYG{p}{)} 
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}IPython.core.display.HTML object\PYGZgt{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{.scroll\_off() Turn off scroll cells in Jupyter Notebook}
\label{\detokenize{content/Python/modelflow_features:scroll-off-turn-off-scroll-cells-in-jupyter-notebook}}
\sphinxAtStartPar
Can be useful

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{model}\PYG{o}{.}\PYG{n}{scroll\PYGZus{}off}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{.modelload Load a pre\sphinxhyphen{}cooked model, data and descriptions}
\label{\detokenize{content/Python/modelflow_features:modelload-load-a-pre-cooked-model-data-and-descriptions}}
\sphinxAtStartPar
In this notebook, we will be using a pre\sphinxhyphen{}existing  model of Pakistan.

\sphinxAtStartPar
The file ‚Äòpak.pcim‚Äô has been created from a Eviews workspace. It contains all that is needed to run the model:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Model equations

\item {} 
\sphinxAtStartPar
Data

\item {} 
\sphinxAtStartPar
Simulation options

\item {} 
\sphinxAtStartPar
Variable descriptions

\end{itemize}

\sphinxAtStartPar
Using the ‚Äòmodelload‚Äô method of the  ‚Äòmodel‚Äô class, a model instance ‚Äòmpak‚Äô and a ‚Äòresult‚Äô DataFrame is created.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{p}{,}\PYG{n}{baseline} \PYG{o}{=} \PYG{n}{model}\PYG{o}{.}\PYG{n}{modelload}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{../models/pak.pcim}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{run}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{silent}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{keep}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Baseline}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\sphinxAtStartPar
\sphinxstylestrong{mpak} 
The \sphinxstyleemphasis{modelload} method processes the file and initiates the model, that we call ‚Äòmpak‚Äô (m for model and pak for Pakistan) with both equations and the data.

\sphinxAtStartPar
‚Äòmpak‚Äô is an \sphinxstylestrong{instance}  of the  model object with which we will work.

\sphinxAtStartPar
\sphinxstylestrong{baseline}  
‚Äòresult‚Äô is a Pandas dataframe containing the data that was loaded.

\sphinxAtStartPar
\sphinxstylestrong{run=1} the model is simulated. The simulation timeframe  and options from the time the file where dumped will be used. The two objects \sphinxstylestrong{mpak.basedf} and \sphinxstylestrong{mpak.lastdf} will contain the simulation result. If run=0 the model will not be simulated.

\sphinxAtStartPar
\sphinxstylestrong{silent=1} if silent is set to 0  information regarding the simulation will be displayed.

\sphinxAtStartPar
\sphinxstylestrong{keep=‚ÄôBaseline‚Äô} This saves the result in a dictionary mpak.keep\_solutions.


\section{Create a scenario}
\label{\detokenize{content/Python/modelflow_features:create-a-scenario}}
\sphinxAtStartPar
Many objects relates to comparison of different scenarios. So first a scenario is created by updating some exogenous variables.
In this case the carbon tax rates for gas, oil and coal are all set to 29 from 2023 to 2100. Then the scenario is simulated.
Now the mpak object contains a number of useful properties and methods.

\sphinxAtStartPar
You can find more on this experiment {\hyperref[\detokenize{content/howto/experiments/create_experiment::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{here}}}}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{scenario\PYGZus{}exo}  \PYG{o}{=}  \PYG{n}{baseline}\PYG{o}{.}\PYG{n}{upd}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZlt{}2020 2100\PYGZgt{} PAKGGREVCO2CER PAKGGREVCO2GER PAKGGREVCO2OER = 29}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{() Simulate on a dataframe}
\label{\detokenize{content/Python/modelflow_features:simulate-on-a-dataframe}}
\sphinxAtStartPar
When calling the model instance like \sphinxcode{\sphinxupquote{mpak(dataframe,start, end)}} the model will be simulated for the time frame \sphinxcode{\sphinxupquote{start to end}} using the dataframe.  
Just above we created a dataframe \sphinxcode{\sphinxupquote{scenario\_exo}} where the tax variables are updated. Now the \sphinxcode{\sphinxupquote{mpak}} can be simulated. We simulate from 2020 to 2100.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{scenario} \PYG{o}{=} \PYG{n}{mpak}\PYG{p}{(}\PYG{n}{scenario\PYGZus{}exo}\PYG{p}{,}\PYG{l+m+mi}{2020}\PYG{p}{,}\PYG{l+m+mi}{2100}\PYG{p}{,}\PYG{n}{keep}\PYG{o}{=}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Coal, Oil and Gastax : 29}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{} runs the simulation}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Access results}
\label{\detokenize{content/Python/modelflow_features:access-results}}
\sphinxAtStartPar
Now we have two dataframes with results \sphinxcode{\sphinxupquote{baseline}} and \sphinxcode{\sphinxupquote{scenario}}. These dataframes can be manipulated and visualized
with the tools provided by the \sphinxstylestrong{pandas} library and other like \sphinxstylestrong{Matplotlib} and \sphinxstylestrong{Plotly}. However to make things easy the first and
latest simulation result is also in the mpak object:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{mpak.basedf}: Dataframe with the values for baseline

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{mpak.lastdf}: Dataframe with the values for alternative

\end{itemize}

\sphinxAtStartPar
This means that .basedf and .lastdf will contain the same result after the first simulation. 
If new scenarios are simulated the data in .lastdf will then be replaced with the latest results.

\sphinxAtStartPar
These dataframes are used by a number of model instance methods as you will see later.

\sphinxAtStartPar
The user can assign dataframes to both .basedf and .lastdf. This is useful for comparing simulations which are not the first and last.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mpak.basedf: Dataframe: with }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{basedf}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{ years and }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{basedf}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{ variables}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mpak.lastdf: Dataframe: with }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{lastdf}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{ years and }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{lastdf}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{ variables}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
mpak.basedf: Dataframe: with 121 years and 1291 variables
mpak.lastdf: Dataframe: with 121 years and 1291 variables
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{.keep\_solutions, A dictionary of dataframes with results}
\label{\detokenize{content/Python/modelflow_features:keep-solutions-a-dictionary-of-dataframes-with-results}}
\sphinxAtStartPar
Create a dictionary of dataframes with .keep\_solutions. Sometimes we want to be able to compare more than two scenarios. Using \sphinxcode{\sphinxupquote{keep='some description'}} the dataframe with results can be saved into a dictionary with the description as key and the dataframe as value.

\sphinxAtStartPar
In our example we have created two scenarios. A baseline and a scenario with the tax set to 29. So mpak.keep\_solutions looks like this:

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mpak.keep\PYGZus{}solutions contains:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{k}{for} \PYG{n}{key}\PYG{p}{,}\PYG{n}{value} \PYG{o+ow}{in} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{keep\PYGZus{}solutions}\PYG{o}{.}\PYG{n}{items}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:} 
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{key = }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{key}\PYG{l+s+si}{:}\PYG{l+s+s1}{25}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{|Dataframe: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{value}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{ years and }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{value}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{ variables}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
mpak.keep\PYGZus{}solutions contains:
key = Baseline                 |Dataframe: 121 years and 1291 variables
key = Coal, Oil and Gastax : 29|Dataframe: 121 years and 1291 variables
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxAtStartPar
Sometime it can be useful to reset the \sphinxcode{\sphinxupquote{.keep\_solutions}}, so that a new set of solutions can be inspected. This is done by replacing it with an empty dictionary. Two methods can be used:
\begin{quote}

\sphinxAtStartPar
mpak.keep\_solutions = \{\}
\end{quote}

\sphinxAtStartPar
or in the simulation call:
\begin{quote}

\sphinxAtStartPar
mpak(,,keep=‚Äô‚Äô)
\end{quote}


\subsection{More on manipulating keep\_solution:}
\label{\detokenize{content/Python/modelflow_features:more-on-manipulating-keep-solution}}
\sphinxAtStartPar
{\hyperref[\detokenize{content/howto/experiments/create_experiment::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{Here}}}}


\subsection{.oldkwargs, Options in the simulation call is persistent between calls}
\label{\detokenize{content/Python/modelflow_features:oldkwargs-options-in-the-simulation-call-is-persistent-between-calls}}
\sphinxAtStartPar
When simulating a model the parameters are persistent. So the user just have to provide the
solution options once. These persistent parameters are located in the property .oldkwargs.

\sphinxAtStartPar
In this case the persistent parameters are:

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{oldkwargs}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZob{}\PYGZsq{}silent\PYGZsq{}: 1, \PYGZsq{}keep\PYGZsq{}: \PYGZsq{}Coal, Oil and Gastax : 29\PYGZsq{}\PYGZcb{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxAtStartPar
The user may have to reset the parameters, this is done like this:

\sphinxAtStartPar
To reset the options just do:
\begin{quote}

\sphinxAtStartPar
mpak.oldkwargs = \{\}
\end{quote}


\section{.current\_per, The time frame operations are performed on}
\label{\detokenize{content/Python/modelflow_features:current-per-the-time-frame-operations-are-performed-on}}
\sphinxAtStartPar
Most operations on a model class instance operates on the current time frame.
It is a subset of the row index of the dataframe which is simulated.

\sphinxAtStartPar
In this case it is:

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{current\PYGZus{}per}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Int64Index([2020, 2021, 2022, 2023, 2024, 2025, 2026, 2027, 2028, 2029, 2030,
            2031, 2032, 2033, 2034, 2035, 2036, 2037, 2038, 2039, 2040, 2041,
            2042, 2043, 2044, 2045, 2046, 2047, 2048, 2049, 2050, 2051, 2052,
            2053, 2054, 2055, 2056, 2057, 2058, 2059, 2060, 2061, 2062, 2063,
            2064, 2065, 2066, 2067, 2068, 2069, 2070, 2071, 2072, 2073, 2074,
            2075, 2076, 2077, 2078, 2079, 2080, 2081, 2082, 2083, 2084, 2085,
            2086, 2087, 2088, 2089, 2090, 2091, 2092, 2093, 2094, 2095, 2096,
            2097, 2098, 2099, 2100],
           dtype=\PYGZsq{}int64\PYGZsq{})
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxAtStartPar
The possible times in the dataframe is contained in the \sphinxcode{\sphinxupquote{<dataframe>.index}} property.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{scenario}\PYG{o}{.}\PYG{n}{index}  \PYG{c+c1}{\PYGZsh{} the index of the dataframe}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Int64Index([1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989,
            ...
            2091, 2092, 2093, 2094, 2095, 2096, 2097, 2098, 2099, 2100],
           dtype=\PYGZsq{}int64\PYGZsq{}, length=121)
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{.smpl, Set time frame}
\label{\detokenize{content/Python/modelflow_features:smpl-set-time-frame}}
\sphinxAtStartPar
The time frame can be set like this:

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{smpl}\PYG{p}{(}\PYG{l+m+mi}{2020}\PYG{p}{,}\PYG{l+m+mi}{2025}\PYG{p}{)}
\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{current\PYGZus{}per}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Int64Index([2020, 2021, 2022, 2023, 2024, 2025], dtype=\PYGZsq{}int64\PYGZsq{})
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{.set\_smpl, Set timeframe for a local scope}
\label{\detokenize{content/Python/modelflow_features:set-smpl-set-timeframe-for-a-local-scope}}
\sphinxAtStartPar
For many operations it can be useful to apply the operations for a shorter time frame, but retain the global time frame after the operation. 
This can be done  with a \sphinxcode{\sphinxupquote{with}} statement like this.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Global time  before   }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{current\PYGZus{}per}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{k}{with} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{set\PYGZus{}smpl}\PYG{p}{(}\PYG{l+m+mi}{2022}\PYG{p}{,}\PYG{l+m+mi}{2023}\PYG{p}{)}\PYG{p}{:}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Local time frame      }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{current\PYGZus{}per}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Unchanged global time }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{current\PYGZus{}per}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Global time  before   Int64Index([2020, 2021, 2022, 2023, 2024, 2025], dtype=\PYGZsq{}int64\PYGZsq{})
Local time frame      Int64Index([2022, 2023], dtype=\PYGZsq{}int64\PYGZsq{})
Unchanged global time Int64Index([2020, 2021, 2022, 2023, 2024, 2025], dtype=\PYGZsq{}int64\PYGZsq{})
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{.set\_smpl\_relative Set relative timeframe for a local scope}
\label{\detokenize{content/Python/modelflow_features:set-smpl-relative-set-relative-timeframe-for-a-local-scope}}
\sphinxAtStartPar
When creating a script it can be useful to set the time frame relative to the
current time.

\sphinxAtStartPar
Like this:

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Global time  before   }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{current\PYGZus{}per}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{k}{with} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{set\PYGZus{}smpl\PYGZus{}relative} \PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{:}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Local time frame      }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{current\PYGZus{}per}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Unchanged global time }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{current\PYGZus{}per}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Global time  before   Int64Index([2020, 2021, 2022, 2023, 2024, 2025], dtype=\PYGZsq{}int64\PYGZsq{})
Local time frame      Int64Index([2019, 2020, 2021, 2022, 2023, 2024, 2025], dtype=\PYGZsq{}int64\PYGZsq{})
Unchanged global time Int64Index([2020, 2021, 2022, 2023, 2024, 2025], dtype=\PYGZsq{}int64\PYGZsq{})
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Using the index operator {[} {]} to select and visualize variables.}
\label{\detokenize{content/Python/modelflow_features:using-the-index-operator-to-select-and-visualize-variables}}\label{\detokenize{content/Python/modelflow_features:index-operator}}
\sphinxAtStartPar
The index operator {[} {]} can be used to select variables and then process the values for quick analysis.

\sphinxAtStartPar
To select variables the method accept patterns which defines variable names. Wildcards:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{\textbackslash{}*}} matches everything

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{?}} matches any single character

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{\textbackslash{}{[}seq{]}}} matches any character in seq

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{\textbackslash{}{[}!seq{]}}} matches any character not in seq

\end{itemize}

\sphinxAtStartPar
For more how wildcards can be used, the specification can be found here (https://docs.python.org/3/library/fnmatch.html)

\sphinxAtStartPar
In the following example we are selecting the results of mpak{[}‚ÄòPAKNYGDPMKTPKN‚Äô{]}

\sphinxAtStartPar
This call will return a special class (called \sphinxcode{\sphinxupquote{vis}}). It implements a number
of methods and properties which comes in handy for quick analyses.

\sphinxAtStartPar
Several properties and methods can be chained. An example:

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{with} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{set\PYGZus{}smpl}\PYG{p}{(}\PYG{l+m+mi}{2020}\PYG{p}{,}\PYG{l+m+mi}{2100}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{difpctlevel}\PYG{o}{.}\PYG{n}{mul100}\PYG{o}{.}\PYG{n}{rename}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{colrow}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}
                \PYG{n}{title}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Difference to baseline in percent}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{top}\PYG{o}{=}\PYG{l+m+mf}{0.8}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{modelflow_features_39_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxAtStartPar
But first some basic information


\subsection{model{[}‚Äò\#ENDO‚Äô{]}}
\label{\detokenize{content/Python/modelflow_features:model-endo}}
\sphinxAtStartPar
Use ‚Äò\#ENDO‚Äô to access all endogenous variables in your model instance.

\sphinxAtStartPar
For the sake of space, the result is saved in the variable ‚Äòallendo‚Äô and not printed.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{allendo} \PYG{o}{=} \PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsh{}ENDO}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{c+c1}{\PYGZsh{} allendo.show}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\subsection{Access values in .lastdf and .basedf}
\label{\detokenize{content/Python/modelflow_features:access-values-in-lastdf-and-basedf}}
\sphinxAtStartPar
To limit the output printed, we set the time frame to 2020 to 2023.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{smpl}\PYG{p}{(}\PYG{l+m+mi}{2020}\PYG{p}{,}\PYG{l+m+mi}{2023}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\sphinxAtStartPar
To access the values of ‚ÄòPAKNYGDPMKTPKN‚Äô and ‚ÄòPAKNECONPRVTKN‚Äô from the latest simulation a small widget is displayed.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN PAKNECONPRVTKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} 
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Tab(children=(Tab(children=(HTML(value=\PYGZsq{}\PYGZlt{}?xml version=\PYGZdq{}1.0\PYGZdq{} encoding=\PYGZdq{}utf\PYGZhy{}8\PYGZdq{} standalone=\PYGZdq{}no\PYGZdq{}?\PYGZgt{}\PYGZbs{}n\PYGZlt{}!DOCTYPE svg ‚Ä¶
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxAtStartPar
To access the values of ‚ÄòPAKNYGDPMKTPKN‚Äô and ‚ÄòPAKNECONPRVTKN‚Äô from the base dataframe, specify .base

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN PAKNECONPRVTKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{base}\PYG{o}{.}\PYG{n}{df} 
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
      PAKNYGDPMKTPKN  PAKNECONPRVTKN
2020    2.670160e+07    2.332304e+07
2021    2.720258e+07    2.383172e+07
2022    2.780126e+07    2.439406e+07
2023    2.849982e+07    2.501286e+07
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{.df  Pandas dataframe}
\label{\detokenize{content/Python/modelflow_features:df-pandas-dataframe}}
\sphinxAtStartPar
Sometime you need to perform additional operations on the values. Therefor the .df will return a dataframe with the selected variables.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN PAKNECONPRVTKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{df}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
      PAKNYGDPMKTPKN  PAKNECONPRVTKN
2020    2.648318e+07    2.268967e+07
2021    2.723559e+07    2.331771e+07
2022    2.796332e+07    2.394832e+07
2023    2.869072e+07    2.455519e+07
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{.show  as a html table with tooltips}
\label{\detokenize{content/Python/modelflow_features:show-as-a-html-table-with-tooltips}}
\sphinxAtStartPar
If you want the variable descriptions use this

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN PAKNECONPRVTKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{show}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Tab(children=(Tab(children=(HTML(value=\PYGZsq{}\PYGZlt{}?xml version=\PYGZdq{}1.0\PYGZdq{} encoding=\PYGZdq{}utf\PYGZhy{}8\PYGZdq{} standalone=\PYGZdq{}no\PYGZdq{}?\PYGZgt{}\PYGZbs{}n\PYGZlt{}!DOCTYPE svg ‚Ä¶
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{.names Variable names}
\label{\detokenize{content/Python/modelflow_features:names-variable-names}}
\sphinxAtStartPar
If you select variables using wildcards, then you can access the names that correspond to your query.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDP??????}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{names}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
[\PYGZsq{}PAKNYGDPDISCCN\PYGZsq{},
 \PYGZsq{}PAKNYGDPDISCKN\PYGZsq{},
 \PYGZsq{}PAKNYGDPFCSTCN\PYGZsq{},
 \PYGZsq{}PAKNYGDPFCSTKN\PYGZsq{},
 \PYGZsq{}PAKNYGDPFCSTXN\PYGZsq{},
 \PYGZsq{}PAKNYGDPMKTPCD\PYGZsq{},
 \PYGZsq{}PAKNYGDPMKTPCN\PYGZsq{},
 \PYGZsq{}PAKNYGDPMKTPKD\PYGZsq{},
 \PYGZsq{}PAKNYGDPMKTPKN\PYGZsq{},
 \PYGZsq{}PAKNYGDPMKTPXN\PYGZsq{},
 \PYGZsq{}PAKNYGDPPOTLKN\PYGZsq{}]
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{.frml The formulas}
\label{\detokenize{content/Python/modelflow_features:frml-the-formulas}}
\sphinxAtStartPar
Use .frml to access all the equations for the endogenous variables.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN PAKNECONPRVTKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{frml}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
PAKNYGDPMKTPKN : FRML \PYGZlt{}\PYGZgt{} PAKNYGDPMKTPKN = PAKNECONPRVTKN+PAKNECONGOVTKN+PAKNEGDIFTOTKN+PAKNEGDISTKBKN+PAKNEEXPGNFSKN\PYGZhy{}PAKNEIMPGNFSKN+PAKNYGDPDISCKN+PAKADAP*PAKDISPREPKN \PYGZdl{}
PAKNECONPRVTKN : FRML \PYGZlt{}Z,EXO\PYGZgt{} PAKNECONPRVTKN = (PAKNECONPRVTKN(\PYGZhy{}1)*EXP(\PYGZhy{}PAKNECONPRVTKN\PYGZus{}A+ (\PYGZhy{}0.2*(LOG(PAKNECONPRVTKN(\PYGZhy{}1))\PYGZhy{}LOG((PAKNYYWBTOTLCN(\PYGZhy{}1)*(1\PYGZhy{}PAKGGREVDRCTXN(\PYGZhy{}1)/100))/PAKNECONPRVTXN(\PYGZhy{}1)))+1*((LOG((PAKNYYWBTOTLCN*(1\PYGZhy{}PAKGGREVDRCTXN/100))/PAKNECONPRVTXN))\PYGZhy{}(LOG((PAKNYYWBTOTLCN(\PYGZhy{}1)*(1\PYGZhy{}PAKGGREVDRCTXN(\PYGZhy{}1)/100))/PAKNECONPRVTXN(\PYGZhy{}1))))+0.0303228629698929+0.0163839011059956*DURING\PYGZus{}2010\PYGZhy{}0.3*(PAKFMLBLPOLYXN/100\PYGZhy{}((LOG(PAKNECONPRVTXN))\PYGZhy{}(LOG(PAKNECONPRVTXN(\PYGZhy{}1)))))) )) * (1\PYGZhy{}PAKNECONPRVTKN\PYGZus{}D)+ PAKNECONPRVTKN\PYGZus{}X*PAKNECONPRVTKN\PYGZus{}D \PYGZdl{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{.rename() Rename variables to descriptions}
\label{\detokenize{content/Python/modelflow_features:rename-rename-variables-to-descriptions}}
\sphinxAtStartPar
Use .rename() to assign variable descriptions as variable names.

\sphinxAtStartPar
Handy when plotting!

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN PAKNECONPRVTKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{rename}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{df}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
      GDP Expenditure side at market prices  Household Consumption
2020                           2.648318e+07           2.268967e+07
2021                           2.723559e+07           2.331771e+07
2022                           2.796332e+07           2.394832e+07
2023                           2.869072e+07           2.455519e+07
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Transformations of solution results}
\label{\detokenize{content/Python/modelflow_features:transformations-of-solution-results}}
\sphinxAtStartPar
When the variables has been selected through the index operator a number of standard data transformations can be performed.


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Transfomation
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Meaning
&\sphinxstyletheadfamily 
\sphinxAtStartPar
expression
\\
\hline
\sphinxAtStartPar
pct
&
\sphinxAtStartPar
Growth rates
&
\sphinxAtStartPar
\(\left(\cfrac{this_t}{this_{t-1}}-1\right )\)
\\
\hline
\sphinxAtStartPar
dif
&
\sphinxAtStartPar
Difference in level
&
\sphinxAtStartPar
\(l-b\)
\\
\hline
\sphinxAtStartPar
difpct
&
\sphinxAtStartPar
Differens in growth rate
&
\sphinxAtStartPar
\(\left( \cfrac{l_t}{l_{t-1}}-1 \right) - \left(\cfrac{b_t}{b_{t-1}}-1 \right)\)
\\
\hline
\sphinxAtStartPar
difpctlevel
&
\sphinxAtStartPar
differens in level in pct of baseline
&
\sphinxAtStartPar
\(\left( \cfrac{l_t-b_t}{b_{t}} \right) \)
\\
\hline
\sphinxAtStartPar
mul100
&
\sphinxAtStartPar
multiply by 100
&
\sphinxAtStartPar
\(this_t \times 100\)
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\(this\) is the chained value. Default lastdf but if preseeded by .base the values from .basedf will be used

\item {} 
\sphinxAtStartPar
\(b\) is the values from .basedf

\item {} 
\sphinxAtStartPar
\(l\) is the values from .lastdf

\end{itemize}


\subsection{.dif Difference in level}
\label{\detokenize{content/Python/modelflow_features:dif-difference-in-level}}
\sphinxAtStartPar
The ‚Äòdif‚Äô command displays the difference in levels of the latest and previous solutions.

\sphinxAtStartPar
\(l-b\)

\sphinxAtStartPar
where l is the variable from the .lastdf and b is the variable from .basedf.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN PAKNECONPRVTKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{dif}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{modelflow_features_62_0}.png}

\noindent\sphinxincludegraphics{{modelflow_features_62_1}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{.pct  Growthrates}
\label{\detokenize{content/Python/modelflow_features:pct-growthrates}}
\sphinxAtStartPar
Display growth rates

\sphinxAtStartPar
\(\left(\cfrac{l_t}{l_{t-1}}-1\right )\)

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN PAKNECONPRVTKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{pct}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{modelflow_features_64_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{.difpct property difference in growthrate}
\label{\detokenize{content/Python/modelflow_features:difpct-property-difference-in-growthrate}}
\sphinxAtStartPar
The difference in the growth rates  between the last and base dataframe.

\sphinxAtStartPar
\(\left( \cfrac{l_t}{l_{t-1}}-1 \right) - \left(\cfrac{b_t}{b_{t-1}}-1 \right)\)

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN PAKNECONPRVTKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{difpct}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{p}{)} \PYG{p}{;} 
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{modelflow_features_66_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{.difpctlevel percent difference of  levels}
\label{\detokenize{content/Python/modelflow_features:difpctlevel-percent-difference-of-levels}}
\sphinxAtStartPar
\(\left( \cfrac{l_t-b_t}{b_{t}} \right) \)

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN PAKNECONPRVTKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{difpctlevel}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}  
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{modelflow_features_68_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{mul100 multiply by 100}
\label{\detokenize{content/Python/modelflow_features:mul100-multiply-by-100}}
\sphinxAtStartPar
multiply growth rate by 100.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN PAKNECONPRVTKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{pct}\PYG{o}{.}\PYG{n}{mul100}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{p}{)} 
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{modelflow_features_70_0}.png}

\noindent\sphinxincludegraphics{{modelflow_features_70_1}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{.plot chart the selected and transformed variables}
\label{\detokenize{content/Python/modelflow_features:plot-chart-the-selected-and-transformed-variables}}
\sphinxAtStartPar
After the varaibles has been selected and transformed, they can  be plotted. The .plot() method plots the selected variables separately

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{smpl}\PYG{p}{(}\PYG{l+m+mi}{2020}\PYG{p}{,}\PYG{l+m+mi}{2100}\PYG{p}{)}\PYG{p}{;}

\PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDP??????}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{rename}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{modelflow_features_72_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Options to plot()}
\label{\detokenize{content/Python/modelflow_features:options-to-plot}}
\sphinxAtStartPar
Common:
\begin{itemize}
\item {} 
\sphinxAtStartPar
title (optional): title. Defaults to ‚Äò‚Äô.

\item {} 
\sphinxAtStartPar
colrow (TYPE, optional): Columns per row . Defaults to 2.

\item {} 
\sphinxAtStartPar
sharey (TYPE, optional): Share y axis between plots. Defaults to False.

\item {} 
\sphinxAtStartPar
top (TYPE, optional): Relative position of the title. Defaults to 0.90.

\end{itemize}

\sphinxAtStartPar
More excotic:
\begin{itemize}
\item {} 
\sphinxAtStartPar
splitchar (TYPE, optional): If the name should be split . Defaults to ‚Äò\_\_‚Äô.

\item {} 
\sphinxAtStartPar
savefig (TYPE, optional): Save figure. Defaults to ‚Äò‚Äô.

\item {} 
\sphinxAtStartPar
xsize  (TYPE, optional): x size default to 10

\item {} 
\sphinxAtStartPar
ysize  (TYPE, optional): y size per row, defaults to 2

\item {} 
\sphinxAtStartPar
ppos (optional): \# of position to use if split. Defaults to \sphinxhyphen{}1.

\item {} 
\sphinxAtStartPar
kind (TYPE, optional): Matplotlib kind . Defaults to ‚Äòline‚Äô.

\end{itemize}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDP??????}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{difpct}\PYG{o}{.}\PYG{n}{mul100}\PYG{o}{.}\PYG{n}{rename}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{title}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{GDP growth }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{top} \PYG{o}{=} \PYG{l+m+mf}{0.92}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{modelflow_features_74_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Plotting inspiration}
\label{\detokenize{content/Python/modelflow_features:plotting-inspiration}}
\sphinxAtStartPar
The following graph shows the components of GDP using the values of the baseline dataframe.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN PAKNECONPRVTKN PAKNEGDIFTOTKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYGZbs{}
\PYG{n}{difpctlevel}\PYG{o}{.}\PYG{n}{mul100}\PYG{o}{.}\PYG{n}{rename}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYGZbs{}
\PYG{n}{plot}\PYG{p}{(}\PYG{n}{title}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Components of GDP in pct of baseline}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{colrow}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{top}\PYG{o}{=}\PYG{l+m+mf}{0.90}\PYG{p}{,}\PYG{n}{kind}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bar}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{modelflow_features_77_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Heatmaps}
\label{\detokenize{content/Python/modelflow_features:heatmaps}}
\sphinxAtStartPar
For some model types heatmaps can be helpful, and they come out of the box. This feature was developed for use by bank stress test models.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{with} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{set\PYGZus{}smpl}\PYG{p}{(}\PYG{l+m+mi}{2020}\PYG{p}{,}\PYG{l+m+mi}{2030}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{heatmap} \PYG{o}{=} \PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN PAKNECONPRVTKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{pct}\PYG{o}{.}\PYG{n}{rename}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{mul100}\PYG{o}{.}\PYG{n}{heat}\PYG{p}{(}\PYG{n}{title}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Growth rates}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{annot}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,}\PYG{n}{dec}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{10}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}  
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{modelflow_features_79_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxAtStartPar



\subsection{Violin and boxplots,}
\label{\detokenize{content/Python/modelflow_features:violin-and-boxplots}}
\sphinxAtStartPar
Not obvious for macro models, but useful for stress test  models with many banks.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{with} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{set\PYGZus{}smpl}\PYG{p}{(}\PYG{l+m+mi}{2020}\PYG{p}{,}\PYG{l+m+mi}{2030}\PYG{p}{)}\PYG{p}{:} 
    \PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN PAKNECONPRVTKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{difpct}\PYG{o}{.}\PYG{n}{box}\PYG{p}{(}\PYG{p}{)}  
    \PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN PAKNECONPRVTKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{difpct}\PYG{o}{.}\PYG{n}{violin}\PYG{p}{(}\PYG{p}{)}  
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{modelflow_features_81_0}.png}

\noindent\sphinxincludegraphics{{modelflow_features_81_1}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Plot baseline vs alternative}
\label{\detokenize{content/Python/modelflow_features:plot-baseline-vs-alternative}}
\sphinxAtStartPar
A raw routine, only showing levels.
To make it really useful it should be expanded.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN PAKNECONPRVTKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{plot\PYGZus{}alt}\PYG{p}{(}\PYG{p}{)} \PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{modelflow_features_83_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{.draw() Graphical presentation of relationships between variables}
\label{\detokenize{content/Python/modelflow_features:draw-graphical-presentation-of-relationships-between-variables}}
\sphinxAtStartPar
.draw() helps you understand the relationship between variables in your model better.

\sphinxAtStartPar
The thickness the arrow reflect the attribution of the the upstream variable to the impact on the downstream variable.


\subsection{.draw(up = level, down = level)}
\label{\detokenize{content/Python/modelflow_features:draw-up-level-down-level}}
\sphinxAtStartPar
You can specify how many levels up and down you want in your graphical presentation (Needs more explanation).

\sphinxAtStartPar
In this example all variables that depend directly upon GDP and consumption as well as those that are determined by them, are displayed. This means one step upstream in the model logic and one step downstream.

\sphinxAtStartPar
More on the how to visualize the logic structure {\hyperref[\detokenize{content/howto/structure/Logical_structure::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{here}}}}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN PAKNECONPRVTKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{draw}\PYG{p}{(}\PYG{n}{up}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{down}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}  \PYG{c+c1}{\PYGZsh{} diagram of all direct dependencies }
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}IPython.core.display.SVG object\PYGZgt{}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}IPython.core.display.SVG object\PYGZgt{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{.draw(filter =<minimal impact>)}
\label{\detokenize{content/Python/modelflow_features:draw-filter-minimal-impact}}
\sphinxAtStartPar
By specifying filter=  only links where the minimal impact is more than <minimal impact> are show. In this case 20\%

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNECONPRVTKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{draw}\PYG{p}{(}\PYG{n}{up}\PYG{o}{=}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{n}{down}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n+nb}{filter}\PYG{o}{=}\PYG{l+m+mi}{20}\PYG{p}{)}  
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}IPython.core.display.SVG object\PYGZgt{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{dekomp() Attrribution of right hand side variables to change in result.}
\label{\detokenize{content/Python/modelflow_features:dekomp-attrribution-of-right-hand-side-variables-to-change-in-result}}
\sphinxAtStartPar
For more information on attribution look {\hyperref[\detokenize{content/howto/attribution/Attribution background::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{here}}}}

\sphinxAtStartPar
The dekomp command decomposes the contributions of the right hand side variables to the observed change in the left hand side variables.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{with} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{set\PYGZus{}smpl}\PYG{p}{(}\PYG{l+m+mi}{2021}\PYG{p}{,}\PYG{l+m+mi}{2025}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN PAKNECONPRVTKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{dekomp}\PYG{p}{(}\PYG{p}{)}  \PYG{c+c1}{\PYGZsh{} frml attribution }
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Formula        : FRML  \PYGZlt{}\PYGZgt{} PAKNYGDPMKTPKN = PAKNECONPRVTKN+PAKNECONGOVTKN+PAKNEGDIFTOTKN+PAKNEGDISTKBKN+PAKNEEXPGNFSKN\PYGZhy{}PAKNEIMPGNFSKN+PAKNYGDPDISCKN+PAKADAP*PAKDISPREPKN \PYGZdl{} 

                       2021        2022        2023        2024        2025
Variable    lag                                                            
Base        0   27202580.71 27801259.41 28499818.71 29256735.74 30047560.47
Alternative 0   27235594.33 27963320.85 28690715.67 29445700.39 30238498.05
Difference  0      33013.62   162061.44   190896.96   188964.65   190937.58
Percent     0          0.12        0.58        0.67        0.65        0.64

 Contributions to differende for  PAKNYGDPMKTPKN
                         2021       2022       2023       2024       2025
Variable       lag                                                       
PAKNECONPRVTKN 0   \PYGZhy{}514010.77 \PYGZhy{}445732.98 \PYGZhy{}457677.02 \PYGZhy{}485936.67 \PYGZhy{}495257.60
PAKNECONGOVTKN 0    275618.47  268128.64  252327.22  239826.74  231709.68
PAKNEGDIFTOTKN 0    120796.11  143323.04  155599.32  163987.30  171158.99
PAKNEGDISTKBKN 0        \PYGZhy{}0.07      \PYGZhy{}0.07       0.03       0.15      \PYGZhy{}0.28
PAKNEEXPGNFSKN 0       104.35     \PYGZhy{}30.01    \PYGZhy{}668.46   \PYGZhy{}1711.58   \PYGZhy{}3035.79
PAKNEIMPGNFSKN 0    150505.20  196372.49  241316.02  272799.56  286361.28
PAKNYGDPDISCKN 0        \PYGZhy{}0.07      \PYGZhy{}0.07       0.03       0.15      \PYGZhy{}0.28
PAKADAP        0        \PYGZhy{}0.07      \PYGZhy{}0.07       0.03       0.15      \PYGZhy{}0.28
PAKDISPREPKN   0        \PYGZhy{}0.07      \PYGZhy{}0.07       0.03       0.15      \PYGZhy{}0.28

 Share of contributions to differende for  PAKNYGDPMKTPKN
                          2021        2022        2023        2024        2025
Variable       lag                                                            
PAKNEIMPGNFSKN 0          456\PYGZpc{}        121\PYGZpc{}        126\PYGZpc{}        144\PYGZpc{}        150\PYGZpc{}
PAKNECONGOVTKN 0          835\PYGZpc{}        165\PYGZpc{}        132\PYGZpc{}        127\PYGZpc{}        121\PYGZpc{}
PAKNEGDIFTOTKN 0          366\PYGZpc{}         88\PYGZpc{}         82\PYGZpc{}         87\PYGZpc{}         90\PYGZpc{}
PAKNEGDISTKBKN 0           \PYGZhy{}0\PYGZpc{}         \PYGZhy{}0\PYGZpc{}          0\PYGZpc{}          0\PYGZpc{}         \PYGZhy{}0\PYGZpc{}
PAKNYGDPDISCKN 0           \PYGZhy{}0\PYGZpc{}         \PYGZhy{}0\PYGZpc{}          0\PYGZpc{}          0\PYGZpc{}         \PYGZhy{}0\PYGZpc{}
PAKADAP        0           \PYGZhy{}0\PYGZpc{}         \PYGZhy{}0\PYGZpc{}          0\PYGZpc{}          0\PYGZpc{}         \PYGZhy{}0\PYGZpc{}
PAKDISPREPKN   0           \PYGZhy{}0\PYGZpc{}         \PYGZhy{}0\PYGZpc{}          0\PYGZpc{}          0\PYGZpc{}         \PYGZhy{}0\PYGZpc{}
PAKNEEXPGNFSKN 0            0\PYGZpc{}         \PYGZhy{}0\PYGZpc{}         \PYGZhy{}0\PYGZpc{}         \PYGZhy{}1\PYGZpc{}         \PYGZhy{}2\PYGZpc{}
PAKNECONPRVTKN 0        \PYGZhy{}1557\PYGZpc{}       \PYGZhy{}275\PYGZpc{}       \PYGZhy{}240\PYGZpc{}       \PYGZhy{}257\PYGZpc{}       \PYGZhy{}259\PYGZpc{}
Total          0          100\PYGZpc{}        100\PYGZpc{}        100\PYGZpc{}        100\PYGZpc{}        100\PYGZpc{}
Residual       0           \PYGZhy{}0\PYGZpc{}         \PYGZhy{}0\PYGZpc{}          0\PYGZpc{}          0\PYGZpc{}         \PYGZhy{}0\PYGZpc{}

 Contribution to growth rate PAKNYGDPMKTPKN
                          2021        2022        2023        2024        2025
Variable       lag                                                            
PAKNECONPRVTKN 0         \PYGZhy{}0.0\PYGZpc{}       \PYGZhy{}0.0\PYGZpc{}       \PYGZhy{}0.0\PYGZpc{}       \PYGZhy{}0.0\PYGZpc{}       \PYGZhy{}0.0\PYGZpc{}
PAKNECONGOVTKN 0          0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}
PAKNEGDIFTOTKN 0          0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}
PAKNEGDISTKBKN 0         \PYGZhy{}0.0\PYGZpc{}       \PYGZhy{}0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}       \PYGZhy{}0.0\PYGZpc{}
PAKNEEXPGNFSKN 0          0.0\PYGZpc{}       \PYGZhy{}0.0\PYGZpc{}       \PYGZhy{}0.0\PYGZpc{}       \PYGZhy{}0.0\PYGZpc{}       \PYGZhy{}0.0\PYGZpc{}
PAKNEIMPGNFSKN 0          0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}
PAKNYGDPDISCKN 0         \PYGZhy{}0.0\PYGZpc{}       \PYGZhy{}0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}       \PYGZhy{}0.0\PYGZpc{}
PAKADAP        0         \PYGZhy{}0.0\PYGZpc{}       \PYGZhy{}0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}       \PYGZhy{}0.0\PYGZpc{}
PAKDISPREPKN   0         \PYGZhy{}0.0\PYGZpc{}       \PYGZhy{}0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}       \PYGZhy{}0.0\PYGZpc{}

Formula        : FRML \PYGZlt{}Z,EXO\PYGZgt{} PAKNECONPRVTKN = (PAKNECONPRVTKN(\PYGZhy{}1)*EXP(\PYGZhy{}PAKNECONPRVTKN\PYGZus{}A+ (\PYGZhy{}0.2*(LOG(PAKNECONPRVTKN(\PYGZhy{}1))\PYGZhy{}LOG((PAKNYYWBTOTLCN(\PYGZhy{}1)*(1\PYGZhy{}PAKGGREVDRCTXN(\PYGZhy{}1)/100))/PAKNECONPRVTXN(\PYGZhy{}1)))+1*((LOG((PAKNYYWBTOTLCN*(1\PYGZhy{}PAKGGREVDRCTXN/100))/PAKNECONPRVTXN))\PYGZhy{}(LOG((PAKNYYWBTOTLCN(\PYGZhy{}1)*(1\PYGZhy{}PAKGGREVDRCTXN(\PYGZhy{}1)/100))/PAKNECONPRVTXN(\PYGZhy{}1))))+0.0303228629698929+0.0163839011059956*DURING\PYGZus{}2010\PYGZhy{}0.3*(PAKFMLBLPOLYXN/100\PYGZhy{}((LOG(PAKNECONPRVTXN))\PYGZhy{}(LOG(PAKNECONPRVTXN(\PYGZhy{}1)))))) )) * (1\PYGZhy{}PAKNECONPRVTKN\PYGZus{}D)+ PAKNECONPRVTKN\PYGZus{}X*PAKNECONPRVTKN\PYGZus{}D  \PYGZdl{} 

                       2021        2022        2023        2024        2025
Variable    lag                                                            
Base        0   23831715.84 24394056.97 25012863.13 25644576.44 26265982.97
Alternative 0   23317705.14 23948324.06 24555186.08 25158639.61 25770725.66
Difference  0    \PYGZhy{}514010.70  \PYGZhy{}445732.91  \PYGZhy{}457677.05  \PYGZhy{}485936.83  \PYGZhy{}495257.31
Percent     0         \PYGZhy{}2.16       \PYGZhy{}1.83       \PYGZhy{}1.83       \PYGZhy{}1.89       \PYGZhy{}1.89

 Contributions to differende for  PAKNECONPRVTKN
                           2021       2022       2023       2024       2025
Variable         lag                                                       
PAKNECONPRVTKN   \PYGZhy{}1  \PYGZhy{}519278.88 \PYGZhy{}421406.68 \PYGZhy{}364946.91 \PYGZhy{}374445.66 \PYGZhy{}397444.12
PAKNECONPRVTKN\PYGZus{}A  0        0.00       0.00       0.00       0.00       0.00
PAKNYYWBTOTLCN   \PYGZhy{}1   144221.00   27963.43  \PYGZhy{}67399.51 \PYGZhy{}105242.43 \PYGZhy{}127427.51
PAKGGREVDRCTXN   \PYGZhy{}1        0.00       0.00       0.00       0.00       0.00
PAKNECONPRVTXN   \PYGZhy{}1   313813.15  295937.70  302656.21  319638.36  337039.02
PAKNYYWBTOTLCN    0   \PYGZhy{}34078.61   81914.26  127796.10  154640.78  194233.39
PAKGGREVDRCTXN    0        0.00       0.00       0.00       0.00       0.00
PAKNECONPRVTXN    0  \PYGZhy{}409469.82 \PYGZhy{}419445.57 \PYGZhy{}443516.18 \PYGZhy{}467985.65 \PYGZhy{}489904.40
DURING\PYGZus{}2010       0        0.00       0.00       0.00       0.00       0.00
PAKFMLBLPOLYXN    0   \PYGZhy{}15494.12  \PYGZhy{}15900.08  \PYGZhy{}17009.59  \PYGZhy{}17718.21  \PYGZhy{}17966.21
PAKNECONPRVTKN\PYGZus{}D  0        0.00       0.00       0.00       0.00       0.00
PAKNECONPRVTKN\PYGZus{}X  0        0.00       0.00       0.00       0.00       0.00

 Share of contributions to differende for  PAKNECONPRVTKN
                            2021        2022        2023        2024        2025
Variable         lag                                                            
PAKNECONPRVTXN    0          80\PYGZpc{}         94\PYGZpc{}         97\PYGZpc{}         96\PYGZpc{}         99\PYGZpc{}
PAKNECONPRVTKN   \PYGZhy{}1         101\PYGZpc{}         95\PYGZpc{}         80\PYGZpc{}         77\PYGZpc{}         80\PYGZpc{}
PAKNYYWBTOTLCN   \PYGZhy{}1         \PYGZhy{}28\PYGZpc{}         \PYGZhy{}6\PYGZpc{}         15\PYGZpc{}         22\PYGZpc{}         26\PYGZpc{}
PAKFMLBLPOLYXN    0           3\PYGZpc{}          4\PYGZpc{}          4\PYGZpc{}          4\PYGZpc{}          4\PYGZpc{}
PAKNECONPRVTKN\PYGZus{}A  0          \PYGZhy{}0\PYGZpc{}         \PYGZhy{}0\PYGZpc{}         \PYGZhy{}0\PYGZpc{}         \PYGZhy{}0\PYGZpc{}         \PYGZhy{}0\PYGZpc{}
PAKGGREVDRCTXN   \PYGZhy{}1          \PYGZhy{}0\PYGZpc{}         \PYGZhy{}0\PYGZpc{}         \PYGZhy{}0\PYGZpc{}         \PYGZhy{}0\PYGZpc{}         \PYGZhy{}0\PYGZpc{}
                  0          \PYGZhy{}0\PYGZpc{}         \PYGZhy{}0\PYGZpc{}         \PYGZhy{}0\PYGZpc{}         \PYGZhy{}0\PYGZpc{}         \PYGZhy{}0\PYGZpc{}
DURING\PYGZus{}2010       0          \PYGZhy{}0\PYGZpc{}         \PYGZhy{}0\PYGZpc{}         \PYGZhy{}0\PYGZpc{}         \PYGZhy{}0\PYGZpc{}         \PYGZhy{}0\PYGZpc{}
PAKNECONPRVTKN\PYGZus{}D  0          \PYGZhy{}0\PYGZpc{}         \PYGZhy{}0\PYGZpc{}         \PYGZhy{}0\PYGZpc{}         \PYGZhy{}0\PYGZpc{}         \PYGZhy{}0\PYGZpc{}
PAKNECONPRVTKN\PYGZus{}X  0          \PYGZhy{}0\PYGZpc{}         \PYGZhy{}0\PYGZpc{}         \PYGZhy{}0\PYGZpc{}         \PYGZhy{}0\PYGZpc{}         \PYGZhy{}0\PYGZpc{}
PAKNYYWBTOTLCN    0           7\PYGZpc{}        \PYGZhy{}18\PYGZpc{}        \PYGZhy{}28\PYGZpc{}        \PYGZhy{}32\PYGZpc{}        \PYGZhy{}39\PYGZpc{}
PAKNECONPRVTXN   \PYGZhy{}1         \PYGZhy{}61\PYGZpc{}        \PYGZhy{}66\PYGZpc{}        \PYGZhy{}66\PYGZpc{}        \PYGZhy{}66\PYGZpc{}        \PYGZhy{}68\PYGZpc{}
Total             0         101\PYGZpc{}        101\PYGZpc{}        101\PYGZpc{}        101\PYGZpc{}        101\PYGZpc{}
Residual          0           1\PYGZpc{}          1\PYGZpc{}          1\PYGZpc{}          1\PYGZpc{}          1\PYGZpc{}

 Contribution to growth rate PAKNECONPRVTKN
                            2021        2022        2023        2024        2025
Variable         lag                                                            
PAKNECONPRVTKN   \PYGZhy{}1         0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}
PAKNECONPRVTKN\PYGZus{}A  0         0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}
PAKNYYWBTOTLCN   \PYGZhy{}1         0.0\PYGZpc{}        0.0\PYGZpc{}       \PYGZhy{}0.0\PYGZpc{}       \PYGZhy{}0.0\PYGZpc{}       \PYGZhy{}0.0\PYGZpc{}
PAKGGREVDRCTXN   \PYGZhy{}1         0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}
PAKNECONPRVTXN   \PYGZhy{}1         0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}
PAKNYYWBTOTLCN    0        \PYGZhy{}0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}
PAKGGREVDRCTXN    0         0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}
PAKNECONPRVTXN    0        \PYGZhy{}0.0\PYGZpc{}       \PYGZhy{}0.0\PYGZpc{}       \PYGZhy{}0.0\PYGZpc{}       \PYGZhy{}0.0\PYGZpc{}       \PYGZhy{}0.0\PYGZpc{}
DURING\PYGZus{}2010       0         0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}
PAKFMLBLPOLYXN    0        \PYGZhy{}0.0\PYGZpc{}       \PYGZhy{}0.0\PYGZpc{}       \PYGZhy{}0.0\PYGZpc{}       \PYGZhy{}0.0\PYGZpc{}       \PYGZhy{}0.0\PYGZpc{}
PAKNECONPRVTKN\PYGZus{}D  0         0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}
PAKNECONPRVTKN\PYGZus{}X  0         0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Bespoken plots using matplotlib  (or plotly \sphinxhyphen{}later) (should go to a separate plot book}
\label{\detokenize{content/Python/modelflow_features:bespoken-plots-using-matplotlib-or-plotly-later-should-go-to-a-separate-plot-book}}
\sphinxAtStartPar
The predefined plots are not necessary created for presentation purpose. To create  bespoken plots the they can be
constructed directly in python scripts. The two main libraries are matplotlib, plotly but any ther python plotting library can be used. Here is an example using matplotlib.


\section{Plot four separate plots of multiple series in grid}
\label{\detokenize{content/Python/modelflow_features:plot-four-separate-plots-of-multiple-series-in-grid}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{figure}\PYG{p}{,}\PYG{n}{axs}\PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{11}\PYG{p}{,} \PYG{l+m+mi}{7}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{axs}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{basedf}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{l+m+mi}{2020}\PYG{p}{:}\PYG{l+m+mi}{2099}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKGGBALOVRLCN\PYGZus{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}\PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Baseline}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{axs}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{lastdf}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{l+m+mi}{2020}\PYG{p}{:}\PYG{l+m+mi}{2099}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKGGBALOVRLCN\PYGZus{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}\PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Scenario}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}axs[0,0].legend()}

\PYG{n}{axs}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{basedf}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{l+m+mi}{2020}\PYG{p}{:}\PYG{l+m+mi}{2099}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKGGDBTTOTLCN\PYGZus{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}\PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Baseline}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{axs}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{lastdf}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{l+m+mi}{2020}\PYG{p}{:}\PYG{l+m+mi}{2099}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKGGDBTTOTLCN\PYGZus{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}\PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Scenario}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{n}{axs}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{basedf}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{l+m+mi}{2020}\PYG{p}{:}\PYG{l+m+mi}{2099}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKGGREVTOTLCN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{/}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{basedf}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{l+m+mi}{2020}\PYG{p}{:}\PYG{l+m+mi}{2099}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPCN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{*}\PYG{l+m+mi}{100}\PYG{p}{,}\PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Baseline}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{axs}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{lastdf}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{l+m+mi}{2020}\PYG{p}{:}\PYG{l+m+mi}{2099}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKGGREVTOTLCN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{/}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{lastdf}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{l+m+mi}{2020}\PYG{p}{:}\PYG{l+m+mi}{2099}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPCN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{*}\PYG{l+m+mi}{100}\PYG{p}{,}\PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Scenario}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{n}{axs}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{basedf}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{l+m+mi}{2020}\PYG{p}{:}\PYG{l+m+mi}{2099}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKGGREVGRNTCN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{/}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{basedf}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{l+m+mi}{2020}\PYG{p}{:}\PYG{l+m+mi}{2099}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPCN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{*}\PYG{l+m+mi}{100}\PYG{p}{,}\PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Baseline}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{axs}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{lastdf}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{l+m+mi}{2020}\PYG{p}{:}\PYG{l+m+mi}{2099}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKGGREVGRNTCN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{/}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{lastdf}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{l+m+mi}{2020}\PYG{p}{:}\PYG{l+m+mi}{2099}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPCN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{*}\PYG{l+m+mi}{100}\PYG{p}{,}\PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Scenario}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}axs2[4].plot(mpak.lastdf.loc[2000:2099,\PYGZsq{}PAKGGREVGRNTCN\PYGZsq{}]/mpak.basedf.loc[2000:2099,\PYGZsq{}PAKNYGDPMKTPCN\PYGZsq{}]*100,label=\PYGZsq{}Scenario\PYGZsq{})}

\PYG{n}{axs}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{title}\PYG{o}{.}\PYG{n}{set\PYGZus{}text}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Fiscal balance (}\PYG{l+s+si}{\PYGZpc{} o}\PYG{l+s+s2}{f GDP)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{axs}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{title}\PYG{o}{.}\PYG{n}{set\PYGZus{}text}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Gov}\PYG{l+s+s2}{\PYGZsq{}}\PYG{l+s+s2}{t Debt (}\PYG{l+s+si}{\PYGZpc{} o}\PYG{l+s+s2}{f GDP)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{axs}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{title}\PYG{o}{.}\PYG{n}{set\PYGZus{}text}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Total revenues (}\PYG{l+s+si}{\PYGZpc{} o}\PYG{l+s+s2}{f GDP)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{axs}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{title}\PYG{o}{.}\PYG{n}{set\PYGZus{}text}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Grant Revenues (}\PYG{l+s+si}{\PYGZpc{} o}\PYG{l+s+s2}{f GDP)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{figure}\PYG{o}{.}\PYG{n}{suptitle}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Fiscal outcomes}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{n}{plt}\PYG{o}{.}\PYG{n}{figlegend}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Baseline}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Scenario}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}\PYG{n}{loc}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lower left}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{ncol}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{)}  
\PYG{n}{figure}\PYG{o}{.}\PYG{n}{tight\PYGZus{}layout}\PYG{p}{(}\PYG{n}{pad}\PYG{o}{=}\PYG{l+m+mf}{2.3}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{}Ensures legend does not overlap dates}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{modelflow_features_93_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxstepscope


\part{Structure}

\sphinxstepscope


\chapter{Logical structure and dependencies.}
\label{\detokenize{content/howto/structure/Logical_structure:logical-structure-and-dependencies}}\label{\detokenize{content/howto/structure/Logical_structure::doc}}
\sphinxAtStartPar
When solving models it is useful to be able to use the causal (logical) structure of the model.

\sphinxAtStartPar
An introduction to causal analysis of models can be found in \hyperlink{cite.content/litterature:id4}{Kogiku}(1968). A more elaborate text is here \hyperlink{cite.content/litterature:id2}{Berndsen}(1995).

\sphinxAtStartPar
By identifying equations which comprise simultaneous block (contain feedback loops) and recursive
blocks the model can be divided into smaller sub\sphinxhyphen{}models. Only simultaneous equations have to be solved iterative. The recursive equations have to be \sphinxhref{https://en.wikipedia.org/wiki/Topological\_sorting}{topological sorted} and then calculated in the sorted order.

\sphinxAtStartPar
In this chapter different ways to look at the logical structure is explored. 
The logical structure can be viewed as a \sphinxhref{https://en.wikipedia.org/wiki/Directed\_graph}{directed graph}.
\begin{itemize}
\item {} 
\sphinxAtStartPar
The Python package \sphinxhref{https://networkx.org/}{networkx} is used to store and analyze graphs.

\item {} 
\sphinxAtStartPar
The program \sphinxhref{https://graphviz.org/}{Graphviz} is used to draw handsome charts based on scripts in the dot language.

\item {} 
\sphinxAtStartPar
The model class writes dot scripts based on the Networkx directed graphs.

\end{itemize}

\sphinxAtStartPar
The model class contains a number of methods and properties which uses the dependency graphs. A subset is exposed in this chapter.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{modelclass} \PYG{k+kn}{import} \PYG{n}{model} 
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Load a pre\sphinxhyphen{}existing model, data and descriptions}
\label{\detokenize{content/howto/structure/Logical_structure:load-a-pre-existing-model-data-and-descriptions}}
\sphinxAtStartPar
The file \sphinxcode{\sphinxupquote{pak.pcim}} contains a dump of model equations, dataframe, simulation options and variable descriptions.
The next cell:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Loads the model and simulates it to establish a baseline.

\item {} 
\sphinxAtStartPar
Creates a dataframe with a tax rate of 29 USD/Ton for carbon emission for 3 energy types.

\item {} 
\sphinxAtStartPar
Simulates the new experiment.

\end{itemize}

\sphinxAtStartPar
You can find more on this experiment {\hyperref[\detokenize{content/howto/experiments/create_experiment::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{here}}}}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{p}{,}\PYG{n}{baseline} \PYG{o}{=} \PYG{n}{model}\PYG{o}{.}\PYG{n}{modelload}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{../../models/pak.pcim}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{alfa}\PYG{o}{=}\PYG{l+m+mf}{0.7}\PYG{p}{,}\PYG{n}{run}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
\PYG{n}{alternative}  \PYG{o}{=}  \PYG{n}{baseline}\PYG{o}{.}\PYG{n}{upd}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZlt{}2020 2100\PYGZgt{} PAKGGREVCO2CER PAKGGREVCO2GER PAKGGREVCO2OER = 29}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{result} \PYG{o}{=} \PYG{n}{mpak}\PYG{p}{(}\PYG{n}{alternative}\PYG{p}{,}\PYG{l+m+mi}{2020}\PYG{p}{,}\PYG{l+m+mi}{2100}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{} simulates the model }
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Trace upstream variables:}
\label{\detokenize{content/howto/structure/Logical_structure:trace-upstream-variables}}
\sphinxAtStartPar
Lets look at The equation for \sphinxstylestrong{GDP}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{PAKNYGDPMKTPKN}\PYG{o}{.}\PYG{n}{frml}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Endogeneous: PAKNYGDPMKTPKN: GDP Expenditure side at market prices
Formular: FRML  \PYGZlt{}\PYGZgt{} PAKNYGDPMKTPKN = PAKNECONPRVTKN+PAKNECONGOVTKN+PAKNEGDIFTOTKN+PAKNEGDISTKBKN+PAKNEEXPGNFSKN\PYGZhy{}PAKNEIMPGNFSKN+PAKNYGDPDISCKN+PAKADAP*PAKDISPREPKN \PYGZdl{}

PAKNYGDPMKTPKN: GDP Expenditure side at market prices
PAKADAP       : Switch on adaptation mode (0 or 1)
PAKDISPREPKN  : Investment in disaster risk preparation, constant prices
PAKNECONGOVTKN: Government Consumption
PAKNECONPRVTKN: Household Consumption
PAKNEEXPGNFSKN: Exports (G\PYGZam{}S)
PAKNEGDIFTOTKN: Total Gross Capital Formation
PAKNEGDISTKBKN: Change in Inventories
PAKNEIMPGNFSKN: Imports (G\PYGZam{}S)
PAKNYGDPDISCKN: Statistical Discrepency (Expenditure Side)
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{The incoming variables can be displayed as a graph}
\label{\detokenize{content/howto/structure/Logical_structure:the-incoming-variables-can-be-displayed-as-a-graph}}
\sphinxAtStartPar
That is, the preceding variables on the right hand side of the equation for GDP is shown as a directed graph. The width of the arrow reflect how much of the impact can be attributed to this variable.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{latex}\PYG{o}{=}\PYG{l+m+mi}{0}
\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{PAKNYGDPMKTPKN}\PYG{o}{.}\PYG{n}{tracepre}\PYG{p}{(}\PYG{n}{png}\PYG{o}{=}\PYG{n}{latex}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}IPython.core.display.SVG object\PYGZgt{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
\sphinxstylestrong{png=latex}

\sphinxAtStartPar
The default behavior when displaying graphs in a \sphinxstyleemphasis{jupyter notebook} is to produce images in .svg format.
These images scale well and the mouseover
feature can be used. That is: On mouseover of a node, the variable and the equation are displayed.
On mouseover on an edge the percent attribution for this variable is displayed

\sphinxAtStartPar
Unfortunately this \sphinxstyleemphasis{jupyter book} (that is not a notebook) can not be build into a latex and PDF  form using images in svg format.

\sphinxAtStartPar
When a  pdf file is created, the latex variable has to be set to True. If this notebook is used as a notebook set latex=0 and use the mouseover feature.
\end{sphinxadmonition}


\subsection{.tracepre(,,,filter=<minimal impact>) Pruning the tree}
\label{\detokenize{content/howto/structure/Logical_structure:tracepre-filter-minimal-impact-pruning-the-tree}}
\sphinxAtStartPar
Not all preceding variables have impact. By using filter=<minimal impact> only  links where the minimal impact is more than <minimal impact> are show.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{PAKNYGDPMKTPKN}\PYG{o}{.}\PYG{n}{tracepre}\PYG{p}{(}\PYG{n+nb}{filter}\PYG{o}{=}\PYG{l+m+mi}{20}\PYG{p}{,}\PYG{n}{png}\PYG{o}{=}\PYG{n}{latex}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}IPython.core.display.SVG object\PYGZgt{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{.tracepre(,,,up=<upstream levels>)}
\label{\detokenize{content/howto/structure/Logical_structure:tracepre-up-upstream-levels}}
\sphinxAtStartPar
Combined with filter we can look behind the dependencies

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{PAKNYGDPMKTPKN}\PYG{o}{.}\PYG{n}{tracepre}\PYG{p}{(}\PYG{n+nb}{filter} \PYG{o}{=} \PYG{l+m+mi}{20}\PYG{p}{,}\PYG{n}{up}\PYG{o}{=}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{n}{png}\PYG{o}{=}\PYG{n}{latex}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}IPython.core.display.SVG object\PYGZgt{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{tracepre(,fokus2=<variable pattern>,growthshow=True) Additional information regarding selected variables}
\label{\detokenize{content/howto/structure/Logical_structure:tracepre-fokus2-variable-pattern-growthshow-true-additional-information-regarding-selected-variables}}
\sphinxAtStartPar
The data for selected nodes can be displayed by mentioning the variable in fokus2=<variable pattern>.
To also show growth rates, growthshow=True can be specified.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{with} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{set\PYGZus{}smpl}\PYG{p}{(}\PYG{l+m+mi}{2020}\PYG{p}{,}\PYG{l+m+mi}{2024}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{PAKNYGDPMKTPKN}\PYG{o}{.}\PYG{n}{tracepre}\PYG{p}{(}\PYG{n+nb}{filter} \PYG{o}{=} \PYG{l+m+mi}{20}\PYG{p}{,}\PYG{n}{fokus2}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNEGDIFTOTKN PAKNYGDPMKTPKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{growthshow}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}IPython.core.display.SVG object\PYGZgt{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{.tracedep match .tracepre for downstream (dependent variables)}
\label{\detokenize{content/howto/structure/Logical_structure:tracedep-match-tracepre-for-downstream-dependent-variables}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{PAKNYGDPMKTPKN}\PYG{o}{.}\PYG{n}{tracedep}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}IPython.core.display.SVG object\PYGZgt{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{.modeldash() The really convenient  way to navigate the dependency graph}
\label{\detokenize{content/howto/structure/Logical_structure:modeldash-the-really-convenient-way-to-navigate-the-dependency-graph}}
\sphinxAtStartPar
This is the way to navigate the dependency graph. You can point and click and much more.

\sphinxAtStartPar
Unfortunately you can not run this facility from this manual. It only works in a live notebook on your local computer.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{try}\PYG{p}{:}
    \PYG{k}{with} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{set\PYGZus{}smpl}\PYG{p}{(}\PYG{l+m+mi}{2022}\PYG{p}{,}\PYG{l+m+mi}{2026}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{modeldash}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{jupyter}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,}\PYG{n}{inline}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}  \PYG{c+c1}{\PYGZsh{} delete \PYGZsh{} if running a live notebook }
\PYG{k}{except} \PYG{n+ne}{Exception} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Can}\PYG{l+s+s2}{\PYGZsq{}}\PYG{l+s+s2}{t show modeldash }\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{e}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
apprun
Dash app running on http://127.0.0.1:5001/
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxAtStartPar
And it will look like this

\sphinxAtStartPar
\sphinxincludegraphics{{dash}.png}


\section{Plot the adjacency matrix for current periode}
\label{\detokenize{content/howto/structure/Logical_structure:plot-the-adjacency-matrix-for-current-periode}}
\sphinxAtStartPar
Another way to display the logical graph is as an \sphinxhref{https://en.wikipedia.org/wiki/Adjacency\_matrix}{adjacency matrix}.

\sphinxAtStartPar
This is the structure of the graph of  endogenous variables.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{plotadjacency}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{20}\PYG{p}{,}\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{,}\PYG{n}{nolag}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Logical_structure_23_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Plot the adjacency matrix including lagged effects}
\label{\detokenize{content/howto/structure/Logical_structure:plot-the-adjacency-matrix-including-lagged-effects}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{plotadjacency}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{20}\PYG{p}{,}\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{,}\PYG{n}{nolag}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Logical_structure_25_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxstepscope


\part{Attribution}

\sphinxstepscope


\chapter{Attribution}
\label{\detokenize{content/howto/attribution/Attribution background:attribution}}\label{\detokenize{content/howto/attribution/Attribution background::doc}}
\sphinxAtStartPar
When inspecting the impact of experiments it is very useful to be able to analyze which input changes drives the impact. Also for a specific simulation it can be useful to analyze which input changes drives the year to year changes.

\sphinxAtStartPar
Modelflow has some tools to automate this process and to visualize the impact. This chapter gives an introduction to the concept ‚Äòattribution‚Äô and demonstrates how Modelflow‚Äôs built\sphinxhyphen{}in functionalities help you explore and understand your results and which variables drive the change.


\section{Setup}
\label{\detokenize{content/howto/attribution/Attribution background:setup}}
\sphinxAtStartPar
This class incorporates most of the methods used to manage a model.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Modules from Modelflow }
\PYG{k+kn}{from} \PYG{n+nn}{modelclass} \PYG{k+kn}{import} \PYG{n}{model} 

\PYG{c+c1}{\PYGZsh{} optional functionalities }
\PYG{n}{model}\PYG{o}{.}\PYG{n}{widescreen}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{model}\PYG{o}{.}\PYG{n}{scroll\PYGZus{}off}\PYG{p}{(}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Output compatabiltity with LaTeX }
\PYG{n}{latex}\PYG{o}{=}\PYG{k+kc}{False}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}IPython.core.display.HTML object\PYGZgt{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Load a pre\sphinxhyphen{}existing model, data and descriptions}
\label{\detokenize{content/howto/attribution/Attribution background:load-a-pre-existing-model-data-and-descriptions}}
\sphinxAtStartPar
The file \sphinxcode{\sphinxupquote{pak.pcim}} contains a dump of model equations, dataframe, simulation options and variable descriptions:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Loads model and simulates to establish a baseline.

\item {} 
\sphinxAtStartPar
Creates a dataframe with a tax rate of 29 USD/Ton for carbon emission for 3 sectors.

\item {} 
\sphinxAtStartPar
Simulates the new experiment.

\end{itemize}

\sphinxAtStartPar
You can find more on this experiment {\hyperref[\detokenize{content/howto/experiments/create_experiment::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{here}}}}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{p}{,}\PYG{n}{baseline} \PYG{o}{=} \PYG{n}{model}\PYG{o}{.}\PYG{n}{modelload}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{../../models/pak.pcim}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{alfa}\PYG{o}{=}\PYG{l+m+mf}{0.7}\PYG{p}{,}\PYG{n}{run}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{keep}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Business as Usual}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{alternative}  \PYG{o}{=}  \PYG{n}{baseline}\PYG{o}{.}\PYG{n}{upd}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZlt{}2020 2100\PYGZgt{} PAKGGREVCO2CER PAKGGREVCO2GER PAKGGREVCO2OER = 29}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{result} \PYG{o}{=} \PYG{n}{mpak}\PYG{p}{(}\PYG{n}{alternative}\PYG{p}{,}\PYG{l+m+mi}{2020}\PYG{p}{,}\PYG{l+m+mi}{2100}\PYG{p}{,}\PYG{n}{keep}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Carbon tax nominal 29}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{} simulates the model }
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Attribution}
\label{\detokenize{content/howto/attribution/Attribution background:id1}}\label{\detokenize{content/howto/attribution/Attribution background:id2}}
\sphinxAtStartPar
Experience shows that it is useful to be able to explain the difference between the result from two runs, or between two time periods.
\begin{itemize}
\item {} 
\sphinxAtStartPar
The first level of understanding the difference is to look at selected formulas and find out, how much each input variables accounts for.

\item {} 
\sphinxAtStartPar
The second level of understanding the difference is to look at the attribution of the
exogenous variables to the results of the model.

\end{itemize}

\sphinxAtStartPar
If we have:

\sphinxAtStartPar
\(y = f(a,b)\)

\sphinxAtStartPar
and we have two solutions where the variables differs by \(\Delta y, \Delta a, \Delta b\)

\sphinxAtStartPar
How much of \(\Delta y\) can be explained by \(\Delta a\) and \(\Delta b\) ?

\sphinxAtStartPar
Analytical the attributions \(\Omega a\) and \(\Omega b\) can  be calculated like this:

\sphinxAtStartPar
\(\Delta y = \underbrace{\Delta a \dfrac{\partial {f}}{\partial{a}}(a,b)}_{\Omega a} + 
\underbrace{\Delta b \dfrac{\partial {f}}{\partial{b}}(a,b)}_{\Omega b}+Residual\)

\sphinxAtStartPar
ModelFlow will do a numerical approximation of \(\Omega a\) and \(\Omega b\). This is done by looking at the two runs of the model:
\label{equation:content/howto/attribution/Attribution background:e2cd6733-cc2d-42b5-8074-e007c8f56b88}\begin{eqnarray}  
y_0&=&f(a_{0},b_{0}) \\
y_1&=&f(a_0+\Delta a,b_{0}+ \Delta b)
\end{eqnarray}
\sphinxAtStartPar
So \(\Omega a\) and \(\Omega b\) can be determined:
\label{equation:content/howto/attribution/Attribution background:2bf407b4-1f77-45fd-b1db-60c18b739e0a}\begin{eqnarray}  
\Omega f_a&=&f(a_1,b_1 )-f(a_1-\Delta a,b_1) \\
\Omega f_b&=&f(a_1,b_1 )-f(a_1,b_1-\Delta  b)
\end{eqnarray}
\sphinxAtStartPar
And:
\label{equation:content/howto/attribution/Attribution background:3a5117f2-5b80-41e2-88d2-22467244cbbb}\begin{eqnarray}
residual = \Omega f_a + \Omega f_b -(y_1 - y_0) 
\end{eqnarray}
\sphinxAtStartPar
If the model is fairly linear, the residual will be small.


\section{Which function: Model attribution or  single equation attribution?}
\label{\detokenize{content/howto/attribution/Attribution background:which-function-model-attribution-or-single-equation-attribution}}
\sphinxAtStartPar
To recap. Above we just used the term \(f\) for the function. \(f\) can actually be two different types of functions.
\begin{itemize}
\item {} 
\sphinxAtStartPar
The complete modelIn this case the \(\Delta a\),\(\Delta b\) ‚Ä¶ can be different exogenous variables.

\item {} 
\sphinxAtStartPar
A single equation In this case the \(\Delta a\),\(\Delta b\) ‚Ä¶ can be all the current and lagged variables on the right hand side of the = in the equation

\end{itemize}

\sphinxAtStartPar
Examples will be given below.


\section{Which output?}
\label{\detokenize{content/howto/attribution/Attribution background:which-output}}
\sphinxAtStartPar
Let‚Äôs pretend we only have two variables \(a\) and \(b\):
\begin{itemize}
\item {} 
\sphinxAtStartPar
Absolute levels:  \(\Omega a\) and \(\Omega b\) ‚Ä¶

\item {} 
\sphinxAtStartPar
Relative impact in percent:  \(\cfrac{100*\Omega a}{\Delta y}\)  \(\cfrac{100*\Omega b}{\Delta y}\)

\item {} 
\sphinxAtStartPar
Impact on the growth rate of \(y\) from  \(a\) and \(b\)

\end{itemize}


\section{Which input?}
\label{\detokenize{content/howto/attribution/Attribution background:which-input}}
\sphinxAtStartPar
What exactly is \(\Delta a\) and \(\Delta b\)? There are two possibilities:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
The difference between the two scenarios in .basedf and .lastdf

\item {} 
\sphinxAtStartPar
The difference over time: \(\Delta a = a_t - a_{t-1}\) and \(\Delta b = b_t - b_{t-1}\) taken from .lastdf

\end{enumerate}


\section{.totdif() Makes an instance of a  model attribution class}
\label{\detokenize{content/howto/attribution/Attribution background:totdif-makes-an-instance-of-a-model-attribution-class}}
\sphinxAtStartPar
.totdif() returns a class instance of the totdif class. The totdif class contains a number of
methods and properties which can slice and dice attribution at the model level. Without any parameters it
takes all changed exogenous variables and finds the attribution from each of these.

\sphinxAtStartPar
To do this it simulates the model a number of times. So If many exogenous differ this can take some time.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{totdekomp} \PYG{o}{=} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{totdif}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Total dekomp took       :         3.314 Seconds
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{.explain\_all will visualize the results}
\label{\detokenize{content/howto/attribution/Attribution background:explain-all-will-visualize-the-results}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{showvar} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN PAKCCEMISCO2CKN PAKCCEMISCO2OKN PAKCCEMISCO2GKN PAKGGREVTOTLCN}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{totdekomp}\PYG{o}{.}\PYG{n}{explain\PYGZus{}all}\PYG{p}{(}\PYG{n}{showvar}\PYG{p}{,}\PYG{n}{kind}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{area}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{stacked}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,}\PYG{n}{top}\PYG{o}{=}\PYG{l+m+mf}{0.95}\PYG{p}{)}\PYG{p}{;}    
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Attribution background_13_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Or we can use interactive widgets}
\label{\detokenize{content/howto/attribution/Attribution background:or-we-can-use-interactive-widgets}}
\sphinxAtStartPar
This allows the user to select the specific variable of interest and what to display:

\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
If this is read in a manual the widget is not live.

\sphinxAtStartPar
In a notebook the selection widgets are live.
\end{sphinxadmonition}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{display}\PYG{p}{(}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{get\PYGZus{}att\PYGZus{}gui}\PYG{p}{(}\PYG{n}{var}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKGGREVTOTLCN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{ysize}\PYG{o}{=}\PYG{l+m+mi}{7}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
interactive(children=(Dropdown(description=\PYGZsq{}Variable\PYGZsq{}, index=108, options=(\PYGZsq{}CHNEXR05\PYGZsq{}, \PYGZsq{}CHNPCEXN05\PYGZsq{}, \PYGZsq{}DEUEXR05‚Ä¶
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
None
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxAtStartPar
When the results are displayed, they can be filtered, sliced and diced in a number of ways.


\subsection{More advanced model attribution}
\label{\detokenize{content/howto/attribution/Attribution background:more-advanced-model-attribution}}
\sphinxAtStartPar
For some  models (like the EBA bank stress test model) the number of changed exogenous variables can be large. Using a dictionary to contain the experiments allows us to create experiments where all variables for each country are analyzed, or each macro variable for all countries are analyzed.

\sphinxAtStartPar
Also it is possible to use aggregated sums \sphinxhyphen{} useful for looking at impact on PD‚Äôs. Or just the last time period \sphinxhyphen{} useful for looking at CET1 ratios.

\sphinxAtStartPar
If there are many experiments, data can be filtered in order to look only at the variables with an impact above a certain threshold.

\sphinxAtStartPar
The is also the possibility to   anonymize  the row and column names and to randomize
the order of rows and/or columns \sphinxhyphen{} useful for bank names.


\section{Formula attribution}
\label{\detokenize{content/howto/attribution/Attribution background:formula-attribution}}
\sphinxAtStartPar
Attribution analysis on the formula level is performed by the method \sphinxstylestrong{.dekomp}.

\sphinxAtStartPar
This method utilizes that two attributes .basedf and .lastdf containing the first and the last run are contained in the model instance. Also all the formulas are contained in the instance. Therefore a model, just with one formula \sphinxhyphen{} is created. Then experiments mentioned above is run for each period and each right hand side variable.


\subsection{Single equation attribution output}
\label{\detokenize{content/howto/attribution/Attribution background:single-equation-attribution-output}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{with} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{set\PYGZus{}smpl}\PYG{p}{(}\PYG{l+m+mi}{2020}\PYG{p}{,}\PYG{l+m+mi}{2025}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKCCEMISCO2TKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{dekomp}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Formula        : FRML  \PYGZlt{}\PYGZgt{} PAKCCEMISCO2TKN = PAKCCEMISCO2CKN+PAKCCEMISCO2OKN+PAKCCEMISCO2GKN \PYGZdl{} 

                        2020         2021         2022         2023         2024         2025
Variable    lag                                                                              
Base        0   216055772.84 222601656.91 230049529.33 238103197.33 246127123.55 253659456.66
Alternative 0   153705842.11 160634232.91 168319944.42 176432099.88 184790573.07 193170252.17
Difference  0   \PYGZhy{}62349930.73 \PYGZhy{}61967424.00 \PYGZhy{}61729584.91 \PYGZhy{}61671097.45 \PYGZhy{}61336550.48 \PYGZhy{}60489204.50
Percent     0         \PYGZhy{}28.86       \PYGZhy{}27.84       \PYGZhy{}26.83       \PYGZhy{}25.90       \PYGZhy{}24.92       \PYGZhy{}23.85

 Contributions to differende for  PAKCCEMISCO2TKN
                            2020         2021         2022         2023         2024         2025
Variable        lag                                                                              
PAKCCEMISCO2CKN 0   \PYGZhy{}24768096.25 \PYGZhy{}25017497.26 \PYGZhy{}25248615.93 \PYGZhy{}25456453.36 \PYGZhy{}25531990.77 \PYGZhy{}25414039.06
PAKCCEMISCO2OKN 0   \PYGZhy{}15859351.44 \PYGZhy{}16379596.20 \PYGZhy{}16816413.36 \PYGZhy{}17232706.59 \PYGZhy{}17434843.28 \PYGZhy{}17332637.96
PAKCCEMISCO2GKN 0   \PYGZhy{}21722483.03 \PYGZhy{}20570330.55 \PYGZhy{}19664555.61 \PYGZhy{}18981937.50 \PYGZhy{}18369716.44 \PYGZhy{}17742527.48

 Share of contributions to differende for  PAKCCEMISCO2TKN
                           2020        2021        2022        2023        2024        2025
Variable        lag                                                                        
PAKCCEMISCO2CKN 0           40\PYGZpc{}         40\PYGZpc{}         41\PYGZpc{}         41\PYGZpc{}         42\PYGZpc{}         42\PYGZpc{}
PAKCCEMISCO2GKN 0           35\PYGZpc{}         33\PYGZpc{}         32\PYGZpc{}         31\PYGZpc{}         30\PYGZpc{}         29\PYGZpc{}
PAKCCEMISCO2OKN 0           25\PYGZpc{}         26\PYGZpc{}         27\PYGZpc{}         28\PYGZpc{}         28\PYGZpc{}         29\PYGZpc{}
Total           0          100\PYGZpc{}        100\PYGZpc{}        100\PYGZpc{}        100\PYGZpc{}        100\PYGZpc{}        100\PYGZpc{}
Residual        0            0\PYGZpc{}          0\PYGZpc{}          0\PYGZpc{}          0\PYGZpc{}          0\PYGZpc{}          0\PYGZpc{}

 Contribution to growth rate PAKCCEMISCO2TKN
                           2020        2021        2022        2023        2024        2025
Variable        lag                                                                        
PAKCCEMISCO2CKN 0         \PYGZhy{}0.1\PYGZpc{}       \PYGZhy{}0.2\PYGZpc{}       \PYGZhy{}0.2\PYGZpc{}       \PYGZhy{}0.2\PYGZpc{}       \PYGZhy{}0.1\PYGZpc{}       \PYGZhy{}0.1\PYGZpc{}
PAKCCEMISCO2OKN 0         \PYGZhy{}0.1\PYGZpc{}       \PYGZhy{}0.1\PYGZpc{}       \PYGZhy{}0.1\PYGZpc{}       \PYGZhy{}0.1\PYGZpc{}       \PYGZhy{}0.1\PYGZpc{}       \PYGZhy{}0.1\PYGZpc{}
PAKCCEMISCO2GKN 0         \PYGZhy{}0.1\PYGZpc{}       \PYGZhy{}0.1\PYGZpc{}       \PYGZhy{}0.1\PYGZpc{}       \PYGZhy{}0.1\PYGZpc{}       \PYGZhy{}0.1\PYGZpc{}       \PYGZhy{}0.1\PYGZpc{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Single equation attribution chart}
\label{\detokenize{content/howto/attribution/Attribution background:single-equation-attribution-chart}}
\sphinxAtStartPar
The results can be visualized in different ways.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{help}\PYG{p}{(}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{dekomp\PYGZus{}plot}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Help on method dekomp\PYGZus{}plot in module modelclass:

dekomp\PYGZus{}plot(varnavn, sort=True, pct=True, per=\PYGZsq{}\PYGZsq{}, top=0.9, threshold=0.0, lag=True, rename=True, time\PYGZus{}att=False) method of modelclass.model instance
    Returns  a chart with attribution for a variable over the smpl  
    
    Parameters
    \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}
    varnavn : TYPE
        variable name.
    sort : TYPE, optional
        . The default is False.
    pct : TYPE, optional
        display pct contribution . The default is True.
    per : TYPE, optional
        DESCRIPTION. The default is \PYGZsq{}\PYGZsq{}.
    threshold : TYPE, optional
        cutoff. The default is 0.0.
    rename : TYPE, optional
        Use descriptions instead of variable names. The default is True.
    time\PYGZus{}att : TYPE, optional
        Do time attribution . The default is False.
    lag : TYPE, optional
       separete by lags The default is True.           
    top : TYPE, optional
      where to place the title 
       
    
    Returns
    \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}
    a matplotlib figure instance .
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{dekomp\PYGZus{}plot}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKGGREVTOTLCN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{pct}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
C:\PYGZbs{}modelflow2\PYGZbs{}modelflow\PYGZbs{}modelclass.py:1993: UserWarning: This figure was using a layout engine that is incompatible with subplots\PYGZus{}adjust and/or tight\PYGZus{}layout; not calling subplots\PYGZus{}adjust.
  fig.subplots\PYGZus{}adjust(top=top)
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{Attribution background_24_1}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Chart in pct of the total}
\label{\detokenize{content/howto/attribution/Attribution background:chart-in-pct-of-the-total}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{dekomp\PYGZus{}plot}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKGGREVTOTLCN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{rename}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
C:\PYGZbs{}modelflow2\PYGZbs{}modelflow\PYGZbs{}modelclass.py:1993: UserWarning: This figure was using a layout engine that is incompatible with subplots\PYGZus{}adjust and/or tight\PYGZus{}layout; not calling subplots\PYGZus{}adjust.
  fig.subplots\PYGZus{}adjust(top=top)
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{Attribution background_26_1}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Chart for one year}
\label{\detokenize{content/howto/attribution/Attribution background:chart-for-one-year}}
\sphinxAtStartPar
The attribution for one year can be dispalyed in a waterfall chart.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{dekomp\PYGZus{}plot\PYGZus{}per}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{per}\PYG{o}{=}\PYG{l+m+mi}{2040}\PYG{p}{,}\PYG{n}{rename}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{pct}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{ysize}\PYG{o}{=}\PYG{l+m+mi}{12}\PYG{p}{,}\PYG{n}{threshold} \PYG{o}{=}\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Attribution background_28_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Sorting of attribution}
\label{\detokenize{content/howto/attribution/Attribution background:sorting-of-attribution}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{dekomp\PYGZus{}plot\PYGZus{}per}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{per}\PYG{o}{=}\PYG{l+m+mi}{2040}\PYG{p}{,}\PYG{n}{pct}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{rename}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{sort}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{ysize}\PYG{o}{=}\PYG{l+m+mi}{12}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Attribution background_30_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Truncate attribution}
\label{\detokenize{content/howto/attribution/Attribution background:truncate-attribution}}
\sphinxAtStartPar
Some equations have a lot of small contributions. These can be aggregated through the \sphinxcode{\sphinxupquote{threshold=<some number>}} parameter.
Variables for which all contributions are below the threshold will be lumped together in the \sphinxstylestrong{small} bin. Like below:

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{dekomp\PYGZus{}plot\PYGZus{}per}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{per}\PYG{o}{=}\PYG{l+m+mi}{2040}\PYG{p}{,}\PYG{n}{pct}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{rename}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{sort}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{threshold} \PYG{o}{=}\PYG{l+m+mi}{200000}\PYG{p}{,}\PYG{n}{ysize}\PYG{o}{=}\PYG{l+m+mi}{7}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Attribution background_32_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Attribution when comparing time frames}
\label{\detokenize{content/howto/attribution/Attribution background:attribution-when-comparing-time-frames}}
\sphinxAtStartPar
In this case we seek to find out which variables explains the development from year to year. This is done only for the .lastdf dateframe.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{with} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{set\PYGZus{}smpl}\PYG{p}{(}\PYG{l+m+mi}{2020}\PYG{p}{,}\PYG{l+m+mi}{2024}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{dekomp}\PYG{p}{(}\PYG{n}{time\PYGZus{}att}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Formula        : FRML  \PYGZlt{}\PYGZgt{} PAKNYGDPMKTPKN = PAKNECONPRVTKN+PAKNECONGOVTKN+PAKNEGDIFTOTKN+PAKNEGDISTKBKN+PAKNEEXPGNFSKN\PYGZhy{}PAKNEIMPGNFSKN+PAKNYGDPDISCKN+PAKADAP*PAKDISPREPKN \PYGZdl{} 

                      2020        2021        2022        2023        2024
Variable   lag                                                            
t\PYGZhy{}1        0   26155676.78 26483175.56 27235594.39 27963320.84 28690715.60
t          0   26483175.56 27235594.39 27963320.84 28690715.60 29445700.45
Difference 0     327498.79   752418.82   727726.46   727394.76   754984.85
Percent    0          1.25        2.84        2.67        2.60        2.63

 Contributions to differende for  PAKNYGDPMKTPKN
                         2020       2021       2022       2023       2024
Variable       lag                                                       
PAKNECONPRVTKN 0    \PYGZhy{}13865.31  628033.34  630618.85  606862.06  603453.77
PAKNECONGOVTKN 0    308028.31   98561.83   70113.20   89705.17  116556.97
PAKNEGDIFTOTKN 0    225172.56  195017.31  183925.28  181458.37  182265.98
PAKNEGDISTKBKN 0      9896.78   10138.33   10385.78   10639.27   10898.97
PAKNEEXPGNFSKN 0     94706.27  109298.75  117096.75  121185.21  123550.09
PAKNEIMPGNFSKN 0   \PYGZhy{}297736.16 \PYGZhy{}289958.75 \PYGZhy{}285773.83 \PYGZhy{}283848.95 \PYGZhy{}283168.48
PAKNYGDPDISCKN 0      1296.40    1328.04    1360.45    1393.65    1427.69
PAKADAP        0         0.01       0.00       0.00       0.00       0.02
PAKDISPREPKN   0         0.01       0.00       0.00       0.00       0.02

 Share of contributions to differende for  PAKNYGDPMKTPKN
                          2020        2021        2022        2023        2024
Variable       lag                                                            
PAKNECONPRVTKN 0           \PYGZhy{}4\PYGZpc{}         83\PYGZpc{}         87\PYGZpc{}         83\PYGZpc{}         80\PYGZpc{}
PAKNEGDIFTOTKN 0           69\PYGZpc{}         26\PYGZpc{}         25\PYGZpc{}         25\PYGZpc{}         24\PYGZpc{}
PAKNEEXPGNFSKN 0           29\PYGZpc{}         15\PYGZpc{}         16\PYGZpc{}         17\PYGZpc{}         16\PYGZpc{}
PAKNECONGOVTKN 0           94\PYGZpc{}         13\PYGZpc{}         10\PYGZpc{}         12\PYGZpc{}         15\PYGZpc{}
PAKNEGDISTKBKN 0            3\PYGZpc{}          1\PYGZpc{}          1\PYGZpc{}          1\PYGZpc{}          1\PYGZpc{}
PAKNYGDPDISCKN 0            0\PYGZpc{}          0\PYGZpc{}          0\PYGZpc{}          0\PYGZpc{}          0\PYGZpc{}
PAKADAP        0            0\PYGZpc{}          0\PYGZpc{}          0\PYGZpc{}          0\PYGZpc{}          0\PYGZpc{}
PAKDISPREPKN   0            0\PYGZpc{}          0\PYGZpc{}          0\PYGZpc{}          0\PYGZpc{}          0\PYGZpc{}
PAKNEIMPGNFSKN 0          \PYGZhy{}91\PYGZpc{}        \PYGZhy{}39\PYGZpc{}        \PYGZhy{}39\PYGZpc{}        \PYGZhy{}39\PYGZpc{}        \PYGZhy{}38\PYGZpc{}
Total          0          100\PYGZpc{}        100\PYGZpc{}        100\PYGZpc{}        100\PYGZpc{}        100\PYGZpc{}
Residual       0            0\PYGZpc{}          0\PYGZpc{}          0\PYGZpc{}          0\PYGZpc{}          0\PYGZpc{}

 Contribution to growth rate PAKNYGDPMKTPKN
                          2020        2021        2022        2023        2024
Variable       lag                                                            
PAKNECONPRVTKN 0         \PYGZhy{}0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}
PAKNECONGOVTKN 0          0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}
PAKNEGDIFTOTKN 0          0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}
PAKNEGDISTKBKN 0          0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}
PAKNEEXPGNFSKN 0          0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}
PAKNEIMPGNFSKN 0         \PYGZhy{}0.0\PYGZpc{}       \PYGZhy{}0.0\PYGZpc{}       \PYGZhy{}0.0\PYGZpc{}       \PYGZhy{}0.0\PYGZpc{}       \PYGZhy{}0.0\PYGZpc{}
PAKNYGDPDISCKN 0          0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}
PAKADAP        0          0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}
PAKDISPREPKN   0          0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}        0.0\PYGZpc{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{dekomp\PYGZus{}plot}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{pct}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{rename}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{sort}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{threshold} \PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{time\PYGZus{}att} \PYG{o}{=} \PYG{k+kc}{True}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
C:\PYGZbs{}modelflow2\PYGZbs{}modelflow\PYGZbs{}modelclass.py:1993: UserWarning: This figure was using a layout engine that is incompatible with subplots\PYGZus{}adjust and/or tight\PYGZus{}layout; not calling subplots\PYGZus{}adjust.
  fig.subplots\PYGZus{}adjust(top=top)
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{Attribution background_35_1}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Visualizing attribution in dependency graphs}
\label{\detokenize{content/howto/attribution/Attribution background:visualizing-attribution-in-dependency-graphs}}
\sphinxAtStartPar
The logical graph of the model can be used to show the upstream and downstream variable for a specific variable. More on this {\hyperref[\detokenize{content/howto/structure/Logical_structure::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{here}}}}
When drawing the logical graph for a variable the model attribution will be used to guide the thickness of edges between nodes (variables). This enables a visual impression of which
variables drives the impact.

\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
If png == 0 the graph below will be rendered in SVG format. This enables tooltips with additional information when the mouse hovers
over an edge or an node.

\sphinxAtStartPar
Unfortunately svg can‚Äôt be displayed in the manual, so png has to be True for the manual. In a live jupyter notebook set latex=0. This will
enable svg format.
\end{sphinxadmonition}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN PAKNECONPRVTKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{draw}\PYG{p}{(}\PYG{n}{up}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{down}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{png}\PYG{o}{=}\PYG{n}{latex}\PYG{p}{)}  \PYG{c+c1}{\PYGZsh{} diagram all direct dependencies }
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}IPython.core.display.SVG object\PYGZgt{}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}IPython.core.display.SVG object\PYGZgt{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{The attribution can be filtered and more levels can be displayed.}
\label{\detokenize{content/howto/attribution/Attribution background:the-attribution-can-be-filtered-and-more-levels-can-be-displayed}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{draw}\PYG{p}{(}\PYG{n}{up}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{n}{down}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{png}\PYG{o}{=}\PYG{n}{latex}\PYG{p}{,}\PYG{n+nb}{filter}\PYG{o}{=}\PYG{l+m+mi}{20}\PYG{p}{)} 
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}IPython.core.display.SVG object\PYGZgt{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Or it can be used in a dashboard (not avaiable in the offline manual)}
\label{\detokenize{content/howto/attribution/Attribution background:or-it-can-be-used-in-a-dashboard-not-avaiable-in-the-offline-manual}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{try}\PYG{p}{:}
    \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{modeldash}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{jupyter}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
\PYG{k}{except}\PYG{p}{:} 
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{No Dashboard installed}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
apprun
Dash app running on http://127.0.0.1:5001/
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxstepscope


\part{Target and instruments}

\sphinxstepscope

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZpc{}}\PYG{k}{matplotlib} inline
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\chapter{One target one instrument with 3 instrument variables}
\label{\detokenize{content/howto/targetinstruments/One target one instrument with 3 instrument variables:one-target-one-instrument-with-3-instrument-variables}}\label{\detokenize{content/howto/targetinstruments/One target one instrument with 3 instrument variables::doc}}
\sphinxAtStartPar
This notebook shows how to make a single simple experiment
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Loading a pre\sphinxhyphen{}existing model in Modelflow

\item {} 
\sphinxAtStartPar
Creating an experimet by updating some variables

\item {} 
\sphinxAtStartPar
Simulating the model

\item {} 
\sphinxAtStartPar
Visualizing the results

\end{enumerate}

\sphinxAtStartPar
This Notebook uses a  model for Pakistan described here: \hyperlink{cite.content/litterature:id14}{Burns \sphinxstyleemphasis{et al.}}


\section{Imports}
\label{\detokenize{content/howto/targetinstruments/One target one instrument with 3 instrument variables:imports}}
\sphinxAtStartPar
Modelflow‚Äôs modelclass includes most of the methods needed to manage a model in Modelflow.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{modelclass} \PYG{k+kn}{import} \PYG{n}{model} 
\PYG{k+kn}{import} \PYG{n+nn}{modelmf}
\PYG{n}{model}\PYG{o}{.}\PYG{n}{widescreen}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{model}\PYG{o}{.}\PYG{n}{scroll\PYGZus{}off}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}IPython.core.display.HTML object\PYGZgt{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{modelmf}

\PYG{k+kn}{from} \PYG{n+nn}{modelinvert} \PYG{k+kn}{import} \PYG{n}{targets\PYGZus{}instruments}
\PYG{k+kn}{from} \PYG{n+nn}{modelclass} \PYG{k+kn}{import} \PYG{n}{model}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Load a pre\sphinxhyphen{}existing model, data and descriptions}
\label{\detokenize{content/howto/targetinstruments/One target one instrument with 3 instrument variables:load-a-pre-existing-model-data-and-descriptions}}
\sphinxAtStartPar
The file \sphinxcode{\sphinxupquote{pak.pcim}} contains a dump of model equations, dataframe, simulation options and variable descriptions. The file has been created when onboarding the model.
Examples can be found \sphinxhref{../../onboard/eviews/onboard\%20one\%20model\%20from\%20\%20wf1.html\#onboard-a-model-defined-in-a-wf1-file}{here}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{p}{,}\PYG{n}{baseline} \PYG{o}{=} \PYG{n}{model}\PYG{o}{.}\PYG{n}{modelload}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{../../models/pak.pcim}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{alfa}\PYG{o}{=}\PYG{l+m+mf}{0.7}\PYG{p}{,}\PYG{n}{run}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{ljit}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Define targets and instruments}
\label{\detokenize{content/howto/targetinstruments/One target one instrument with 3 instrument variables:define-targets-and-instruments}}
\sphinxAtStartPar
In year 2100 we want to reduce the emission \sphinxstylestrong{PAKCCEMISCO2TKN} to a percent of the baseline (business as usual)

\sphinxAtStartPar
There is a tax rate for 3 different emission fuel types:

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{for} \PYG{n}{variable} \PYG{o+ow}{in} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKGGREVCO2CER}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKGGREVCO2GER}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKGGREVCO2OER}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{]}\PYG{p}{:}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{variable}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{var\PYGZus{}description}\PYG{p}{[}\PYG{n}{variable}\PYG{p}{]}\PYG{p}{)}
    
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
PAKGGREVCO2CER : Tax/subsidy (Coal) (USD p/tco2)
PAKGGREVCO2GER : Tax/subsidy (Gas) (USD p/tco2)
PAKGGREVCO2OER : Tax/subsidy (Oil) (USD p/tco2)
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxAtStartPar
So the tax instrument consists of 3 variables.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{target\PYGZus{}var} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKCCEMISCO2TKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{instruments} \PYG{o}{=} \PYG{p}{[}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKGGREVCO2CER}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKGGREVCO2GER}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKGGREVCO2OER}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Set the target reduction}
\label{\detokenize{content/howto/targetinstruments/One target one instrument with 3 instrument variables:set-the-target-reduction}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{reduction\PYGZus{}percent} \PYG{o}{=} \PYG{l+m+mi}{30}   \PYG{c+c1}{\PYGZsh{} Input the desired reduction }
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{bau\PYGZus{}2100} \PYG{o}{=}\PYG{n}{baseline}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{l+m+mi}{2100}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKCCEMISCO2TKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{bau\PYGZus{}2022} \PYG{o}{=} \PYG{n}{baseline}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{l+m+mi}{2022}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKCCEMISCO2TKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{bau\PYGZus{}growth\PYGZus{}rate} \PYG{o}{=} \PYG{p}{(}\PYG{n}{bau\PYGZus{}2100}\PYG{o}{/}\PYG{n}{bau\PYGZus{}2022}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{2100}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2022}\PYG{p}{)}\PYG{p}{)}

\PYG{n}{target\PYGZus{}2100} \PYG{o}{=} \PYG{n}{baseline}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{l+m+mi}{2100}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKCCEMISCO2TKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{n}{reduction\PYGZus{}percent}\PYG{o}{/}\PYG{l+m+mi}{100}\PYG{p}{)}
\PYG{n}{target\PYGZus{}growth\PYGZus{}rate} \PYG{o}{=} \PYG{p}{(}\PYG{n}{target\PYGZus{}2100}\PYG{o}{/}\PYG{n}{bau\PYGZus{}2022}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{2100}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2022}\PYG{p}{)}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Business as usual Emission value in 2100: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{bau\PYGZus{}2100}\PYG{l+s+si}{:}\PYG{l+s+s2}{13,.0f}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Business as usual Emission value in 2100: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{target\PYGZus{}2100}\PYG{l+s+si}{:}\PYG{l+s+s2}{13,.0f}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Business as usual growth rate in percent: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{bau\PYGZus{}growth\PYGZus{}rate}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{l+s+si}{:}\PYG{l+s+s2}{13,.1\PYGZpc{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Target growth rate in percent           : }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{target\PYGZus{}growth\PYGZus{}rate}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{l+s+si}{:}\PYG{l+s+s2}{13,.1\PYGZpc{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Business as usual Emission value in 2100:   682,338,966
Business as usual Emission value in 2100:   477,637,277
Business as usual growth rate in percent:          1.4\PYGZpc{}
Target growth rate in percent           :          0.9\PYGZpc{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Create a dataframe with the target}
\label{\detokenize{content/howto/targetinstruments/One target one instrument with 3 instrument variables:create-a-dataframe-with-the-target}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{target\PYGZus{}before} \PYG{o}{=} \PYG{n}{baseline}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{l+m+mi}{2022}\PYG{p}{:}\PYG{p}{,}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKCCEMISCO2TKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{]}     \PYG{c+c1}{\PYGZsh{} Create dataframe with only the target variable }
\PYG{c+c1}{\PYGZsh{} create a target dataframe with a projection of the target variable }
\PYG{n}{target} \PYG{o}{=} \PYG{n}{target\PYGZus{}before}\PYG{o}{.}\PYG{n}{mfcalc}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKCCEMISCO2TKN = PAKCCEMISCO2TKN(\PYGZhy{}1) * }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{target\PYGZus{}growth\PYGZus{}rate}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+m+mi}{2023}\PYG{p}{,}\PYG{l+m+mi}{2100} \PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Now solve the problem:}
\label{\detokenize{content/howto/targetinstruments/One target one instrument with 3 instrument variables:now-solve-the-problem}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{\PYGZus{}} \PYG{o}{=} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{invert}\PYG{p}{(}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{basedf}\PYG{p}{,}                  \PYG{c+c1}{\PYGZsh{} Invert calls the target instrument device                   }
                \PYG{n}{targets} \PYG{o}{=} \PYG{n}{target}\PYG{p}{,}                   
                \PYG{n}{instruments}\PYG{o}{=}\PYG{n}{instruments}\PYG{p}{,}
                \PYG{n}{DefaultImpuls}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{,}              \PYG{c+c1}{\PYGZsh{} The default impulse instrument variables }
                \PYG{n}{defaultconv}\PYG{o}{=}\PYG{l+m+mf}{2.0}\PYG{p}{,}              \PYG{c+c1}{\PYGZsh{} Convergergence criteria for targets}
                \PYG{n}{varimpulse}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,}              \PYG{c+c1}{\PYGZsh{} Only change the variable for current period}
                \PYG{n}{nonlin}\PYG{o}{=}\PYG{l+m+mi}{15}\PYG{p}{,}                    \PYG{c+c1}{\PYGZsh{} If no convergence in 15 iteration recalculate jacobi }
                \PYG{n}{silent}\PYG{o}{=}\PYG{l+m+mi}{1}                      \PYG{c+c1}{\PYGZsh{} Don\PYGZsq{}t show iteration output (try 1 for showing)}
                \PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Finding instruments :   0\PYGZpc{}|          | 0/79
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Make a graph and decorate with a line and an annotation}
\label{\detokenize{content/howto/targetinstruments/One target one instrument with 3 instrument variables:make-a-graph-and-decorate-with-a-line-and-an-annotation}}
\sphinxAtStartPar
Also show the tax rate

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{with} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{set\PYGZus{}smpl}\PYG{p}{(}\PYG{l+m+mi}{2020}\PYG{p}{,}\PYG{l+m+mi}{2100}\PYG{p}{)}\PYG{p}{:}    \PYG{c+c1}{\PYGZsh{} change if you want another  timeframe }
    \PYG{n}{fig} \PYG{o}{=} \PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKCCEMISCO2TKN}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{]}\PYG{o}{.}\PYG{n}{plot\PYGZus{}alt}\PYG{p}{(}\PYG{n}{title}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Pakistan}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{fig}\PYG{o}{.}\PYG{n}{axes}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{axhline}\PYG{p}{(} \PYG{n}{target\PYGZus{}2100}\PYG{p}{,}
                                  \PYG{n}{xmin}\PYG{o}{=}\PYG{l+m+mf}{0.6}\PYG{p}{,}
                                  \PYG{n}{xmax} \PYG{o}{=} \PYG{l+m+mf}{0.99}\PYG{p}{,}
                                  \PYG{n}{linewidth}\PYG{o}{=}\PYG{l+m+mi}{3}\PYG{p}{,} 
                                  \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{ls}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{dashed}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

    \PYG{n}{fig}\PYG{o}{.}\PYG{n}{axes}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{annotate}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{BAU 2050 reduced by }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{reduction\PYGZus{}percent}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{xy}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{2050}\PYG{p}{,}\PYG{n}{target\PYGZus{}2100} \PYG{p}{)}\PYG{p}{)}
    \PYG{n}{fig2} \PYG{o}{=} \PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKGGREVCO2CER}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{]}\PYG{o}{.}\PYG{n}{plot\PYGZus{}alt}\PYG{p}{(}\PYG{n}{title}\PYG{o}{=}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Pakistan}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{;} 
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{One target one instrument with 3 instrument variables_20_0}.png}

\noindent\sphinxincludegraphics{{One target one instrument with 3 instrument variables_20_1}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Look at selected variables with the {[}{]} operator}
\label{\detokenize{content/howto/targetinstruments/One target one instrument with 3 instrument variables:look-at-selected-variables-with-the-operator}}
\sphinxAtStartPar
If you want to look at multiple variables the index {[}{]} operator can be used to select the variables to analyze/visualize. Here only a few operations will be shown. There is more {\hyperref[\detokenize{content/Python/modelflow_features:index-operator}]{\sphinxcrossref{\DUrole{std,std-ref}{here}}}}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKNYGDPMKTPKN PAKNECONGOVTKN PAKNEGDIFTOTKN PAKNEIMPGNFSKN PAKCCEMISCO2TKN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Tab(children=(Tab(children=(HTML(value=\PYGZsq{}\PYGZlt{}?xml version=\PYGZdq{}1.0\PYGZdq{} encoding=\PYGZdq{}utf\PYGZhy{}8\PYGZdq{} standalone=\PYGZdq{}no\PYGZdq{}?\PYGZgt{}\PYGZbs{}n\PYGZlt{}!DOCTYPE svg ‚Ä¶
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Now define instruments so they don‚Äôt get the same shock.}
\label{\detokenize{content/howto/targetinstruments/One target one instrument with 3 instrument variables:now-define-instruments-so-they-don-t-get-the-same-shock}}
\sphinxAtStartPar
Here the coal emission gets twice the shock as the two other.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{new\PYGZus{}instruments} \PYG{o}{=}\PYG{p}{[}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKGGREVCO2CER}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{,}
                   \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKGGREVCO2GER}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{,}
                   \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKGGREVCO2OER}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{]}\PYG{p}{]}


\PYG{n}{\PYGZus{}} \PYG{o}{=} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{invert}\PYG{p}{(}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{basedf}\PYG{p}{,}\PYG{n}{targets} \PYG{o}{=} \PYG{n}{target}\PYG{p}{,}
                            \PYG{n}{instruments}\PYG{o}{=}\PYG{n}{new\PYGZus{}instruments}\PYG{p}{,}
                          \PYG{n}{DefaultImpuls}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}
                                \PYG{n}{defaultconv}\PYG{o}{=}\PYG{l+m+mf}{2.0}\PYG{p}{,}\PYG{n}{varimpulse}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,}\PYG{n}{nonlin}\PYG{o}{=}\PYG{l+m+mi}{15}\PYG{p}{,}\PYG{n}{silent}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Finding instruments :   0\PYGZpc{}|          | 0/79
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{with} \PYG{n}{mpak}\PYG{o}{.}\PYG{n}{set\PYGZus{}smpl}\PYG{p}{(}\PYG{l+m+mi}{2020}\PYG{p}{,}\PYG{l+m+mi}{2100}\PYG{p}{)}\PYG{p}{:}    \PYG{c+c1}{\PYGZsh{} change if you want another  timeframe }
    \PYG{n}{fig} \PYG{o}{=} \PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKCCEMISCO2TKN}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{]}\PYG{o}{.}\PYG{n}{plot\PYGZus{}alt}\PYG{p}{(}\PYG{n}{title}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Pakistan}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{fig}\PYG{o}{.}\PYG{n}{axes}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{axhline}\PYG{p}{(} \PYG{n}{target\PYGZus{}2100}\PYG{p}{,}
                                  \PYG{n}{xmin}\PYG{o}{=}\PYG{l+m+mf}{0.6}\PYG{p}{,}
                                  \PYG{n}{xmax} \PYG{o}{=} \PYG{l+m+mf}{0.99}\PYG{p}{,}
                                  \PYG{n}{linewidth}\PYG{o}{=}\PYG{l+m+mi}{3}\PYG{p}{,} 
                                  \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{ls}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{dashed}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

    \PYG{n}{fig}\PYG{o}{.}\PYG{n}{axes}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{annotate}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{BAU 2050 reduced by }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{reduction\PYGZus{}percent}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{xy}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{2050}\PYG{p}{,}\PYG{n}{target\PYGZus{}2100}\PYG{o}{*}\PYG{l+m+mf}{1.015} \PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{One target one instrument with 3 instrument variables_25_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
    \PYG{n}{mpak}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PAKGGREVCO2CER PAKGGREVCO2GER PAKGGREVCO2OER}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Tab(children=(Tab(children=(HTML(value=\PYGZsq{}\PYGZlt{}?xml version=\PYGZdq{}1.0\PYGZdq{} encoding=\PYGZdq{}utf\PYGZhy{}8\PYGZdq{} standalone=\PYGZdq{}no\PYGZdq{}?\PYGZgt{}\PYGZbs{}n\PYGZlt{}!DOCTYPE svg ‚Ä¶
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{help}\PYG{p}{(}\PYG{n}{mpak}\PYG{o}{.}\PYG{n}{invert}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Help on method invert in module modelclass:

invert(databank, targets, instruments, silent=1, DefaultImpuls=0.01, defaultconv=0.001, nonlin=False, maxiter=30, **kwargs) method of modelclass.model instance
    Solves instruments for targets
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{modelinvert}
\PYG{n}{help}\PYG{p}{(}\PYG{n}{modelinvert}\PYG{o}{.}\PYG{n}{targets\PYGZus{}instruments}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Help on class targets\PYGZus{}instruments in module modelinvert:

class targets\PYGZus{}instruments(builtins.object)
 |  targets\PYGZus{}instruments(databank, targets, instruments, model, DefaultImpuls=0.01, defaultconv=0.01, nonlin=False, silent=True, maxiter=30, solveopt=\PYGZob{}\PYGZcb{}, varimpulse=False)
 |  
 |  Class to handle general target/instrument problems. 
 |  Where the response is delayed specify this with delay.
 |  
 |  Number of targets should be equal to number of instruments 
 |  
 |  An instrument can comprice of severeral variables
 |  
 |  **Instruments** are inputtet as a list of instruments
 |  
 |  To calculate the jacobian each instrument variable has a impuls, 
 |  which is used as delta when evaluating the jacobi matrix:: 
 |      
 |    [ \PYGZsq{}QO\PYGZus{}J\PYGZsq{},\PYGZsq{}TG\PYGZsq{}]   Simple list each variable are shocked by the default impulse 
 |    [ (\PYGZsq{}QO\PYGZus{}J\PYGZsq{},0.5), \PYGZsq{}TG\PYGZsq{}]  Here QO\PYGZus{}J is getting its own impuls (0.5)
 |    [ [(\PYGZsq{}QO\PYGZus{}J\PYGZsq{},0.5),(\PYGZsq{}ORLOV\PYGZsq{},1.)] , (\PYGZsq{}TG\PYGZsq{},0.01)] here an impuls is given for each variable, and the first instrument consiste of two variables 
 |  
 |  **Targets** are list of variables
 |  
 |  Convergence is achieved when all targets are within convergens distance from the target value
 |  
 |  Convergencedistance can be set individual for a target variable by setting a value in \PYGZlt{}modelinstance\PYGZgt{}.targetconv 
 |  
 |  Targets and target values are provided by a dataframe.
 |  
 |  Methods defined here:
 |  
 |  \PYGZus{}\PYGZus{}call\PYGZus{}\PYGZus{}(self, *args, **kwargs)
 |      Uses :any:`targetseek`
 |  
 |  \PYGZus{}\PYGZus{}init\PYGZus{}\PYGZus{}(self, databank, targets, instruments, model, DefaultImpuls=0.01, defaultconv=0.01, nonlin=False, silent=True, maxiter=30, solveopt=\PYGZob{}\PYGZcb{}, varimpulse=False)
 |      Initialize self.  See help(type(self)) for accurate signature.
 |  
 |  invjacobi(self, per, diag=False, delay=0)
 |      Calculates the inverted jacobi matrix
 |      
 |      returns a dataframe
 |  
 |  jacobi(self, per, delay=None)
 |      Calculates a jecobi matrix of derivatives based on the instruments and targets 
 |      
 |      returns a dataframe
 |  
 |  targetseek(self, databank=None, shortfall=False, ti\PYGZus{}damp=1.0, delay=0, progressbar=True, **kwargs)
 |      Calculates the instruments as a function of targets
 |  
 |  \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}
 |  Data descriptors defined here:
 |  
 |  \PYGZus{}\PYGZus{}dict\PYGZus{}\PYGZus{}
 |      dictionary for instance variables (if defined)
 |  
 |  \PYGZus{}\PYGZus{}weakref\PYGZus{}\PYGZus{}
 |      list of weak references to the object (if defined)
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxstepscope


\part{Specification}

\sphinxstepscope


\chapter{Specification of models (introduction)}
\label{\detokenize{content/notebooks/intro/model specification:specification-of-models-introduction}}\label{\detokenize{content/notebooks/intro/model specification::doc}}
\sphinxAtStartPar
Modelflow was started in order to build transparent and agile models and in order to be able to recycle and connect a broad range of models from different sources.

\sphinxAtStartPar
For these reasons it should be possible to onboard models from different sources and it should be possible to specify a model in a parsimonious and expressive way. This allows focus  on the economic content without entanglement from implementation and housekeeping details.

\sphinxAtStartPar
For this purpose specification of a model typical \sphinxstylestrong{flows}  through several phases (hence the flow in modelflow).

\sphinxAtStartPar
Which \sphinxstyleemphasis{initial phases} the model specification flows through depend on the nature and origin of the model at hand. Python has a rich set of string manipulation functions which allows different processing in these phases. Some more advanced examples for instance {\hyperref[\detokenize{content/howto/onboard/eviews/onboard one model from  wf1::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{onboarding a Eviews model}}}} is given in the onboarding section of this manual.

\sphinxAtStartPar
The \sphinxstyleemphasis{last phase} is always the model specification in \sphinxstylestrong{The Basic Business logic language}. From this specification the model is  transpiled by a python function like this {\hyperref[\detokenize{content/notebooks/intro/Example Solow:solow-python-code}]{\sphinxcrossref{\DUrole{std,std-ref}{python solution code for Solow model}}}}
which is needed for both the Gauss and the Newton type solution methods {\hyperref[\detokenize{content/notebooks/intro/model and solution:id3}]{\sphinxcrossref{\DUrole{std,std-ref}{python solution code}}}}.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=700\sphinxpxdimen]{{onboarding}.png}
\caption{Flow from model specification to python solver}\label{\detokenize{content/notebooks/intro/model specification:markdown-fig}}\end{figure}

\sphinxAtStartPar
The Basic Business Logic Language which is used for specification of models in ModelFlow can trace its origins to the \sphinxhref{https://en.wikipedia.org/wiki/TSP\_(econometrics\_software)}{TSP program} which was installed in the UNIVAC mainframe in RECKU \sphinxhyphen{} the computer center of University of Copenhagen in the 70‚Äôs (and a lot of other mainframes used for model worK). It looks to some extend like model specification in packages used for simulation of macroeconomic models like  {[}Eviews{]}, Gekko, PCIM, Dynare, Aremos or TROLL.


\section{Specify equations in Basic business logic language.}
\label{\detokenize{content/notebooks/intro/model specification:specify-equations-in-basic-business-logic-language}}
\sphinxAtStartPar
Each equation \(f_i\) in a model is specified as:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
FRML \PYGZlt{}options\PYGZgt{} \PYGZlt{}left hand side\PYGZgt{} = \PYGZlt{}right hand side\PYGZgt{} \PYGZdl{}
\end{sphinxVerbatim}

\sphinxAtStartPar
Each formula ends with a \$.

\sphinxAtStartPar
The \sphinxcode{\sphinxupquote{<left hand side>}} should not contain transformations. Lags or leads can not be specified at the left hand side of \(=\).

\sphinxAtStartPar
Time \(t\) is implicit in the equations which means that a \(var\) at time \(t\) written as \sphinxcode{\sphinxupquote{var}}, while \(var_{t-1}\) is written as \sphinxcode{\sphinxupquote{var(\sphinxhyphen{}1)}}. ModelFlow is case\sphinxhyphen{}insensitive. Everything is eventually transformed into upper case.

\sphinxAtStartPar
The \sphinxcode{\sphinxupquote{<right hand side>}} can contain variables, operators, functions and variables. ModelFlow comes with a number of built\sphinxhyphen{}in functions. In addition python functions can be supplied when a model is created.

\sphinxAtStartPar
A variable is a timeseries which for contains a numbers or Python objects. This paper is mostly concerned with variables containing numbers (scalars).

\sphinxAtStartPar
Operators:

\sphinxAtStartPar
Standard: \sphinxcode{\sphinxupquote{= + \sphinxhyphen{} * / ** ( ) @ }}

\sphinxAtStartPar
Comparison: \sphinxcode{\sphinxupquote{>= <= == !=}}  \# evaluates to 0 if false, 1 if true

\sphinxAtStartPar
Special: \sphinxcode{\sphinxupquote{\$ > < , . {[}  {]} }} \# used in different python constructions.

\sphinxAtStartPar
In addition a number of pre\sphinxhyphen{}defined functions can be used and should be avoided as variable names.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{tag_hide-input}\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
DLOG SUM\PYGZus{}EXCEL DIFF MIN MAX FLOAT NORM.CDF NORM.PPF ABS MOVAVG PCT\PYGZus{}GROWTH ARRAY CLASSFUNK CLOGNORM EXP GAMMA INSPECT JIT LIFETIME\PYGZus{}CREDIT\PYGZus{}LOSS LOG LOGIT LOGIT\PYGZus{}INVERSE LOGNORM MATRIX MV\PYGZus{}OPT MV\PYGZus{}OPT\PYGZus{}PROP NORM NORMCDF QGAMMA SQRT SUM\PYGZus{}EXCEL TRANSPOSE JIT RECODE TRANS
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
If formulas (equations) can be separated by linebreak, frml and \$ don‚Äôt need to be specified.

\sphinxAtStartPar
Equation options  which are enclosed in ¬¥¬¥¬¥<>``` are used to control differed aspects both of the text processing of equations and of the solving. Use of equation options will be provided later.


\section{Specify equations in (Macro) Business logic language.}
\label{\detokenize{content/notebooks/intro/model specification:specify-equations-in-macro-business-logic-language}}
\sphinxAtStartPar
Models should be specified in a domain specific language which matches the problem at hand and which lend itself to short and expressive specification. The focus should be on the business logic and not on the housekeeping which is necessary for the solving algorithms.

\sphinxAtStartPar
Stress test models should for instance be able to handle many bank and sectors without repeating text. Also the language should be able to handle common model constructs like: DLOG(var) = \((log(var_t)-log(var_{t-1}))\) or DIF(var) = \((var_t-var_{t-1})\) on both sides of =, inclusion of factors, possibility of fixing endogenous variables and more.

\sphinxAtStartPar
So on top of the \sphinxstylestrong{Business logic language}. there is a \sphinxstylestrong{Macro Business Logic language}. The primary goal of this is to allow (conditional) looping and normalization of formulas. More no this later on.


\subsection{Advanced, Tupels and matrices.}
\label{\detokenize{content/notebooks/intro/model specification:advanced-tupels-and-matrices}}
\sphinxAtStartPar
The left hand side can be a Python \sphinxhref{https://docs.python.org/3/tutorial/datastructures.html\#tuples-and-sequences}{tuple} that matches the \sphinxcode{\sphinxupquote{<right hand side>}}.

\sphinxAtStartPar
Also Pandas Dataframes can also contain python objects. This means that a variable can also be a matrix. This makes it possible to create a broader range of models \sphinxhyphen{} input output, bank contagion and optimizing models \sphinxhyphen{} in Modelflow. However there are also limitations to solving methods and output has to be taken special care of. In this manual it is therefor assumed that a variable is a timeserie of numbers.

\sphinxstepscope


\part{Optimization}

\sphinxstepscope


\chapter{Mean variance optimization}
\label{\detokenize{content/howto/optimization/Optimize_simpel:mean-variance-optimization}}\label{\detokenize{content/howto/optimization/Optimize_simpel::doc}}
\sphinxAtStartPar
\sphinxstylestrong{This is an advanced notebook which requires prior knowledge on optimization and linear algebra}

\sphinxAtStartPar
The \sphinxhref{https://cvxopt.org}{CVXOPT } library can solve convex optimization problems. In Modelflow this is harnesses to solve \sphinxstylestrong{mean variance} problems as they frequently arise in finance.

\sphinxAtStartPar
This notebook first takes the reader through how a mean variance problem can be restated as a quadratic problem, which is a standard problem for CVXOPT. It covers a little more general mean variance problem which also a stylized bank balance sheet optimization problem.

\sphinxAtStartPar
\sphinxstylestrong{The notebook is fairly advanced and requires some previous knowledge.}

\sphinxAtStartPar
A small currency mix optimization model with 3 currencies is used to illustrate the optimization.

\sphinxAtStartPar
Notice also that the rows in this example has nothing to do with time, but indicates the risk level. This does not matter, as no lags or leads are involved.

\sphinxAtStartPar
Enjoy

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\PYG{k+kn}{import} \PYG{n+nn}{pandas} \PYG{k}{as} \PYG{n+nn}{pd} 

\PYG{c+c1}{\PYGZsh{} Modules from Modelflow}
\PYG{k+kn}{from} \PYG{n+nn}{modelclass} \PYG{k+kn}{import} \PYG{n}{model} 

\PYG{c+c1}{\PYGZsh{}Optional functionalities }
\PYG{n}{model}\PYG{o}{.}\PYG{n}{widescreen}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{model}\PYG{o}{.}\PYG{n}{scroll\PYGZus{}off}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}IPython.core.display.HTML object\PYGZgt{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Mean variance problem}
\label{\detokenize{content/howto/optimization/Optimize_simpel:mean-variance-problem}}
\sphinxAtStartPar
A mean variance problem for allocating positions to banks.
let:
\begin{equation*}
\begin{split}
\begin{array}{ll}
\mathbf x & \mbox{Position in each asset(+)/liability(-) type}\\
\Sigma & \mbox{Covariance matrix} \\
\mathbf r & \mbox{Return vector}\\
\lambda & \mbox{Risk aversion}\\
\mathbf{riskweights}&\text{Vector of risk weights, liabilities has riskweight = 0}\\
Capital&\text{Max of sum of risk weighted assets}\\
\mathbf{lcrweights}&\text{Vector of LCR weights, liabilities has lcrweight = 0}\\
LCR&\text{Min of sum of lcr weighted assets}\\
\mathbf{leverageweight}&\text{Vector of leverage weights, liabilities has leverageweight = 0}\\
Equity&\text{Max sum of leverage weighted positions}\\
Budget&\text{initial sum of the positions, as no new money is injected the sum has to be maintained }\\
\mbox{Risk} & \mathbf x^T  \Sigma \mathbf x\\
\mbox{Return} & \mathbf r^T \mathbf x\\
\end{array}
\end{split}
\end{equation*}
\sphinxAtStartPar
The optimization problem can be stated as:
\begin{equation*}
\begin{split}
\begin{array}{lll}
\mbox{minimize:}  & \lambda \mathbf x^T \Sigma \mathbf x - (1-\lambda) \mathbf r^T \mathbf x & \mbox{If }\lambda \mbox{ = 1 minimize risk, if } \lambda\mbox{ = 0 maximize return }\\
\mbox{subject to:} & \mathbf x \succeq \mathbf{x^{min}} &\mbox{Each position greater or equal a minimum}\\ 
                   & \mathbf x \preceq \mathbf{x^{max}} &\mbox{Each position less or equal a maximum}\\ 
                   & \mathbf{riskweights}^T\mathbf x \leq Capital &\mbox{Risk weighted assets less than or equal to capital}\\ 
                   & \mathbf{lcrweights}^T\mathbf x \geq LCR &\mbox{lcr weighted assets greater than or equal to LCR target}\\ 
                   & \mathbf{leverageweight}^T\mathbf x \leq equity &\mbox{leverage weighted assets less than or equal to equity}\\ 
                   & \mathbf 1^T\mathbf x = Budget & \mbox{Sum of positions = E, we are not getting more money}
\end{array}
\end{split}
\end{equation*}

\section{Quadratic program}
\label{\detokenize{content/howto/optimization/Optimize_simpel:quadratic-program}}
\sphinxAtStartPar
The general quadratic optimization problem is usually formulated in this way:
\begin{equation*}
\begin{split}
\begin{array}{lr}
\mbox{minimize:}   &\frac{1}{2} x^TPx + q^T x \\
\mbox{subject to:} & G x \preceq h \\
                  & Ax = b
\end{array}
\end{split}
\end{equation*}
\sphinxAtStartPar
P,q,G,h,A,b are the parameters quadratic program algorithms usually have as inputs.
This also goes for the \sphinxstylestrong{cvxopt} package which is used in this example.


\section{Translation from Mean Variance to quadratic program}
\label{\detokenize{content/howto/optimization/Optimize_simpel:translation-from-mean-variance-to-quadratic-program}}
\sphinxAtStartPar
To solve the Mean variance problem the problem has to be translated to the standard quadratic programming formulation. This can be done according to this recipe:
\begin{equation*}
\begin{split}
\begin{array}{ll}
P & = 2\times (1-\lambda)\times  \Sigma \\
q & = -\lambda\times r \\ 
G &= \begin{bmatrix} -x^{min} \\ 
\phantom{-}x^{max} \\ 
 Capital \\ 
 -LCR\\ 
 \end{bmatrix}\\
A &= \mathbf 1^T \\
b &= Budget\\
\end{array}
\end{split}
\end{equation*}
\sphinxAtStartPar
So in a example with 3 positions \( G \times x \preceq h  \) can be constructed this way:
\begin{equation*}
\begin{split}
\begin{array}{llll}
 \begin{bmatrix} 
		-1 & \phantom{-}0 & \phantom{-}0 \\
		\phantom{-}0 & -1 & \phantom{-}0 \\
		\phantom{-}0 & \phantom{-}0 & -1 \\
		\phantom{-}1 & \phantom{-}0 & \phantom{-}0 \\
		\phantom{-}0 & \phantom{-}1 & \phantom{-}0 \\
		\phantom{-}0 & \phantom{-}0 & \phantom{-}1 \\
   		\text{Risk weight}_{position_1} & \text{Risk weight}_{position_2} & \text{Risk weight}_{position_3} \\
   		\text{-LCR weight}_{position_1} & \text{-LCR weight}_{position_2} & \text{-LCR weight}_{position_3} \\
   		\text{Leverage weight}_{position_1} & \text{Leverage weight}_{position_2} & \text{Leverage weight}_{position_3} \\
\end{bmatrix} \times  \begin{bmatrix} 
		x_1 \\
		x_2  \\
		x_3 \\
\end{bmatrix} \preceq \begin{bmatrix} 
		-x_1^{min} \\
		-x_2^{min} \\
		-x_3^{min} \\
		\phantom{-}x_1^{max} \\
		\phantom{-}x_2^{max} \\
		\phantom{-}x_3^{max} \\
        Capital  \\
        -LCR \\
        Equity \\
\end{bmatrix}
\end{array}
\end{split}
\end{equation*}

\section{Grouping af variables}
\label{\detokenize{content/howto/optimization/Optimize_simpel:grouping-af-variables}}
\sphinxAtStartPar
If we want to group position so that positions have are proportional, it can be done by adding rows to A and b
if \(position_{1}\) should be equal to \(position_2\)
\begin{gather*}
A = \begin{bmatrix} 
		1 & \phantom{-}1 & 1 \\
		1 & -1 & 0 \\
		\end{bmatrix} \\        
         b = \begin{bmatrix} 
		1  \\
	    0 \\
		\end{bmatrix}
\end{gather*}
\sphinxAtStartPar
if \(position_{1}\) should be equal to the double of \(position_2\) A should be changed to:
\begin{gather*}
A = \begin{bmatrix} 
		1 & \phantom{-}1 & 1 \\
		2 &  -1 & 0 \\
		\end{bmatrix}
\end{gather*}

\section{mv\_opt() Mean variance to Quadratic Programming}
\label{\detokenize{content/howto/optimization/Optimize_simpel:mv-opt-mean-variance-to-quadratic-programming}}
\sphinxAtStartPar
The function mv\_opt() translates the Mean variance problem to a Quadratic programming problem.

\sphinxAtStartPar
Calls to this function can be incorporated in the business logic.   Include more explanation. 

\sphinxAtStartPar
 Why is the function defined here? And not ‚Äújust‚Äù called upon and explained like the others? 

\begin{sphinxVerbatim}[commandchars=\\\{\}]
def mv\PYGZus{}opt(PP,qq,riskaversion,bsum,weights,weigthtedsum,boundsmin,boundsmax,lprint=False):
    from cvxopt import qp , matrix
    q\PYGZus{}size   =  len(qq)
    P        =  matrix(2.0*(1.0\PYGZhy{}riskaversion)*PP)                
    q        =  matrix(\PYGZhy{}1.0*riskaversion*qq)
    Gmin     = \PYGZhy{}matrix(np.eye(q\PYGZus{}size))
    hmin     = \PYGZhy{}matrix(boundsmin)
    Gmax     =  matrix(np.eye(q\PYGZus{}size))
    hmax     =  matrix(boundsmax)
    Gweights =  matrix(weights)
    hweights =  matrix(weigthtedsum)
    G        =  matrix([Gmin,Gmax,Gweights.T])\PYGZsh{} creates the combined inequalities 
    h        =  matrix([hmin,hmax,hweights])
    A        =  matrix(1.,(1,q\PYGZus{}size))        \PYGZsh{} sum of shares equal to one
    b        =  matrix([bsum])   
    sol      = qp(P,q,G,h,A,b)               \PYGZsh{} minimize risk and maximize return 
    x        = sol[\PYGZsq{}x\PYGZsq{}] 
    res      = x
    return res
    ```
\end{sphinxVerbatim}


\section{Example: currency mix with three currencies.}
\label{\detokenize{content/howto/optimization/Optimize_simpel:example-currency-mix-with-three-currencies}}

\subsection{Specify the model in the business language}
\label{\detokenize{content/howto/optimization/Optimize_simpel:specify-the-model-in-the-business-language}}
\sphinxAtStartPar
First the model is specified in business language.

\sphinxAtStartPar
tvaluate sets up the parameters, packs and unpacks the variables to appropriate matrices as well as uses the mv\_opt optimizer function to define ‚Äòpositions‚Äô:

\sphinxAtStartPar
\(positions          =  mv\_opt(msigma,vreturn,riskaversion, total, 
                                       [[risk\_weights] , [-lcr\_weights] , [leverage\_weights]],
                                           [capital, -lcr , equity] ,min_w,max_w) \)

\sphinxAtStartPar
Notice:
\begin{itemize}
\item {} 
\sphinxAtStartPar
matrix in frmlname indicates that the left hand side is a matrix

\item {} 
\sphinxAtStartPar
the matrix function creates a matrix from nested lists

\item {} 
\sphinxAtStartPar
the to\_matrix function creates a matrix

\item {} 
\sphinxAtStartPar
argexpand(list,argument) will expand the argument to all elements in list and substitute

\end{itemize}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{tvaluta}\PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\PYG{l+s+s1}{list valuta1 = ISO  : USD JPY EUR \PYGZdl{}}


\PYG{l+s+s1}{frml \PYGZlt{}matrix\PYGZgt{} msigma  = matrix( [[0.01573635,0.01436816,	0.01045556],}
\PYG{l+s+s1}{                                 [0.01436816,0.02289016,	0.01172995],}
\PYG{l+s+s1}{                                 [0.01045556,0.01172995,	0.01748076]]  ) \PYGZdl{}}

\PYG{l+s+s1}{frml \PYGZlt{}matrix\PYGZgt{} vreturn         = matrix([0.048,0.040,0.035]) \PYGZdl{}}

\PYG{l+s+s1}{frml \PYGZlt{}matrix\PYGZgt{} max\PYGZus{}w             = to\PYGZus{}matrix(valuta1,max\PYGZus{}}\PYG{l+s+si}{\PYGZob{}iso\PYGZcb{}}\PYG{l+s+s1}{)      \PYGZdl{}}
\PYG{l+s+s1}{frml \PYGZlt{}matrix\PYGZgt{} min\PYGZus{}w             = to\PYGZus{}matrix(valuta1,min\PYGZus{}}\PYG{l+s+si}{\PYGZob{}iso\PYGZcb{}}\PYG{l+s+s1}{)       \PYGZdl{}}


\PYG{l+s+s1}{frml \PYGZlt{}matrix\PYGZgt{} risk\PYGZus{}weights      = to\PYGZus{}matrix(valuta1,risk\PYGZus{}weight\PYGZus{}}\PYG{l+s+si}{\PYGZob{}iso\PYGZcb{}}\PYG{l+s+s1}{) \PYGZdl{}}
\PYG{l+s+s1}{frml \PYGZlt{}matrix\PYGZgt{} leverage\PYGZus{}weights  = to\PYGZus{}matrix(valuta1,leverage\PYGZus{}weight\PYGZus{}}\PYG{l+s+si}{\PYGZob{}iso\PYGZcb{}}\PYG{l+s+s1}{) \PYGZdl{}}
\PYG{l+s+s1}{frml \PYGZlt{}matrix\PYGZgt{} lcr\PYGZus{}weights       = to\PYGZus{}matrix(valuta1,lcr\PYGZus{}weight\PYGZus{}}\PYG{l+s+si}{\PYGZob{}iso\PYGZcb{}}\PYG{l+s+s1}{) \PYGZdl{}}
\PYG{l+s+s1}{FRML \PYGZlt{}matrix\PYGZgt{} positions          =  mv\PYGZus{}opt(msigma,vreturn,riskaversion, total,}
\PYG{l+s+s1}{                      [[risk\PYGZus{}weights] , [\PYGZhy{}lcr\PYGZus{}weights] , [leverage\PYGZus{}weights]],}
\PYG{l+s+s1}{                                       [capital, \PYGZhy{}lcr , equity] ,min\PYGZus{}w,max\PYGZus{}w) \PYGZdl{}}
\PYG{l+s+s1}{frml  xx      risk               =  (positions.trans() * msigma * positions)[0,0]\PYGZdl{}}
\PYG{l+s+s1}{frml  xx      return             =  (positions.trans() * vreturn        )[0,0] \PYGZdl{}}
\PYG{l+s+s1}{frml  xx      risk\PYGZus{}weighted\PYGZus{}sum     = (risk\PYGZus{}weights.trans() * positions)[0,0] \PYGZdl{}}
\PYG{l+s+s1}{frml  xx      lcr\PYGZus{}weighted\PYGZus{}sum      = (lcr\PYGZus{}weights.trans() * positions)[0,0] \PYGZdl{}}
\PYG{l+s+s1}{frml  xx      leverage\PYGZus{}weighted\PYGZus{}sum = (leverage\PYGZus{}weights.trans() * positions)[0,0] \PYGZdl{}}
\PYG{l+s+s1}{frml  xx      argexpand(valuta1,position\PYGZus{}}\PYG{l+s+si}{\PYGZob{}iso\PYGZcb{}}\PYG{l+s+s1}{) = positions \PYGZdl{}}
\PYG{l+s+s1}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\subsection{Create a model instance}
\label{\detokenize{content/howto/optimization/Optimize_simpel:create-a-model-instance}}
\sphinxAtStartPar
After we have defined our problem in the business language, we can create a model instance.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mvaluta} \PYG{o}{=} \PYG{n}{model}\PYG{o}{.}\PYG{n}{from\PYGZus{}eq}\PYG{p}{(}\PYG{n}{tvaluta}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\subsection{.equation The expanded model equations}
\label{\detokenize{content/howto/optimization/Optimize_simpel:equation-the-expanded-model-equations}}
\sphinxAtStartPar
Here you can see how the matrices are constructed and how tuple unpacking is used to extract values from vectors.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{mvaluta}\PYG{o}{.}\PYG{n}{equations}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
LIST VALUTA1 = ISO  : USD JPY EUR \PYGZdl{}
FRML \PYGZlt{}MATRIX\PYGZgt{} MSIGMA  = MATRIX( [[0.01573635,0.01436816,	0.01045556],
                                 [0.01436816,0.02289016,	0.01172995],
                                 [0.01045556,0.01172995,	0.01748076]]  ) \PYGZdl{}
FRML \PYGZlt{}MATRIX\PYGZgt{} VRETURN         = MATRIX([0.048,0.040,0.035]) \PYGZdl{}
FRML \PYGZlt{}MATRIX\PYGZgt{} MAX\PYGZus{}W             = MATRIX(
[MAX\PYGZus{}USD,MAX\PYGZus{}JPY,MAX\PYGZus{}EUR])      \PYGZdl{}
FRML \PYGZlt{}MATRIX\PYGZgt{} MIN\PYGZus{}W             = MATRIX(
[MIN\PYGZus{}USD,MIN\PYGZus{}JPY,MIN\PYGZus{}EUR])       \PYGZdl{}
FRML \PYGZlt{}MATRIX\PYGZgt{} RISK\PYGZus{}WEIGHTS      = MATRIX(
[RISK\PYGZus{}WEIGHT\PYGZus{}USD,RISK\PYGZus{}WEIGHT\PYGZus{}JPY,RISK\PYGZus{}WEIGHT\PYGZus{}EUR]) \PYGZdl{}
FRML \PYGZlt{}MATRIX\PYGZgt{} LEVERAGE\PYGZus{}WEIGHTS  = MATRIX(
[LEVERAGE\PYGZus{}WEIGHT\PYGZus{}USD,LEVERAGE\PYGZus{}WEIGHT\PYGZus{}JPY,LEVERAGE\PYGZus{}WEIGHT\PYGZus{}EUR]) \PYGZdl{}
FRML \PYGZlt{}MATRIX\PYGZgt{} LCR\PYGZus{}WEIGHTS       = MATRIX(
[LCR\PYGZus{}WEIGHT\PYGZus{}USD,LCR\PYGZus{}WEIGHT\PYGZus{}JPY,LCR\PYGZus{}WEIGHT\PYGZus{}EUR]) \PYGZdl{}
FRML \PYGZlt{}MATRIX\PYGZgt{} POSITIONS          =  MV\PYGZus{}OPT(MSIGMA,VRETURN,RISKAVERSION, TOTAL,
                      [[RISK\PYGZus{}WEIGHTS] , [\PYGZhy{}LCR\PYGZus{}WEIGHTS] , [LEVERAGE\PYGZus{}WEIGHTS]],
                                       [CAPITAL, \PYGZhy{}LCR , EQUITY] ,MIN\PYGZus{}W,MAX\PYGZus{}W) \PYGZdl{}
FRML XX      RISK               =  (POSITIONS.TRANS() * MSIGMA * POSITIONS)[0,0]\PYGZdl{}
FRML XX      RETURN             =  (POSITIONS.TRANS() * VRETURN        )[0,0] \PYGZdl{}
FRML XX      RISK\PYGZus{}WEIGHTED\PYGZus{}SUM     = (RISK\PYGZus{}WEIGHTS.TRANS() * POSITIONS)[0,0] \PYGZdl{}
FRML XX      LCR\PYGZus{}WEIGHTED\PYGZus{}SUM      = (LCR\PYGZus{}WEIGHTS.TRANS() * POSITIONS)[0,0] \PYGZdl{}
FRML XX      LEVERAGE\PYGZus{}WEIGHTED\PYGZus{}SUM = (LEVERAGE\PYGZus{}WEIGHTS.TRANS() * POSITIONS)[0,0] \PYGZdl{}
FRML XX      POSITION\PYGZus{}USD,POSITION\PYGZus{}JPY,POSITION\PYGZus{}EUR = POSITIONS \PYGZdl{}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{.drawmodel() Visualizing the structure of the model}
\label{\detokenize{content/howto/optimization/Optimize_simpel:drawmodel-visualizing-the-structure-of-the-model}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mvaluta}\PYG{o}{.}\PYG{n}{drawmodel}\PYG{p}{(}\PYG{n}{png}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Optimize_simpel_18_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Create a Dataframe}
\label{\detokenize{content/howto/optimization/Optimize_simpel:create-a-dataframe}}
\sphinxAtStartPar
We have defined a model. Let‚Äôs create some data.

\sphinxAtStartPar
We are creating a  dataframe, df, with 500 experiments with increasing risk\sphinxhyphen{}apatite.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{experiments}  \PYG{o}{=} \PYG{p}{[}\PYG{n}{i}  \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{500}\PYG{p}{)}\PYG{p}{]}                     \PYG{c+c1}{\PYGZsh{} make some experiments }
\PYG{n}{riskaversion} \PYG{o}{=} \PYG{p}{[}\PYG{n}{e}\PYG{o}{/}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{experiments}\PYG{p}{)} \PYG{k}{for} \PYG{n}{e} \PYG{o+ow}{in} \PYG{n}{experiments}\PYG{p}{]}    \PYG{c+c1}{\PYGZsh{} set the risk aversion in each experiment }
\PYG{n}{temp}         \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{riskaversion}\PYG{p}{,}\PYG{n}{index}\PYG{o}{=}\PYG{n}{experiments}\PYG{p}{,}\PYG{n}{columns}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RISKAVERSION}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}  \PYG{c+c1}{\PYGZsh{} stuff it into a dataframe}
\PYG{n}{df}    \PYG{o}{=} \PYG{n}{mvaluta}\PYG{o}{.}\PYG{n}{insertModelVar}\PYG{p}{(}\PYG{n}{temp}\PYG{p}{)}\PYG{o}{.}\PYG{n}{pipe}\PYG{p}{(}\PYG{k}{lambda} \PYG{n}{df\PYGZus{}}\PYG{p}{:} \PYG{n}{df\PYGZus{}}\PYG{p}{[}\PYG{n+nb}{sorted}\PYG{p}{(}\PYG{p}{[}\PYG{n}{c} \PYG{k}{for} \PYG{n}{c} \PYG{o+ow}{in} \PYG{n}{df\PYGZus{}}\PYG{o}{.}\PYG{n}{columns}\PYG{p}{]}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{} fill the dataframe}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\subsection{Assigning values to the exogenous variables}
\label{\detokenize{content/howto/optimization/Optimize_simpel:assigning-values-to-the-exogenous-variables}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df}\PYG{o}{.}\PYG{n}{TOTAL}     \PYG{o}{=} \PYG{l+m+mf}{10.0}

\PYG{n}{df}\PYG{o}{.}\PYG{n}{MAX\PYGZus{}USD}   \PYG{o}{=} \PYG{l+m+mi}{90}
\PYG{n}{df}\PYG{o}{.}\PYG{n}{MAX\PYGZus{}JPY}   \PYG{o}{=} \PYG{l+m+mi}{90}
\PYG{n}{df}\PYG{o}{.}\PYG{n}{MAX\PYGZus{}EUR}   \PYG{o}{=} \PYG{l+m+mf}{0.}   \PYG{c+c1}{\PYGZsh{} eur forced to be a liability }

\PYG{n}{df}\PYG{o}{.}\PYG{n}{MIN\PYGZus{}USD}   \PYG{o}{=} \PYG{l+m+mi}{0}
\PYG{n}{df}\PYG{o}{.}\PYG{n}{MIN\PYGZus{}JPY}   \PYG{o}{=} \PYG{l+m+mi}{0}
\PYG{n}{df}\PYG{o}{.}\PYG{n}{MIN\PYGZus{}EUR}   \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{50}
\PYG{n}{df}\PYG{o}{.}\PYG{n}{CAPITAL} \PYG{o}{=} \PYG{l+m+mi}{100}
\PYG{n}{df}\PYG{o}{.}\PYG{n}{RISK\PYGZus{}WEIGHT\PYGZus{}USD} \PYG{o}{=} \PYG{l+m+mi}{1}
\PYG{n}{df}\PYG{o}{.}\PYG{n}{RISK\PYGZus{}WEIGHT\PYGZus{}JPY} \PYG{o}{=} \PYG{l+m+mf}{0.5}
\PYG{n}{df}\PYG{o}{.}\PYG{n}{RISK\PYGZus{}WEIGHT\PYGZus{}EUR} \PYG{o}{=} \PYG{l+m+mf}{0.0}

\PYG{n}{df}\PYG{o}{.}\PYG{n}{EQUITY}  \PYG{o}{=} \PYG{l+m+mf}{8.}
\PYG{n}{df}\PYG{o}{.}\PYG{n}{LEVERAGE\PYGZus{}WEIGHT\PYGZus{}USD} \PYG{o}{=} \PYG{l+m+mf}{0.5}
\PYG{n}{df}\PYG{o}{.}\PYG{n}{LEVERAGE\PYGZus{}WEIGHT\PYGZus{}JPY} \PYG{o}{=} \PYG{l+m+mf}{0.5}
\PYG{n}{df}\PYG{o}{.}\PYG{n}{LEVERAGE\PYGZus{}WEIGHT\PYGZus{}EUR} \PYG{o}{=} \PYG{l+m+mf}{0.0}

\PYG{n}{df}\PYG{o}{.}\PYG{n}{LCR}     \PYG{o}{=} \PYG{l+m+mi}{2}
\PYG{n}{df}\PYG{o}{.}\PYG{n}{LCR\PYGZus{}WEIGHT\PYGZus{}USD} \PYG{o}{=} \PYG{l+m+mf}{0.5}
\PYG{n}{df}\PYG{o}{.}\PYG{n}{LCR\PYGZus{}WEIGHT\PYGZus{}JPY} \PYG{o}{=} \PYG{l+m+mf}{0.1}
\PYG{n}{df}\PYG{o}{.}\PYG{n}{LCR\PYGZus{}WEIGHT\PYGZus{}EUR} \PYG{o}{=} \PYG{l+m+mf}{0.0}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Solve the model for all the experiments}
\label{\detokenize{content/howto/optimization/Optimize_simpel:solve-the-model-for-all-the-experiments}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{results} \PYG{o}{=} \PYG{n}{mvaluta}\PYG{p}{(}\PYG{n}{df}\PYG{p}{,}\PYG{n}{start} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{slut} \PYG{o}{=} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{experiments}\PYG{p}{)}\PYG{p}{,} \PYG{n}{silent} \PYG{o}{=} \PYG{k+kc}{True} \PYG{p}{)}  \PYG{c+c1}{\PYGZsh{} Run the model }
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\subsection{Visualization of results}
\label{\detokenize{content/howto/optimization/Optimize_simpel:visualization-of-results}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{results}\PYG{o}{.}\PYG{n}{RISK} \PYG{o}{=} \PYG{n}{results}\PYG{o}{.}\PYG{n}{RISK}\PYG{o}{.}\PYG{n}{astype}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{float}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{k}{def} \PYG{n+nf}{pplot}\PYG{p}{(}\PYG{n+nb}{vars}\PYG{p}{,}\PYG{n}{ax}\PYG{p}{)}\PYG{p}{:}
    \PYG{k}{for} \PYG{n}{v} \PYG{o+ow}{in} \PYG{n+nb}{vars}\PYG{p}{:}
        
        \PYG{n}{\PYGZus{}} \PYG{o}{=} \PYG{n}{results}\PYG{o}{.}\PYG{n}{plot}\PYG{o}{.}\PYG{n}{line}\PYG{p}{(}\PYG{n}{x}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RISK}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{y}\PYG{o}{=}\PYG{n}{v}\PYG{p}{,}\PYG{n}{ax}\PYG{o}{=}\PYG{n}{axes}\PYG{p}{[}\PYG{n}{ax}\PYG{p}{]}\PYG{p}{)}
        
\PYG{n}{fig}\PYG{p}{,} \PYG{n}{axes} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{n}{nrows}\PYG{o}{=}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{n}{ncols}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}  \PYG{n}{sharex}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,}\PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{9}\PYG{p}{,} \PYG{l+m+mi}{11}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{pplot}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RETURN}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{n}{pplot}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{POSITION\PYGZus{}JPY}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{POSITION\PYGZus{}USD}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{POSITION\PYGZus{}EUR}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}
\PYG{n}{pplot}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RISK\PYGZus{}WEIGHTED\PYGZus{}SUM}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{CAPITAL}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{n}{pplot}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{LEVERAGE\PYGZus{}WEIGHTED\PYGZus{}SUM}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{EQUITY}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Optimize_simpel_26_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxstepscope


\part{More}

\sphinxstepscope


\chapter{Litterature}
\label{\detokenize{content/litterature:litterature}}\label{\detokenize{content/litterature::doc}}
\begin{sphinxthebibliography}{Ber95}
\bibitem[Ber95]{content/litterature:id2}
\sphinxAtStartPar
Ron Berndsen. Causal ordering in economic models. \sphinxstyleemphasis{Decision Support Systems}, 1995. \sphinxhref{https://doi.org/10.1016/0167-9236(94)00034-P}{doi:10.1016/0167\sphinxhyphen{}9236(94)00034\sphinxhyphen{}P}.
\bibitem[BJS21]{content/litterature:id14}
\sphinxAtStartPar
Andrew Burns, Charl Jooste, and Gregor Schwerhoff. \sphinxstyleemphasis{Climate Modeling for Macroeconomic Policy : A Case Study for Pakistan}. Policy Research Working Papers. World Bank, Washington, DC, 2021. URL: \sphinxurl{https://openknowledge.worldbank.org/bitstream/handle/10986/36307/Climate-Modeling-for-Macroeconomic-Policy-A-Case-Study-for-Pakistan.pdf?sequence=1\&isAllowed=y}.
\bibitem[Kog68]{content/litterature:id4}
\sphinxAtStartPar
K.C. Kogiku. \sphinxstyleemphasis{An Introduction to Macroeconomic Models}. McGwaw\sphinxhyphen{}Hill, 1968. URL: \sphinxurl{https://books.google.de/books?id=jp4LzQEACAAJ}.
\bibitem[Pau97]{content/litterature:id8}
\sphinxAtStartPar
Giorgio Pauletto. \sphinxstyleemphasis{Computational Solution of Large\sphinxhyphen{}Scale Macroeconometric Models}. Kluwer Academic Publishers, 01 1997. ISBN 978\sphinxhyphen{}1\sphinxhyphen{}4419\sphinxhyphen{}4778\sphinxhyphen{}9. \sphinxhref{https://doi.org/10.1007/978-1-4757-2631-2\_3}{doi:10.1007/978\sphinxhyphen{}1\sphinxhyphen{}4757\sphinxhyphen{}2631\sphinxhyphen{}2\_3}.
\bibitem[PS87]{content/litterature:id7}
\sphinxAtStartPar
Christian¬†E. Petersen and Christopher¬†A. Sims. Computer simulation of large\sphinxhyphen{}scale econometric models: project link. \sphinxstyleemphasis{International Journal of High Performance Computing Applications}, 1987. URL: \sphinxurl{(http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.853.6387\&rep=rep1\&type=pdf}, \sphinxhref{https://doi.org/10.1177/109434208700100404}{doi:10.1177/109434208700100404}.
\end{sphinxthebibliography}







\renewcommand{\indexname}{Index}
\printindex
\end{document}